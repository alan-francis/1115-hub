{"ingressPaths":{"ingress":{"home":"HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx"}},"initAt":"2024-05-03T10:18:40.507Z","sessionID":"52c6a395-5d83-4051-bb7c-39036f26ab29","src":[{"fsPath":"HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/DEMOGRAPHIC_DATA_20240307.csv","watchPath":{"pathID":"ingress","rootPath":"HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx"},"draining":true},{"fsPath":"HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/QE_ADMIN_DATA_20240307.csv","watchPath":{"pathID":"ingress","rootPath":"HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx"},"draining":true},{"fsPath":"HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/SCREENING_20240307.csv","watchPath":{"pathID":"ingress","rootPath":"HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx"},"draining":true}],"version":"0.17.2","consumed":[{"activity":"move","fsPath":"HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/DEMOGRAPHIC_DATA_20240307.csv"},{"activity":"move","fsPath":"HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/QE_ADMIN_DATA_20240307.csv"},{"activity":"move","fsPath":"HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/SCREENING_20240307.csv"}],"stdErrsEncountered":"âœ… No DuckDB orchestration SQL syntax or SQL parsing errors encountered.","diagsMarkdown":"ðŸ“„ Diagnostics are in HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/diagnostics.md","duckDb":"ðŸ¦† HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.workflow/ingestion-center.duckdb has the raw ingested content and `orch_session_*` validation tables.","sqliteDB":"ðŸ“¦ HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/resource.sqlite.db has the aggregated content and `orch_session_*` validation tables.","referenceDataHome":"/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data","publishFhirURL":"https://40lafnwsw7.execute-api.us-east-1.amazonaws.com/dev/processingAgent=QE","publishFhirResult":[{"response":"{\"message\":\"Missing Authentication Token\"}","fhirJsonStructValid":true,"fhirFileName":"fhir-healthelink-20240305-testcase3-MRN-healthelink19VCFAQISN.json"},{"response":"{\"message\":\"Missing Authentication Token\"}","fhirJsonStructValid":true,"fhirFileName":"fhir-healthelink-20240305-testcase3-MRN-healthelinkGYNB8RC1AS.json"}],"finalizeAt":"2024-05-03T10:18:46.143Z","args":{"workflowPaths":{"ingressTx":{"home":"HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx"},"ingressArchive":{"home":"HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.consumed"},"inProcess":{"home":"HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.workflow"},"egress":{"home":"HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29"}},"walkRootPaths":["HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx"],"referenceDataHome":"/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data","sources":[{"uri":"HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/DEMOGRAPHIC_DATA_20240307.csv","nature":"CSV","tableName":"admin_demographics_20240307","ingestionIssues":0},{"uri":"HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/QE_ADMIN_DATA_20240307.csv","nature":"CSV","tableName":"qe_admin_data_20240307","ingestionIssues":0},{"uri":"HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/SCREENING_20240307.csv","nature":"CSV","tableName":"screening_20240307","ingestionIssues":0},{"uri":"/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ahc-cross-walk.csv","nature":"CSV","tableName":"ahc_cross_walk","ingestionIssues":0},{"uri":"/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-class-reference.csv","nature":"CSV","tableName":"encounter_class_reference","ingestionIssues":0},{"uri":"/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-status-code-reference.csv","nature":"CSV","tableName":"encounter_status_code_reference","ingestionIssues":0},{"uri":"/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-type-code-reference.csv","nature":"CSV","tableName":"encounter_type_code_reference","ingestionIssues":0},{"uri":"/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/screening-status-code-reference.csv","nature":"CSV","tableName":"screening_status_code_reference","ingestionIssues":0},{"uri":"/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/gender-identity-reference.csv","nature":"CSV","tableName":"gender_identity_reference","ingestionIssues":0},{"uri":"/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/administrative-sex-reference.csv","nature":"CSV","tableName":"administrative_sex_reference","ingestionIssues":0},{"uri":"/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sex-at-birth-reference.csv","nature":"CSV","tableName":"sex_at_birth_reference","ingestionIssues":0},{"uri":"/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sexual-orientation-reference.csv","nature":"CSV","tableName":"sexual_orientation_reference","ingestionIssues":0},{"uri":"/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/business-rules.csv","nature":"CSV","tableName":"business_rules","ingestionIssues":0},{"uri":"/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/race-reference.csv","nature":"CSV","tableName":"race_reference","ingestionIssues":0},{"uri":"/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ethnicity-reference.csv","nature":"CSV","tableName":"ethnicity_reference","ingestionIssues":0},{"uri":"/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/preferred-language-reference.csv","nature":"CSV","tableName":"preferred_language_reference","ingestionIssues":0},{"uri":"/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sdoh-domain-reference.csv","nature":"CSV","tableName":"sdoh_domain_reference","ingestionIssues":0}]},"diags":[{"insertable":{"exec_identity":"init","exec_code":"duckdb HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.workflow/ingestion-center.duckdb","sql":"-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"version\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMP,\n    \"elaboration\" TEXT,\n    \"args_json\" TEXT,\n    \"diagnostics_json\" TEXT,\n    \"diagnostics_md\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from 'orch_session'\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, '%Y-%m-%d %H:%M:%S') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, '%Y-%m-%d %H:%M:%S') AS orch_finished_at,\n    \n        -- Including all columns from 'orch_session_entry'\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from 'orch_session_issue'\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES ('fb100496-cb54-5e75-8a29-4fe36e78b522', 'ALAN-FRANCIS', 'SINGLETON', 'UNKNOWN', NULL, '{\"os-arch\":\"x64\",\"os-platform\":\"linux\"}', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"version\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\", \"args_json\", \"diagnostics_json\", \"diagnostics_md\") VALUES ('52c6a395-5d83-4051-bb7c-39036f26ab29', 'fb100496-cb54-5e75-8a29-4fe36e78b522', '0.17.2', ('2024-05-03T10:18:40.514Z'), NULL, NULL, NULL, NULL, 'Session 52c6a395-5d83-4051-bb7c-39036f26ab29 markdown diagnostics not provided (not completed?)');\n\n-- Load Reference data from csvs\n\n-- no after-init SQL found","orch_session_exec_id":"06e5cabe-6b22-5c95-b606-e15660eb1006","exec_nature":"duckdb","exec_status":0,"input_text":"-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"version\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMP,\n    \"elaboration\" TEXT,\n    \"args_json\" TEXT,\n    \"diagnostics_json\" TEXT,\n    \"diagnostics_md\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from 'orch_session'\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, '%Y-%m-%d %H:%M:%S') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, '%Y-%m-%d %H:%M:%S') AS orch_finished_at,\n    \n        -- Including all columns from 'orch_session_entry'\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from 'orch_session_issue'\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES ('fb100496-cb54-5e75-8a29-4fe36e78b522', 'ALAN-FRANCIS', 'SINGLETON', 'UNKNOWN', NULL, '{\"os-arch\":\"x64\",\"os-platform\":\"linux\"}', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"version\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\", \"args_json\", \"diagnostics_json\", \"diagnostics_md\") VALUES ('52c6a395-5d83-4051-bb7c-39036f26ab29', 'fb100496-cb54-5e75-8a29-4fe36e78b522', '0.17.2', ('2024-05-03T10:18:40.514Z'), NULL, NULL, NULL, NULL, 'Session 52c6a395-5d83-4051-bb7c-39036f26ab29 markdown diagnostics not provided (not completed?)');\n\n-- Load Reference data from csvs\n\n-- no after-init SQL found","session_id":"52c6a395-5d83-4051-bb7c-39036f26ab29","narrative_md":"\n## init\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"version\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMP,\n    \"elaboration\" TEXT,\n    \"args_json\" TEXT,\n    \"diagnostics_json\" TEXT,\n    \"diagnostics_md\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from 'orch_session'\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, '%Y-%m-%d %H:%M:%S') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, '%Y-%m-%d %H:%M:%S') AS orch_finished_at,\n    \n        -- Including all columns from 'orch_session_entry'\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from 'orch_session_issue'\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES ('fb100496-cb54-5e75-8a29-4fe36e78b522', 'ALAN-FRANCIS', 'SINGLETON', 'UNKNOWN', NULL, '{\"os-arch\":\"x64\",\"os-platform\":\"linux\"}', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"version\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\", \"args_json\", \"diagnostics_json\", \"diagnostics_md\") VALUES ('52c6a395-5d83-4051-bb7c-39036f26ab29', 'fb100496-cb54-5e75-8a29-4fe36e78b522', '0.17.2', ('2024-05-03T10:18:40.514Z'), NULL, NULL, NULL, NULL, 'Session 52c6a395-5d83-4051-bb7c-39036f26ab29 markdown diagnostics not provided (not completed?)');\n\n-- Load Reference data from csvs\n\n-- no after-init SQL found\n```\nNo STDOUT emitted by `init` (status: `0`).\n\nNo STDERR emitted by `init`.\n\n    "}},{"insertable":{"exec_identity":"ingest","exec_code":"duckdb HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.workflow/ingestion-center.duckdb --json","sql":"-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- ingest HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/DEMOGRAPHIC_DATA_20240307.csv (admin_demographics_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('963ed7bf-d356-54ae-ba2a-739f7f164e1a', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/DEMOGRAPHIC_DATA_20240307.csv', 'admin_demographics_20240307', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('9c13e37e-d059-582b-bfe1-3875f9c96436', '52c6a395-5d83-4051-bb7c-39036f26ab29', '963ed7bf-d356-54ae-ba2a-739f7f164e1a', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'AdminDemographicCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE admin_demographics_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, '963ed7bf-d356-54ae-ba2a-739f7f164e1a' as session_entry_id\n    FROM read_csv_auto('HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/DEMOGRAPHIC_DATA_20240307.csv', types={'MPI_ID': 'VARCHAR', 'SEX_AT_BIRTH_CODE': 'VARCHAR', 'ADMINISTRATIVE_SEX_CODE': 'VARCHAR', 'SEXUAL_ORIENTATION_CODE': 'VARCHAR', 'GENDER_IDENTITY_CODE': 'VARCHAR'});\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('MPI_ID'), ('PAT_MRN_ID'), ('FACILITY_ID'), ('CONSENT'), ('FIRST_NAME'), ('MIDDLE_NAME'), ('LAST_NAME'), ('ADMINISTRATIVE_SEX_CODE'), ('ADMINISTRATIVE_SEX_CODE_DESCRIPTION'), ('ADMINISTRATIVE_SEX_CODE_SYSTEM'), ('SEX_AT_BIRTH_CODE'), ('SEX_AT_BIRTH_CODE_DESCRIPTION'), ('SEX_AT_BIRTH_CODE_SYSTEM'), ('PAT_BIRTH_DATE'), ('ADDRESS1'), ('ADDRESS2'), ('CITY'), ('STATE'), ('ZIP'), ('GENDER_IDENTITY_CODE_SYSTEM_NAME'), ('GENDER_IDENTITY_CODE'), ('GENDER_IDENTITY_CODE_DESCRIPTION'), ('SEXUAL_ORIENTATION_CODE_SYSTEM_NAME'), ('SEXUAL_ORIENTATION_CODE'), ('SEXUAL_ORIENTATION_DESCRIPTION'), ('PREFERRED_LANGUAGE_CODE_SYSTEM_NAME'), ('PREFERRED_LANGUAGE_CODE'), ('PREFERRED_LANGUAGE_DESCRIPTION'), ('RACE_CODE_SYSTEM_NAME'), ('RACE_CODE'), ('RACE_CODE_DESCRIPTION'), ('ETHNICITY_CODE_SYSTEM_NAME'), ('ETHNICITY_CODE'), ('ETHNICITY_CODE_DESCRIPTION'), ('MEDICAID_CIN')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'admin_demographics_20240307')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in admin_demographics_20240307.',\n           'Ensure admin_demographics_20240307 contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('e5f8dcaa-aaab-5807-a510-a2478c89fc30', '52c6a395-5d83-4051-bb7c-39036f26ab29', '963ed7bf-d356-54ae-ba2a-739f7f164e1a', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'AdminDemographicCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/QE_ADMIN_DATA_20240307.csv (qe_admin_data_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('767cb8df-3ec0-5b59-998e-a91e75be32b3', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/QE_ADMIN_DATA_20240307.csv', 'qe_admin_data_20240307', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('523de5c7-6ede-5e49-9570-5621dde1f65a', '52c6a395-5d83-4051-bb7c-39036f26ab29', '767cb8df-3ec0-5b59-998e-a91e75be32b3', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'QeAdminDataCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE qe_admin_data_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, '767cb8df-3ec0-5b59-998e-a91e75be32b3' as session_entry_id\n    FROM read_csv_auto('HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/QE_ADMIN_DATA_20240307.csv');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('PAT_MRN_ID'), ('FACILITY_ID'), ('FACILITY_LONG_NAME'), ('ORGANIZATION_TYPE'), ('FACILITY_ADDRESS1'), ('FACILITY_ADDRESS2'), ('FACILITY_CITY'), ('FACILITY_STATE'), ('FACILITY_ZIP'), ('VISIT_PART_2_FLAG'), ('VISIT_OMH_FLAG'), ('VISIT_OPWDD_FLAG')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'qe_admin_data_20240307')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in qe_admin_data_20240307.',\n           'Ensure qe_admin_data_20240307 contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('f70136eb-81d9-550f-8910-1c9d430c71e5', '52c6a395-5d83-4051-bb7c-39036f26ab29', '767cb8df-3ec0-5b59-998e-a91e75be32b3', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'QeAdminDataCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/SCREENING_20240307.csv (screening_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('d09ebe08-1b63-56d8-8f2b-8fff76c9828f', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/SCREENING_20240307.csv', 'screening_20240307', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('aebb9881-f0ee-54c4-be68-53ce86973e56', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'd09ebe08-1b63-56d8-8f2b-8fff76c9828f', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'ScreeningCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE screening_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, 'd09ebe08-1b63-56d8-8f2b-8fff76c9828f' as session_entry_id\n    FROM read_csv_auto('HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/SCREENING_20240307.csv', types={'RECORDED_TIME': 'VARCHAR', 'ENCOUNTER_TYPE_CODE': 'VARCHAR'});\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('PAT_MRN_ID'), ('FACILITY_ID'), ('ENCOUNTER_ID'), ('ENCOUNTER_CLASS_CODE_SYSTEM'), ('ENCOUNTER_CLASS_CODE'), ('ENCOUNTER_CLASS_CODE_DESCRIPTION'), ('ENCOUNTER_STATUS_CODE_SYSTEM'), ('ENCOUNTER_STATUS_CODE'), ('ENCOUNTER_STATUS_CODE_DESCRIPTION'), ('ENCOUNTER_TYPE_CODE_SYSTEM'), ('ENCOUNTER_TYPE_CODE'), ('ENCOUNTER_TYPE_CODE_DESCRIPTION'), ('SCREENING_CODE_DESCRIPTION'), ('SCREENING_CODE_SYSTEM_NAME'), ('SCREENING_CODE'), ('SCREENING_STATUS_CODE_DESCRIPTION'), ('SCREENING_STATUS_CODE'), ('SCREENING_STATUS_CODE_SYSTEM'), ('RECORDED_TIME'), ('QUESTION_CODE_DESCRIPTION'), ('ANSWER_CODE_DESCRIPTION'), ('UCUM_UNITS'), ('QUESTION_CODE'), ('QUESTION_CODE_SYSTEM_NAME'), ('ANSWER_CODE'), ('ANSWER_CODE_SYSTEM_NAME'), ('PARENT_QUESTION_CODE'), ('SDOH_DOMAIN'), ('POTENTIAL_NEED_INDICATED')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'screening_20240307')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in screening_20240307.',\n           'Ensure screening_20240307 contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('6506f244-6870-581c-a47e-875c52326818', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'd09ebe08-1b63-56d8-8f2b-8fff76c9828f', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'ScreeningCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ahc-cross-walk.csv (ahc_cross_walk)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('b9aac8ec-792a-511d-8107-25bd96085898', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ahc-cross-walk.csv', 'ahc_cross_walk', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('5b7d69bd-b348-556b-8e3a-4a4c4397163c', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b9aac8ec-792a-511d-8107-25bd96085898', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'AhcCrossWalkCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_cross_walk AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, 'b9aac8ec-792a-511d-8107-25bd96085898' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ahc-cross-walk.csv', header = true);\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('SCREENING_CODE'), ('SCREENING_CODE_DESCRIPTION'), ('QUESTION_SLNO'), ('QUESTION'), ('QUESTION_CODE'), ('QUESTION_SLNO_REFERENCE'), ('ANSWER_VALUE'), ('ANSWER_CODE'), ('CALCULATED_FIELD'), ('SCORE'), ('UCUM_UNITS'), ('SDOH_DOMAIN'), ('POTENTIAL_NEED_INDICATED')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'ahc_cross_walk')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'b9aac8ec-792a-511d-8107-25bd96085898',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in ahc_cross_walk.',\n           'Ensure ahc_cross_walk contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7c00755d-cac1-5780-b386-435fac109c1e', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b9aac8ec-792a-511d-8107-25bd96085898', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'AhcCrossWalkCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-class-reference.csv (encounter_class_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('48eb0055-f06e-57f4-8019-f49266be3d22', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-class-reference.csv', 'encounter_class_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('a4d8a2c7-1ed0-532c-8617-9b840e0db2a1', '52c6a395-5d83-4051-bb7c-39036f26ab29', '48eb0055-f06e-57f4-8019-f49266be3d22', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'EncounterClassReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE encounter_class_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, '48eb0055-f06e-57f4-8019-f49266be3d22' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-class-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('Code'), ('System'), ('Display'), ('Definition')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'encounter_class_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '48eb0055-f06e-57f4-8019-f49266be3d22',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in encounter_class_reference.',\n           'Ensure encounter_class_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('60e9c67a-d11b-58a8-b606-fec8ae5534b4', '52c6a395-5d83-4051-bb7c-39036f26ab29', '48eb0055-f06e-57f4-8019-f49266be3d22', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'EncounterClassReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-status-code-reference.csv (encounter_status_code_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('2e9c77e9-a664-5323-83e4-e6a92cf998ab', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-status-code-reference.csv', 'encounter_status_code_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('ff07588a-62bc-500b-a066-3dc216afa1c5', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2e9c77e9-a664-5323-83e4-e6a92cf998ab', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'EncounterStatusCodeReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE encounter_status_code_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, '2e9c77e9-a664-5323-83e4-e6a92cf998ab' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-status-code-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('Code'), ('Display'), ('Definition')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'encounter_status_code_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '2e9c77e9-a664-5323-83e4-e6a92cf998ab',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in encounter_status_code_reference.',\n           'Ensure encounter_status_code_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('24cfaeaa-484a-5041-9d81-e7c4fb141c4d', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2e9c77e9-a664-5323-83e4-e6a92cf998ab', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'EncounterStatusCodeReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-type-code-reference.csv (encounter_type_code_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('4b3dd9ab-d81b-509a-9662-68dbd6d142f7', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-type-code-reference.csv', 'encounter_type_code_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('813b4f2b-cc81-5ed4-9305-625009c58ab7', '52c6a395-5d83-4051-bb7c-39036f26ab29', '4b3dd9ab-d81b-509a-9662-68dbd6d142f7', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'EncounterTypeCodeReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE encounter_type_code_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, '4b3dd9ab-d81b-509a-9662-68dbd6d142f7' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-type-code-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('Code'), ('System'), ('Display')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'encounter_type_code_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '4b3dd9ab-d81b-509a-9662-68dbd6d142f7',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in encounter_type_code_reference.',\n           'Ensure encounter_type_code_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('dc2b6f5f-7872-5968-a30f-f8df2e860803', '52c6a395-5d83-4051-bb7c-39036f26ab29', '4b3dd9ab-d81b-509a-9662-68dbd6d142f7', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'EncounterTypeCodeReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/screening-status-code-reference.csv (screening_status_code_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('1a152daa-273d-5411-88cf-84067822a8aa', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/screening-status-code-reference.csv', 'screening_status_code_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('a1402393-e3cf-5cc3-a644-da19d3689fc7', '52c6a395-5d83-4051-bb7c-39036f26ab29', '1a152daa-273d-5411-88cf-84067822a8aa', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE screening_status_code_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, '1a152daa-273d-5411-88cf-84067822a8aa' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/screening-status-code-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('Lvl'), ('Code'), ('Display'), ('Definition')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'screening_status_code_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '1a152daa-273d-5411-88cf-84067822a8aa',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in screening_status_code_reference.',\n           'Ensure screening_status_code_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('72b2e7e1-545d-540e-bbd7-5ab6b566a52a', '52c6a395-5d83-4051-bb7c-39036f26ab29', '1a152daa-273d-5411-88cf-84067822a8aa', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/gender-identity-reference.csv (gender_identity_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('787ee7ff-3ef5-59aa-a055-659cf10b6202', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/gender-identity-reference.csv', 'gender_identity_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('30f231bd-8ace-577e-ac7d-b7484a41cf8c', '52c6a395-5d83-4051-bb7c-39036f26ab29', '787ee7ff-3ef5-59aa-a055-659cf10b6202', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'GenderIdentityReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE gender_identity_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, '787ee7ff-3ef5-59aa-a055-659cf10b6202' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/gender-identity-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('GENDER_IDENTITY_CODE'), ('GENDER_IDENTITY_CODE_DESCRIPTION'), ('GENDER_IDENTITY_CODE_SYSTEM_NAME')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'gender_identity_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '787ee7ff-3ef5-59aa-a055-659cf10b6202',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in gender_identity_reference.',\n           'Ensure gender_identity_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('c33e617a-4c3b-5907-b98a-f576ff4ac7bd', '52c6a395-5d83-4051-bb7c-39036f26ab29', '787ee7ff-3ef5-59aa-a055-659cf10b6202', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'GenderIdentityReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/administrative-sex-reference.csv (administrative_sex_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('79f3d60e-c863-5759-8043-f122175a7cbb', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/administrative-sex-reference.csv', 'administrative_sex_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('6a920ce5-e480-5723-a3f5-e3167db5bd23', '52c6a395-5d83-4051-bb7c-39036f26ab29', '79f3d60e-c863-5759-8043-f122175a7cbb', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'AdministrativeSexReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE administrative_sex_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, '79f3d60e-c863-5759-8043-f122175a7cbb' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/administrative-sex-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('ADMINISTRATIVE_SEX_CODE'), ('ADMINISTRATIVE_SEX_CODE_DESCRIPTION'), ('ADMINISTRATIVE_SEX_CODE_SYSTEM')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'administrative_sex_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '79f3d60e-c863-5759-8043-f122175a7cbb',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in administrative_sex_reference.',\n           'Ensure administrative_sex_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('476191aa-f321-5d08-be13-ba624ad50951', '52c6a395-5d83-4051-bb7c-39036f26ab29', '79f3d60e-c863-5759-8043-f122175a7cbb', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'AdministrativeSexReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sex-at-birth-reference.csv (sex_at_birth_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('6c2d9879-7393-524d-9e9e-02ea961aca39', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sex-at-birth-reference.csv', 'sex_at_birth_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('438bb3e5-1ee9-5ed9-9763-4626ae804fad', '52c6a395-5d83-4051-bb7c-39036f26ab29', '6c2d9879-7393-524d-9e9e-02ea961aca39', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'SexAtBirthReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE sex_at_birth_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, '6c2d9879-7393-524d-9e9e-02ea961aca39' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sex-at-birth-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('SEX_AT_BIRTH_CODE'), ('SEX_AT_BIRTH_CODE_DESCRIPTION'), ('SEX_AT_BIRTH_CODE_SYSTEM')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'sex_at_birth_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '6c2d9879-7393-524d-9e9e-02ea961aca39',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in sex_at_birth_reference.',\n           'Ensure sex_at_birth_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('4bf5c21f-f9bc-5798-a40f-49354972a8e7', '52c6a395-5d83-4051-bb7c-39036f26ab29', '6c2d9879-7393-524d-9e9e-02ea961aca39', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'SexAtBirthReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sexual-orientation-reference.csv (sexual_orientation_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('2239dca2-9dd4-5c3a-91c8-2585839b9584', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sexual-orientation-reference.csv', 'sexual_orientation_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('f02a11b9-d2a8-547c-b57c-7a67b06a3716', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2239dca2-9dd4-5c3a-91c8-2585839b9584', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'SexualOrientationReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE sexual_orientation_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, '2239dca2-9dd4-5c3a-91c8-2585839b9584' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sexual-orientation-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('SEXUAL_ORIENTATION_CODE'), ('SEXUAL_ORIENTATION_CODE_DESCRIPTION'), ('SEXUAL_ORIENTATION_CODE_SYSTEM_NAME')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'sexual_orientation_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '2239dca2-9dd4-5c3a-91c8-2585839b9584',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in sexual_orientation_reference.',\n           'Ensure sexual_orientation_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('f3038d1f-a52a-597e-92b4-1e0be7e6d464', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2239dca2-9dd4-5c3a-91c8-2585839b9584', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'SexualOrientationReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/business-rules.csv (business_rules)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('fc740f9e-863e-5dd1-b1a1-86d176cb549c', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/business-rules.csv', 'business_rules', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('5f9ab8c7-65b5-5dd8-9e6b-1501c2a639a9', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'fc740f9e-863e-5dd1-b1a1-86d176cb549c', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'BusinessRulesReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE business_rules AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, 'fc740f9e-863e-5dd1-b1a1-86d176cb549c' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/business-rules.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('Worksheet'), ('Field'), ('Required'), ('Permissible Values'), ('True Rejection'), ('Warning Layer'), ('Resolved by QE/QCS')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'business_rules')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'fc740f9e-863e-5dd1-b1a1-86d176cb549c',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in business_rules.',\n           'Ensure business_rules contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('939acb5c-0c8e-5d68-9797-9e37ecf7f0a1', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'fc740f9e-863e-5dd1-b1a1-86d176cb549c', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'BusinessRulesReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/race-reference.csv (race_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('f98a88dc-a929-5a9b-906a-277e62c93012', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/race-reference.csv', 'race_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('48fd69a6-5ad7-5d32-aa35-f9c05860c3d3', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f98a88dc-a929-5a9b-906a-277e62c93012', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'RaceReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE race_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, 'f98a88dc-a929-5a9b-906a-277e62c93012' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/race-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('Concept Name'), ('Concept Code'), ('Hierarchical Code'), ('Race Category (Concept Name)'), ('Race Category (Concept Code)'), ('Hiearchical Code')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'race_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'f98a88dc-a929-5a9b-906a-277e62c93012',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in race_reference.',\n           'Ensure race_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('72451a16-9ba1-5038-a58a-c3aca50cfad6', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f98a88dc-a929-5a9b-906a-277e62c93012', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'RaceReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ethnicity-reference.csv (ethnicity_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('b0cbca95-5c20-5b2b-b589-9e832c556bc6', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ethnicity-reference.csv', 'ethnicity_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('d0ed9035-6320-5391-8d2e-509cdc185699', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b0cbca95-5c20-5b2b-b589-9e832c556bc6', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'EthnicityReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ethnicity_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, 'b0cbca95-5c20-5b2b-b589-9e832c556bc6' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ethnicity-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('Concept Code'), ('Concept Name'), ('Hierarchical Code'), ('Ethnicity Group (Concept Name)'), ('Ethnicity Group (Concept Code)')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'ethnicity_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'b0cbca95-5c20-5b2b-b589-9e832c556bc6',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in ethnicity_reference.',\n           'Ensure ethnicity_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('f517a0e3-a9aa-5e82-83d1-5ace996332f0', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b0cbca95-5c20-5b2b-b589-9e832c556bc6', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'EthnicityReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/preferred-language-reference.csv (preferred_language_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('3469db42-0066-5f23-9ee4-2b857bf339a4', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/preferred-language-reference.csv', 'preferred_language_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('d65cb030-fbbf-55e3-b848-18fd81a32679', '52c6a395-5d83-4051-bb7c-39036f26ab29', '3469db42-0066-5f23-9ee4-2b857bf339a4', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'PreferredLanguageReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE preferred_language_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, '3469db42-0066-5f23-9ee4-2b857bf339a4' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/preferred-language-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('ISO 639-2 Code'), ('ISO 639-1 Code'), ('English name of Language'), ('French name of Language'), ('German name of Language')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'preferred_language_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '3469db42-0066-5f23-9ee4-2b857bf339a4',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in preferred_language_reference.',\n           'Ensure preferred_language_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('f1c1a13a-58bf-51c3-92e0-12f2056f8a68', '52c6a395-5d83-4051-bb7c-39036f26ab29', '3469db42-0066-5f23-9ee4-2b857bf339a4', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'PreferredLanguageReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sdoh-domain-reference.csv (sdoh_domain_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('f19d5ebb-ea63-5b1d-b1b1-758457a2da29', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sdoh-domain-reference.csv', 'sdoh_domain_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('34308a17-4300-50d6-96bd-b34982aa25db', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f19d5ebb-ea63-5b1d-b1b1-758457a2da29', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'SdohDomainReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE sdoh_domain_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, 'f19d5ebb-ea63-5b1d-b1b1-758457a2da29' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sdoh-domain-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('Code'), ('Display'), ('Definition')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'sdoh_domain_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'f19d5ebb-ea63-5b1d-b1b1-758457a2da29',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in sdoh_domain_reference.',\n           'Ensure sdoh_domain_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('3204b0bd-3443-59e9-9b22-d1881b9c7797', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f19d5ebb-ea63-5b1d-b1b1-758457a2da29', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'SdohDomainReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'screening_20240307'\n        AS table_name,\n        'SCREENING' AS table_name_suffix\n      UNION ALL\n      SELECT 'admin_demographics_20240307'\n        AS table_name,\n        'DEMOGRAPHIC_DATA' AS table_name_suffix\n      UNION ALL\n      SELECT 'qe_admin_data_20240307'\n        AS table_name,\n        'QE_ADMIN_DATA' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'admin_demographics_20240307' IN (\n      'screening_20240307',\n      'admin_demographics_20240307',\n      'qe_admin_data_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'screening_20240307'\n        AS table_name,\n        'SCREENING' AS table_name_suffix\n      UNION ALL\n      SELECT 'admin_demographics_20240307'\n        AS table_name,\n        'DEMOGRAPHIC_DATA' AS table_name_suffix\n      UNION ALL\n      SELECT 'qe_admin_data_20240307'\n        AS table_name,\n        'QE_ADMIN_DATA' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'qe_admin_data_20240307' IN (\n      'screening_20240307',\n      'admin_demographics_20240307',\n      'qe_admin_data_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'screening_20240307'\n        AS table_name,\n        'SCREENING' AS table_name_suffix\n      UNION ALL\n      SELECT 'admin_demographics_20240307'\n        AS table_name,\n        'DEMOGRAPHIC_DATA' AS table_name_suffix\n      UNION ALL\n      SELECT 'qe_admin_data_20240307'\n        AS table_name,\n        'QE_ADMIN_DATA' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'screening_20240307' IN (\n      'screening_20240307',\n      'admin_demographics_20240307',\n      'qe_admin_data_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'screening_20240307'\n        AS table_name,\n        'SCREENING' AS table_name_suffix\n      UNION ALL\n      SELECT 'admin_demographics_20240307'\n        AS table_name,\n        'DEMOGRAPHIC_DATA' AS table_name_suffix\n      UNION ALL\n      SELECT 'qe_admin_data_20240307'\n        AS table_name,\n        'QE_ADMIN_DATA' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'screening_status_code_reference' IN (\n      'screening_20240307',\n      'admin_demographics_20240307',\n      'qe_admin_data_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '1a152daa-273d-5411-88cf-84067822a8aa',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nSELECT osi.session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value, ingest_table_name FROM orch_session_issue osi LEFT JOIN orch_session_entry ose ON osi.session_entry_id = ose.orch_session_entry_id WHERE osi.session_id = '52c6a395-5d83-4051-bb7c-39036f26ab29'","output_nature":"JSON","orch_session_exec_id":"986fcfe7-9b44-5a16-b7cc-ea656710ca64","exec_nature":"duckdb","exec_status":0,"input_text":"-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- ingest HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/DEMOGRAPHIC_DATA_20240307.csv (admin_demographics_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('963ed7bf-d356-54ae-ba2a-739f7f164e1a', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/DEMOGRAPHIC_DATA_20240307.csv', 'admin_demographics_20240307', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('9c13e37e-d059-582b-bfe1-3875f9c96436', '52c6a395-5d83-4051-bb7c-39036f26ab29', '963ed7bf-d356-54ae-ba2a-739f7f164e1a', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'AdminDemographicCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE admin_demographics_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, '963ed7bf-d356-54ae-ba2a-739f7f164e1a' as session_entry_id\n    FROM read_csv_auto('HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/DEMOGRAPHIC_DATA_20240307.csv', types={'MPI_ID': 'VARCHAR', 'SEX_AT_BIRTH_CODE': 'VARCHAR', 'ADMINISTRATIVE_SEX_CODE': 'VARCHAR', 'SEXUAL_ORIENTATION_CODE': 'VARCHAR', 'GENDER_IDENTITY_CODE': 'VARCHAR'});\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('MPI_ID'), ('PAT_MRN_ID'), ('FACILITY_ID'), ('CONSENT'), ('FIRST_NAME'), ('MIDDLE_NAME'), ('LAST_NAME'), ('ADMINISTRATIVE_SEX_CODE'), ('ADMINISTRATIVE_SEX_CODE_DESCRIPTION'), ('ADMINISTRATIVE_SEX_CODE_SYSTEM'), ('SEX_AT_BIRTH_CODE'), ('SEX_AT_BIRTH_CODE_DESCRIPTION'), ('SEX_AT_BIRTH_CODE_SYSTEM'), ('PAT_BIRTH_DATE'), ('ADDRESS1'), ('ADDRESS2'), ('CITY'), ('STATE'), ('ZIP'), ('GENDER_IDENTITY_CODE_SYSTEM_NAME'), ('GENDER_IDENTITY_CODE'), ('GENDER_IDENTITY_CODE_DESCRIPTION'), ('SEXUAL_ORIENTATION_CODE_SYSTEM_NAME'), ('SEXUAL_ORIENTATION_CODE'), ('SEXUAL_ORIENTATION_DESCRIPTION'), ('PREFERRED_LANGUAGE_CODE_SYSTEM_NAME'), ('PREFERRED_LANGUAGE_CODE'), ('PREFERRED_LANGUAGE_DESCRIPTION'), ('RACE_CODE_SYSTEM_NAME'), ('RACE_CODE'), ('RACE_CODE_DESCRIPTION'), ('ETHNICITY_CODE_SYSTEM_NAME'), ('ETHNICITY_CODE'), ('ETHNICITY_CODE_DESCRIPTION'), ('MEDICAID_CIN')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'admin_demographics_20240307')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in admin_demographics_20240307.',\n           'Ensure admin_demographics_20240307 contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('e5f8dcaa-aaab-5807-a510-a2478c89fc30', '52c6a395-5d83-4051-bb7c-39036f26ab29', '963ed7bf-d356-54ae-ba2a-739f7f164e1a', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'AdminDemographicCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/QE_ADMIN_DATA_20240307.csv (qe_admin_data_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('767cb8df-3ec0-5b59-998e-a91e75be32b3', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/QE_ADMIN_DATA_20240307.csv', 'qe_admin_data_20240307', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('523de5c7-6ede-5e49-9570-5621dde1f65a', '52c6a395-5d83-4051-bb7c-39036f26ab29', '767cb8df-3ec0-5b59-998e-a91e75be32b3', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'QeAdminDataCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE qe_admin_data_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, '767cb8df-3ec0-5b59-998e-a91e75be32b3' as session_entry_id\n    FROM read_csv_auto('HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/QE_ADMIN_DATA_20240307.csv');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('PAT_MRN_ID'), ('FACILITY_ID'), ('FACILITY_LONG_NAME'), ('ORGANIZATION_TYPE'), ('FACILITY_ADDRESS1'), ('FACILITY_ADDRESS2'), ('FACILITY_CITY'), ('FACILITY_STATE'), ('FACILITY_ZIP'), ('VISIT_PART_2_FLAG'), ('VISIT_OMH_FLAG'), ('VISIT_OPWDD_FLAG')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'qe_admin_data_20240307')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in qe_admin_data_20240307.',\n           'Ensure qe_admin_data_20240307 contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('f70136eb-81d9-550f-8910-1c9d430c71e5', '52c6a395-5d83-4051-bb7c-39036f26ab29', '767cb8df-3ec0-5b59-998e-a91e75be32b3', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'QeAdminDataCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/SCREENING_20240307.csv (screening_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('d09ebe08-1b63-56d8-8f2b-8fff76c9828f', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/SCREENING_20240307.csv', 'screening_20240307', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('aebb9881-f0ee-54c4-be68-53ce86973e56', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'd09ebe08-1b63-56d8-8f2b-8fff76c9828f', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'ScreeningCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE screening_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, 'd09ebe08-1b63-56d8-8f2b-8fff76c9828f' as session_entry_id\n    FROM read_csv_auto('HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/SCREENING_20240307.csv', types={'RECORDED_TIME': 'VARCHAR', 'ENCOUNTER_TYPE_CODE': 'VARCHAR'});\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('PAT_MRN_ID'), ('FACILITY_ID'), ('ENCOUNTER_ID'), ('ENCOUNTER_CLASS_CODE_SYSTEM'), ('ENCOUNTER_CLASS_CODE'), ('ENCOUNTER_CLASS_CODE_DESCRIPTION'), ('ENCOUNTER_STATUS_CODE_SYSTEM'), ('ENCOUNTER_STATUS_CODE'), ('ENCOUNTER_STATUS_CODE_DESCRIPTION'), ('ENCOUNTER_TYPE_CODE_SYSTEM'), ('ENCOUNTER_TYPE_CODE'), ('ENCOUNTER_TYPE_CODE_DESCRIPTION'), ('SCREENING_CODE_DESCRIPTION'), ('SCREENING_CODE_SYSTEM_NAME'), ('SCREENING_CODE'), ('SCREENING_STATUS_CODE_DESCRIPTION'), ('SCREENING_STATUS_CODE'), ('SCREENING_STATUS_CODE_SYSTEM'), ('RECORDED_TIME'), ('QUESTION_CODE_DESCRIPTION'), ('ANSWER_CODE_DESCRIPTION'), ('UCUM_UNITS'), ('QUESTION_CODE'), ('QUESTION_CODE_SYSTEM_NAME'), ('ANSWER_CODE'), ('ANSWER_CODE_SYSTEM_NAME'), ('PARENT_QUESTION_CODE'), ('SDOH_DOMAIN'), ('POTENTIAL_NEED_INDICATED')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'screening_20240307')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in screening_20240307.',\n           'Ensure screening_20240307 contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('6506f244-6870-581c-a47e-875c52326818', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'd09ebe08-1b63-56d8-8f2b-8fff76c9828f', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'ScreeningCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ahc-cross-walk.csv (ahc_cross_walk)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('b9aac8ec-792a-511d-8107-25bd96085898', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ahc-cross-walk.csv', 'ahc_cross_walk', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('5b7d69bd-b348-556b-8e3a-4a4c4397163c', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b9aac8ec-792a-511d-8107-25bd96085898', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'AhcCrossWalkCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_cross_walk AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, 'b9aac8ec-792a-511d-8107-25bd96085898' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ahc-cross-walk.csv', header = true);\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('SCREENING_CODE'), ('SCREENING_CODE_DESCRIPTION'), ('QUESTION_SLNO'), ('QUESTION'), ('QUESTION_CODE'), ('QUESTION_SLNO_REFERENCE'), ('ANSWER_VALUE'), ('ANSWER_CODE'), ('CALCULATED_FIELD'), ('SCORE'), ('UCUM_UNITS'), ('SDOH_DOMAIN'), ('POTENTIAL_NEED_INDICATED')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'ahc_cross_walk')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'b9aac8ec-792a-511d-8107-25bd96085898',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in ahc_cross_walk.',\n           'Ensure ahc_cross_walk contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7c00755d-cac1-5780-b386-435fac109c1e', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b9aac8ec-792a-511d-8107-25bd96085898', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'AhcCrossWalkCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-class-reference.csv (encounter_class_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('48eb0055-f06e-57f4-8019-f49266be3d22', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-class-reference.csv', 'encounter_class_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('a4d8a2c7-1ed0-532c-8617-9b840e0db2a1', '52c6a395-5d83-4051-bb7c-39036f26ab29', '48eb0055-f06e-57f4-8019-f49266be3d22', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'EncounterClassReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE encounter_class_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, '48eb0055-f06e-57f4-8019-f49266be3d22' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-class-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('Code'), ('System'), ('Display'), ('Definition')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'encounter_class_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '48eb0055-f06e-57f4-8019-f49266be3d22',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in encounter_class_reference.',\n           'Ensure encounter_class_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('60e9c67a-d11b-58a8-b606-fec8ae5534b4', '52c6a395-5d83-4051-bb7c-39036f26ab29', '48eb0055-f06e-57f4-8019-f49266be3d22', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'EncounterClassReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-status-code-reference.csv (encounter_status_code_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('2e9c77e9-a664-5323-83e4-e6a92cf998ab', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-status-code-reference.csv', 'encounter_status_code_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('ff07588a-62bc-500b-a066-3dc216afa1c5', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2e9c77e9-a664-5323-83e4-e6a92cf998ab', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'EncounterStatusCodeReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE encounter_status_code_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, '2e9c77e9-a664-5323-83e4-e6a92cf998ab' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-status-code-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('Code'), ('Display'), ('Definition')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'encounter_status_code_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '2e9c77e9-a664-5323-83e4-e6a92cf998ab',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in encounter_status_code_reference.',\n           'Ensure encounter_status_code_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('24cfaeaa-484a-5041-9d81-e7c4fb141c4d', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2e9c77e9-a664-5323-83e4-e6a92cf998ab', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'EncounterStatusCodeReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-type-code-reference.csv (encounter_type_code_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('4b3dd9ab-d81b-509a-9662-68dbd6d142f7', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-type-code-reference.csv', 'encounter_type_code_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('813b4f2b-cc81-5ed4-9305-625009c58ab7', '52c6a395-5d83-4051-bb7c-39036f26ab29', '4b3dd9ab-d81b-509a-9662-68dbd6d142f7', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'EncounterTypeCodeReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE encounter_type_code_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, '4b3dd9ab-d81b-509a-9662-68dbd6d142f7' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-type-code-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('Code'), ('System'), ('Display')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'encounter_type_code_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '4b3dd9ab-d81b-509a-9662-68dbd6d142f7',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in encounter_type_code_reference.',\n           'Ensure encounter_type_code_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('dc2b6f5f-7872-5968-a30f-f8df2e860803', '52c6a395-5d83-4051-bb7c-39036f26ab29', '4b3dd9ab-d81b-509a-9662-68dbd6d142f7', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'EncounterTypeCodeReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/screening-status-code-reference.csv (screening_status_code_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('1a152daa-273d-5411-88cf-84067822a8aa', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/screening-status-code-reference.csv', 'screening_status_code_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('a1402393-e3cf-5cc3-a644-da19d3689fc7', '52c6a395-5d83-4051-bb7c-39036f26ab29', '1a152daa-273d-5411-88cf-84067822a8aa', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE screening_status_code_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, '1a152daa-273d-5411-88cf-84067822a8aa' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/screening-status-code-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('Lvl'), ('Code'), ('Display'), ('Definition')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'screening_status_code_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '1a152daa-273d-5411-88cf-84067822a8aa',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in screening_status_code_reference.',\n           'Ensure screening_status_code_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('72b2e7e1-545d-540e-bbd7-5ab6b566a52a', '52c6a395-5d83-4051-bb7c-39036f26ab29', '1a152daa-273d-5411-88cf-84067822a8aa', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/gender-identity-reference.csv (gender_identity_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('787ee7ff-3ef5-59aa-a055-659cf10b6202', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/gender-identity-reference.csv', 'gender_identity_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('30f231bd-8ace-577e-ac7d-b7484a41cf8c', '52c6a395-5d83-4051-bb7c-39036f26ab29', '787ee7ff-3ef5-59aa-a055-659cf10b6202', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'GenderIdentityReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE gender_identity_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, '787ee7ff-3ef5-59aa-a055-659cf10b6202' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/gender-identity-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('GENDER_IDENTITY_CODE'), ('GENDER_IDENTITY_CODE_DESCRIPTION'), ('GENDER_IDENTITY_CODE_SYSTEM_NAME')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'gender_identity_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '787ee7ff-3ef5-59aa-a055-659cf10b6202',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in gender_identity_reference.',\n           'Ensure gender_identity_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('c33e617a-4c3b-5907-b98a-f576ff4ac7bd', '52c6a395-5d83-4051-bb7c-39036f26ab29', '787ee7ff-3ef5-59aa-a055-659cf10b6202', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'GenderIdentityReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/administrative-sex-reference.csv (administrative_sex_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('79f3d60e-c863-5759-8043-f122175a7cbb', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/administrative-sex-reference.csv', 'administrative_sex_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('6a920ce5-e480-5723-a3f5-e3167db5bd23', '52c6a395-5d83-4051-bb7c-39036f26ab29', '79f3d60e-c863-5759-8043-f122175a7cbb', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'AdministrativeSexReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE administrative_sex_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, '79f3d60e-c863-5759-8043-f122175a7cbb' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/administrative-sex-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('ADMINISTRATIVE_SEX_CODE'), ('ADMINISTRATIVE_SEX_CODE_DESCRIPTION'), ('ADMINISTRATIVE_SEX_CODE_SYSTEM')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'administrative_sex_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '79f3d60e-c863-5759-8043-f122175a7cbb',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in administrative_sex_reference.',\n           'Ensure administrative_sex_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('476191aa-f321-5d08-be13-ba624ad50951', '52c6a395-5d83-4051-bb7c-39036f26ab29', '79f3d60e-c863-5759-8043-f122175a7cbb', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'AdministrativeSexReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sex-at-birth-reference.csv (sex_at_birth_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('6c2d9879-7393-524d-9e9e-02ea961aca39', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sex-at-birth-reference.csv', 'sex_at_birth_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('438bb3e5-1ee9-5ed9-9763-4626ae804fad', '52c6a395-5d83-4051-bb7c-39036f26ab29', '6c2d9879-7393-524d-9e9e-02ea961aca39', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'SexAtBirthReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE sex_at_birth_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, '6c2d9879-7393-524d-9e9e-02ea961aca39' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sex-at-birth-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('SEX_AT_BIRTH_CODE'), ('SEX_AT_BIRTH_CODE_DESCRIPTION'), ('SEX_AT_BIRTH_CODE_SYSTEM')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'sex_at_birth_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '6c2d9879-7393-524d-9e9e-02ea961aca39',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in sex_at_birth_reference.',\n           'Ensure sex_at_birth_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('4bf5c21f-f9bc-5798-a40f-49354972a8e7', '52c6a395-5d83-4051-bb7c-39036f26ab29', '6c2d9879-7393-524d-9e9e-02ea961aca39', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'SexAtBirthReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sexual-orientation-reference.csv (sexual_orientation_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('2239dca2-9dd4-5c3a-91c8-2585839b9584', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sexual-orientation-reference.csv', 'sexual_orientation_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('f02a11b9-d2a8-547c-b57c-7a67b06a3716', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2239dca2-9dd4-5c3a-91c8-2585839b9584', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'SexualOrientationReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE sexual_orientation_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, '2239dca2-9dd4-5c3a-91c8-2585839b9584' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sexual-orientation-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('SEXUAL_ORIENTATION_CODE'), ('SEXUAL_ORIENTATION_CODE_DESCRIPTION'), ('SEXUAL_ORIENTATION_CODE_SYSTEM_NAME')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'sexual_orientation_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '2239dca2-9dd4-5c3a-91c8-2585839b9584',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in sexual_orientation_reference.',\n           'Ensure sexual_orientation_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('f3038d1f-a52a-597e-92b4-1e0be7e6d464', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2239dca2-9dd4-5c3a-91c8-2585839b9584', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'SexualOrientationReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/business-rules.csv (business_rules)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('fc740f9e-863e-5dd1-b1a1-86d176cb549c', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/business-rules.csv', 'business_rules', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('5f9ab8c7-65b5-5dd8-9e6b-1501c2a639a9', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'fc740f9e-863e-5dd1-b1a1-86d176cb549c', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'BusinessRulesReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE business_rules AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, 'fc740f9e-863e-5dd1-b1a1-86d176cb549c' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/business-rules.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('Worksheet'), ('Field'), ('Required'), ('Permissible Values'), ('True Rejection'), ('Warning Layer'), ('Resolved by QE/QCS')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'business_rules')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'fc740f9e-863e-5dd1-b1a1-86d176cb549c',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in business_rules.',\n           'Ensure business_rules contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('939acb5c-0c8e-5d68-9797-9e37ecf7f0a1', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'fc740f9e-863e-5dd1-b1a1-86d176cb549c', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'BusinessRulesReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/race-reference.csv (race_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('f98a88dc-a929-5a9b-906a-277e62c93012', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/race-reference.csv', 'race_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('48fd69a6-5ad7-5d32-aa35-f9c05860c3d3', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f98a88dc-a929-5a9b-906a-277e62c93012', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'RaceReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE race_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, 'f98a88dc-a929-5a9b-906a-277e62c93012' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/race-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('Concept Name'), ('Concept Code'), ('Hierarchical Code'), ('Race Category (Concept Name)'), ('Race Category (Concept Code)'), ('Hiearchical Code')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'race_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'f98a88dc-a929-5a9b-906a-277e62c93012',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in race_reference.',\n           'Ensure race_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('72451a16-9ba1-5038-a58a-c3aca50cfad6', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f98a88dc-a929-5a9b-906a-277e62c93012', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'RaceReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ethnicity-reference.csv (ethnicity_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('b0cbca95-5c20-5b2b-b589-9e832c556bc6', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ethnicity-reference.csv', 'ethnicity_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('d0ed9035-6320-5391-8d2e-509cdc185699', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b0cbca95-5c20-5b2b-b589-9e832c556bc6', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'EthnicityReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ethnicity_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, 'b0cbca95-5c20-5b2b-b589-9e832c556bc6' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ethnicity-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('Concept Code'), ('Concept Name'), ('Hierarchical Code'), ('Ethnicity Group (Concept Name)'), ('Ethnicity Group (Concept Code)')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'ethnicity_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'b0cbca95-5c20-5b2b-b589-9e832c556bc6',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in ethnicity_reference.',\n           'Ensure ethnicity_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('f517a0e3-a9aa-5e82-83d1-5ace996332f0', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b0cbca95-5c20-5b2b-b589-9e832c556bc6', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'EthnicityReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/preferred-language-reference.csv (preferred_language_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('3469db42-0066-5f23-9ee4-2b857bf339a4', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/preferred-language-reference.csv', 'preferred_language_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('d65cb030-fbbf-55e3-b848-18fd81a32679', '52c6a395-5d83-4051-bb7c-39036f26ab29', '3469db42-0066-5f23-9ee4-2b857bf339a4', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'PreferredLanguageReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE preferred_language_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, '3469db42-0066-5f23-9ee4-2b857bf339a4' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/preferred-language-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('ISO 639-2 Code'), ('ISO 639-1 Code'), ('English name of Language'), ('French name of Language'), ('German name of Language')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'preferred_language_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '3469db42-0066-5f23-9ee4-2b857bf339a4',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in preferred_language_reference.',\n           'Ensure preferred_language_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('f1c1a13a-58bf-51c3-92e0-12f2056f8a68', '52c6a395-5d83-4051-bb7c-39036f26ab29', '3469db42-0066-5f23-9ee4-2b857bf339a4', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'PreferredLanguageReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sdoh-domain-reference.csv (sdoh_domain_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('f19d5ebb-ea63-5b1d-b1b1-758457a2da29', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sdoh-domain-reference.csv', 'sdoh_domain_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('34308a17-4300-50d6-96bd-b34982aa25db', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f19d5ebb-ea63-5b1d-b1b1-758457a2da29', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'SdohDomainReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE sdoh_domain_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, 'f19d5ebb-ea63-5b1d-b1b1-758457a2da29' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sdoh-domain-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('Code'), ('Display'), ('Definition')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'sdoh_domain_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'f19d5ebb-ea63-5b1d-b1b1-758457a2da29',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in sdoh_domain_reference.',\n           'Ensure sdoh_domain_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('3204b0bd-3443-59e9-9b22-d1881b9c7797', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f19d5ebb-ea63-5b1d-b1b1-758457a2da29', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'SdohDomainReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'screening_20240307'\n        AS table_name,\n        'SCREENING' AS table_name_suffix\n      UNION ALL\n      SELECT 'admin_demographics_20240307'\n        AS table_name,\n        'DEMOGRAPHIC_DATA' AS table_name_suffix\n      UNION ALL\n      SELECT 'qe_admin_data_20240307'\n        AS table_name,\n        'QE_ADMIN_DATA' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'admin_demographics_20240307' IN (\n      'screening_20240307',\n      'admin_demographics_20240307',\n      'qe_admin_data_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'screening_20240307'\n        AS table_name,\n        'SCREENING' AS table_name_suffix\n      UNION ALL\n      SELECT 'admin_demographics_20240307'\n        AS table_name,\n        'DEMOGRAPHIC_DATA' AS table_name_suffix\n      UNION ALL\n      SELECT 'qe_admin_data_20240307'\n        AS table_name,\n        'QE_ADMIN_DATA' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'qe_admin_data_20240307' IN (\n      'screening_20240307',\n      'admin_demographics_20240307',\n      'qe_admin_data_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'screening_20240307'\n        AS table_name,\n        'SCREENING' AS table_name_suffix\n      UNION ALL\n      SELECT 'admin_demographics_20240307'\n        AS table_name,\n        'DEMOGRAPHIC_DATA' AS table_name_suffix\n      UNION ALL\n      SELECT 'qe_admin_data_20240307'\n        AS table_name,\n        'QE_ADMIN_DATA' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'screening_20240307' IN (\n      'screening_20240307',\n      'admin_demographics_20240307',\n      'qe_admin_data_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'screening_20240307'\n        AS table_name,\n        'SCREENING' AS table_name_suffix\n      UNION ALL\n      SELECT 'admin_demographics_20240307'\n        AS table_name,\n        'DEMOGRAPHIC_DATA' AS table_name_suffix\n      UNION ALL\n      SELECT 'qe_admin_data_20240307'\n        AS table_name,\n        'QE_ADMIN_DATA' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'screening_status_code_reference' IN (\n      'screening_20240307',\n      'admin_demographics_20240307',\n      'qe_admin_data_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '1a152daa-273d-5411-88cf-84067822a8aa',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nSELECT osi.session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value, ingest_table_name FROM orch_session_issue osi LEFT JOIN orch_session_entry ose ON osi.session_entry_id = ose.orch_session_entry_id WHERE osi.session_id = '52c6a395-5d83-4051-bb7c-39036f26ab29'","session_id":"52c6a395-5d83-4051-bb7c-39036f26ab29","narrative_md":"\n## ingest\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- ingest HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/DEMOGRAPHIC_DATA_20240307.csv (admin_demographics_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('963ed7bf-d356-54ae-ba2a-739f7f164e1a', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/DEMOGRAPHIC_DATA_20240307.csv', 'admin_demographics_20240307', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('9c13e37e-d059-582b-bfe1-3875f9c96436', '52c6a395-5d83-4051-bb7c-39036f26ab29', '963ed7bf-d356-54ae-ba2a-739f7f164e1a', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'AdminDemographicCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE admin_demographics_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, '963ed7bf-d356-54ae-ba2a-739f7f164e1a' as session_entry_id\n    FROM read_csv_auto('HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/DEMOGRAPHIC_DATA_20240307.csv', types={'MPI_ID': 'VARCHAR', 'SEX_AT_BIRTH_CODE': 'VARCHAR', 'ADMINISTRATIVE_SEX_CODE': 'VARCHAR', 'SEXUAL_ORIENTATION_CODE': 'VARCHAR', 'GENDER_IDENTITY_CODE': 'VARCHAR'});\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('MPI_ID'), ('PAT_MRN_ID'), ('FACILITY_ID'), ('CONSENT'), ('FIRST_NAME'), ('MIDDLE_NAME'), ('LAST_NAME'), ('ADMINISTRATIVE_SEX_CODE'), ('ADMINISTRATIVE_SEX_CODE_DESCRIPTION'), ('ADMINISTRATIVE_SEX_CODE_SYSTEM'), ('SEX_AT_BIRTH_CODE'), ('SEX_AT_BIRTH_CODE_DESCRIPTION'), ('SEX_AT_BIRTH_CODE_SYSTEM'), ('PAT_BIRTH_DATE'), ('ADDRESS1'), ('ADDRESS2'), ('CITY'), ('STATE'), ('ZIP'), ('GENDER_IDENTITY_CODE_SYSTEM_NAME'), ('GENDER_IDENTITY_CODE'), ('GENDER_IDENTITY_CODE_DESCRIPTION'), ('SEXUAL_ORIENTATION_CODE_SYSTEM_NAME'), ('SEXUAL_ORIENTATION_CODE'), ('SEXUAL_ORIENTATION_DESCRIPTION'), ('PREFERRED_LANGUAGE_CODE_SYSTEM_NAME'), ('PREFERRED_LANGUAGE_CODE'), ('PREFERRED_LANGUAGE_DESCRIPTION'), ('RACE_CODE_SYSTEM_NAME'), ('RACE_CODE'), ('RACE_CODE_DESCRIPTION'), ('ETHNICITY_CODE_SYSTEM_NAME'), ('ETHNICITY_CODE'), ('ETHNICITY_CODE_DESCRIPTION'), ('MEDICAID_CIN')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'admin_demographics_20240307')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in admin_demographics_20240307.',\n           'Ensure admin_demographics_20240307 contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('e5f8dcaa-aaab-5807-a510-a2478c89fc30', '52c6a395-5d83-4051-bb7c-39036f26ab29', '963ed7bf-d356-54ae-ba2a-739f7f164e1a', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'AdminDemographicCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/QE_ADMIN_DATA_20240307.csv (qe_admin_data_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('767cb8df-3ec0-5b59-998e-a91e75be32b3', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/QE_ADMIN_DATA_20240307.csv', 'qe_admin_data_20240307', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('523de5c7-6ede-5e49-9570-5621dde1f65a', '52c6a395-5d83-4051-bb7c-39036f26ab29', '767cb8df-3ec0-5b59-998e-a91e75be32b3', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'QeAdminDataCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE qe_admin_data_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, '767cb8df-3ec0-5b59-998e-a91e75be32b3' as session_entry_id\n    FROM read_csv_auto('HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/QE_ADMIN_DATA_20240307.csv');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('PAT_MRN_ID'), ('FACILITY_ID'), ('FACILITY_LONG_NAME'), ('ORGANIZATION_TYPE'), ('FACILITY_ADDRESS1'), ('FACILITY_ADDRESS2'), ('FACILITY_CITY'), ('FACILITY_STATE'), ('FACILITY_ZIP'), ('VISIT_PART_2_FLAG'), ('VISIT_OMH_FLAG'), ('VISIT_OPWDD_FLAG')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'qe_admin_data_20240307')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in qe_admin_data_20240307.',\n           'Ensure qe_admin_data_20240307 contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('f70136eb-81d9-550f-8910-1c9d430c71e5', '52c6a395-5d83-4051-bb7c-39036f26ab29', '767cb8df-3ec0-5b59-998e-a91e75be32b3', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'QeAdminDataCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/SCREENING_20240307.csv (screening_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('d09ebe08-1b63-56d8-8f2b-8fff76c9828f', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/SCREENING_20240307.csv', 'screening_20240307', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('aebb9881-f0ee-54c4-be68-53ce86973e56', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'd09ebe08-1b63-56d8-8f2b-8fff76c9828f', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'ScreeningCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE screening_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, 'd09ebe08-1b63-56d8-8f2b-8fff76c9828f' as session_entry_id\n    FROM read_csv_auto('HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/SCREENING_20240307.csv', types={'RECORDED_TIME': 'VARCHAR', 'ENCOUNTER_TYPE_CODE': 'VARCHAR'});\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('PAT_MRN_ID'), ('FACILITY_ID'), ('ENCOUNTER_ID'), ('ENCOUNTER_CLASS_CODE_SYSTEM'), ('ENCOUNTER_CLASS_CODE'), ('ENCOUNTER_CLASS_CODE_DESCRIPTION'), ('ENCOUNTER_STATUS_CODE_SYSTEM'), ('ENCOUNTER_STATUS_CODE'), ('ENCOUNTER_STATUS_CODE_DESCRIPTION'), ('ENCOUNTER_TYPE_CODE_SYSTEM'), ('ENCOUNTER_TYPE_CODE'), ('ENCOUNTER_TYPE_CODE_DESCRIPTION'), ('SCREENING_CODE_DESCRIPTION'), ('SCREENING_CODE_SYSTEM_NAME'), ('SCREENING_CODE'), ('SCREENING_STATUS_CODE_DESCRIPTION'), ('SCREENING_STATUS_CODE'), ('SCREENING_STATUS_CODE_SYSTEM'), ('RECORDED_TIME'), ('QUESTION_CODE_DESCRIPTION'), ('ANSWER_CODE_DESCRIPTION'), ('UCUM_UNITS'), ('QUESTION_CODE'), ('QUESTION_CODE_SYSTEM_NAME'), ('ANSWER_CODE'), ('ANSWER_CODE_SYSTEM_NAME'), ('PARENT_QUESTION_CODE'), ('SDOH_DOMAIN'), ('POTENTIAL_NEED_INDICATED')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'screening_20240307')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in screening_20240307.',\n           'Ensure screening_20240307 contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('6506f244-6870-581c-a47e-875c52326818', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'd09ebe08-1b63-56d8-8f2b-8fff76c9828f', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'ScreeningCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ahc-cross-walk.csv (ahc_cross_walk)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('b9aac8ec-792a-511d-8107-25bd96085898', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ahc-cross-walk.csv', 'ahc_cross_walk', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('5b7d69bd-b348-556b-8e3a-4a4c4397163c', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b9aac8ec-792a-511d-8107-25bd96085898', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'AhcCrossWalkCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_cross_walk AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, 'b9aac8ec-792a-511d-8107-25bd96085898' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ahc-cross-walk.csv', header = true);\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('SCREENING_CODE'), ('SCREENING_CODE_DESCRIPTION'), ('QUESTION_SLNO'), ('QUESTION'), ('QUESTION_CODE'), ('QUESTION_SLNO_REFERENCE'), ('ANSWER_VALUE'), ('ANSWER_CODE'), ('CALCULATED_FIELD'), ('SCORE'), ('UCUM_UNITS'), ('SDOH_DOMAIN'), ('POTENTIAL_NEED_INDICATED')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'ahc_cross_walk')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'b9aac8ec-792a-511d-8107-25bd96085898',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in ahc_cross_walk.',\n           'Ensure ahc_cross_walk contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7c00755d-cac1-5780-b386-435fac109c1e', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b9aac8ec-792a-511d-8107-25bd96085898', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'AhcCrossWalkCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-class-reference.csv (encounter_class_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('48eb0055-f06e-57f4-8019-f49266be3d22', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-class-reference.csv', 'encounter_class_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('a4d8a2c7-1ed0-532c-8617-9b840e0db2a1', '52c6a395-5d83-4051-bb7c-39036f26ab29', '48eb0055-f06e-57f4-8019-f49266be3d22', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'EncounterClassReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE encounter_class_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, '48eb0055-f06e-57f4-8019-f49266be3d22' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-class-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('Code'), ('System'), ('Display'), ('Definition')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'encounter_class_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '48eb0055-f06e-57f4-8019-f49266be3d22',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in encounter_class_reference.',\n           'Ensure encounter_class_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('60e9c67a-d11b-58a8-b606-fec8ae5534b4', '52c6a395-5d83-4051-bb7c-39036f26ab29', '48eb0055-f06e-57f4-8019-f49266be3d22', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'EncounterClassReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-status-code-reference.csv (encounter_status_code_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('2e9c77e9-a664-5323-83e4-e6a92cf998ab', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-status-code-reference.csv', 'encounter_status_code_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('ff07588a-62bc-500b-a066-3dc216afa1c5', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2e9c77e9-a664-5323-83e4-e6a92cf998ab', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'EncounterStatusCodeReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE encounter_status_code_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, '2e9c77e9-a664-5323-83e4-e6a92cf998ab' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-status-code-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('Code'), ('Display'), ('Definition')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'encounter_status_code_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '2e9c77e9-a664-5323-83e4-e6a92cf998ab',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in encounter_status_code_reference.',\n           'Ensure encounter_status_code_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('24cfaeaa-484a-5041-9d81-e7c4fb141c4d', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2e9c77e9-a664-5323-83e4-e6a92cf998ab', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'EncounterStatusCodeReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-type-code-reference.csv (encounter_type_code_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('4b3dd9ab-d81b-509a-9662-68dbd6d142f7', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-type-code-reference.csv', 'encounter_type_code_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('813b4f2b-cc81-5ed4-9305-625009c58ab7', '52c6a395-5d83-4051-bb7c-39036f26ab29', '4b3dd9ab-d81b-509a-9662-68dbd6d142f7', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'EncounterTypeCodeReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE encounter_type_code_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, '4b3dd9ab-d81b-509a-9662-68dbd6d142f7' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-type-code-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('Code'), ('System'), ('Display')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'encounter_type_code_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '4b3dd9ab-d81b-509a-9662-68dbd6d142f7',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in encounter_type_code_reference.',\n           'Ensure encounter_type_code_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('dc2b6f5f-7872-5968-a30f-f8df2e860803', '52c6a395-5d83-4051-bb7c-39036f26ab29', '4b3dd9ab-d81b-509a-9662-68dbd6d142f7', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'EncounterTypeCodeReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/screening-status-code-reference.csv (screening_status_code_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('1a152daa-273d-5411-88cf-84067822a8aa', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/screening-status-code-reference.csv', 'screening_status_code_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('a1402393-e3cf-5cc3-a644-da19d3689fc7', '52c6a395-5d83-4051-bb7c-39036f26ab29', '1a152daa-273d-5411-88cf-84067822a8aa', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE screening_status_code_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, '1a152daa-273d-5411-88cf-84067822a8aa' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/screening-status-code-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('Lvl'), ('Code'), ('Display'), ('Definition')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'screening_status_code_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '1a152daa-273d-5411-88cf-84067822a8aa',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in screening_status_code_reference.',\n           'Ensure screening_status_code_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('72b2e7e1-545d-540e-bbd7-5ab6b566a52a', '52c6a395-5d83-4051-bb7c-39036f26ab29', '1a152daa-273d-5411-88cf-84067822a8aa', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/gender-identity-reference.csv (gender_identity_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('787ee7ff-3ef5-59aa-a055-659cf10b6202', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/gender-identity-reference.csv', 'gender_identity_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('30f231bd-8ace-577e-ac7d-b7484a41cf8c', '52c6a395-5d83-4051-bb7c-39036f26ab29', '787ee7ff-3ef5-59aa-a055-659cf10b6202', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'GenderIdentityReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE gender_identity_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, '787ee7ff-3ef5-59aa-a055-659cf10b6202' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/gender-identity-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('GENDER_IDENTITY_CODE'), ('GENDER_IDENTITY_CODE_DESCRIPTION'), ('GENDER_IDENTITY_CODE_SYSTEM_NAME')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'gender_identity_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '787ee7ff-3ef5-59aa-a055-659cf10b6202',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in gender_identity_reference.',\n           'Ensure gender_identity_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('c33e617a-4c3b-5907-b98a-f576ff4ac7bd', '52c6a395-5d83-4051-bb7c-39036f26ab29', '787ee7ff-3ef5-59aa-a055-659cf10b6202', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'GenderIdentityReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/administrative-sex-reference.csv (administrative_sex_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('79f3d60e-c863-5759-8043-f122175a7cbb', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/administrative-sex-reference.csv', 'administrative_sex_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('6a920ce5-e480-5723-a3f5-e3167db5bd23', '52c6a395-5d83-4051-bb7c-39036f26ab29', '79f3d60e-c863-5759-8043-f122175a7cbb', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'AdministrativeSexReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE administrative_sex_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, '79f3d60e-c863-5759-8043-f122175a7cbb' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/administrative-sex-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('ADMINISTRATIVE_SEX_CODE'), ('ADMINISTRATIVE_SEX_CODE_DESCRIPTION'), ('ADMINISTRATIVE_SEX_CODE_SYSTEM')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'administrative_sex_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '79f3d60e-c863-5759-8043-f122175a7cbb',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in administrative_sex_reference.',\n           'Ensure administrative_sex_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('476191aa-f321-5d08-be13-ba624ad50951', '52c6a395-5d83-4051-bb7c-39036f26ab29', '79f3d60e-c863-5759-8043-f122175a7cbb', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'AdministrativeSexReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sex-at-birth-reference.csv (sex_at_birth_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('6c2d9879-7393-524d-9e9e-02ea961aca39', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sex-at-birth-reference.csv', 'sex_at_birth_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('438bb3e5-1ee9-5ed9-9763-4626ae804fad', '52c6a395-5d83-4051-bb7c-39036f26ab29', '6c2d9879-7393-524d-9e9e-02ea961aca39', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'SexAtBirthReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE sex_at_birth_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, '6c2d9879-7393-524d-9e9e-02ea961aca39' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sex-at-birth-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('SEX_AT_BIRTH_CODE'), ('SEX_AT_BIRTH_CODE_DESCRIPTION'), ('SEX_AT_BIRTH_CODE_SYSTEM')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'sex_at_birth_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '6c2d9879-7393-524d-9e9e-02ea961aca39',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in sex_at_birth_reference.',\n           'Ensure sex_at_birth_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('4bf5c21f-f9bc-5798-a40f-49354972a8e7', '52c6a395-5d83-4051-bb7c-39036f26ab29', '6c2d9879-7393-524d-9e9e-02ea961aca39', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'SexAtBirthReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sexual-orientation-reference.csv (sexual_orientation_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('2239dca2-9dd4-5c3a-91c8-2585839b9584', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sexual-orientation-reference.csv', 'sexual_orientation_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('f02a11b9-d2a8-547c-b57c-7a67b06a3716', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2239dca2-9dd4-5c3a-91c8-2585839b9584', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'SexualOrientationReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE sexual_orientation_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, '2239dca2-9dd4-5c3a-91c8-2585839b9584' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sexual-orientation-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('SEXUAL_ORIENTATION_CODE'), ('SEXUAL_ORIENTATION_CODE_DESCRIPTION'), ('SEXUAL_ORIENTATION_CODE_SYSTEM_NAME')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'sexual_orientation_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '2239dca2-9dd4-5c3a-91c8-2585839b9584',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in sexual_orientation_reference.',\n           'Ensure sexual_orientation_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('f3038d1f-a52a-597e-92b4-1e0be7e6d464', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2239dca2-9dd4-5c3a-91c8-2585839b9584', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'SexualOrientationReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/business-rules.csv (business_rules)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('fc740f9e-863e-5dd1-b1a1-86d176cb549c', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/business-rules.csv', 'business_rules', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('5f9ab8c7-65b5-5dd8-9e6b-1501c2a639a9', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'fc740f9e-863e-5dd1-b1a1-86d176cb549c', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'BusinessRulesReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE business_rules AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, 'fc740f9e-863e-5dd1-b1a1-86d176cb549c' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/business-rules.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('Worksheet'), ('Field'), ('Required'), ('Permissible Values'), ('True Rejection'), ('Warning Layer'), ('Resolved by QE/QCS')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'business_rules')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'fc740f9e-863e-5dd1-b1a1-86d176cb549c',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in business_rules.',\n           'Ensure business_rules contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('939acb5c-0c8e-5d68-9797-9e37ecf7f0a1', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'fc740f9e-863e-5dd1-b1a1-86d176cb549c', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'BusinessRulesReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/race-reference.csv (race_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('f98a88dc-a929-5a9b-906a-277e62c93012', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/race-reference.csv', 'race_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('48fd69a6-5ad7-5d32-aa35-f9c05860c3d3', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f98a88dc-a929-5a9b-906a-277e62c93012', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'RaceReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE race_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, 'f98a88dc-a929-5a9b-906a-277e62c93012' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/race-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('Concept Name'), ('Concept Code'), ('Hierarchical Code'), ('Race Category (Concept Name)'), ('Race Category (Concept Code)'), ('Hiearchical Code')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'race_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'f98a88dc-a929-5a9b-906a-277e62c93012',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in race_reference.',\n           'Ensure race_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('72451a16-9ba1-5038-a58a-c3aca50cfad6', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f98a88dc-a929-5a9b-906a-277e62c93012', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'RaceReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ethnicity-reference.csv (ethnicity_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('b0cbca95-5c20-5b2b-b589-9e832c556bc6', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ethnicity-reference.csv', 'ethnicity_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('d0ed9035-6320-5391-8d2e-509cdc185699', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b0cbca95-5c20-5b2b-b589-9e832c556bc6', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'EthnicityReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ethnicity_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, 'b0cbca95-5c20-5b2b-b589-9e832c556bc6' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ethnicity-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('Concept Code'), ('Concept Name'), ('Hierarchical Code'), ('Ethnicity Group (Concept Name)'), ('Ethnicity Group (Concept Code)')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'ethnicity_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'b0cbca95-5c20-5b2b-b589-9e832c556bc6',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in ethnicity_reference.',\n           'Ensure ethnicity_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('f517a0e3-a9aa-5e82-83d1-5ace996332f0', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b0cbca95-5c20-5b2b-b589-9e832c556bc6', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'EthnicityReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/preferred-language-reference.csv (preferred_language_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('3469db42-0066-5f23-9ee4-2b857bf339a4', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/preferred-language-reference.csv', 'preferred_language_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('d65cb030-fbbf-55e3-b848-18fd81a32679', '52c6a395-5d83-4051-bb7c-39036f26ab29', '3469db42-0066-5f23-9ee4-2b857bf339a4', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'PreferredLanguageReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE preferred_language_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, '3469db42-0066-5f23-9ee4-2b857bf339a4' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/preferred-language-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('ISO 639-2 Code'), ('ISO 639-1 Code'), ('English name of Language'), ('French name of Language'), ('German name of Language')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'preferred_language_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '3469db42-0066-5f23-9ee4-2b857bf339a4',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in preferred_language_reference.',\n           'Ensure preferred_language_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('f1c1a13a-58bf-51c3-92e0-12f2056f8a68', '52c6a395-5d83-4051-bb7c-39036f26ab29', '3469db42-0066-5f23-9ee4-2b857bf339a4', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'PreferredLanguageReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sdoh-domain-reference.csv (sdoh_domain_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('f19d5ebb-ea63-5b1d-b1b1-758457a2da29', '52c6a395-5d83-4051-bb7c-39036f26ab29', '/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sdoh-domain-reference.csv', 'sdoh_domain_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('34308a17-4300-50d6-96bd-b34982aa25db', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f19d5ebb-ea63-5b1d-b1b1-758457a2da29', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'SdohDomainReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE sdoh_domain_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '52c6a395-5d83-4051-bb7c-39036f26ab29' as session_id, 'f19d5ebb-ea63-5b1d-b1b1-758457a2da29' as session_entry_id\n    FROM read_csv_auto('/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sdoh-domain-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('Code'), ('Display'), ('Definition')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'sdoh_domain_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'f19d5ebb-ea63-5b1d-b1b1-758457a2da29',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in sdoh_domain_reference.',\n           'Ensure sdoh_domain_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('3204b0bd-3443-59e9-9b22-d1881b9c7797', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f19d5ebb-ea63-5b1d-b1b1-758457a2da29', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'SdohDomainReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'screening_20240307'\n        AS table_name,\n        'SCREENING' AS table_name_suffix\n      UNION ALL\n      SELECT 'admin_demographics_20240307'\n        AS table_name,\n        'DEMOGRAPHIC_DATA' AS table_name_suffix\n      UNION ALL\n      SELECT 'qe_admin_data_20240307'\n        AS table_name,\n        'QE_ADMIN_DATA' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'admin_demographics_20240307' IN (\n      'screening_20240307',\n      'admin_demographics_20240307',\n      'qe_admin_data_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'screening_20240307'\n        AS table_name,\n        'SCREENING' AS table_name_suffix\n      UNION ALL\n      SELECT 'admin_demographics_20240307'\n        AS table_name,\n        'DEMOGRAPHIC_DATA' AS table_name_suffix\n      UNION ALL\n      SELECT 'qe_admin_data_20240307'\n        AS table_name,\n        'QE_ADMIN_DATA' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'qe_admin_data_20240307' IN (\n      'screening_20240307',\n      'admin_demographics_20240307',\n      'qe_admin_data_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'screening_20240307'\n        AS table_name,\n        'SCREENING' AS table_name_suffix\n      UNION ALL\n      SELECT 'admin_demographics_20240307'\n        AS table_name,\n        'DEMOGRAPHIC_DATA' AS table_name_suffix\n      UNION ALL\n      SELECT 'qe_admin_data_20240307'\n        AS table_name,\n        'QE_ADMIN_DATA' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'screening_20240307' IN (\n      'screening_20240307',\n      'admin_demographics_20240307',\n      'qe_admin_data_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'screening_20240307'\n        AS table_name,\n        'SCREENING' AS table_name_suffix\n      UNION ALL\n      SELECT 'admin_demographics_20240307'\n        AS table_name,\n        'DEMOGRAPHIC_DATA' AS table_name_suffix\n      UNION ALL\n      SELECT 'qe_admin_data_20240307'\n        AS table_name,\n        'QE_ADMIN_DATA' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'screening_status_code_reference' IN (\n      'screening_20240307',\n      'admin_demographics_20240307',\n      'qe_admin_data_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '1a152daa-273d-5411-88cf-84067822a8aa',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nSELECT osi.session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value, ingest_table_name FROM orch_session_issue osi LEFT JOIN orch_session_entry ose ON osi.session_entry_id = ose.orch_session_entry_id WHERE osi.session_id = '52c6a395-5d83-4051-bb7c-39036f26ab29'\n```\nNo STDOUT emitted by `ingest` (status: `0`).\n\nNo STDERR emitted by `ingest`.\n\n    "}},{"insertable":{"exec_identity":"ensureContent","exec_code":"duckdb HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.workflow/ingestion-center.duckdb","sql":"-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('630f992f-2d33-5d0b-9855-29fdb84f62ee', '52c6a395-5d83-4051-bb7c-39036f26ab29', '963ed7bf-d356-54ae-ba2a-739f7f164e1a', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'AdminDemographicCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT 'FIRST_NAME' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"FIRST_NAME\" IS NULL\n        OR TRIM(CAST(\"FIRST_NAME\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'FIRST_NAME' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"FIRST_NAME\" AS VARCHAR) NOT SIMILAR TO '^[A-Za-z]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]+$',\n           'Follow the pattern ^[A-Za-z]+$ in ' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT 'MIDDLE_NAME' AS issue_column,\n           \"MIDDLE_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"MIDDLE_NAME\" AS VARCHAR) NOT SIMILAR TO '^[A-Za-z]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]+$',\n           'Follow the pattern ^[A-Za-z]+$ in ' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT 'LAST_NAME' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"LAST_NAME\" IS NULL\n        OR TRIM(CAST(\"LAST_NAME\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'LAST_NAME' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"LAST_NAME\" AS VARCHAR) NOT SIMILAR TO '^[A-Za-z]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]+$',\n           'Follow the pattern ^[A-Za-z]+$ in ' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT 'ADMINISTRATIVE_SEX_CODE' AS issue_column,\n           \"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"ADMINISTRATIVE_SEX_CODE\" IS NULL\n        OR TRIM(CAST(\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'ADMINISTRATIVE_SEX_CODE_SYSTEM' AS issue_column,\n           \"ADMINISTRATIVE_SEX_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"ADMINISTRATIVE_SEX_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"ADMINISTRATIVE_SEX_CODE_SYSTEM\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_administrative_sex_code_in_all_rows AS (\n    SELECT 'ADMINISTRATIVE_SEX_CODE' AS issue_column,\n           sr.\"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN administrative_sex_reference ref\n      ON UPPER(sr.\"ADMINISTRATIVE_SEX_CODE\") = UPPER(ref.ADMINISTRATIVE_SEX_CODE)\n     WHERE sr.\"ADMINISTRATIVE_SEX_CODE\" IS NOT NULL\n      AND ref.ADMINISTRATIVE_SEX_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid ADMINISTRATIVE SEX CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ADMINISTRATIVE SEX CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ADMINISTRATIVE SEX CODE with administrative sex reference data'\n      FROM valid_administrative_sex_code_in_all_rows;\nWITH valid_administrative_sex_code_description_in_all_rows AS (\n    SELECT 'ADMINISTRATIVE_SEX_CODE_DESCRIPTION' AS issue_column,\n           sr.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN administrative_sex_reference ref\n      ON UPPER(sr.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\") = UPPER(ref.ADMINISTRATIVE_SEX_CODE_DESCRIPTION)\n     WHERE sr.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" IS NOT NULL\n      AND ref.ADMINISTRATIVE_SEX_CODE_DESCRIPTION IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid ADMINISTRATIVE SEX CODE DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ADMINISTRATIVE SEX CODE DESCRIPTION \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ADMINISTRATIVE SEX CODE DESCRIPTION with administrative sex reference data'\n      FROM valid_administrative_sex_code_description_in_all_rows;\nWITH valid_administrative_sex_code_system_in_all_rows AS (\n    SELECT 'ADMINISTRATIVE_SEX_CODE_SYSTEM' AS issue_column,\n           sr.\"ADMINISTRATIVE_SEX_CODE_SYSTEM\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN administrative_sex_reference ref\n      ON UPPER(sr.\"ADMINISTRATIVE_SEX_CODE_SYSTEM\") = UPPER(ref.ADMINISTRATIVE_SEX_CODE_SYSTEM)\n     WHERE sr.\"ADMINISTRATIVE_SEX_CODE_SYSTEM\" IS NOT NULL\n      AND ref.ADMINISTRATIVE_SEX_CODE_SYSTEM IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid ADMINISTRATIVE SEX CODE SYSTEM',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ADMINISTRATIVE SEX CODE SYSTEM \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ADMINISTRATIVE SEX CODE SYSTEM with administrative sex reference data'\n      FROM valid_administrative_sex_code_system_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'ADMINISTRATIVE_SEX_CODE' AS issue_column,\n      tbl.\"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n      tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"ADMINISTRATIVE_SEX_CODE\" is not null\n  and tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" FROM administrative_sex_reference WHERE UPPER(CAST(tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)) = UPPER(CAST(\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The ADMINISTRATIVE_SEX_CODE \"' || invalid_value || '\" of ADMINISTRATIVE_SEX_CODE_DESCRIPTION \"' || dependent_value || '\" is not matching with the ADMINISTRATIVE_SEX_CODE of ADMINISTRATIVE_SEX_CODE_DESCRIPTION in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'ADMINISTRATIVE_SEX_CODE_DESCRIPTION' AS issue_column,\n      tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ADMINISTRATIVE_SEX_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" is not null\n  and tbl.\"ADMINISTRATIVE_SEX_CODE\" is not null\n  and NOT EXISTS ( SELECT \"ADMINISTRATIVE_SEX_CODE\" FROM administrative_sex_reference WHERE UPPER(CAST(tbl.\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)) = UPPER(CAST(\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The ADMINISTRATIVE_SEX_CODE_DESCRIPTION \"' || invalid_value || '\" of ADMINISTRATIVE_SEX_CODE \"' || dependent_value || '\" is not matching with the ADMINISTRATIVE_SEX_CODE_DESCRIPTION of ADMINISTRATIVE_SEX_CODE in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_sex_at_birth_code_in_all_rows AS (\n    SELECT 'SEX_AT_BIRTH_CODE' AS issue_column,\n           sr.\"SEX_AT_BIRTH_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sex_at_birth_reference ref\n      ON UPPER(sr.SEX_AT_BIRTH_CODE) = UPPER(ref.SEX_AT_BIRTH_CODE)\n     WHERE sr.SEX_AT_BIRTH_CODE IS NOT NULL\n      AND ref.SEX_AT_BIRTH_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid SEX AT BIRTH CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid SEX AT BIRTH CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate SEX AT BIRTH CODE with sex at birth reference data'\n      FROM valid_sex_at_birth_code_in_all_rows;\nWITH valid_sex_at_birth_code_description_in_all_rows AS (\n    SELECT 'SEX_AT_BIRTH_CODE_DESCRIPTION' AS issue_column,\n           sr.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sex_at_birth_reference ref\n      ON UPPER(sr.SEX_AT_BIRTH_CODE_DESCRIPTION) = UPPER(ref.SEX_AT_BIRTH_CODE_DESCRIPTION)\n     WHERE sr.SEX_AT_BIRTH_CODE_DESCRIPTION IS NOT NULL\n      AND ref.SEX_AT_BIRTH_CODE_DESCRIPTION IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid SEX_AT_BIRTH_CODE_DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid SEX_AT_BIRTH_CODE_DESCRIPTION \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate SEX_AT_BIRTH_CODE_DESCRIPTION with sex at birth reference data'\n      FROM valid_sex_at_birth_code_description_in_all_rows;\nWITH valid_sex_at_birth_code_system_in_all_rows AS (\n    SELECT 'SEX_AT_BIRTH_CODE_SYSTEM' AS issue_column,\n           sr.\"SEX_AT_BIRTH_CODE_SYSTEM\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sex_at_birth_reference ref\n      ON UPPER(sr.SEX_AT_BIRTH_CODE_SYSTEM) = UPPER(ref.SEX_AT_BIRTH_CODE_SYSTEM)\n     WHERE sr.SEX_AT_BIRTH_CODE_SYSTEM IS NOT NULL\n      AND ref.SEX_AT_BIRTH_CODE_SYSTEM IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid SEX AT BIRTH CODE SYSTEM',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid SEX AT BIRTH CODE SYSTEM \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate SEX AT BIRTH CODE SYSTEM with sex at birth reference data'\n      FROM valid_sex_at_birth_code_system_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'SEX_AT_BIRTH_CODE' AS issue_column,\n      tbl.\"SEX_AT_BIRTH_CODE\" AS invalid_value,\n      tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"SEX_AT_BIRTH_CODE\" is not null\n  and tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"SEX_AT_BIRTH_CODE_DESCRIPTION\" FROM sex_at_birth_reference WHERE UPPER(CAST(tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SEX_AT_BIRTH_CODE\" AS VARCHAR)) = UPPER(CAST(\"SEX_AT_BIRTH_CODE\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The SEX_AT_BIRTH_CODE \"' || invalid_value || '\" of SEX_AT_BIRTH_CODE_DESCRIPTION \"' || dependent_value || '\" is not matching with the SEX_AT_BIRTH_CODE of SEX_AT_BIRTH_CODE_DESCRIPTION in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'SEX_AT_BIRTH_CODE_DESCRIPTION' AS issue_column,\n      tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"SEX_AT_BIRTH_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" is not null\n  and tbl.\"SEX_AT_BIRTH_CODE\" is not null\n  and NOT EXISTS ( SELECT \"SEX_AT_BIRTH_CODE\" FROM sex_at_birth_reference WHERE UPPER(CAST(tbl.\"SEX_AT_BIRTH_CODE\" AS VARCHAR)) = UPPER(CAST(\"SEX_AT_BIRTH_CODE\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The SEX_AT_BIRTH_CODE_DESCRIPTION \"' || invalid_value || '\" of SEX_AT_BIRTH_CODE \"' || dependent_value || '\" is not matching with the SEX_AT_BIRTH_CODE_DESCRIPTION of SEX_AT_BIRTH_CODE in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'PAT_BIRTH_DATE' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"PAT_BIRTH_DATE\" IS NULL\n        OR TRIM(CAST(\"PAT_BIRTH_DATE\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_date_time_in_all_rows AS (\n    SELECT 'PAT_BIRTH_DATE' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"PAT_BIRTH_DATE\" IS NOT NULL\n       AND TRY_CAST(\"PAT_BIRTH_DATE\" AS TIMESTAMP) IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid Date',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid timestamp \"' || invalid_value || '\" found in ' || issue_column,\n           'Please be sure to provide both a valid date and time.'\n      FROM valid_date_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'CITY' AS issue_column,\n           \"CITY\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"CITY\" IS NULL\n        OR TRIM(CAST(\"CITY\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'STATE' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"STATE\" IS NULL\n        OR TRIM(CAST(\"STATE\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'STATE' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"STATE\" NOT IN ('NY', 'New York')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''NY'', ''New York'')',\n           'Use only allowed values ''NY'', ''New York'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'ZIP' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"ZIP\" IS NULL\n        OR TRIM(CAST(\"ZIP\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'ZIP' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"ZIP\" AS VARCHAR) NOT SIMILAR TO '^\\d{5}(\\d{4})?$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^\\d{5}(\\d{4})?$',\n           'Follow the pattern ^\\d{5}(\\d{4})?$ in ' || issue_column\n      FROM pattern;\nWITH valid_integer_alphanumeric_string_in_all_rows AS (\n  SELECT 'ADDRESS1' AS issue_column,\n    t.\"ADDRESS1\" AS invalid_value,\n    t.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307 t\n  WHERE t.\"ADDRESS1\" SIMILAR TO '[0-9]+'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Data Type Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'Invalid string of numbers found'\n      FROM valid_integer_alphanumeric_string_in_all_rows;\nWITH valid_address1_or_medicaid_cin_in_all_rows AS (\n    SELECT 'ADDRESS1' AS issue_column,\n           ADDRESS1 AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM admin_demographics_20240307\n      WHERE (ADDRESS1 IS NULL OR TRIM(\"ADDRESS1\") = '') AND (MEDICAID_CIN IS NULL OR TRIM(\"MEDICAID_CIN\") = '')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid ADDRESS1',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field \"' || issue_column || '\" is empty',\n           'The required field value ADDRESS1 is missing. This is required due to the absence of the MEDICAID_CIN.'\n      FROM valid_address1_or_medicaid_cin_in_all_rows;\nWITH valid_gender_identity_code_in_all_rows AS (\n    SELECT 'GENDER_IDENTITY_CODE' AS issue_column,\n           sr.\"GENDER_IDENTITY_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN gender_identity_reference ref\n      ON UPPER(sr.GENDER_IDENTITY_CODE) = UPPER(ref.GENDER_IDENTITY_CODE)\n     WHERE sr.GENDER_IDENTITY_CODE IS NOT NULL\n      AND ref.GENDER_IDENTITY_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid GENDER IDENTITY CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid GENDER IDENTITY CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate GENDER IDENTITY CODE with gender identity reference data'\n      FROM valid_gender_identity_code_in_all_rows;\nWITH allowed_values AS (\n    SELECT 'GENDER_IDENTITY_CODE_SYSTEM_NAME' AS issue_column,\n           \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" NOT IN ('SNOMED-CT','SNOMED','http://snomed.info/sct')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''SNOMED-CT'',''SNOMED'',''http://snomed.info/sct'')',\n           'Use only allowed values ''SNOMED-CT'',''SNOMED'',''http://snomed.info/sct'' in ' || issue_column\n      FROM allowed_values;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'GENDER_IDENTITY_CODE' AS issue_column,\n      tbl.\"GENDER_IDENTITY_CODE\" AS invalid_value,\n      tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"GENDER_IDENTITY_CODE\" is not null\n  and tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"GENDER_IDENTITY_CODE_DESCRIPTION\" FROM gender_identity_reference WHERE UPPER(CAST(tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS VARCHAR)) AND UPPER(CAST(tbl.\"GENDER_IDENTITY_CODE\" AS VARCHAR)) = UPPER(CAST(\"GENDER_IDENTITY_CODE\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The GENDER_IDENTITY_CODE \"' || invalid_value || '\" of GENDER_IDENTITY_CODE_DESCRIPTION \"' || dependent_value || '\" is not matching with the GENDER_IDENTITY_CODE of GENDER_IDENTITY_CODE_DESCRIPTION in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'GENDER_IDENTITY_CODE_DESCRIPTION' AS issue_column,\n      tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"GENDER_IDENTITY_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" is not null\n  and tbl.\"GENDER_IDENTITY_CODE\" is not null\n  and NOT EXISTS ( SELECT \"GENDER_IDENTITY_CODE\" FROM gender_identity_reference WHERE UPPER(CAST(tbl.\"GENDER_IDENTITY_CODE\" AS VARCHAR)) = UPPER(CAST(\"GENDER_IDENTITY_CODE\" AS VARCHAR)) AND UPPER(CAST(tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The GENDER_IDENTITY_CODE_DESCRIPTION \"' || invalid_value || '\" of GENDER_IDENTITY_CODE \"' || dependent_value || '\" is not matching with the GENDER_IDENTITY_CODE_DESCRIPTION of GENDER_IDENTITY_CODE in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_sexual_orientation_code_in_all_rows AS (\n    SELECT 'SEXUAL_ORIENTATION_CODE' AS issue_column,\n           sr.\"SEXUAL_ORIENTATION_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sexual_orientation_reference ref\n      ON UPPER(sr.SEXUAL_ORIENTATION_CODE) = UPPER(ref.SEXUAL_ORIENTATION_CODE)\n     WHERE sr.SEXUAL_ORIENTATION_CODE IS NOT NULL\n      AND ref.SEXUAL_ORIENTATION_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid SEXUAL ORIENTATION CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid SEXUAL ORIENTATION CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate SEXUAL ORIENTATION CODE with sexual orientation reference data'\n      FROM valid_sexual_orientation_code_in_all_rows;\nWITH valid_sexual_orientation_description_in_all_rows AS (\n    SELECT 'SEXUAL_ORIENTATION_DESCRIPTION' AS issue_column,\n           sr.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sexual_orientation_reference ref\n      ON UPPER(sr.SEXUAL_ORIENTATION_DESCRIPTION) = UPPER(ref.SEXUAL_ORIENTATION_CODE_DESCRIPTION)\n     WHERE sr.SEXUAL_ORIENTATION_DESCRIPTION IS NOT NULL\n      AND ref.SEXUAL_ORIENTATION_CODE_DESCRIPTION IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid SEXUAL ORIENTATION CODE DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid SEXUAL ORIENTATION CODE DESCRIPTION \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate SEXUAL ORIENTATION CODE DESCRIPTION with sexual orientation reference data'\n      FROM valid_sexual_orientation_description_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'SEXUAL_ORIENTATION_CODE' AS issue_column,\n      tbl.\"SEXUAL_ORIENTATION_CODE\" AS invalid_value,\n      tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"SEXUAL_ORIENTATION_CODE\" is not null\n  and tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"SEXUAL_ORIENTATION_CODE_DESCRIPTION\" FROM sexual_orientation_reference WHERE UPPER(CAST(tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"SEXUAL_ORIENTATION_CODE_DESCRIPTION\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SEXUAL_ORIENTATION_CODE\" AS VARCHAR)) = UPPER(CAST(\"SEXUAL_ORIENTATION_CODE\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The SEXUAL_ORIENTATION_CODE \"' || invalid_value || '\" of SEXUAL_ORIENTATION_DESCRIPTION \"' || dependent_value || '\" is not matching with the SEXUAL_ORIENTATION_CODE of SEXUAL_ORIENTATION_DESCRIPTION in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'SEXUAL_ORIENTATION_DESCRIPTION' AS issue_column,\n      tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS invalid_value,\n      tbl.\"SEXUAL_ORIENTATION_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" is not null\n  and tbl.\"SEXUAL_ORIENTATION_CODE\" is not null\n  and NOT EXISTS ( SELECT \"SEXUAL_ORIENTATION_CODE\" FROM sexual_orientation_reference WHERE UPPER(CAST(tbl.\"SEXUAL_ORIENTATION_CODE\" AS VARCHAR)) = UPPER(CAST(\"SEXUAL_ORIENTATION_CODE\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"SEXUAL_ORIENTATION_CODE_DESCRIPTION\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The SEXUAL_ORIENTATION_DESCRIPTION \"' || invalid_value || '\" of SEXUAL_ORIENTATION_CODE \"' || dependent_value || '\" is not matching with the SEXUAL_ORIENTATION_DESCRIPTION of SEXUAL_ORIENTATION_CODE in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH allowed_values AS (\n    SELECT 'SEXUAL_ORIENTATION_CODE_SYSTEM_NAME' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" NOT IN ('SNOMED-CT','SNOMED','http://snomed.info/sct')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''SNOMED-CT'',''SNOMED'',''http://snomed.info/sct'')',\n           'Use only allowed values ''SNOMED-CT'',''SNOMED'',''http://snomed.info/sct'' in ' || issue_column\n      FROM allowed_values;\nWITH valid_ethnicity_code_in_all_rows AS (\n    SELECT 'ETHNICITY_CODE' AS issue_column,\n           ad.\"ETHNICITY_CODE\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN ethnicity_reference ref\n      ON UPPER(CAST(ad.\"ETHNICITY_CODE\" AS VARCHAR)) = UPPER(CAST(ref.\"Concept Code\" AS VARCHAR))\n     WHERE ad.\"ETHNICITY_CODE\" IS NOT NULL\n      AND ref.\"Concept Code\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid ETHNICITY CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ETHNICITY CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ETHNICITY CODE with ethnicity reference data'\n      FROM valid_ethnicity_code_in_all_rows;\nWITH valid_ethnicity_code_description_in_all_rows AS (\n    SELECT 'ETHNICITY_CODE_DESCRIPTION' AS issue_column,\n           ad.\"ETHNICITY_CODE_DESCRIPTION\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN ethnicity_reference ref\n      ON UPPER(CAST(ad.\"ETHNICITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(ref.\"Concept Name\" AS VARCHAR))\n     WHERE ad.\"ETHNICITY_CODE_DESCRIPTION\" IS NOT NULL\n      AND ref.\"Concept Name\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid ETHNICITY CODE DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ETHNICITY CODE DESCRIPTION \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ETHNICITY CODE DESCRIPTION with ethnicity reference data'\n      FROM valid_ethnicity_code_description_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'ETHNICITY_CODE' AS issue_column,\n      tbl.\"ETHNICITY_CODE\" AS invalid_value,\n      tbl.\"ETHNICITY_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"ETHNICITY_CODE\" is not null\n  and tbl.\"ETHNICITY_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Concept Name\" FROM ethnicity_reference WHERE UPPER(CAST(tbl.\"ETHNICITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Concept Name\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ETHNICITY_CODE\" AS VARCHAR)) = UPPER(CAST(\"Concept Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The ETHNICITY_CODE \"' || invalid_value || '\" of ETHNICITY_CODE_DESCRIPTION \"' || dependent_value || '\" is not matching with the ETHNICITY_CODE of ETHNICITY_CODE_DESCRIPTION in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'ETHNICITY_CODE_DESCRIPTION' AS issue_column,\n      tbl.\"ETHNICITY_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ETHNICITY_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"ETHNICITY_CODE_DESCRIPTION\" is not null\n  and tbl.\"ETHNICITY_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Concept Code\" FROM ethnicity_reference WHERE UPPER(CAST(tbl.\"ETHNICITY_CODE\" AS VARCHAR)) = UPPER(CAST(\"Concept Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ETHNICITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Concept Name\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The ETHNICITY_CODE_DESCRIPTION \"' || invalid_value || '\" of ETHNICITY_CODE \"' || dependent_value || '\" is not matching with the ETHNICITY_CODE_DESCRIPTION of ETHNICITY_CODE in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_race_code_in_all_rows AS (\n    SELECT 'RACE_CODE' AS issue_column,\n           ad.\"RACE_CODE\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN race_reference ref\n      ON UPPER(CAST(ad.\"RACE_CODE\" AS VARCHAR)) = UPPER(CAST(ref.\"Concept Code\" AS VARCHAR))\n     WHERE ad.\"RACE_CODE\" IS NOT NULL\n      AND ref.\"Concept Code\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid RACE CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid RACE CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate RACE CODE with race reference data'\n      FROM valid_race_code_in_all_rows;\nWITH valid_race_code_description_in_all_rows AS (\n    SELECT 'RACE_CODE_DESCRIPTION' AS issue_column,\n           ad.\"RACE_CODE_DESCRIPTION\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN race_reference ref\n      ON UPPER(CAST(ad.\"RACE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(ref.\"Concept Name\" AS VARCHAR))\n     WHERE ad.\"RACE_CODE_DESCRIPTION\" IS NOT NULL\n      AND ref.\"Concept Name\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid RACE CODE DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid RACE CODE DESCRIPTION \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate RACE CODE DESCRIPTION with race reference data'\n      FROM valid_race_code_description_in_all_rows;\nWITH valid_preferred_language_code_in_all_rows AS (\n    SELECT 'PREFERRED_LANGUAGE_CODE' AS issue_column,\n           ad.\"PREFERRED_LANGUAGE_CODE\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN preferred_language_reference ref\n      ON UPPER(CAST(ad.\"PREFERRED_LANGUAGE_CODE\" AS VARCHAR)) = UPPER(CAST(ref.\"ISO 639-2 Code\" AS VARCHAR))\n     WHERE ad.\"PREFERRED_LANGUAGE_CODE\" IS NOT NULL\n      AND ref.\"ISO 639-2 Code\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid PREFERRED LANGUAGE CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid PREFERRED LANGUAGE CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate PREFERRED LANGUAGE CODE with preferred language reference data'\n      FROM valid_preferred_language_code_in_all_rows;\nWITH valid_preferred_language_code_description_in_all_rows AS (\n    SELECT 'PREFERRED_LANGUAGE_DESCRIPTION' AS issue_column,\n           ad.\"PREFERRED_LANGUAGE_DESCRIPTION\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN preferred_language_reference ref\n      ON UPPER(CAST(ad.\"PREFERRED_LANGUAGE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(ref.\"English name of Language\" AS VARCHAR))\n     WHERE ad.\"PREFERRED_LANGUAGE_DESCRIPTION\" IS NOT NULL\n      AND ref.\"English name of Language\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid PREFERRED LANGUAGE CODE DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid PREFERRED LANGUAGE CODE DESCRIPTION \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate PREFERRED LANGUAGE CODE DESCRIPTION with preferred language reference data'\n      FROM valid_preferred_language_code_description_in_all_rows;\nWITH allowed_values AS (\n    SELECT 'PREFERRED_LANGUAGE_CODE_SYSTEM_NAME' AS issue_column,\n           \"PREFERRED_LANGUAGE_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"PREFERRED_LANGUAGE_CODE_SYSTEM_NAME\" NOT IN ('ISO','ISO 639-2','http://hl7.org/fhir/us/core/ValueSet/simple-language')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''ISO'',''ISO 639-2'',''http://hl7.org/fhir/us/core/ValueSet/simple-language'')',\n           'Use only allowed values ''ISO'',''ISO 639-2'',''http://hl7.org/fhir/us/core/ValueSet/simple-language'' in ' || issue_column\n      FROM allowed_values;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'RACE_CODE' AS issue_column,\n      tbl.\"RACE_CODE\" AS invalid_value,\n      tbl.\"RACE_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"RACE_CODE\" is not null\n  and tbl.\"RACE_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Concept Name\" FROM race_reference WHERE UPPER(CAST(tbl.\"RACE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Concept Name\" AS VARCHAR)) AND UPPER(CAST(tbl.\"RACE_CODE\" AS VARCHAR)) = UPPER(CAST(\"Concept Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The RACE_CODE \"' || invalid_value || '\" of RACE_CODE_DESCRIPTION \"' || dependent_value || '\" is not matching with the RACE_CODE of RACE_CODE_DESCRIPTION in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'PREFERRED_LANGUAGE_CODE' AS issue_column,\n      tbl.\"PREFERRED_LANGUAGE_CODE\" AS invalid_value,\n      tbl.\"PREFERRED_LANGUAGE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"PREFERRED_LANGUAGE_CODE\" is not null\n  and tbl.\"PREFERRED_LANGUAGE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"English name of Language\" FROM preferred_language_reference WHERE UPPER(CAST(tbl.\"PREFERRED_LANGUAGE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"English name of Language\" AS VARCHAR)) AND UPPER(CAST(tbl.\"PREFERRED_LANGUAGE_CODE\" AS VARCHAR)) = UPPER(CAST(\"ISO 639-2 Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The PREFERRED_LANGUAGE_CODE \"' || invalid_value || '\" of PREFERRED_LANGUAGE_DESCRIPTION \"' || dependent_value || '\" is not matching with the PREFERRED_LANGUAGE_CODE of PREFERRED_LANGUAGE_DESCRIPTION in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'RACE_CODE_DESCRIPTION' AS issue_column,\n      tbl.\"RACE_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"RACE_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"RACE_CODE_DESCRIPTION\" is not null\n  and tbl.\"RACE_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Concept Code\" FROM race_reference WHERE UPPER(CAST(tbl.\"RACE_CODE\" AS VARCHAR)) = UPPER(CAST(\"Concept Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"RACE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Concept Name\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The RACE_CODE_DESCRIPTION \"' || invalid_value || '\" of RACE_CODE \"' || dependent_value || '\" is not matching with the RACE_CODE_DESCRIPTION of RACE_CODE in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH allowed_values AS (\n    SELECT 'RACE_CODE_SYSTEM_NAME' AS issue_column,\n           \"RACE_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"RACE_CODE_SYSTEM_NAME\" NOT IN ('CDC','CDCRE','urn:oid:2.16.840.1.113883.6.238')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''CDC'',''CDCRE'',''urn:oid:2.16.840.1.113883.6.238'')',\n           'Use only allowed values ''CDC'',''CDCRE'',''urn:oid:2.16.840.1.113883.6.238'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'ETHNICITY_CODE_SYSTEM_NAME' AS issue_column,\n           \"ETHNICITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"ETHNICITY_CODE_SYSTEM_NAME\" NOT IN ('CDC','CDCRE','urn:oid:2.16.840.1.113883.6.238')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''CDC'',''CDCRE'',''urn:oid:2.16.840.1.113883.6.238'')',\n           'Use only allowed values ''CDC'',''CDCRE'',''urn:oid:2.16.840.1.113883.6.238'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'MPI_ID' AS issue_column,\n           \"MPI_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"MPI_ID\" IS NULL\n        OR TRIM(CAST(\"MPI_ID\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'PAT_MRN_ID' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(CAST(\"PAT_MRN_ID\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_mpi_id_per_pat_mrn_id_in_all_rows AS (\n    SELECT 'MPI_ID' AS issue_column,\n      MPI_ID AS invalid_value,\n      min(src_file_row_number) AS issue_row\n    FROM admin_demographics_20240307\n    GROUP BY MPI_ID\n    HAVING COUNT(DISTINCT PAT_MRN_ID) > 1\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid MPI_ID',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'The unique field \"' || issue_column || '\" \"' || invalid_value || '\"is not unique per PAT MRN ID',\n           'MPI_ID is not unique per PAT MRN ID.'\n      FROM valid_mpi_id_per_pat_mrn_id_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'FACILITY_ID' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ID\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'MEDICAID_CIN' AS issue_column,\n           \"MEDICAID_CIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"MEDICAID_CIN\" AS VARCHAR) NOT SIMILAR TO '^[A-Za-z]{2}\\d{5}[A-Za-z]$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$',\n           'Follow the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$ in ' || issue_column\n      FROM pattern;\nWITH valid_unique_medicaid_cin_per_mrn_in_all_rows AS (\n  SELECT 'MEDICAID_CIN' AS issue_column,\n          \"MEDICAID_CIN\" AS invalid_value,\n          min(src_file_row_number) AS issue_row\n    FROM admin_demographics_20240307\n    WHERE MEDICAID_CIN IS NOT NULL\n    GROUP BY pat_mrn_id, MEDICAID_CIN\n    HAVING COUNT(*) > 1\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid Unique Medicaid Cin Per Mrn',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid Unique Medicaid Cin Per Mrn \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate Unique Medicaid Cin Per Mrn'\n      FROM valid_unique_medicaid_cin_per_mrn_in_all_rows;\nWITH valid_address1_or_medicaid_cin_in_all_rows AS (\n    SELECT 'MEDICAID_CIN' AS issue_column,\n           MEDICAID_CIN AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM admin_demographics_20240307\n      WHERE (MEDICAID_CIN IS NULL OR TRIM(\"MEDICAID_CIN\") = '') AND (ADDRESS1 IS NULL OR TRIM(\"ADDRESS1\") = '')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid MEDICAID_CIN',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field \"' || issue_column || '\" is empty',\n           'The required field value MEDICAID_CIN is missing. This is required due to the absence of the ADDRESS1.'\n      FROM valid_address1_or_medicaid_cin_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'CONSENT' AS issue_column,\n           \"CONSENT\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"CONSENT\" IS NULL\n        OR TRIM(CAST(\"CONSENT\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'CONSENT' AS issue_column,\n           \"CONSENT\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"CONSENT\" NOT IN ('Yes', 'YES', 'yes', 'Y', 'y', 'No', 'NO', 'no','N', 'n','Unknown', 'UNKNOWN', 'unknown','UNK', 'Unk', 'unk')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'', ''YES'', ''yes'', ''Y'', ''y'', ''No'', ''NO'', ''no'',''N'', ''n'',''Unknown'', ''UNKNOWN'', ''unknown'',''UNK'', ''Unk'', ''unk'')',\n           'Use only allowed values ''Yes'', ''YES'', ''yes'', ''Y'', ''y'', ''No'', ''NO'', ''no'',''N'', ''n'',''Unknown'', ''UNKNOWN'', ''unknown'',''UNK'', ''Unk'', ''unk'' in ' || issue_column\n      FROM allowed_values;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('87f8bee3-8c83-518e-865a-740b0e3a45d3', '52c6a395-5d83-4051-bb7c-39036f26ab29', '963ed7bf-d356-54ae-ba2a-739f7f164e1a', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'AdminDemographicCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('f6f5cc47-43d2-5134-b3d4-e6d954f3e391', '52c6a395-5d83-4051-bb7c-39036f26ab29', '767cb8df-3ec0-5b59-998e-a91e75be32b3', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'QeAdminDataCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT 'PAT_MRN_ID' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(CAST(\"PAT_MRN_ID\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'FACILITY_ID' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ID\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_unique_facility_id_per_facility_in_all_rows AS (\n  SELECT 'FACILITY_ID' AS issue_column,\n    FACILITY_ID AS invalid_value,\n    min(src_file_row_number) AS issue_row\n  FROM qe_admin_data_20240307\n  GROUP BY FACILITY_ID\n  HAVING COUNT(DISTINCT FACILITY_LONG_NAME) > 1\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Invalid FACILITY_ID',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'The unique field \"' || issue_column || '\" \"' || invalid_value || '\"is not unique per facility',\n           'FACILITY_ID is not unique per facility.'\n      FROM valid_unique_facility_id_per_facility_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'FACILITY_LONG_NAME' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_LONG_NAME\" IS NULL\n        OR TRIM(CAST(\"FACILITY_LONG_NAME\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'ORGANIZATION_TYPE' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"ORGANIZATION_TYPE\" IS NULL\n        OR TRIM(CAST(\"ORGANIZATION_TYPE\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'ORGANIZATION_TYPE' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"ORGANIZATION_TYPE\" NOT IN ('Hospital', 'DTC', 'SNF', 'SCN', 'CBO', 'OMH', 'OASAS', 'Practice', 'Article 36', 'Article 40', 'MCO')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Hospital'', ''DTC'', ''SNF'', ''SCN'', ''CBO'', ''OMH'', ''OASAS'', ''Practice'', ''Article 36'', ''Article 40'', ''MCO'')',\n           'Use only allowed values ''Hospital'', ''DTC'', ''SNF'', ''SCN'', ''CBO'', ''OMH'', ''OASAS'', ''Practice'', ''Article 36'', ''Article 40'', ''MCO'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'FACILITY_ADDRESS1' AS issue_column,\n           \"FACILITY_ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_ADDRESS1\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ADDRESS1\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_unique_facility_address1_per_facility_in_all_rows AS (\n  SELECT 'FACILITY_ADDRESS1' AS issue_column,\n    FACILITY_ADDRESS1 AS invalid_value,\n    min(src_file_row_number) AS issue_row\n  FROM qe_admin_data_20240307\n  GROUP BY FACILITY_ADDRESS1\n  HAVING COUNT(DISTINCT FACILITY_LONG_NAME) > 1\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Invalid FACILITY_ADDRESS1',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'The unique field \"' || issue_column || '\" \"' || invalid_value || '\"is not unique per facility',\n           'FACILITY_ADDRESS1 is not unique per facility.'\n      FROM valid_unique_facility_address1_per_facility_in_all_rows;\nWITH valid_integer_alphanumeric_string_in_all_rows AS (\n  SELECT 'FACILITY_ADDRESS1' AS issue_column,\n    t.\"FACILITY_ADDRESS1\" AS invalid_value,\n    t.src_file_row_number AS issue_row\n  FROM qe_admin_data_20240307 t\n  WHERE t.\"FACILITY_ADDRESS1\" SIMILAR TO '[0-9]+'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Data Type Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'Invalid string of numbers found'\n      FROM valid_integer_alphanumeric_string_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'FACILITY_STATE' AS issue_column,\n           \"FACILITY_STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_STATE\" IS NULL\n        OR TRIM(CAST(\"FACILITY_STATE\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'FACILITY_STATE' AS issue_column,\n           \"FACILITY_STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_STATE\" NOT IN ('NY', 'New York')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''NY'', ''New York'')',\n           'Use only allowed values ''NY'', ''New York'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'FACILITY_ZIP' AS issue_column,\n           \"FACILITY_ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_ZIP\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ZIP\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'FACILITY_ZIP' AS issue_column,\n           \"FACILITY_ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE CAST(\"FACILITY_ZIP\" AS VARCHAR) NOT SIMILAR TO '^\\d{5}(\\d{4})?$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^\\d{5}(\\d{4})?$',\n           'Follow the pattern ^\\d{5}(\\d{4})?$ in ' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT 'VISIT_PART_2_FLAG' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_PART_2_FLAG\" IS NULL\n        OR TRIM(CAST(\"VISIT_PART_2_FLAG\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_PART_2_FLAG' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_PART_2_FLAG\" NOT IN ('Yes', 'No')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'', ''No'')',\n           'Use only allowed values ''Yes'', ''No'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'VISIT_OMH_FLAG' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_OMH_FLAG\" IS NULL\n        OR TRIM(CAST(\"VISIT_OMH_FLAG\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_OMH_FLAG' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_OMH_FLAG\" NOT IN ('Yes', 'No')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'', ''No'')',\n           'Use only allowed values ''Yes'', ''No'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'VISIT_OPWDD_FLAG' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_OPWDD_FLAG\" IS NULL\n        OR TRIM(CAST(\"VISIT_OPWDD_FLAG\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_OPWDD_FLAG' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_OPWDD_FLAG\" NOT IN ('Yes', 'No')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'', ''No'')',\n           'Use only allowed values ''Yes'', ''No'' in ' || issue_column\n      FROM allowed_values;\nWITH pattern AS (\n    SELECT 'FACILITY_LONG_NAME' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE CAST(\"FACILITY_LONG_NAME\" AS VARCHAR) NOT SIMILAR TO '^[a-zA-Z\\s]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[a-zA-Z\\s]+$',\n           'Follow the pattern ^[a-zA-Z\\s]+$ in ' || issue_column\n      FROM pattern;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7115f76c-32eb-563c-a1d5-040d0146651a', '52c6a395-5d83-4051-bb7c-39036f26ab29', '767cb8df-3ec0-5b59-998e-a91e75be32b3', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'QeAdminDataCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('26a2e6f5-6b62-5616-8b14-1059006f438b', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'd09ebe08-1b63-56d8-8f2b-8fff76c9828f', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'ScreeningCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n\nWITH mandatory_value AS (\n    SELECT 'PAT_MRN_ID' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(CAST(\"PAT_MRN_ID\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'FACILITY_ID' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ID\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_pat_mrn_id_across_all_three_tables AS (\n  WITH cte_qe_demographic_unmatched AS (\n      SELECT DISTINCT COALESCE(ad.PAT_MRN_ID, qe.PAT_MRN_ID) AS PAT_MRN_ID,\n              COALESCE(ad.FACILITY_ID, qe.FACILITY_ID) AS FACILITY_ID,\n                    CASE\n                        WHEN ad.PAT_MRN_ID IS NULL THEN 'QE_ADMIN_DATA'\n                        ELSE 'ADMIN_DEMOGRAPHIC'\n                    END AS unmatched_source,\n                    COALESCE(ad.src_file_row_number, qe.src_file_row_number) AS src_file_row_number,\n      FROM  admin_demographics_20240307 ad\n      FULL OUTER JOIN qe_admin_data_20240307 qe\n          ON ad.PAT_MRN_ID = qe.PAT_MRN_ID\n          AND ad.FACILITY_ID = qe.FACILITY_ID\n      WHERE ad.PAT_MRN_ID IS NULL OR qe.PAT_MRN_ID IS NULL\n  )\n  Select 'PAT_MRN_ID' AS issue_column, pat_mrn_id AS invalid_pat_value, FACILITY_ID AS invalid_facility_value, unmatched_source, src_file_row_number  AS issue_row,\n  case when unmatched_source = 'ADMIN_DEMOGRAPHIC' then 'admin_demographics_20240307'\n  when unmatched_source = 'QE_ADMIN_DATA' then 'qe_admin_data_20240307'\n  Else '' End As issue_table_name\n  from cte_qe_demographic_unmatched\n  UNION\n  Select DISTINCT 'PAT_MRN_ID' AS issue_column, s.PAT_MRN_ID AS invalid_pat_value,s.FACILITY_ID AS invalid_facility_value,'SCREENING' As unmatched_source, src_file_row_number  AS issue_row,\n  'screening_20240307' as issue_table_name\n  FROM screening_20240307 s\n    Left Outer Join (\n      SELECT  DISTINCT a.PAT_MRN_ID,a.FACILITY_ID From admin_demographics_20240307 a\n      Inner Join qe_admin_data_20240307 q\n      ON a.PAT_MRN_ID = q.PAT_MRN_ID\n      AND a.FACILITY_ID = q.FACILITY_ID\n      WHERE a.PAT_MRN_ID IS NOT NULL AND q.PAT_MRN_ID IS NOT NULL\n    ) aq\n    ON s.PAT_MRN_ID = aq.PAT_MRN_ID\n  AND aq.FACILITY_ID = s.FACILITY_ID\n  Where aq.PAT_MRN_ID IS  NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'PAT_MRN_ID that does not match the FACILITY_ID',\n           issue_row,\n           issue_column,\n           invalid_pat_value,\n           'PAT_MRN_ID (\"' || invalid_pat_value || '\") that does not match the FACILITY_ID (\"' || invalid_facility_value || '\") across the files was found in \"' || issue_table_name || '\".',\n           'Validate PAT_MRN_ID that maches the FACILITY_ID across the files'\n      FROM valid_pat_mrn_id_across_all_three_tables;\nWITH mandatory_value AS (\n    SELECT 'ENCOUNTER_CLASS_CODE' AS issue_column,\n           \"ENCOUNTER_CLASS_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_CLASS_CODE\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_CLASS_CODE\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_encounter_class_in_all_rows AS (\n    SELECT 'ENCOUNTER_CLASS_CODE' AS issue_column,\n           sr.\"ENCOUNTER_CLASS_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_class_reference ecr\n      ON UPPER(sr.ENCOUNTER_CLASS_CODE) = UPPER(ecr.Code)\n     WHERE sr.ENCOUNTER_CLASS_CODE IS NOT NULL\n      AND ecr.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid ENCOUNTER CLASS CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ENCOUNTER CLASS CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ENCOUNTER CLASS CODE with encounter class reference data'\n      FROM valid_encounter_class_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'ENCOUNTER_CLASS_CODE' AS issue_column,\n      tbl.\"ENCOUNTER_CLASS_CODE\" AS invalid_value,\n      tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_CLASS_CODE\" is not null\n  and tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Display\" FROM encounter_class_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_CLASS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The ENCOUNTER_CLASS_CODE \"' || invalid_value || '\" of ENCOUNTER_CLASS_CODE_DESCRIPTION \"' || dependent_value || '\" is not matching with the ENCOUNTER_CLASS_CODE of ENCOUNTER_CLASS_CODE_DESCRIPTION in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'ENCOUNTER_CLASS_CODE_DESCRIPTION' AS issue_column,\n      tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ENCOUNTER_CLASS_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" is not null\n  and tbl.\"ENCOUNTER_CLASS_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Code\" FROM encounter_class_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_CLASS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The ENCOUNTER_CLASS_CODE_DESCRIPTION \"' || invalid_value || '\" of ENCOUNTER_CLASS_CODE \"' || dependent_value || '\" is not matching with the ENCOUNTER_CLASS_CODE_DESCRIPTION of ENCOUNTER_CLASS_CODE in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'ENCOUNTER_CLASS_CODE_SYSTEM' AS issue_column,\n           \"ENCOUNTER_CLASS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_CLASS_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_CLASS_CODE_SYSTEM\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'ENCOUNTER_CLASS_CODE_SYSTEM' AS issue_column,\n           \"ENCOUNTER_CLASS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_CLASS_CODE_SYSTEM\" NOT IN ('http://terminology.hl7.org/CodeSystem/v3-ActCode')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''http://terminology.hl7.org/CodeSystem/v3-ActCode'')',\n           'Use only allowed values ''http://terminology.hl7.org/CodeSystem/v3-ActCode'' in ' || issue_column\n      FROM allowed_values;\nWITH valid_encounter_class_in_all_rows AS (\n    SELECT 'ENCOUNTER_CLASS_CODE_DESCRIPTION' AS issue_column,\n           sr.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_class_reference ecr\n      ON UPPER(sr.ENCOUNTER_CLASS_CODE_DESCRIPTION) = UPPER(ecr.Display)\n     WHERE sr.ENCOUNTER_CLASS_CODE_DESCRIPTION IS NOT NULL\n      AND ecr.Display IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid ENCOUNTER CLASS CODE DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ENCOUNTER CLASS CODE DESCRIPTION \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ENCOUNTER CLASS CODE DESCRIPTION with encounter class reference data'\n      FROM valid_encounter_class_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'ENCOUNTER_STATUS_CODE' AS issue_column,\n           \"ENCOUNTER_STATUS_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_STATUS_CODE\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_STATUS_CODE\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_encounter_status_code_in_all_rows AS (\n    SELECT 'ENCOUNTER_STATUS_CODE' AS issue_column,\n           sr.\"ENCOUNTER_STATUS_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_status_code_reference ecr\n      ON UPPER(sr.ENCOUNTER_STATUS_CODE) = UPPER(ecr.Code)\n     WHERE sr.ENCOUNTER_STATUS_CODE IS NOT NULL\n      AND ecr.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid ENCOUNTER STATUS CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ENCOUNTER STATUS CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ENCOUNTER STATUS CODE with encounter status reference data'\n      FROM valid_encounter_status_code_in_all_rows;\nWITH valid_encounter_status_code_in_all_rows AS (\n    SELECT 'ENCOUNTER_STATUS_CODE_DESCRIPTION' AS issue_column,\n           sr.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_status_code_reference ecr\n      ON UPPER(sr.ENCOUNTER_STATUS_CODE_DESCRIPTION) = UPPER(ecr.Display)\n     WHERE sr.ENCOUNTER_STATUS_CODE_DESCRIPTION IS NOT NULL\n      AND ecr.Display IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid ENCOUNTER STATUS CODE DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ENCOUNTER STATUS CODE DESCRIPTION \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ENCOUNTER STATUS CODE DESCRIPTION with encounter status reference data'\n      FROM valid_encounter_status_code_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'ENCOUNTER_STATUS_CODE' AS issue_column,\n      tbl.\"ENCOUNTER_STATUS_CODE\" AS invalid_value,\n      tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_STATUS_CODE\" is not null\n  and tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Display\" FROM encounter_status_code_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_STATUS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The ENCOUNTER_STATUS_CODE \"' || invalid_value || '\" of ENCOUNTER_STATUS_CODE_DESCRIPTION \"' || dependent_value || '\" is not matching with the ENCOUNTER_STATUS_CODE of ENCOUNTER_STATUS_CODE_DESCRIPTION in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'ENCOUNTER_STATUS_CODE_DESCRIPTION' AS issue_column,\n      tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ENCOUNTER_STATUS_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" is not null\n  and tbl.\"ENCOUNTER_STATUS_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Code\" FROM encounter_status_code_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_STATUS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The ENCOUNTER_STATUS_CODE_DESCRIPTION \"' || invalid_value || '\" of ENCOUNTER_STATUS_CODE \"' || dependent_value || '\" is not matching with the ENCOUNTER_STATUS_CODE_DESCRIPTION of ENCOUNTER_STATUS_CODE in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'ENCOUNTER_STATUS_CODE_SYSTEM' AS issue_column,\n           \"ENCOUNTER_STATUS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_STATUS_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_STATUS_CODE_SYSTEM\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'ENCOUNTER_STATUS_CODE_SYSTEM' AS issue_column,\n           \"ENCOUNTER_STATUS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_STATUS_CODE_SYSTEM\" NOT IN ('http://hl7.org/fhir/encounter-status')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''http://hl7.org/fhir/encounter-status'')',\n           'Use only allowed values ''http://hl7.org/fhir/encounter-status'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'ENCOUNTER_TYPE_CODE' AS issue_column,\n           \"ENCOUNTER_TYPE_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_TYPE_CODE\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_TYPE_CODE\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'ENCOUNTER_TYPE_CODE_SYSTEM' AS issue_column,\n           \"ENCOUNTER_TYPE_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_TYPE_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_TYPE_CODE_SYSTEM\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_encounter_type_code_in_all_rows AS (\n    SELECT 'ENCOUNTER_TYPE_CODE' AS issue_column,\n           sr.\"ENCOUNTER_TYPE_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_type_code_reference ecr\n      ON UPPER(CAST(sr.ENCOUNTER_TYPE_CODE AS VARCHAR)) = UPPER(CAST(ecr.Code AS VARCHAR))\n     WHERE sr.ENCOUNTER_TYPE_CODE IS NOT NULL\n      AND ecr.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid ENCOUNTER TYPE CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ENCOUNTER TYPE CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ENCOUNTER TYPE CODE with encounter type reference data'\n      FROM valid_encounter_type_code_in_all_rows;\nWITH allowed_values AS (\n    SELECT 'ENCOUNTER_TYPE_CODE_SYSTEM' AS issue_column,\n           \"ENCOUNTER_TYPE_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_TYPE_CODE_SYSTEM\" NOT IN ('SNOMED-CT', 'SNOMED', 'http://snomed.info/sct')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''SNOMED-CT'', ''SNOMED'', ''http://snomed.info/sct'')',\n           'Use only allowed values ''SNOMED-CT'', ''SNOMED'', ''http://snomed.info/sct'' in ' || issue_column\n      FROM allowed_values;\nWITH valid_encounter_type_code_in_all_rows AS (\n    SELECT 'ENCOUNTER_TYPE_CODE_DESCRIPTION' AS issue_column,\n           sr.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_type_code_reference ecr\n      ON UPPER(CAST(sr.ENCOUNTER_TYPE_CODE_DESCRIPTION AS VARCHAR)) = UPPER(CAST(ecr.Display AS VARCHAR))\n     WHERE sr.ENCOUNTER_TYPE_CODE_DESCRIPTION IS NOT NULL\n      AND ecr.Display IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid ENCOUNTER TYPE CODE DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ENCOUNTER TYPE CODE DESCRIPTION \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ENCOUNTER TYPE CODE DESCRIPTION with encounter type reference data'\n      FROM valid_encounter_type_code_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'ENCOUNTER_TYPE_CODE' AS issue_column,\n      tbl.\"ENCOUNTER_TYPE_CODE\" AS invalid_value,\n      tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_TYPE_CODE\" is not null\n  and tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Display\" FROM encounter_type_code_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_TYPE_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The ENCOUNTER_TYPE_CODE \"' || invalid_value || '\" of ENCOUNTER_TYPE_CODE_DESCRIPTION \"' || dependent_value || '\" is not matching with the ENCOUNTER_TYPE_CODE of ENCOUNTER_TYPE_CODE_DESCRIPTION in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'ENCOUNTER_TYPE_CODE_DESCRIPTION' AS issue_column,\n      tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ENCOUNTER_TYPE_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" is not null\n  and tbl.\"ENCOUNTER_TYPE_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Code\" FROM encounter_type_code_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_TYPE_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The ENCOUNTER_TYPE_CODE_DESCRIPTION \"' || invalid_value || '\" of ENCOUNTER_TYPE_CODE \"' || dependent_value || '\" is not matching with the ENCOUNTER_TYPE_CODE_DESCRIPTION of ENCOUNTER_TYPE_CODE in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'SCREENING_STATUS_CODE' AS issue_column,\n           \"SCREENING_STATUS_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_STATUS_CODE\" IS NULL\n        OR TRIM(CAST(\"SCREENING_STATUS_CODE\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_screening_status_code_in_all_rows AS (\n    SELECT 'SCREENING_STATUS_CODE' AS issue_column,\n           sr.\"SCREENING_STATUS_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN screening_status_code_reference ref\n      ON UPPER(sr.SCREENING_STATUS_CODE) = UPPER(ref.Code)\n     WHERE sr.SCREENING_STATUS_CODE IS NOT NULL\n      AND ref.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid SCREENING STATUS CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid SCREENING STATUS CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate SCREENING STATUS CODE with screening status code reference data'\n      FROM valid_screening_status_code_in_all_rows;\nWITH valid_screening_status_code_in_all_rows AS (\n    SELECT 'SCREENING_STATUS_CODE_DESCRIPTION' AS issue_column,\n           sr.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN screening_status_code_reference ecr\n      ON UPPER(sr.SCREENING_STATUS_CODE_DESCRIPTION) = UPPER(ecr.Display)\n     WHERE sr.SCREENING_STATUS_CODE_DESCRIPTION IS NOT NULL\n      AND ecr.Display IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid SCREENING STATUS CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid SCREENING STATUS CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate SCREENING STATUS CODE with screening status code reference data'\n      FROM valid_screening_status_code_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'SCREENING_STATUS_CODE' AS issue_column,\n      tbl.\"SCREENING_STATUS_CODE\" AS invalid_value,\n      tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"SCREENING_STATUS_CODE\" is not null\n  and tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Display\" FROM screening_status_code_reference WHERE UPPER(CAST(tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SCREENING_STATUS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The SCREENING_STATUS_CODE \"' || invalid_value || '\" of SCREENING_STATUS_CODE_DESCRIPTION \"' || dependent_value || '\" is not matching with the SCREENING_STATUS_CODE of SCREENING_STATUS_CODE_DESCRIPTION in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'SCREENING_STATUS_CODE_DESCRIPTION' AS issue_column,\n      tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"SCREENING_STATUS_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" is not null\n  and tbl.\"SCREENING_STATUS_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Code\" FROM screening_status_code_reference WHERE UPPER(CAST(tbl.\"SCREENING_STATUS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The SCREENING_STATUS_CODE_DESCRIPTION \"' || invalid_value || '\" of SCREENING_STATUS_CODE \"' || dependent_value || '\" is not matching with the SCREENING_STATUS_CODE_DESCRIPTION of SCREENING_STATUS_CODE in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'SCREENING_STATUS_CODE_SYSTEM' AS issue_column,\n           \"SCREENING_STATUS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_STATUS_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"SCREENING_STATUS_CODE_SYSTEM\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'SCREENING_STATUS_CODE_SYSTEM' AS issue_column,\n           \"SCREENING_STATUS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_STATUS_CODE_SYSTEM\" NOT IN ('http://hl7.org/fhir/observation-status')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''http://hl7.org/fhir/observation-status'')',\n           'Use only allowed values ''http://hl7.org/fhir/observation-status'' in ' || issue_column\n      FROM allowed_values;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  'ANSWER_CODE' AS issue_column,\n              \"ANSWER_CODE\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (ANSWER_CODE IS NULL OR TRIM(\"ANSWER_CODE\") = '')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN ('TOTAL SAFETY SCORE',\n            'CALCULATED WEEKLY PHYSICAL ACTIVITY',\n            'CALCULATED MENTAL HEALTH SCORE')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid value in ANSWER_CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field \"' || issue_column || '\" is empty',\n           'The required field value ANSWER_CODE is missing'\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  'ANSWER_CODE_SYSTEM_NAME' AS issue_column,\n              \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (ANSWER_CODE_SYSTEM_NAME IS NULL OR TRIM(\"ANSWER_CODE_SYSTEM_NAME\") = '')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN ('TOTAL SAFETY SCORE',\n            'CALCULATED WEEKLY PHYSICAL ACTIVITY',\n            'CALCULATED MENTAL HEALTH SCORE')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid value in ANSWER_CODE_SYSTEM_NAME',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field \"' || issue_column || '\" is empty',\n           'The required field value ANSWER_CODE_SYSTEM_NAME is missing'\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  'QUESTION_CODE' AS issue_column,\n              \"QUESTION_CODE\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (QUESTION_CODE IS NULL OR TRIM(\"QUESTION_CODE\") = '')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN ('TOTAL SAFETY SCORE',\n            'CALCULATED WEEKLY PHYSICAL ACTIVITY',\n            'CALCULATED MENTAL HEALTH SCORE')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid value in QUESTION_CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field \"' || issue_column || '\" is empty',\n           'The required field value QUESTION_CODE is missing'\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  'QUESTION_CODE_SYSTEM_NAME' AS issue_column,\n              \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (QUESTION_CODE_SYSTEM_NAME IS NULL OR TRIM(\"QUESTION_CODE_SYSTEM_NAME\") = '')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN ('TOTAL SAFETY SCORE',\n            'CALCULATED WEEKLY PHYSICAL ACTIVITY',\n            'CALCULATED MENTAL HEALTH SCORE')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid value in QUESTION_CODE_SYSTEM_NAME',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field \"' || issue_column || '\" is empty',\n           'The required field value QUESTION_CODE_SYSTEM_NAME is missing'\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  'SCREENING_CODE_DESCRIPTION' AS issue_column,\n              \"SCREENING_CODE_DESCRIPTION\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (SCREENING_CODE_DESCRIPTION IS NULL OR TRIM(\"SCREENING_CODE_DESCRIPTION\") = '')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN ('TOTAL SAFETY SCORE',\n            'CALCULATED WEEKLY PHYSICAL ACTIVITY',\n            'CALCULATED MENTAL HEALTH SCORE')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid value in SCREENING_CODE_DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field \"' || issue_column || '\" is empty',\n           'The required field value SCREENING_CODE_DESCRIPTION is missing'\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH allowed_values AS (\n    SELECT 'SCREENING_CODE_DESCRIPTION' AS issue_column,\n           \"SCREENING_CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_CODE_DESCRIPTION\" NOT IN ('Accountable health communities (AHC) health-related social needs (HRSN) supplemental questions','Accountable health communities (AHC) health-related social needs screening (HRSN) tool')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Accountable health communities (AHC) health-related social needs (HRSN) supplemental questions'',''Accountable health communities (AHC) health-related social needs screening (HRSN) tool'')',\n           'Use only allowed values ''Accountable health communities (AHC) health-related social needs (HRSN) supplemental questions'',''Accountable health communities (AHC) health-related social needs screening (HRSN) tool'' in ' || issue_column\n      FROM allowed_values;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  'SCREENING_CODE_SYSTEM_NAME' AS issue_column,\n              \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (SCREENING_CODE_SYSTEM_NAME IS NULL OR TRIM(\"SCREENING_CODE_SYSTEM_NAME\") = '')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN ('TOTAL SAFETY SCORE',\n            'CALCULATED WEEKLY PHYSICAL ACTIVITY',\n            'CALCULATED MENTAL HEALTH SCORE')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid value in SCREENING_CODE_SYSTEM_NAME',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field \"' || issue_column || '\" is empty',\n           'The required field value SCREENING_CODE_SYSTEM_NAME is missing'\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  'SCREENING_CODE' AS issue_column,\n              \"SCREENING_CODE\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (SCREENING_CODE IS NULL OR TRIM(\"SCREENING_CODE\") = '')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN ('TOTAL SAFETY SCORE',\n            'CALCULATED WEEKLY PHYSICAL ACTIVITY',\n            'CALCULATED MENTAL HEALTH SCORE')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid value in SCREENING_CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field \"' || issue_column || '\" is empty',\n           'The required field value SCREENING_CODE is missing'\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'QUESTION_CODE_DESCRIPTION' AS issue_column,\n           \"QUESTION_CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"QUESTION_CODE_DESCRIPTION\" IS NULL\n        OR TRIM(CAST(\"QUESTION_CODE_DESCRIPTION\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_answer_code_in_all_rows AS (\n  SELECT 'ANSWER_CODE' AS issue_column,\n    scr.\"ANSWER_CODE\" AS invalid_value,\n    scr.\"QUESTION_CODE\" AS invalid_question_value,\n    scr.SCREENING_CODE AS invalid_screening_value,\n    scr.src_file_row_number AS issue_row\n    FROM screening_20240307 scr\n    LEFT OUTER JOIN ahc_cross_walk crw\n      ON UPPER(scr.SCREENING_CODE) = UPPER(crw.SCREENING_CODE)\n      AND UPPER(scr.QUESTION_CODE) = UPPER(crw.QUESTION_CODE)\n      AND UPPER(scr.ANSWER_CODE) = UPPER(crw.ANSWER_CODE)\n    WHERE scr.SCREENING_CODE IS NOT NULL\n      AND scr.QUESTION_CODE IS NOT NULL\n      AND scr.ANSWER_CODE IS NOT NULL\n      AND crw.ANSWER_CODE IS NULL\n)\n\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Answer Code',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Provided Screening Code \"' || invalid_screening_value || '\", Question Code \"' || invalid_question_value || '\" and Answer Code \"' || invalid_value || '\" are not matching with the reference data found in ' || issue_column,\n           'Validate Screening Code, Question Code and Answer Code with ahc cross walk reference data'\n      FROM valid_answer_code_in_all_rows;\nWITH valid_total_safety_score_in_all_rows AS (\n  WITH cte_score AS (\n    SELECT\n        SUM(crw.Score) AS cross_walk_Score,\n        SUM(\n            CASE\n                WHEN UPPER(TRIM(scr.QUESTION_CODE_DESCRIPTION)) LIKE '%TOTAL SAFETY SCORE%' AND TRY_CAST(scr.ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL THEN CAST(scr.ANSWER_CODE_DESCRIPTION AS INTEGER)\n                ELSE 0\n            END\n        ) AS screening_score\n    FROM\n        screening_20240307 scr\n    LEFT OUTER JOIN (\n        SELECT \tacw.SCREENING_CODE,\n              acw.QUESTION_CODE,\n              acw.ANSWER_CODE,\n              acw.QUESTION_SLNO,\n              acw.Score AS Score\n        FROM ahc_cross_walk acw\n        Where QUESTION_SLNO_REFERENCE In(\n        SELECT QUESTION_SLNO\n            FROM ahc_cross_walk\n            WHERE UPPER(TRIM(QUESTION)) LIKE '%TOTAL SAFETY SCORE%'\n            )\n        AND acw.QUESTION_CODE = scr.QUESTION_CODE\n        AND acw.ANSWER_CODE = scr.ANSWER_CODE\n    ) AS crw ON crw.SCREENING_CODE = scr.SCREENING_CODE\n)\nSELECT \tcross_walk_Score,\n    screening_score AS invalid_value,\n    (SELECT src_file_row_number FROM screening_20240307 WHERE UPPER(TRIM(QUESTION_CODE_DESCRIPTION)) LIKE '%TOTAL SAFETY SCORE%') AS issue_row,\n  'ANSWER_CODE_DESCRIPTION' AS issue_column\nFROM cte_score\nWHERE screening_score <> cross_walk_Score\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid ANSWER_CODE_DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ANSWER_CODE_DESCRIPTION for TOTAL SAFETY SCORE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ANSWER_CODE_DESCRIPTION for TOTAL SAFETY SCORE (Calculated Score)'\n      FROM valid_total_safety_score_in_all_rows;\nWITH valid_calculated_mental_health_score_in_all_rows AS (\n  SELECT ANSWER_CODE_DESCRIPTION AS issue_column,\n  SCREENING_CALCULATED_SCORE AS invalid_value,\n  SRC_FILE_ROW_NUMBER AS issue_row\n  FROM\n  (\n  SELECT Sum(crw.score) As CROSSWALK_ANSWER_SCORE,\n      (SELECT CASE WHEN TRY_CAST(ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL THEN CAST(ANSWER_CODE_DESCRIPTION AS INTEGER) ELSE 0 END AS SCREENING_CALC_SCORE\n        FROM screening_20240307 scr2\n        WHERE UPPER(scr2.QUESTION_CODE_DESCRIPTION) LIKE '%CALCULATED MENTAL HEALTH SCORE%'\n    ) AS SCREENING_CALCULATED_SCORE,\n    (SELECT src_file_row_number FROM screening_20240307 WHERE UPPER(QUESTION_CODE_DESCRIPTION) LIKE '%CALCULATED MENTAL HEALTH SCORE%') AS SRC_FILE_ROW_NUMBER,\n    'ANSWER_CODE_DESCRIPTION' AS ANSWER_CODE_DESCRIPTION\n      FROM screening_20240307 scr\n      INNER JOIN (\n          SELECT \tacw.score As SCORE\n          FROM ahc_cross_walk acw\n          Where QUESTION_SLNO_REFERENCE In(\n          SELECT QUESTION_SLNO\n              FROM ahc_cross_walk\n              WHERE UPPER(QUESTION) LIKE '%CALCULATED MENTAL HEALTH SCORE%'\n              )\n          AND acw.QUESTION_CODE = scr.QUESTION_CODE\n          AND acw.ANSWER_CODE  = scr.ANSWER_CODE\n      ) AS crw ON 1 = 1\n  ) As calc_fld_val\n  Where calc_fld_val.CROSSWALK_ANSWER_SCORE <> calc_fld_val.SCREENING_CALCULATED_SCORE\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid ANSWER_CODE_DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ANSWER_CODE_DESCRIPTION for CALCULATED MENTAL HEALTH SCORE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ANSWER_CODE_DESCRIPTION for CALCULATED MENTAL HEALTH SCORE (Calculated Score)'\n      FROM valid_calculated_mental_health_score_in_all_rows;\nWITH valid_calculated_weekly_physical_activity_score_in_all_rows AS (\n  WITH cte_physical_activity AS (\n    SELECT\n      scr.SCREENING_CODE,\n      scr.QUESTION_CODE,\n      scr.ANSWER_CODE,\n      crw.ANSWER_VALUE,\n      scr.ANSWER_CODE_DESCRIPTION,\n      ROW_NUMBER() OVER (\n      ORDER BY scr.SCREENING_CODE) AS sequence_number\n    FROM\n      screening_20240307 scr\n    INNER JOIN (\n      SELECT\n        acw.SCREENING_CODE,\n        acw.QUESTION_CODE,\n        acw.ANSWER_CODE,\n        acw.QUESTION_SLNO,\n        CASE\n          WHEN TRY_CAST(acw.ANSWER_VALUE AS INTEGER) IS NOT NULL THEN CAST(acw.ANSWER_VALUE AS INTEGER)\n          ELSE CASE WHEN acw.ANSWER_CODE='LA32060-8' THEN 150 ELSE 0 END\n        END AS ANSWER_VALUE\n      FROM\n        ahc_cross_walk acw\n      Where\n        QUESTION_SLNO_REFERENCE In(\n        SELECT\n          QUESTION_SLNO\n        FROM\n          ahc_cross_walk\n        WHERE\n          UPPER(QUESTION) LIKE '%CALCULATED PHYSICAL ACTIVITY SCORE%'\n                )\n        AND acw.QUESTION_CODE = scr.QUESTION_CODE\n        AND acw.ANSWER_CODE = scr.ANSWER_CODE\n        ) AS crw ON\n      crw.SCREENING_CODE = scr.SCREENING_CODE\n    )\n    Select \tANSWER_CODE_DESCRIPTION AS issue_column,\n        CROSSWALK_ANSWER_VALUE AS CROSSWALK_ANSWER_VALUE,\n        SCREENING_CALCULATED_VALUE AS invalid_value,\n        SRC_FILE_ROW_NUMBER AS issue_row\n    FROM\n      (\n      Select\n        t1.ANSWER_VALUE * t2.ANSWER_VALUE As CROSSWALK_ANSWER_VALUE,\n        CASE\n          WHEN TRY_CAST(t1.ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL\n            AND TRY_CAST(t2.ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL THEN\n        CAST(t1.ANSWER_CODE_DESCRIPTION AS INTEGER) * CAST(t2.ANSWER_CODE_DESCRIPTION AS INTEGER)\n          ELSE CASE WHEN t2.ANSWER_CODE='LA32060-8' THEN 150 * CAST(t1.ANSWER_CODE_DESCRIPTION AS INTEGER) ELSE 0 END\n          END AS SCREENING_ANSWER_VALUE,\n          Scrn_Phycical_Act_Score.SCRN_PHYSICAL_ACTIVITY_VALUE AS SCREENING_CALCULATED_VALUE,\n          (SELECT src_file_row_number FROM screening_20240307 WHERE UPPER(QUESTION_CODE_DESCRIPTION) LIKE '%CALCULATED WEEKLY PHYSICAL ACTIVITY%') AS SRC_FILE_ROW_NUMBER,\n          'ANSWER_CODE_DESCRIPTION' AS ANSWER_CODE_DESCRIPTION\n\n        from\n          cte_physical_activity t1\n        Inner Join cte_physical_activity t2\n    On\n          t1.sequence_number = 1\n          and t2.sequence_number = 2\n        Left Outer Join (\n          Select\n            CASE\n              WHEN TRY_CAST(ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL THEN CAST(ANSWER_CODE_DESCRIPTION AS INTEGER)\n              ELSE 0\n            END SCRN_PHYSICAL_ACTIVITY_VALUE\n          From\n          screening_20240307 scr\n          Where\n            UPPER(scr.QUESTION_CODE_DESCRIPTION) LIKE '%CALCULATED WEEKLY PHYSICAL ACTIVITY%') AS Scrn_Phycical_Act_Score\n                On\n          1 = 1\n    ) As calc_fld\n    Where\n      (calc_fld.CROSSWALK_ANSWER_VALUE <> calc_fld.SCREENING_ANSWER_VALUE)\n      OR (calc_fld.SCREENING_ANSWER_VALUE <> calc_fld.SCREENING_CALCULATED_VALUE)\n      OR (calc_fld.CROSSWALK_ANSWER_VALUE <> calc_fld.SCREENING_CALCULATED_VALUE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid ANSWER_CODE_DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ANSWER_CODE_DESCRIPTION for CALCULATED PHYSICAL ACTIVITY SCORE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ANSWER_CODE_DESCRIPTION for CALCULATED PHYSICAL ACTIVITY SCORE (Calculated Score)'\n      FROM valid_calculated_weekly_physical_activity_score_in_all_rows;\nWITH allowed_values AS (\n    SELECT 'SCREENING_CODE' AS issue_column,\n           \"SCREENING_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_CODE\" NOT IN ('96777-8', '97023-6')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''96777-8'', ''97023-6'')',\n           'Use only allowed values ''96777-8'', ''97023-6'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'SCREENING_CODE_SYSTEM_NAME' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" NOT IN ('LN', 'LOINC', 'http://loinc.org')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''LN'', ''LOINC'', ''http://loinc.org'')',\n           'Use only allowed values ''LN'', ''LOINC'', ''http://loinc.org'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'RECORDED_TIME' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"RECORDED_TIME\" IS NULL\n        OR TRIM(CAST(\"RECORDED_TIME\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_date_time_in_all_rows AS (\n        SELECT  'RECORDED_TIME' AS issue_column,\n              \"RECORDED_TIME\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM \"screening_20240307\"\n        WHERE \"RECORDED_TIME\" IS NOT NULL\n        AND \"RECORDED_TIME\" NOT SIMILAR TO '([0-9]([0-9]([0-9][1-9]|[1-9]0)|[1-9]00)|[1-9]000)-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])T([01][0-9]|2[0-3]):[0-5][0-9]:([0-5][0-9]|60)(\\.[0-9]+)?(Z|(\\+|-)((0[0-9]|1[0-3]):[0-5][0-9]|14:00))$'\n        OR TRY_CAST(\"RECORDED_TIME\" AS TIMESTAMP) IS NULL\n  )\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Date',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid timestamp \"' || invalid_value || '\" found in ' || issue_column,\n           'Please be sure to provide both a valid date and time.'\n      FROM valid_date_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'SDOH_DOMAIN' AS issue_column,\n           \"SDOH_DOMAIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SDOH_DOMAIN\" IS NULL\n        OR TRIM(CAST(\"SDOH_DOMAIN\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_sdoh_domain_in_all_rows AS (\n  SELECT DISTINCT scr.SDOH_DOMAIN AS invalid_value,\n    'SDOH_DOMAIN' AS issue_column,\n    scr.src_file_row_number AS issue_row\n  FROM screening_20240307 scr\n  LEFT JOIN ahc_cross_walk cw\n  ON UPPER(scr.SDOH_DOMAIN) = UPPER(cw.SDOH_DOMAIN)\n  WHERE cw.SDOH_DOMAIN IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid SDOH DOMAIN',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid SDOH DOMAIN \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate SDOH DOMAIN with ahc cross walk reference data'\n      FROM valid_sdoh_domain_in_all_rows;\nWITH valid_question_code_for_screening_code_in_all_rows AS (\n  SELECT DISTINCT scr.SCREENING_CODE AS issue_screening_value, scr.QUESTION_CODE AS invalid_value, 'QUESTION_CODE' AS issue_column, scr.src_file_row_number AS issue_row\n  FROM screening_20240307 scr\n  LEFT JOIN ahc_cross_walk cw ON UPPER(scr.QUESTION_CODE) = UPPER(cw.QUESTION_CODE)\n  AND UPPER(scr.SCREENING_CODE) = UPPER(cw.SCREENING_CODE)\n  WHERE cw.QUESTION_CODE IS NULL\n  AND cw.SCREENING_CODE IS NOT NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Question Code',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid Question Code \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate Question Code with ahc cross walk reference data'\n      FROM valid_question_code_for_screening_code_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'ANSWER_CODE_DESCRIPTION' AS issue_column,\n           \"ANSWER_CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ANSWER_CODE_DESCRIPTION\" IS NULL\n        OR TRIM(CAST(\"ANSWER_CODE_DESCRIPTION\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'QUESTION_CODE_SYSTEM_NAME' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" NOT IN ('LN','LOINC','http://loinc.org')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''LN'',''LOINC'',''http://loinc.org'')',\n           'Use only allowed values ''LN'',''LOINC'',''http://loinc.org'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'ANSWER_CODE_SYSTEM_NAME' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" NOT IN ('LN','LOINC','http://loinc.org')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''LN'',''LOINC'',''http://loinc.org'')',\n           'Use only allowed values ''LN'',''LOINC'',''http://loinc.org'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'POTENTIAL_NEED_INDICATED' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" IS NULL\n        OR TRIM(CAST(\"POTENTIAL_NEED_INDICATED\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'POTENTIAL_NEED_INDICATED' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" NOT IN ('Yes','No','NA','yes','no','na')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'',''No'',''NA'',''yes'',''no'',''na'')',\n           'Use only allowed values ''Yes'',''No'',''NA'',''yes'',''no'',''na'' in ' || issue_column\n      FROM allowed_values;\nWITH valid_screening_potential_need_indicated_question_answer_values_in_all_rows AS (\n  SELECT  'POTENTIAL_NEED_INDICATED' AS issue_column,\n          coalesce(scr.\"POTENTIAL_NEED_INDICATED\",'NULL') AS invalid_value,\n          scr.ANSWER_CODE AS invalid_answer_value,\n          scr.QUESTION_CODE AS invalid_question_value,\n          scr.SCREENING_CODE AS invalid_screening_value,\n          scr.src_file_row_number AS issue_row\n  FROM screening_20240307 scr\n  LEFT JOIN ahc_cross_walk acw\n    ON UPPER(scr.SCREENING_CODE) = UPPER(acw.SCREENING_CODE)\n    AND UPPER(scr.QUESTION_CODE) = UPPER(acw.QUESTION_CODE)\n    AND UPPER(scr.ANSWER_CODE) = UPPER(acw.ANSWER_CODE)\n    AND UPPER(scr.\"POTENTIAL_NEED_INDICATED\") = UPPER(acw.\"POTENTIAL_NEED_INDICATED\")\n  WHERE acw.\"POTENTIAL_NEED_INDICATED\" IS NULL\n  AND  UPPER(scr.QUESTION_CODE_DESCRIPTION)\n  NOT IN(\n    'TOTAL SAFETY SCORE',\n    'CALCULATED WEEKLY PHYSICAL ACTIVITY',\n    'CALCULATED MENTAL HEALTH SCORE'\n  )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid value in POTENTIAL_NEED_INDICATED',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Provided Potential Need Indicated \"' || invalid_value || '\", Screening Code \"' || invalid_screening_value || '\", Question Code \"' || invalid_question_value || '\" and Answer Code \"' || invalid_answer_value || '\" are not matching with the reference data found in ' || issue_column,\n           'Validate Potential Need Indicated, Screening Code, Question Code and Answer Code with ahc cross walk reference data'\n      FROM valid_screening_potential_need_indicated_question_answer_values_in_all_rows;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('c50d9d2d-753b-5200-b2f6-e63309cf252d', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'd09ebe08-1b63-56d8-8f2b-8fff76c9828f', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'ScreeningCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('463a01b7-82ad-5633-939d-54a554d09923', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b9aac8ec-792a-511d-8107-25bd96085898', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'AhcCrossWalkCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('98f79424-a291-554e-aa6a-17c4c39e5c81', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b9aac8ec-792a-511d-8107-25bd96085898', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'AhcCrossWalkCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('1e8926d1-43b1-5485-9308-7addd10605ab', '52c6a395-5d83-4051-bb7c-39036f26ab29', '48eb0055-f06e-57f4-8019-f49266be3d22', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'EncounterClassReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('a76151ab-e619-51bb-9db7-57c686404756', '52c6a395-5d83-4051-bb7c-39036f26ab29', '48eb0055-f06e-57f4-8019-f49266be3d22', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'EncounterClassReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('81a8b5c0-5c79-5ff9-95d6-cfcf0749c550', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2e9c77e9-a664-5323-83e4-e6a92cf998ab', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'EncounterStatusCodeReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('731b9b5d-fbb0-541f-93bc-11778098ab71', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2e9c77e9-a664-5323-83e4-e6a92cf998ab', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'EncounterStatusCodeReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('2af573ce-4941-56c1-a703-f92928ad3a7d', '52c6a395-5d83-4051-bb7c-39036f26ab29', '4b3dd9ab-d81b-509a-9662-68dbd6d142f7', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'EncounterTypeCodeReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('8fe71cea-8904-5ba0-823d-de9955eee28d', '52c6a395-5d83-4051-bb7c-39036f26ab29', '4b3dd9ab-d81b-509a-9662-68dbd6d142f7', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'EncounterTypeCodeReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('b7082a36-d569-5f54-b0fe-23dfaca90466', '52c6a395-5d83-4051-bb7c-39036f26ab29', '1a152daa-273d-5411-88cf-84067822a8aa', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7d4a917b-2900-5b12-a89c-a246a342b27b', '52c6a395-5d83-4051-bb7c-39036f26ab29', '1a152daa-273d-5411-88cf-84067822a8aa', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('de2853a4-d787-5e6d-ba4c-58a0cd667eac', '52c6a395-5d83-4051-bb7c-39036f26ab29', '787ee7ff-3ef5-59aa-a055-659cf10b6202', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'GenderIdentityReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('51873a08-9517-54b6-982b-38b5e08677b8', '52c6a395-5d83-4051-bb7c-39036f26ab29', '787ee7ff-3ef5-59aa-a055-659cf10b6202', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'GenderIdentityReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('bd4d7db3-4490-5a2f-8b54-876cd96bb629', '52c6a395-5d83-4051-bb7c-39036f26ab29', '79f3d60e-c863-5759-8043-f122175a7cbb', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'AdministrativeSexReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('e6b6e4b0-6fdd-5d2b-a626-801aaaa4967f', '52c6a395-5d83-4051-bb7c-39036f26ab29', '79f3d60e-c863-5759-8043-f122175a7cbb', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'AdministrativeSexReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7b22a848-5153-5975-b74e-e9c3ea06640c', '52c6a395-5d83-4051-bb7c-39036f26ab29', '6c2d9879-7393-524d-9e9e-02ea961aca39', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'SexAtBirthReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('8a53e502-4b61-5596-88d5-e2e23a907935', '52c6a395-5d83-4051-bb7c-39036f26ab29', '6c2d9879-7393-524d-9e9e-02ea961aca39', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'SexAtBirthReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('0ab7227d-471c-5f13-9630-7f3c0c6cd120', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2239dca2-9dd4-5c3a-91c8-2585839b9584', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'SexualOrientationReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('63af23ca-ea46-53d2-a55c-459cb2419b54', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2239dca2-9dd4-5c3a-91c8-2585839b9584', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'SexualOrientationReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('41f3b3f2-2670-5600-96ca-a39e21943a0a', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'fc740f9e-863e-5dd1-b1a1-86d176cb549c', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'BusinessRulesReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('2bb73de9-1a11-58ac-bcda-74d30c2ace8e', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'fc740f9e-863e-5dd1-b1a1-86d176cb549c', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'BusinessRulesReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('baac722a-6a3b-5494-9df5-91e63f8c22b0', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f98a88dc-a929-5a9b-906a-277e62c93012', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'RaceReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('312774c2-4ed4-526a-a68c-64356a89466d', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f98a88dc-a929-5a9b-906a-277e62c93012', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'RaceReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('6cf18abf-2b0d-5ec5-9b5e-2a7e81d0bcc3', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b0cbca95-5c20-5b2b-b589-9e832c556bc6', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'EthnicityReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('66d2dfbd-511a-58c0-9092-fd1965efbe27', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b0cbca95-5c20-5b2b-b589-9e832c556bc6', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'EthnicityReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('905ccf58-6d99-5787-97b2-2534a35e55d6', '52c6a395-5d83-4051-bb7c-39036f26ab29', '3469db42-0066-5f23-9ee4-2b857bf339a4', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'PreferredLanguageReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('96ffe5ed-2b40-5e9b-8e13-a60d66430ceb', '52c6a395-5d83-4051-bb7c-39036f26ab29', '3469db42-0066-5f23-9ee4-2b857bf339a4', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'PreferredLanguageReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('83c7e8ef-bc1c-5726-a3f1-46ec9c63a4df', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f19d5ebb-ea63-5b1d-b1b1-758457a2da29', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'SdohDomainReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('aae34d6f-c822-51b7-b05a-b06cb3774a0f', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f19d5ebb-ea63-5b1d-b1b1-758457a2da29', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'SdohDomainReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      ","orch_session_exec_id":"35df2d8c-7b46-52f7-b53e-aacbad11754e","exec_nature":"duckdb","exec_status":0,"input_text":"-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('630f992f-2d33-5d0b-9855-29fdb84f62ee', '52c6a395-5d83-4051-bb7c-39036f26ab29', '963ed7bf-d356-54ae-ba2a-739f7f164e1a', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'AdminDemographicCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT 'FIRST_NAME' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"FIRST_NAME\" IS NULL\n        OR TRIM(CAST(\"FIRST_NAME\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'FIRST_NAME' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"FIRST_NAME\" AS VARCHAR) NOT SIMILAR TO '^[A-Za-z]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]+$',\n           'Follow the pattern ^[A-Za-z]+$ in ' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT 'MIDDLE_NAME' AS issue_column,\n           \"MIDDLE_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"MIDDLE_NAME\" AS VARCHAR) NOT SIMILAR TO '^[A-Za-z]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]+$',\n           'Follow the pattern ^[A-Za-z]+$ in ' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT 'LAST_NAME' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"LAST_NAME\" IS NULL\n        OR TRIM(CAST(\"LAST_NAME\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'LAST_NAME' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"LAST_NAME\" AS VARCHAR) NOT SIMILAR TO '^[A-Za-z]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]+$',\n           'Follow the pattern ^[A-Za-z]+$ in ' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT 'ADMINISTRATIVE_SEX_CODE' AS issue_column,\n           \"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"ADMINISTRATIVE_SEX_CODE\" IS NULL\n        OR TRIM(CAST(\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'ADMINISTRATIVE_SEX_CODE_SYSTEM' AS issue_column,\n           \"ADMINISTRATIVE_SEX_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"ADMINISTRATIVE_SEX_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"ADMINISTRATIVE_SEX_CODE_SYSTEM\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_administrative_sex_code_in_all_rows AS (\n    SELECT 'ADMINISTRATIVE_SEX_CODE' AS issue_column,\n           sr.\"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN administrative_sex_reference ref\n      ON UPPER(sr.\"ADMINISTRATIVE_SEX_CODE\") = UPPER(ref.ADMINISTRATIVE_SEX_CODE)\n     WHERE sr.\"ADMINISTRATIVE_SEX_CODE\" IS NOT NULL\n      AND ref.ADMINISTRATIVE_SEX_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid ADMINISTRATIVE SEX CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ADMINISTRATIVE SEX CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ADMINISTRATIVE SEX CODE with administrative sex reference data'\n      FROM valid_administrative_sex_code_in_all_rows;\nWITH valid_administrative_sex_code_description_in_all_rows AS (\n    SELECT 'ADMINISTRATIVE_SEX_CODE_DESCRIPTION' AS issue_column,\n           sr.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN administrative_sex_reference ref\n      ON UPPER(sr.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\") = UPPER(ref.ADMINISTRATIVE_SEX_CODE_DESCRIPTION)\n     WHERE sr.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" IS NOT NULL\n      AND ref.ADMINISTRATIVE_SEX_CODE_DESCRIPTION IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid ADMINISTRATIVE SEX CODE DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ADMINISTRATIVE SEX CODE DESCRIPTION \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ADMINISTRATIVE SEX CODE DESCRIPTION with administrative sex reference data'\n      FROM valid_administrative_sex_code_description_in_all_rows;\nWITH valid_administrative_sex_code_system_in_all_rows AS (\n    SELECT 'ADMINISTRATIVE_SEX_CODE_SYSTEM' AS issue_column,\n           sr.\"ADMINISTRATIVE_SEX_CODE_SYSTEM\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN administrative_sex_reference ref\n      ON UPPER(sr.\"ADMINISTRATIVE_SEX_CODE_SYSTEM\") = UPPER(ref.ADMINISTRATIVE_SEX_CODE_SYSTEM)\n     WHERE sr.\"ADMINISTRATIVE_SEX_CODE_SYSTEM\" IS NOT NULL\n      AND ref.ADMINISTRATIVE_SEX_CODE_SYSTEM IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid ADMINISTRATIVE SEX CODE SYSTEM',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ADMINISTRATIVE SEX CODE SYSTEM \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ADMINISTRATIVE SEX CODE SYSTEM with administrative sex reference data'\n      FROM valid_administrative_sex_code_system_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'ADMINISTRATIVE_SEX_CODE' AS issue_column,\n      tbl.\"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n      tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"ADMINISTRATIVE_SEX_CODE\" is not null\n  and tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" FROM administrative_sex_reference WHERE UPPER(CAST(tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)) = UPPER(CAST(\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The ADMINISTRATIVE_SEX_CODE \"' || invalid_value || '\" of ADMINISTRATIVE_SEX_CODE_DESCRIPTION \"' || dependent_value || '\" is not matching with the ADMINISTRATIVE_SEX_CODE of ADMINISTRATIVE_SEX_CODE_DESCRIPTION in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'ADMINISTRATIVE_SEX_CODE_DESCRIPTION' AS issue_column,\n      tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ADMINISTRATIVE_SEX_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" is not null\n  and tbl.\"ADMINISTRATIVE_SEX_CODE\" is not null\n  and NOT EXISTS ( SELECT \"ADMINISTRATIVE_SEX_CODE\" FROM administrative_sex_reference WHERE UPPER(CAST(tbl.\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)) = UPPER(CAST(\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The ADMINISTRATIVE_SEX_CODE_DESCRIPTION \"' || invalid_value || '\" of ADMINISTRATIVE_SEX_CODE \"' || dependent_value || '\" is not matching with the ADMINISTRATIVE_SEX_CODE_DESCRIPTION of ADMINISTRATIVE_SEX_CODE in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_sex_at_birth_code_in_all_rows AS (\n    SELECT 'SEX_AT_BIRTH_CODE' AS issue_column,\n           sr.\"SEX_AT_BIRTH_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sex_at_birth_reference ref\n      ON UPPER(sr.SEX_AT_BIRTH_CODE) = UPPER(ref.SEX_AT_BIRTH_CODE)\n     WHERE sr.SEX_AT_BIRTH_CODE IS NOT NULL\n      AND ref.SEX_AT_BIRTH_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid SEX AT BIRTH CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid SEX AT BIRTH CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate SEX AT BIRTH CODE with sex at birth reference data'\n      FROM valid_sex_at_birth_code_in_all_rows;\nWITH valid_sex_at_birth_code_description_in_all_rows AS (\n    SELECT 'SEX_AT_BIRTH_CODE_DESCRIPTION' AS issue_column,\n           sr.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sex_at_birth_reference ref\n      ON UPPER(sr.SEX_AT_BIRTH_CODE_DESCRIPTION) = UPPER(ref.SEX_AT_BIRTH_CODE_DESCRIPTION)\n     WHERE sr.SEX_AT_BIRTH_CODE_DESCRIPTION IS NOT NULL\n      AND ref.SEX_AT_BIRTH_CODE_DESCRIPTION IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid SEX_AT_BIRTH_CODE_DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid SEX_AT_BIRTH_CODE_DESCRIPTION \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate SEX_AT_BIRTH_CODE_DESCRIPTION with sex at birth reference data'\n      FROM valid_sex_at_birth_code_description_in_all_rows;\nWITH valid_sex_at_birth_code_system_in_all_rows AS (\n    SELECT 'SEX_AT_BIRTH_CODE_SYSTEM' AS issue_column,\n           sr.\"SEX_AT_BIRTH_CODE_SYSTEM\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sex_at_birth_reference ref\n      ON UPPER(sr.SEX_AT_BIRTH_CODE_SYSTEM) = UPPER(ref.SEX_AT_BIRTH_CODE_SYSTEM)\n     WHERE sr.SEX_AT_BIRTH_CODE_SYSTEM IS NOT NULL\n      AND ref.SEX_AT_BIRTH_CODE_SYSTEM IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid SEX AT BIRTH CODE SYSTEM',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid SEX AT BIRTH CODE SYSTEM \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate SEX AT BIRTH CODE SYSTEM with sex at birth reference data'\n      FROM valid_sex_at_birth_code_system_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'SEX_AT_BIRTH_CODE' AS issue_column,\n      tbl.\"SEX_AT_BIRTH_CODE\" AS invalid_value,\n      tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"SEX_AT_BIRTH_CODE\" is not null\n  and tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"SEX_AT_BIRTH_CODE_DESCRIPTION\" FROM sex_at_birth_reference WHERE UPPER(CAST(tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SEX_AT_BIRTH_CODE\" AS VARCHAR)) = UPPER(CAST(\"SEX_AT_BIRTH_CODE\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The SEX_AT_BIRTH_CODE \"' || invalid_value || '\" of SEX_AT_BIRTH_CODE_DESCRIPTION \"' || dependent_value || '\" is not matching with the SEX_AT_BIRTH_CODE of SEX_AT_BIRTH_CODE_DESCRIPTION in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'SEX_AT_BIRTH_CODE_DESCRIPTION' AS issue_column,\n      tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"SEX_AT_BIRTH_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" is not null\n  and tbl.\"SEX_AT_BIRTH_CODE\" is not null\n  and NOT EXISTS ( SELECT \"SEX_AT_BIRTH_CODE\" FROM sex_at_birth_reference WHERE UPPER(CAST(tbl.\"SEX_AT_BIRTH_CODE\" AS VARCHAR)) = UPPER(CAST(\"SEX_AT_BIRTH_CODE\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The SEX_AT_BIRTH_CODE_DESCRIPTION \"' || invalid_value || '\" of SEX_AT_BIRTH_CODE \"' || dependent_value || '\" is not matching with the SEX_AT_BIRTH_CODE_DESCRIPTION of SEX_AT_BIRTH_CODE in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'PAT_BIRTH_DATE' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"PAT_BIRTH_DATE\" IS NULL\n        OR TRIM(CAST(\"PAT_BIRTH_DATE\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_date_time_in_all_rows AS (\n    SELECT 'PAT_BIRTH_DATE' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"PAT_BIRTH_DATE\" IS NOT NULL\n       AND TRY_CAST(\"PAT_BIRTH_DATE\" AS TIMESTAMP) IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid Date',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid timestamp \"' || invalid_value || '\" found in ' || issue_column,\n           'Please be sure to provide both a valid date and time.'\n      FROM valid_date_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'CITY' AS issue_column,\n           \"CITY\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"CITY\" IS NULL\n        OR TRIM(CAST(\"CITY\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'STATE' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"STATE\" IS NULL\n        OR TRIM(CAST(\"STATE\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'STATE' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"STATE\" NOT IN ('NY', 'New York')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''NY'', ''New York'')',\n           'Use only allowed values ''NY'', ''New York'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'ZIP' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"ZIP\" IS NULL\n        OR TRIM(CAST(\"ZIP\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'ZIP' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"ZIP\" AS VARCHAR) NOT SIMILAR TO '^\\d{5}(\\d{4})?$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^\\d{5}(\\d{4})?$',\n           'Follow the pattern ^\\d{5}(\\d{4})?$ in ' || issue_column\n      FROM pattern;\nWITH valid_integer_alphanumeric_string_in_all_rows AS (\n  SELECT 'ADDRESS1' AS issue_column,\n    t.\"ADDRESS1\" AS invalid_value,\n    t.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307 t\n  WHERE t.\"ADDRESS1\" SIMILAR TO '[0-9]+'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Data Type Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'Invalid string of numbers found'\n      FROM valid_integer_alphanumeric_string_in_all_rows;\nWITH valid_address1_or_medicaid_cin_in_all_rows AS (\n    SELECT 'ADDRESS1' AS issue_column,\n           ADDRESS1 AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM admin_demographics_20240307\n      WHERE (ADDRESS1 IS NULL OR TRIM(\"ADDRESS1\") = '') AND (MEDICAID_CIN IS NULL OR TRIM(\"MEDICAID_CIN\") = '')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid ADDRESS1',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field \"' || issue_column || '\" is empty',\n           'The required field value ADDRESS1 is missing. This is required due to the absence of the MEDICAID_CIN.'\n      FROM valid_address1_or_medicaid_cin_in_all_rows;\nWITH valid_gender_identity_code_in_all_rows AS (\n    SELECT 'GENDER_IDENTITY_CODE' AS issue_column,\n           sr.\"GENDER_IDENTITY_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN gender_identity_reference ref\n      ON UPPER(sr.GENDER_IDENTITY_CODE) = UPPER(ref.GENDER_IDENTITY_CODE)\n     WHERE sr.GENDER_IDENTITY_CODE IS NOT NULL\n      AND ref.GENDER_IDENTITY_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid GENDER IDENTITY CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid GENDER IDENTITY CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate GENDER IDENTITY CODE with gender identity reference data'\n      FROM valid_gender_identity_code_in_all_rows;\nWITH allowed_values AS (\n    SELECT 'GENDER_IDENTITY_CODE_SYSTEM_NAME' AS issue_column,\n           \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" NOT IN ('SNOMED-CT','SNOMED','http://snomed.info/sct')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''SNOMED-CT'',''SNOMED'',''http://snomed.info/sct'')',\n           'Use only allowed values ''SNOMED-CT'',''SNOMED'',''http://snomed.info/sct'' in ' || issue_column\n      FROM allowed_values;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'GENDER_IDENTITY_CODE' AS issue_column,\n      tbl.\"GENDER_IDENTITY_CODE\" AS invalid_value,\n      tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"GENDER_IDENTITY_CODE\" is not null\n  and tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"GENDER_IDENTITY_CODE_DESCRIPTION\" FROM gender_identity_reference WHERE UPPER(CAST(tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS VARCHAR)) AND UPPER(CAST(tbl.\"GENDER_IDENTITY_CODE\" AS VARCHAR)) = UPPER(CAST(\"GENDER_IDENTITY_CODE\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The GENDER_IDENTITY_CODE \"' || invalid_value || '\" of GENDER_IDENTITY_CODE_DESCRIPTION \"' || dependent_value || '\" is not matching with the GENDER_IDENTITY_CODE of GENDER_IDENTITY_CODE_DESCRIPTION in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'GENDER_IDENTITY_CODE_DESCRIPTION' AS issue_column,\n      tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"GENDER_IDENTITY_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" is not null\n  and tbl.\"GENDER_IDENTITY_CODE\" is not null\n  and NOT EXISTS ( SELECT \"GENDER_IDENTITY_CODE\" FROM gender_identity_reference WHERE UPPER(CAST(tbl.\"GENDER_IDENTITY_CODE\" AS VARCHAR)) = UPPER(CAST(\"GENDER_IDENTITY_CODE\" AS VARCHAR)) AND UPPER(CAST(tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The GENDER_IDENTITY_CODE_DESCRIPTION \"' || invalid_value || '\" of GENDER_IDENTITY_CODE \"' || dependent_value || '\" is not matching with the GENDER_IDENTITY_CODE_DESCRIPTION of GENDER_IDENTITY_CODE in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_sexual_orientation_code_in_all_rows AS (\n    SELECT 'SEXUAL_ORIENTATION_CODE' AS issue_column,\n           sr.\"SEXUAL_ORIENTATION_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sexual_orientation_reference ref\n      ON UPPER(sr.SEXUAL_ORIENTATION_CODE) = UPPER(ref.SEXUAL_ORIENTATION_CODE)\n     WHERE sr.SEXUAL_ORIENTATION_CODE IS NOT NULL\n      AND ref.SEXUAL_ORIENTATION_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid SEXUAL ORIENTATION CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid SEXUAL ORIENTATION CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate SEXUAL ORIENTATION CODE with sexual orientation reference data'\n      FROM valid_sexual_orientation_code_in_all_rows;\nWITH valid_sexual_orientation_description_in_all_rows AS (\n    SELECT 'SEXUAL_ORIENTATION_DESCRIPTION' AS issue_column,\n           sr.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sexual_orientation_reference ref\n      ON UPPER(sr.SEXUAL_ORIENTATION_DESCRIPTION) = UPPER(ref.SEXUAL_ORIENTATION_CODE_DESCRIPTION)\n     WHERE sr.SEXUAL_ORIENTATION_DESCRIPTION IS NOT NULL\n      AND ref.SEXUAL_ORIENTATION_CODE_DESCRIPTION IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid SEXUAL ORIENTATION CODE DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid SEXUAL ORIENTATION CODE DESCRIPTION \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate SEXUAL ORIENTATION CODE DESCRIPTION with sexual orientation reference data'\n      FROM valid_sexual_orientation_description_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'SEXUAL_ORIENTATION_CODE' AS issue_column,\n      tbl.\"SEXUAL_ORIENTATION_CODE\" AS invalid_value,\n      tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"SEXUAL_ORIENTATION_CODE\" is not null\n  and tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"SEXUAL_ORIENTATION_CODE_DESCRIPTION\" FROM sexual_orientation_reference WHERE UPPER(CAST(tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"SEXUAL_ORIENTATION_CODE_DESCRIPTION\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SEXUAL_ORIENTATION_CODE\" AS VARCHAR)) = UPPER(CAST(\"SEXUAL_ORIENTATION_CODE\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The SEXUAL_ORIENTATION_CODE \"' || invalid_value || '\" of SEXUAL_ORIENTATION_DESCRIPTION \"' || dependent_value || '\" is not matching with the SEXUAL_ORIENTATION_CODE of SEXUAL_ORIENTATION_DESCRIPTION in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'SEXUAL_ORIENTATION_DESCRIPTION' AS issue_column,\n      tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS invalid_value,\n      tbl.\"SEXUAL_ORIENTATION_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" is not null\n  and tbl.\"SEXUAL_ORIENTATION_CODE\" is not null\n  and NOT EXISTS ( SELECT \"SEXUAL_ORIENTATION_CODE\" FROM sexual_orientation_reference WHERE UPPER(CAST(tbl.\"SEXUAL_ORIENTATION_CODE\" AS VARCHAR)) = UPPER(CAST(\"SEXUAL_ORIENTATION_CODE\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"SEXUAL_ORIENTATION_CODE_DESCRIPTION\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The SEXUAL_ORIENTATION_DESCRIPTION \"' || invalid_value || '\" of SEXUAL_ORIENTATION_CODE \"' || dependent_value || '\" is not matching with the SEXUAL_ORIENTATION_DESCRIPTION of SEXUAL_ORIENTATION_CODE in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH allowed_values AS (\n    SELECT 'SEXUAL_ORIENTATION_CODE_SYSTEM_NAME' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" NOT IN ('SNOMED-CT','SNOMED','http://snomed.info/sct')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''SNOMED-CT'',''SNOMED'',''http://snomed.info/sct'')',\n           'Use only allowed values ''SNOMED-CT'',''SNOMED'',''http://snomed.info/sct'' in ' || issue_column\n      FROM allowed_values;\nWITH valid_ethnicity_code_in_all_rows AS (\n    SELECT 'ETHNICITY_CODE' AS issue_column,\n           ad.\"ETHNICITY_CODE\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN ethnicity_reference ref\n      ON UPPER(CAST(ad.\"ETHNICITY_CODE\" AS VARCHAR)) = UPPER(CAST(ref.\"Concept Code\" AS VARCHAR))\n     WHERE ad.\"ETHNICITY_CODE\" IS NOT NULL\n      AND ref.\"Concept Code\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid ETHNICITY CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ETHNICITY CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ETHNICITY CODE with ethnicity reference data'\n      FROM valid_ethnicity_code_in_all_rows;\nWITH valid_ethnicity_code_description_in_all_rows AS (\n    SELECT 'ETHNICITY_CODE_DESCRIPTION' AS issue_column,\n           ad.\"ETHNICITY_CODE_DESCRIPTION\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN ethnicity_reference ref\n      ON UPPER(CAST(ad.\"ETHNICITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(ref.\"Concept Name\" AS VARCHAR))\n     WHERE ad.\"ETHNICITY_CODE_DESCRIPTION\" IS NOT NULL\n      AND ref.\"Concept Name\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid ETHNICITY CODE DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ETHNICITY CODE DESCRIPTION \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ETHNICITY CODE DESCRIPTION with ethnicity reference data'\n      FROM valid_ethnicity_code_description_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'ETHNICITY_CODE' AS issue_column,\n      tbl.\"ETHNICITY_CODE\" AS invalid_value,\n      tbl.\"ETHNICITY_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"ETHNICITY_CODE\" is not null\n  and tbl.\"ETHNICITY_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Concept Name\" FROM ethnicity_reference WHERE UPPER(CAST(tbl.\"ETHNICITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Concept Name\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ETHNICITY_CODE\" AS VARCHAR)) = UPPER(CAST(\"Concept Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The ETHNICITY_CODE \"' || invalid_value || '\" of ETHNICITY_CODE_DESCRIPTION \"' || dependent_value || '\" is not matching with the ETHNICITY_CODE of ETHNICITY_CODE_DESCRIPTION in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'ETHNICITY_CODE_DESCRIPTION' AS issue_column,\n      tbl.\"ETHNICITY_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ETHNICITY_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"ETHNICITY_CODE_DESCRIPTION\" is not null\n  and tbl.\"ETHNICITY_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Concept Code\" FROM ethnicity_reference WHERE UPPER(CAST(tbl.\"ETHNICITY_CODE\" AS VARCHAR)) = UPPER(CAST(\"Concept Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ETHNICITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Concept Name\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The ETHNICITY_CODE_DESCRIPTION \"' || invalid_value || '\" of ETHNICITY_CODE \"' || dependent_value || '\" is not matching with the ETHNICITY_CODE_DESCRIPTION of ETHNICITY_CODE in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_race_code_in_all_rows AS (\n    SELECT 'RACE_CODE' AS issue_column,\n           ad.\"RACE_CODE\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN race_reference ref\n      ON UPPER(CAST(ad.\"RACE_CODE\" AS VARCHAR)) = UPPER(CAST(ref.\"Concept Code\" AS VARCHAR))\n     WHERE ad.\"RACE_CODE\" IS NOT NULL\n      AND ref.\"Concept Code\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid RACE CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid RACE CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate RACE CODE with race reference data'\n      FROM valid_race_code_in_all_rows;\nWITH valid_race_code_description_in_all_rows AS (\n    SELECT 'RACE_CODE_DESCRIPTION' AS issue_column,\n           ad.\"RACE_CODE_DESCRIPTION\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN race_reference ref\n      ON UPPER(CAST(ad.\"RACE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(ref.\"Concept Name\" AS VARCHAR))\n     WHERE ad.\"RACE_CODE_DESCRIPTION\" IS NOT NULL\n      AND ref.\"Concept Name\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid RACE CODE DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid RACE CODE DESCRIPTION \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate RACE CODE DESCRIPTION with race reference data'\n      FROM valid_race_code_description_in_all_rows;\nWITH valid_preferred_language_code_in_all_rows AS (\n    SELECT 'PREFERRED_LANGUAGE_CODE' AS issue_column,\n           ad.\"PREFERRED_LANGUAGE_CODE\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN preferred_language_reference ref\n      ON UPPER(CAST(ad.\"PREFERRED_LANGUAGE_CODE\" AS VARCHAR)) = UPPER(CAST(ref.\"ISO 639-2 Code\" AS VARCHAR))\n     WHERE ad.\"PREFERRED_LANGUAGE_CODE\" IS NOT NULL\n      AND ref.\"ISO 639-2 Code\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid PREFERRED LANGUAGE CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid PREFERRED LANGUAGE CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate PREFERRED LANGUAGE CODE with preferred language reference data'\n      FROM valid_preferred_language_code_in_all_rows;\nWITH valid_preferred_language_code_description_in_all_rows AS (\n    SELECT 'PREFERRED_LANGUAGE_DESCRIPTION' AS issue_column,\n           ad.\"PREFERRED_LANGUAGE_DESCRIPTION\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN preferred_language_reference ref\n      ON UPPER(CAST(ad.\"PREFERRED_LANGUAGE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(ref.\"English name of Language\" AS VARCHAR))\n     WHERE ad.\"PREFERRED_LANGUAGE_DESCRIPTION\" IS NOT NULL\n      AND ref.\"English name of Language\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid PREFERRED LANGUAGE CODE DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid PREFERRED LANGUAGE CODE DESCRIPTION \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate PREFERRED LANGUAGE CODE DESCRIPTION with preferred language reference data'\n      FROM valid_preferred_language_code_description_in_all_rows;\nWITH allowed_values AS (\n    SELECT 'PREFERRED_LANGUAGE_CODE_SYSTEM_NAME' AS issue_column,\n           \"PREFERRED_LANGUAGE_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"PREFERRED_LANGUAGE_CODE_SYSTEM_NAME\" NOT IN ('ISO','ISO 639-2','http://hl7.org/fhir/us/core/ValueSet/simple-language')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''ISO'',''ISO 639-2'',''http://hl7.org/fhir/us/core/ValueSet/simple-language'')',\n           'Use only allowed values ''ISO'',''ISO 639-2'',''http://hl7.org/fhir/us/core/ValueSet/simple-language'' in ' || issue_column\n      FROM allowed_values;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'RACE_CODE' AS issue_column,\n      tbl.\"RACE_CODE\" AS invalid_value,\n      tbl.\"RACE_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"RACE_CODE\" is not null\n  and tbl.\"RACE_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Concept Name\" FROM race_reference WHERE UPPER(CAST(tbl.\"RACE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Concept Name\" AS VARCHAR)) AND UPPER(CAST(tbl.\"RACE_CODE\" AS VARCHAR)) = UPPER(CAST(\"Concept Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The RACE_CODE \"' || invalid_value || '\" of RACE_CODE_DESCRIPTION \"' || dependent_value || '\" is not matching with the RACE_CODE of RACE_CODE_DESCRIPTION in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'PREFERRED_LANGUAGE_CODE' AS issue_column,\n      tbl.\"PREFERRED_LANGUAGE_CODE\" AS invalid_value,\n      tbl.\"PREFERRED_LANGUAGE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"PREFERRED_LANGUAGE_CODE\" is not null\n  and tbl.\"PREFERRED_LANGUAGE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"English name of Language\" FROM preferred_language_reference WHERE UPPER(CAST(tbl.\"PREFERRED_LANGUAGE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"English name of Language\" AS VARCHAR)) AND UPPER(CAST(tbl.\"PREFERRED_LANGUAGE_CODE\" AS VARCHAR)) = UPPER(CAST(\"ISO 639-2 Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The PREFERRED_LANGUAGE_CODE \"' || invalid_value || '\" of PREFERRED_LANGUAGE_DESCRIPTION \"' || dependent_value || '\" is not matching with the PREFERRED_LANGUAGE_CODE of PREFERRED_LANGUAGE_DESCRIPTION in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'RACE_CODE_DESCRIPTION' AS issue_column,\n      tbl.\"RACE_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"RACE_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"RACE_CODE_DESCRIPTION\" is not null\n  and tbl.\"RACE_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Concept Code\" FROM race_reference WHERE UPPER(CAST(tbl.\"RACE_CODE\" AS VARCHAR)) = UPPER(CAST(\"Concept Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"RACE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Concept Name\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The RACE_CODE_DESCRIPTION \"' || invalid_value || '\" of RACE_CODE \"' || dependent_value || '\" is not matching with the RACE_CODE_DESCRIPTION of RACE_CODE in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH allowed_values AS (\n    SELECT 'RACE_CODE_SYSTEM_NAME' AS issue_column,\n           \"RACE_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"RACE_CODE_SYSTEM_NAME\" NOT IN ('CDC','CDCRE','urn:oid:2.16.840.1.113883.6.238')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''CDC'',''CDCRE'',''urn:oid:2.16.840.1.113883.6.238'')',\n           'Use only allowed values ''CDC'',''CDCRE'',''urn:oid:2.16.840.1.113883.6.238'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'ETHNICITY_CODE_SYSTEM_NAME' AS issue_column,\n           \"ETHNICITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"ETHNICITY_CODE_SYSTEM_NAME\" NOT IN ('CDC','CDCRE','urn:oid:2.16.840.1.113883.6.238')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''CDC'',''CDCRE'',''urn:oid:2.16.840.1.113883.6.238'')',\n           'Use only allowed values ''CDC'',''CDCRE'',''urn:oid:2.16.840.1.113883.6.238'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'MPI_ID' AS issue_column,\n           \"MPI_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"MPI_ID\" IS NULL\n        OR TRIM(CAST(\"MPI_ID\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'PAT_MRN_ID' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(CAST(\"PAT_MRN_ID\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_mpi_id_per_pat_mrn_id_in_all_rows AS (\n    SELECT 'MPI_ID' AS issue_column,\n      MPI_ID AS invalid_value,\n      min(src_file_row_number) AS issue_row\n    FROM admin_demographics_20240307\n    GROUP BY MPI_ID\n    HAVING COUNT(DISTINCT PAT_MRN_ID) > 1\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid MPI_ID',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'The unique field \"' || issue_column || '\" \"' || invalid_value || '\"is not unique per PAT MRN ID',\n           'MPI_ID is not unique per PAT MRN ID.'\n      FROM valid_mpi_id_per_pat_mrn_id_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'FACILITY_ID' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ID\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'MEDICAID_CIN' AS issue_column,\n           \"MEDICAID_CIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"MEDICAID_CIN\" AS VARCHAR) NOT SIMILAR TO '^[A-Za-z]{2}\\d{5}[A-Za-z]$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$',\n           'Follow the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$ in ' || issue_column\n      FROM pattern;\nWITH valid_unique_medicaid_cin_per_mrn_in_all_rows AS (\n  SELECT 'MEDICAID_CIN' AS issue_column,\n          \"MEDICAID_CIN\" AS invalid_value,\n          min(src_file_row_number) AS issue_row\n    FROM admin_demographics_20240307\n    WHERE MEDICAID_CIN IS NOT NULL\n    GROUP BY pat_mrn_id, MEDICAID_CIN\n    HAVING COUNT(*) > 1\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid Unique Medicaid Cin Per Mrn',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid Unique Medicaid Cin Per Mrn \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate Unique Medicaid Cin Per Mrn'\n      FROM valid_unique_medicaid_cin_per_mrn_in_all_rows;\nWITH valid_address1_or_medicaid_cin_in_all_rows AS (\n    SELECT 'MEDICAID_CIN' AS issue_column,\n           MEDICAID_CIN AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM admin_demographics_20240307\n      WHERE (MEDICAID_CIN IS NULL OR TRIM(\"MEDICAID_CIN\") = '') AND (ADDRESS1 IS NULL OR TRIM(\"ADDRESS1\") = '')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid MEDICAID_CIN',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field \"' || issue_column || '\" is empty',\n           'The required field value MEDICAID_CIN is missing. This is required due to the absence of the ADDRESS1.'\n      FROM valid_address1_or_medicaid_cin_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'CONSENT' AS issue_column,\n           \"CONSENT\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"CONSENT\" IS NULL\n        OR TRIM(CAST(\"CONSENT\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'CONSENT' AS issue_column,\n           \"CONSENT\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"CONSENT\" NOT IN ('Yes', 'YES', 'yes', 'Y', 'y', 'No', 'NO', 'no','N', 'n','Unknown', 'UNKNOWN', 'unknown','UNK', 'Unk', 'unk')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'', ''YES'', ''yes'', ''Y'', ''y'', ''No'', ''NO'', ''no'',''N'', ''n'',''Unknown'', ''UNKNOWN'', ''unknown'',''UNK'', ''Unk'', ''unk'')',\n           'Use only allowed values ''Yes'', ''YES'', ''yes'', ''Y'', ''y'', ''No'', ''NO'', ''no'',''N'', ''n'',''Unknown'', ''UNKNOWN'', ''unknown'',''UNK'', ''Unk'', ''unk'' in ' || issue_column\n      FROM allowed_values;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('87f8bee3-8c83-518e-865a-740b0e3a45d3', '52c6a395-5d83-4051-bb7c-39036f26ab29', '963ed7bf-d356-54ae-ba2a-739f7f164e1a', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'AdminDemographicCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('f6f5cc47-43d2-5134-b3d4-e6d954f3e391', '52c6a395-5d83-4051-bb7c-39036f26ab29', '767cb8df-3ec0-5b59-998e-a91e75be32b3', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'QeAdminDataCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT 'PAT_MRN_ID' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(CAST(\"PAT_MRN_ID\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'FACILITY_ID' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ID\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_unique_facility_id_per_facility_in_all_rows AS (\n  SELECT 'FACILITY_ID' AS issue_column,\n    FACILITY_ID AS invalid_value,\n    min(src_file_row_number) AS issue_row\n  FROM qe_admin_data_20240307\n  GROUP BY FACILITY_ID\n  HAVING COUNT(DISTINCT FACILITY_LONG_NAME) > 1\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Invalid FACILITY_ID',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'The unique field \"' || issue_column || '\" \"' || invalid_value || '\"is not unique per facility',\n           'FACILITY_ID is not unique per facility.'\n      FROM valid_unique_facility_id_per_facility_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'FACILITY_LONG_NAME' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_LONG_NAME\" IS NULL\n        OR TRIM(CAST(\"FACILITY_LONG_NAME\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'ORGANIZATION_TYPE' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"ORGANIZATION_TYPE\" IS NULL\n        OR TRIM(CAST(\"ORGANIZATION_TYPE\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'ORGANIZATION_TYPE' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"ORGANIZATION_TYPE\" NOT IN ('Hospital', 'DTC', 'SNF', 'SCN', 'CBO', 'OMH', 'OASAS', 'Practice', 'Article 36', 'Article 40', 'MCO')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Hospital'', ''DTC'', ''SNF'', ''SCN'', ''CBO'', ''OMH'', ''OASAS'', ''Practice'', ''Article 36'', ''Article 40'', ''MCO'')',\n           'Use only allowed values ''Hospital'', ''DTC'', ''SNF'', ''SCN'', ''CBO'', ''OMH'', ''OASAS'', ''Practice'', ''Article 36'', ''Article 40'', ''MCO'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'FACILITY_ADDRESS1' AS issue_column,\n           \"FACILITY_ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_ADDRESS1\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ADDRESS1\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_unique_facility_address1_per_facility_in_all_rows AS (\n  SELECT 'FACILITY_ADDRESS1' AS issue_column,\n    FACILITY_ADDRESS1 AS invalid_value,\n    min(src_file_row_number) AS issue_row\n  FROM qe_admin_data_20240307\n  GROUP BY FACILITY_ADDRESS1\n  HAVING COUNT(DISTINCT FACILITY_LONG_NAME) > 1\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Invalid FACILITY_ADDRESS1',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'The unique field \"' || issue_column || '\" \"' || invalid_value || '\"is not unique per facility',\n           'FACILITY_ADDRESS1 is not unique per facility.'\n      FROM valid_unique_facility_address1_per_facility_in_all_rows;\nWITH valid_integer_alphanumeric_string_in_all_rows AS (\n  SELECT 'FACILITY_ADDRESS1' AS issue_column,\n    t.\"FACILITY_ADDRESS1\" AS invalid_value,\n    t.src_file_row_number AS issue_row\n  FROM qe_admin_data_20240307 t\n  WHERE t.\"FACILITY_ADDRESS1\" SIMILAR TO '[0-9]+'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Data Type Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'Invalid string of numbers found'\n      FROM valid_integer_alphanumeric_string_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'FACILITY_STATE' AS issue_column,\n           \"FACILITY_STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_STATE\" IS NULL\n        OR TRIM(CAST(\"FACILITY_STATE\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'FACILITY_STATE' AS issue_column,\n           \"FACILITY_STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_STATE\" NOT IN ('NY', 'New York')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''NY'', ''New York'')',\n           'Use only allowed values ''NY'', ''New York'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'FACILITY_ZIP' AS issue_column,\n           \"FACILITY_ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_ZIP\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ZIP\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'FACILITY_ZIP' AS issue_column,\n           \"FACILITY_ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE CAST(\"FACILITY_ZIP\" AS VARCHAR) NOT SIMILAR TO '^\\d{5}(\\d{4})?$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^\\d{5}(\\d{4})?$',\n           'Follow the pattern ^\\d{5}(\\d{4})?$ in ' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT 'VISIT_PART_2_FLAG' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_PART_2_FLAG\" IS NULL\n        OR TRIM(CAST(\"VISIT_PART_2_FLAG\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_PART_2_FLAG' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_PART_2_FLAG\" NOT IN ('Yes', 'No')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'', ''No'')',\n           'Use only allowed values ''Yes'', ''No'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'VISIT_OMH_FLAG' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_OMH_FLAG\" IS NULL\n        OR TRIM(CAST(\"VISIT_OMH_FLAG\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_OMH_FLAG' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_OMH_FLAG\" NOT IN ('Yes', 'No')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'', ''No'')',\n           'Use only allowed values ''Yes'', ''No'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'VISIT_OPWDD_FLAG' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_OPWDD_FLAG\" IS NULL\n        OR TRIM(CAST(\"VISIT_OPWDD_FLAG\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_OPWDD_FLAG' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_OPWDD_FLAG\" NOT IN ('Yes', 'No')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'', ''No'')',\n           'Use only allowed values ''Yes'', ''No'' in ' || issue_column\n      FROM allowed_values;\nWITH pattern AS (\n    SELECT 'FACILITY_LONG_NAME' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE CAST(\"FACILITY_LONG_NAME\" AS VARCHAR) NOT SIMILAR TO '^[a-zA-Z\\s]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[a-zA-Z\\s]+$',\n           'Follow the pattern ^[a-zA-Z\\s]+$ in ' || issue_column\n      FROM pattern;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7115f76c-32eb-563c-a1d5-040d0146651a', '52c6a395-5d83-4051-bb7c-39036f26ab29', '767cb8df-3ec0-5b59-998e-a91e75be32b3', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'QeAdminDataCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('26a2e6f5-6b62-5616-8b14-1059006f438b', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'd09ebe08-1b63-56d8-8f2b-8fff76c9828f', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'ScreeningCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n\nWITH mandatory_value AS (\n    SELECT 'PAT_MRN_ID' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(CAST(\"PAT_MRN_ID\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'FACILITY_ID' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ID\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_pat_mrn_id_across_all_three_tables AS (\n  WITH cte_qe_demographic_unmatched AS (\n      SELECT DISTINCT COALESCE(ad.PAT_MRN_ID, qe.PAT_MRN_ID) AS PAT_MRN_ID,\n              COALESCE(ad.FACILITY_ID, qe.FACILITY_ID) AS FACILITY_ID,\n                    CASE\n                        WHEN ad.PAT_MRN_ID IS NULL THEN 'QE_ADMIN_DATA'\n                        ELSE 'ADMIN_DEMOGRAPHIC'\n                    END AS unmatched_source,\n                    COALESCE(ad.src_file_row_number, qe.src_file_row_number) AS src_file_row_number,\n      FROM  admin_demographics_20240307 ad\n      FULL OUTER JOIN qe_admin_data_20240307 qe\n          ON ad.PAT_MRN_ID = qe.PAT_MRN_ID\n          AND ad.FACILITY_ID = qe.FACILITY_ID\n      WHERE ad.PAT_MRN_ID IS NULL OR qe.PAT_MRN_ID IS NULL\n  )\n  Select 'PAT_MRN_ID' AS issue_column, pat_mrn_id AS invalid_pat_value, FACILITY_ID AS invalid_facility_value, unmatched_source, src_file_row_number  AS issue_row,\n  case when unmatched_source = 'ADMIN_DEMOGRAPHIC' then 'admin_demographics_20240307'\n  when unmatched_source = 'QE_ADMIN_DATA' then 'qe_admin_data_20240307'\n  Else '' End As issue_table_name\n  from cte_qe_demographic_unmatched\n  UNION\n  Select DISTINCT 'PAT_MRN_ID' AS issue_column, s.PAT_MRN_ID AS invalid_pat_value,s.FACILITY_ID AS invalid_facility_value,'SCREENING' As unmatched_source, src_file_row_number  AS issue_row,\n  'screening_20240307' as issue_table_name\n  FROM screening_20240307 s\n    Left Outer Join (\n      SELECT  DISTINCT a.PAT_MRN_ID,a.FACILITY_ID From admin_demographics_20240307 a\n      Inner Join qe_admin_data_20240307 q\n      ON a.PAT_MRN_ID = q.PAT_MRN_ID\n      AND a.FACILITY_ID = q.FACILITY_ID\n      WHERE a.PAT_MRN_ID IS NOT NULL AND q.PAT_MRN_ID IS NOT NULL\n    ) aq\n    ON s.PAT_MRN_ID = aq.PAT_MRN_ID\n  AND aq.FACILITY_ID = s.FACILITY_ID\n  Where aq.PAT_MRN_ID IS  NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'PAT_MRN_ID that does not match the FACILITY_ID',\n           issue_row,\n           issue_column,\n           invalid_pat_value,\n           'PAT_MRN_ID (\"' || invalid_pat_value || '\") that does not match the FACILITY_ID (\"' || invalid_facility_value || '\") across the files was found in \"' || issue_table_name || '\".',\n           'Validate PAT_MRN_ID that maches the FACILITY_ID across the files'\n      FROM valid_pat_mrn_id_across_all_three_tables;\nWITH mandatory_value AS (\n    SELECT 'ENCOUNTER_CLASS_CODE' AS issue_column,\n           \"ENCOUNTER_CLASS_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_CLASS_CODE\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_CLASS_CODE\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_encounter_class_in_all_rows AS (\n    SELECT 'ENCOUNTER_CLASS_CODE' AS issue_column,\n           sr.\"ENCOUNTER_CLASS_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_class_reference ecr\n      ON UPPER(sr.ENCOUNTER_CLASS_CODE) = UPPER(ecr.Code)\n     WHERE sr.ENCOUNTER_CLASS_CODE IS NOT NULL\n      AND ecr.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid ENCOUNTER CLASS CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ENCOUNTER CLASS CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ENCOUNTER CLASS CODE with encounter class reference data'\n      FROM valid_encounter_class_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'ENCOUNTER_CLASS_CODE' AS issue_column,\n      tbl.\"ENCOUNTER_CLASS_CODE\" AS invalid_value,\n      tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_CLASS_CODE\" is not null\n  and tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Display\" FROM encounter_class_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_CLASS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The ENCOUNTER_CLASS_CODE \"' || invalid_value || '\" of ENCOUNTER_CLASS_CODE_DESCRIPTION \"' || dependent_value || '\" is not matching with the ENCOUNTER_CLASS_CODE of ENCOUNTER_CLASS_CODE_DESCRIPTION in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'ENCOUNTER_CLASS_CODE_DESCRIPTION' AS issue_column,\n      tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ENCOUNTER_CLASS_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" is not null\n  and tbl.\"ENCOUNTER_CLASS_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Code\" FROM encounter_class_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_CLASS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The ENCOUNTER_CLASS_CODE_DESCRIPTION \"' || invalid_value || '\" of ENCOUNTER_CLASS_CODE \"' || dependent_value || '\" is not matching with the ENCOUNTER_CLASS_CODE_DESCRIPTION of ENCOUNTER_CLASS_CODE in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'ENCOUNTER_CLASS_CODE_SYSTEM' AS issue_column,\n           \"ENCOUNTER_CLASS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_CLASS_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_CLASS_CODE_SYSTEM\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'ENCOUNTER_CLASS_CODE_SYSTEM' AS issue_column,\n           \"ENCOUNTER_CLASS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_CLASS_CODE_SYSTEM\" NOT IN ('http://terminology.hl7.org/CodeSystem/v3-ActCode')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''http://terminology.hl7.org/CodeSystem/v3-ActCode'')',\n           'Use only allowed values ''http://terminology.hl7.org/CodeSystem/v3-ActCode'' in ' || issue_column\n      FROM allowed_values;\nWITH valid_encounter_class_in_all_rows AS (\n    SELECT 'ENCOUNTER_CLASS_CODE_DESCRIPTION' AS issue_column,\n           sr.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_class_reference ecr\n      ON UPPER(sr.ENCOUNTER_CLASS_CODE_DESCRIPTION) = UPPER(ecr.Display)\n     WHERE sr.ENCOUNTER_CLASS_CODE_DESCRIPTION IS NOT NULL\n      AND ecr.Display IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid ENCOUNTER CLASS CODE DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ENCOUNTER CLASS CODE DESCRIPTION \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ENCOUNTER CLASS CODE DESCRIPTION with encounter class reference data'\n      FROM valid_encounter_class_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'ENCOUNTER_STATUS_CODE' AS issue_column,\n           \"ENCOUNTER_STATUS_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_STATUS_CODE\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_STATUS_CODE\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_encounter_status_code_in_all_rows AS (\n    SELECT 'ENCOUNTER_STATUS_CODE' AS issue_column,\n           sr.\"ENCOUNTER_STATUS_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_status_code_reference ecr\n      ON UPPER(sr.ENCOUNTER_STATUS_CODE) = UPPER(ecr.Code)\n     WHERE sr.ENCOUNTER_STATUS_CODE IS NOT NULL\n      AND ecr.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid ENCOUNTER STATUS CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ENCOUNTER STATUS CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ENCOUNTER STATUS CODE with encounter status reference data'\n      FROM valid_encounter_status_code_in_all_rows;\nWITH valid_encounter_status_code_in_all_rows AS (\n    SELECT 'ENCOUNTER_STATUS_CODE_DESCRIPTION' AS issue_column,\n           sr.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_status_code_reference ecr\n      ON UPPER(sr.ENCOUNTER_STATUS_CODE_DESCRIPTION) = UPPER(ecr.Display)\n     WHERE sr.ENCOUNTER_STATUS_CODE_DESCRIPTION IS NOT NULL\n      AND ecr.Display IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid ENCOUNTER STATUS CODE DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ENCOUNTER STATUS CODE DESCRIPTION \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ENCOUNTER STATUS CODE DESCRIPTION with encounter status reference data'\n      FROM valid_encounter_status_code_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'ENCOUNTER_STATUS_CODE' AS issue_column,\n      tbl.\"ENCOUNTER_STATUS_CODE\" AS invalid_value,\n      tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_STATUS_CODE\" is not null\n  and tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Display\" FROM encounter_status_code_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_STATUS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The ENCOUNTER_STATUS_CODE \"' || invalid_value || '\" of ENCOUNTER_STATUS_CODE_DESCRIPTION \"' || dependent_value || '\" is not matching with the ENCOUNTER_STATUS_CODE of ENCOUNTER_STATUS_CODE_DESCRIPTION in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'ENCOUNTER_STATUS_CODE_DESCRIPTION' AS issue_column,\n      tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ENCOUNTER_STATUS_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" is not null\n  and tbl.\"ENCOUNTER_STATUS_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Code\" FROM encounter_status_code_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_STATUS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The ENCOUNTER_STATUS_CODE_DESCRIPTION \"' || invalid_value || '\" of ENCOUNTER_STATUS_CODE \"' || dependent_value || '\" is not matching with the ENCOUNTER_STATUS_CODE_DESCRIPTION of ENCOUNTER_STATUS_CODE in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'ENCOUNTER_STATUS_CODE_SYSTEM' AS issue_column,\n           \"ENCOUNTER_STATUS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_STATUS_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_STATUS_CODE_SYSTEM\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'ENCOUNTER_STATUS_CODE_SYSTEM' AS issue_column,\n           \"ENCOUNTER_STATUS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_STATUS_CODE_SYSTEM\" NOT IN ('http://hl7.org/fhir/encounter-status')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''http://hl7.org/fhir/encounter-status'')',\n           'Use only allowed values ''http://hl7.org/fhir/encounter-status'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'ENCOUNTER_TYPE_CODE' AS issue_column,\n           \"ENCOUNTER_TYPE_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_TYPE_CODE\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_TYPE_CODE\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'ENCOUNTER_TYPE_CODE_SYSTEM' AS issue_column,\n           \"ENCOUNTER_TYPE_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_TYPE_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_TYPE_CODE_SYSTEM\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_encounter_type_code_in_all_rows AS (\n    SELECT 'ENCOUNTER_TYPE_CODE' AS issue_column,\n           sr.\"ENCOUNTER_TYPE_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_type_code_reference ecr\n      ON UPPER(CAST(sr.ENCOUNTER_TYPE_CODE AS VARCHAR)) = UPPER(CAST(ecr.Code AS VARCHAR))\n     WHERE sr.ENCOUNTER_TYPE_CODE IS NOT NULL\n      AND ecr.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid ENCOUNTER TYPE CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ENCOUNTER TYPE CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ENCOUNTER TYPE CODE with encounter type reference data'\n      FROM valid_encounter_type_code_in_all_rows;\nWITH allowed_values AS (\n    SELECT 'ENCOUNTER_TYPE_CODE_SYSTEM' AS issue_column,\n           \"ENCOUNTER_TYPE_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_TYPE_CODE_SYSTEM\" NOT IN ('SNOMED-CT', 'SNOMED', 'http://snomed.info/sct')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''SNOMED-CT'', ''SNOMED'', ''http://snomed.info/sct'')',\n           'Use only allowed values ''SNOMED-CT'', ''SNOMED'', ''http://snomed.info/sct'' in ' || issue_column\n      FROM allowed_values;\nWITH valid_encounter_type_code_in_all_rows AS (\n    SELECT 'ENCOUNTER_TYPE_CODE_DESCRIPTION' AS issue_column,\n           sr.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_type_code_reference ecr\n      ON UPPER(CAST(sr.ENCOUNTER_TYPE_CODE_DESCRIPTION AS VARCHAR)) = UPPER(CAST(ecr.Display AS VARCHAR))\n     WHERE sr.ENCOUNTER_TYPE_CODE_DESCRIPTION IS NOT NULL\n      AND ecr.Display IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid ENCOUNTER TYPE CODE DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ENCOUNTER TYPE CODE DESCRIPTION \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ENCOUNTER TYPE CODE DESCRIPTION with encounter type reference data'\n      FROM valid_encounter_type_code_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'ENCOUNTER_TYPE_CODE' AS issue_column,\n      tbl.\"ENCOUNTER_TYPE_CODE\" AS invalid_value,\n      tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_TYPE_CODE\" is not null\n  and tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Display\" FROM encounter_type_code_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_TYPE_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The ENCOUNTER_TYPE_CODE \"' || invalid_value || '\" of ENCOUNTER_TYPE_CODE_DESCRIPTION \"' || dependent_value || '\" is not matching with the ENCOUNTER_TYPE_CODE of ENCOUNTER_TYPE_CODE_DESCRIPTION in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'ENCOUNTER_TYPE_CODE_DESCRIPTION' AS issue_column,\n      tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ENCOUNTER_TYPE_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" is not null\n  and tbl.\"ENCOUNTER_TYPE_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Code\" FROM encounter_type_code_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_TYPE_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The ENCOUNTER_TYPE_CODE_DESCRIPTION \"' || invalid_value || '\" of ENCOUNTER_TYPE_CODE \"' || dependent_value || '\" is not matching with the ENCOUNTER_TYPE_CODE_DESCRIPTION of ENCOUNTER_TYPE_CODE in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'SCREENING_STATUS_CODE' AS issue_column,\n           \"SCREENING_STATUS_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_STATUS_CODE\" IS NULL\n        OR TRIM(CAST(\"SCREENING_STATUS_CODE\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_screening_status_code_in_all_rows AS (\n    SELECT 'SCREENING_STATUS_CODE' AS issue_column,\n           sr.\"SCREENING_STATUS_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN screening_status_code_reference ref\n      ON UPPER(sr.SCREENING_STATUS_CODE) = UPPER(ref.Code)\n     WHERE sr.SCREENING_STATUS_CODE IS NOT NULL\n      AND ref.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid SCREENING STATUS CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid SCREENING STATUS CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate SCREENING STATUS CODE with screening status code reference data'\n      FROM valid_screening_status_code_in_all_rows;\nWITH valid_screening_status_code_in_all_rows AS (\n    SELECT 'SCREENING_STATUS_CODE_DESCRIPTION' AS issue_column,\n           sr.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN screening_status_code_reference ecr\n      ON UPPER(sr.SCREENING_STATUS_CODE_DESCRIPTION) = UPPER(ecr.Display)\n     WHERE sr.SCREENING_STATUS_CODE_DESCRIPTION IS NOT NULL\n      AND ecr.Display IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid SCREENING STATUS CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid SCREENING STATUS CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate SCREENING STATUS CODE with screening status code reference data'\n      FROM valid_screening_status_code_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'SCREENING_STATUS_CODE' AS issue_column,\n      tbl.\"SCREENING_STATUS_CODE\" AS invalid_value,\n      tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"SCREENING_STATUS_CODE\" is not null\n  and tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Display\" FROM screening_status_code_reference WHERE UPPER(CAST(tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SCREENING_STATUS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The SCREENING_STATUS_CODE \"' || invalid_value || '\" of SCREENING_STATUS_CODE_DESCRIPTION \"' || dependent_value || '\" is not matching with the SCREENING_STATUS_CODE of SCREENING_STATUS_CODE_DESCRIPTION in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'SCREENING_STATUS_CODE_DESCRIPTION' AS issue_column,\n      tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"SCREENING_STATUS_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" is not null\n  and tbl.\"SCREENING_STATUS_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Code\" FROM screening_status_code_reference WHERE UPPER(CAST(tbl.\"SCREENING_STATUS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The SCREENING_STATUS_CODE_DESCRIPTION \"' || invalid_value || '\" of SCREENING_STATUS_CODE \"' || dependent_value || '\" is not matching with the SCREENING_STATUS_CODE_DESCRIPTION of SCREENING_STATUS_CODE in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'SCREENING_STATUS_CODE_SYSTEM' AS issue_column,\n           \"SCREENING_STATUS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_STATUS_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"SCREENING_STATUS_CODE_SYSTEM\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'SCREENING_STATUS_CODE_SYSTEM' AS issue_column,\n           \"SCREENING_STATUS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_STATUS_CODE_SYSTEM\" NOT IN ('http://hl7.org/fhir/observation-status')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''http://hl7.org/fhir/observation-status'')',\n           'Use only allowed values ''http://hl7.org/fhir/observation-status'' in ' || issue_column\n      FROM allowed_values;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  'ANSWER_CODE' AS issue_column,\n              \"ANSWER_CODE\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (ANSWER_CODE IS NULL OR TRIM(\"ANSWER_CODE\") = '')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN ('TOTAL SAFETY SCORE',\n            'CALCULATED WEEKLY PHYSICAL ACTIVITY',\n            'CALCULATED MENTAL HEALTH SCORE')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid value in ANSWER_CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field \"' || issue_column || '\" is empty',\n           'The required field value ANSWER_CODE is missing'\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  'ANSWER_CODE_SYSTEM_NAME' AS issue_column,\n              \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (ANSWER_CODE_SYSTEM_NAME IS NULL OR TRIM(\"ANSWER_CODE_SYSTEM_NAME\") = '')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN ('TOTAL SAFETY SCORE',\n            'CALCULATED WEEKLY PHYSICAL ACTIVITY',\n            'CALCULATED MENTAL HEALTH SCORE')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid value in ANSWER_CODE_SYSTEM_NAME',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field \"' || issue_column || '\" is empty',\n           'The required field value ANSWER_CODE_SYSTEM_NAME is missing'\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  'QUESTION_CODE' AS issue_column,\n              \"QUESTION_CODE\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (QUESTION_CODE IS NULL OR TRIM(\"QUESTION_CODE\") = '')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN ('TOTAL SAFETY SCORE',\n            'CALCULATED WEEKLY PHYSICAL ACTIVITY',\n            'CALCULATED MENTAL HEALTH SCORE')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid value in QUESTION_CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field \"' || issue_column || '\" is empty',\n           'The required field value QUESTION_CODE is missing'\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  'QUESTION_CODE_SYSTEM_NAME' AS issue_column,\n              \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (QUESTION_CODE_SYSTEM_NAME IS NULL OR TRIM(\"QUESTION_CODE_SYSTEM_NAME\") = '')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN ('TOTAL SAFETY SCORE',\n            'CALCULATED WEEKLY PHYSICAL ACTIVITY',\n            'CALCULATED MENTAL HEALTH SCORE')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid value in QUESTION_CODE_SYSTEM_NAME',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field \"' || issue_column || '\" is empty',\n           'The required field value QUESTION_CODE_SYSTEM_NAME is missing'\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  'SCREENING_CODE_DESCRIPTION' AS issue_column,\n              \"SCREENING_CODE_DESCRIPTION\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (SCREENING_CODE_DESCRIPTION IS NULL OR TRIM(\"SCREENING_CODE_DESCRIPTION\") = '')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN ('TOTAL SAFETY SCORE',\n            'CALCULATED WEEKLY PHYSICAL ACTIVITY',\n            'CALCULATED MENTAL HEALTH SCORE')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid value in SCREENING_CODE_DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field \"' || issue_column || '\" is empty',\n           'The required field value SCREENING_CODE_DESCRIPTION is missing'\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH allowed_values AS (\n    SELECT 'SCREENING_CODE_DESCRIPTION' AS issue_column,\n           \"SCREENING_CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_CODE_DESCRIPTION\" NOT IN ('Accountable health communities (AHC) health-related social needs (HRSN) supplemental questions','Accountable health communities (AHC) health-related social needs screening (HRSN) tool')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Accountable health communities (AHC) health-related social needs (HRSN) supplemental questions'',''Accountable health communities (AHC) health-related social needs screening (HRSN) tool'')',\n           'Use only allowed values ''Accountable health communities (AHC) health-related social needs (HRSN) supplemental questions'',''Accountable health communities (AHC) health-related social needs screening (HRSN) tool'' in ' || issue_column\n      FROM allowed_values;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  'SCREENING_CODE_SYSTEM_NAME' AS issue_column,\n              \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (SCREENING_CODE_SYSTEM_NAME IS NULL OR TRIM(\"SCREENING_CODE_SYSTEM_NAME\") = '')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN ('TOTAL SAFETY SCORE',\n            'CALCULATED WEEKLY PHYSICAL ACTIVITY',\n            'CALCULATED MENTAL HEALTH SCORE')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid value in SCREENING_CODE_SYSTEM_NAME',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field \"' || issue_column || '\" is empty',\n           'The required field value SCREENING_CODE_SYSTEM_NAME is missing'\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  'SCREENING_CODE' AS issue_column,\n              \"SCREENING_CODE\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (SCREENING_CODE IS NULL OR TRIM(\"SCREENING_CODE\") = '')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN ('TOTAL SAFETY SCORE',\n            'CALCULATED WEEKLY PHYSICAL ACTIVITY',\n            'CALCULATED MENTAL HEALTH SCORE')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid value in SCREENING_CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field \"' || issue_column || '\" is empty',\n           'The required field value SCREENING_CODE is missing'\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'QUESTION_CODE_DESCRIPTION' AS issue_column,\n           \"QUESTION_CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"QUESTION_CODE_DESCRIPTION\" IS NULL\n        OR TRIM(CAST(\"QUESTION_CODE_DESCRIPTION\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_answer_code_in_all_rows AS (\n  SELECT 'ANSWER_CODE' AS issue_column,\n    scr.\"ANSWER_CODE\" AS invalid_value,\n    scr.\"QUESTION_CODE\" AS invalid_question_value,\n    scr.SCREENING_CODE AS invalid_screening_value,\n    scr.src_file_row_number AS issue_row\n    FROM screening_20240307 scr\n    LEFT OUTER JOIN ahc_cross_walk crw\n      ON UPPER(scr.SCREENING_CODE) = UPPER(crw.SCREENING_CODE)\n      AND UPPER(scr.QUESTION_CODE) = UPPER(crw.QUESTION_CODE)\n      AND UPPER(scr.ANSWER_CODE) = UPPER(crw.ANSWER_CODE)\n    WHERE scr.SCREENING_CODE IS NOT NULL\n      AND scr.QUESTION_CODE IS NOT NULL\n      AND scr.ANSWER_CODE IS NOT NULL\n      AND crw.ANSWER_CODE IS NULL\n)\n\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Answer Code',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Provided Screening Code \"' || invalid_screening_value || '\", Question Code \"' || invalid_question_value || '\" and Answer Code \"' || invalid_value || '\" are not matching with the reference data found in ' || issue_column,\n           'Validate Screening Code, Question Code and Answer Code with ahc cross walk reference data'\n      FROM valid_answer_code_in_all_rows;\nWITH valid_total_safety_score_in_all_rows AS (\n  WITH cte_score AS (\n    SELECT\n        SUM(crw.Score) AS cross_walk_Score,\n        SUM(\n            CASE\n                WHEN UPPER(TRIM(scr.QUESTION_CODE_DESCRIPTION)) LIKE '%TOTAL SAFETY SCORE%' AND TRY_CAST(scr.ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL THEN CAST(scr.ANSWER_CODE_DESCRIPTION AS INTEGER)\n                ELSE 0\n            END\n        ) AS screening_score\n    FROM\n        screening_20240307 scr\n    LEFT OUTER JOIN (\n        SELECT \tacw.SCREENING_CODE,\n              acw.QUESTION_CODE,\n              acw.ANSWER_CODE,\n              acw.QUESTION_SLNO,\n              acw.Score AS Score\n        FROM ahc_cross_walk acw\n        Where QUESTION_SLNO_REFERENCE In(\n        SELECT QUESTION_SLNO\n            FROM ahc_cross_walk\n            WHERE UPPER(TRIM(QUESTION)) LIKE '%TOTAL SAFETY SCORE%'\n            )\n        AND acw.QUESTION_CODE = scr.QUESTION_CODE\n        AND acw.ANSWER_CODE = scr.ANSWER_CODE\n    ) AS crw ON crw.SCREENING_CODE = scr.SCREENING_CODE\n)\nSELECT \tcross_walk_Score,\n    screening_score AS invalid_value,\n    (SELECT src_file_row_number FROM screening_20240307 WHERE UPPER(TRIM(QUESTION_CODE_DESCRIPTION)) LIKE '%TOTAL SAFETY SCORE%') AS issue_row,\n  'ANSWER_CODE_DESCRIPTION' AS issue_column\nFROM cte_score\nWHERE screening_score <> cross_walk_Score\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid ANSWER_CODE_DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ANSWER_CODE_DESCRIPTION for TOTAL SAFETY SCORE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ANSWER_CODE_DESCRIPTION for TOTAL SAFETY SCORE (Calculated Score)'\n      FROM valid_total_safety_score_in_all_rows;\nWITH valid_calculated_mental_health_score_in_all_rows AS (\n  SELECT ANSWER_CODE_DESCRIPTION AS issue_column,\n  SCREENING_CALCULATED_SCORE AS invalid_value,\n  SRC_FILE_ROW_NUMBER AS issue_row\n  FROM\n  (\n  SELECT Sum(crw.score) As CROSSWALK_ANSWER_SCORE,\n      (SELECT CASE WHEN TRY_CAST(ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL THEN CAST(ANSWER_CODE_DESCRIPTION AS INTEGER) ELSE 0 END AS SCREENING_CALC_SCORE\n        FROM screening_20240307 scr2\n        WHERE UPPER(scr2.QUESTION_CODE_DESCRIPTION) LIKE '%CALCULATED MENTAL HEALTH SCORE%'\n    ) AS SCREENING_CALCULATED_SCORE,\n    (SELECT src_file_row_number FROM screening_20240307 WHERE UPPER(QUESTION_CODE_DESCRIPTION) LIKE '%CALCULATED MENTAL HEALTH SCORE%') AS SRC_FILE_ROW_NUMBER,\n    'ANSWER_CODE_DESCRIPTION' AS ANSWER_CODE_DESCRIPTION\n      FROM screening_20240307 scr\n      INNER JOIN (\n          SELECT \tacw.score As SCORE\n          FROM ahc_cross_walk acw\n          Where QUESTION_SLNO_REFERENCE In(\n          SELECT QUESTION_SLNO\n              FROM ahc_cross_walk\n              WHERE UPPER(QUESTION) LIKE '%CALCULATED MENTAL HEALTH SCORE%'\n              )\n          AND acw.QUESTION_CODE = scr.QUESTION_CODE\n          AND acw.ANSWER_CODE  = scr.ANSWER_CODE\n      ) AS crw ON 1 = 1\n  ) As calc_fld_val\n  Where calc_fld_val.CROSSWALK_ANSWER_SCORE <> calc_fld_val.SCREENING_CALCULATED_SCORE\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid ANSWER_CODE_DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ANSWER_CODE_DESCRIPTION for CALCULATED MENTAL HEALTH SCORE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ANSWER_CODE_DESCRIPTION for CALCULATED MENTAL HEALTH SCORE (Calculated Score)'\n      FROM valid_calculated_mental_health_score_in_all_rows;\nWITH valid_calculated_weekly_physical_activity_score_in_all_rows AS (\n  WITH cte_physical_activity AS (\n    SELECT\n      scr.SCREENING_CODE,\n      scr.QUESTION_CODE,\n      scr.ANSWER_CODE,\n      crw.ANSWER_VALUE,\n      scr.ANSWER_CODE_DESCRIPTION,\n      ROW_NUMBER() OVER (\n      ORDER BY scr.SCREENING_CODE) AS sequence_number\n    FROM\n      screening_20240307 scr\n    INNER JOIN (\n      SELECT\n        acw.SCREENING_CODE,\n        acw.QUESTION_CODE,\n        acw.ANSWER_CODE,\n        acw.QUESTION_SLNO,\n        CASE\n          WHEN TRY_CAST(acw.ANSWER_VALUE AS INTEGER) IS NOT NULL THEN CAST(acw.ANSWER_VALUE AS INTEGER)\n          ELSE CASE WHEN acw.ANSWER_CODE='LA32060-8' THEN 150 ELSE 0 END\n        END AS ANSWER_VALUE\n      FROM\n        ahc_cross_walk acw\n      Where\n        QUESTION_SLNO_REFERENCE In(\n        SELECT\n          QUESTION_SLNO\n        FROM\n          ahc_cross_walk\n        WHERE\n          UPPER(QUESTION) LIKE '%CALCULATED PHYSICAL ACTIVITY SCORE%'\n                )\n        AND acw.QUESTION_CODE = scr.QUESTION_CODE\n        AND acw.ANSWER_CODE = scr.ANSWER_CODE\n        ) AS crw ON\n      crw.SCREENING_CODE = scr.SCREENING_CODE\n    )\n    Select \tANSWER_CODE_DESCRIPTION AS issue_column,\n        CROSSWALK_ANSWER_VALUE AS CROSSWALK_ANSWER_VALUE,\n        SCREENING_CALCULATED_VALUE AS invalid_value,\n        SRC_FILE_ROW_NUMBER AS issue_row\n    FROM\n      (\n      Select\n        t1.ANSWER_VALUE * t2.ANSWER_VALUE As CROSSWALK_ANSWER_VALUE,\n        CASE\n          WHEN TRY_CAST(t1.ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL\n            AND TRY_CAST(t2.ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL THEN\n        CAST(t1.ANSWER_CODE_DESCRIPTION AS INTEGER) * CAST(t2.ANSWER_CODE_DESCRIPTION AS INTEGER)\n          ELSE CASE WHEN t2.ANSWER_CODE='LA32060-8' THEN 150 * CAST(t1.ANSWER_CODE_DESCRIPTION AS INTEGER) ELSE 0 END\n          END AS SCREENING_ANSWER_VALUE,\n          Scrn_Phycical_Act_Score.SCRN_PHYSICAL_ACTIVITY_VALUE AS SCREENING_CALCULATED_VALUE,\n          (SELECT src_file_row_number FROM screening_20240307 WHERE UPPER(QUESTION_CODE_DESCRIPTION) LIKE '%CALCULATED WEEKLY PHYSICAL ACTIVITY%') AS SRC_FILE_ROW_NUMBER,\n          'ANSWER_CODE_DESCRIPTION' AS ANSWER_CODE_DESCRIPTION\n\n        from\n          cte_physical_activity t1\n        Inner Join cte_physical_activity t2\n    On\n          t1.sequence_number = 1\n          and t2.sequence_number = 2\n        Left Outer Join (\n          Select\n            CASE\n              WHEN TRY_CAST(ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL THEN CAST(ANSWER_CODE_DESCRIPTION AS INTEGER)\n              ELSE 0\n            END SCRN_PHYSICAL_ACTIVITY_VALUE\n          From\n          screening_20240307 scr\n          Where\n            UPPER(scr.QUESTION_CODE_DESCRIPTION) LIKE '%CALCULATED WEEKLY PHYSICAL ACTIVITY%') AS Scrn_Phycical_Act_Score\n                On\n          1 = 1\n    ) As calc_fld\n    Where\n      (calc_fld.CROSSWALK_ANSWER_VALUE <> calc_fld.SCREENING_ANSWER_VALUE)\n      OR (calc_fld.SCREENING_ANSWER_VALUE <> calc_fld.SCREENING_CALCULATED_VALUE)\n      OR (calc_fld.CROSSWALK_ANSWER_VALUE <> calc_fld.SCREENING_CALCULATED_VALUE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid ANSWER_CODE_DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ANSWER_CODE_DESCRIPTION for CALCULATED PHYSICAL ACTIVITY SCORE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ANSWER_CODE_DESCRIPTION for CALCULATED PHYSICAL ACTIVITY SCORE (Calculated Score)'\n      FROM valid_calculated_weekly_physical_activity_score_in_all_rows;\nWITH allowed_values AS (\n    SELECT 'SCREENING_CODE' AS issue_column,\n           \"SCREENING_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_CODE\" NOT IN ('96777-8', '97023-6')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''96777-8'', ''97023-6'')',\n           'Use only allowed values ''96777-8'', ''97023-6'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'SCREENING_CODE_SYSTEM_NAME' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" NOT IN ('LN', 'LOINC', 'http://loinc.org')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''LN'', ''LOINC'', ''http://loinc.org'')',\n           'Use only allowed values ''LN'', ''LOINC'', ''http://loinc.org'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'RECORDED_TIME' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"RECORDED_TIME\" IS NULL\n        OR TRIM(CAST(\"RECORDED_TIME\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_date_time_in_all_rows AS (\n        SELECT  'RECORDED_TIME' AS issue_column,\n              \"RECORDED_TIME\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM \"screening_20240307\"\n        WHERE \"RECORDED_TIME\" IS NOT NULL\n        AND \"RECORDED_TIME\" NOT SIMILAR TO '([0-9]([0-9]([0-9][1-9]|[1-9]0)|[1-9]00)|[1-9]000)-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])T([01][0-9]|2[0-3]):[0-5][0-9]:([0-5][0-9]|60)(\\.[0-9]+)?(Z|(\\+|-)((0[0-9]|1[0-3]):[0-5][0-9]|14:00))$'\n        OR TRY_CAST(\"RECORDED_TIME\" AS TIMESTAMP) IS NULL\n  )\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Date',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid timestamp \"' || invalid_value || '\" found in ' || issue_column,\n           'Please be sure to provide both a valid date and time.'\n      FROM valid_date_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'SDOH_DOMAIN' AS issue_column,\n           \"SDOH_DOMAIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SDOH_DOMAIN\" IS NULL\n        OR TRIM(CAST(\"SDOH_DOMAIN\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_sdoh_domain_in_all_rows AS (\n  SELECT DISTINCT scr.SDOH_DOMAIN AS invalid_value,\n    'SDOH_DOMAIN' AS issue_column,\n    scr.src_file_row_number AS issue_row\n  FROM screening_20240307 scr\n  LEFT JOIN ahc_cross_walk cw\n  ON UPPER(scr.SDOH_DOMAIN) = UPPER(cw.SDOH_DOMAIN)\n  WHERE cw.SDOH_DOMAIN IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid SDOH DOMAIN',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid SDOH DOMAIN \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate SDOH DOMAIN with ahc cross walk reference data'\n      FROM valid_sdoh_domain_in_all_rows;\nWITH valid_question_code_for_screening_code_in_all_rows AS (\n  SELECT DISTINCT scr.SCREENING_CODE AS issue_screening_value, scr.QUESTION_CODE AS invalid_value, 'QUESTION_CODE' AS issue_column, scr.src_file_row_number AS issue_row\n  FROM screening_20240307 scr\n  LEFT JOIN ahc_cross_walk cw ON UPPER(scr.QUESTION_CODE) = UPPER(cw.QUESTION_CODE)\n  AND UPPER(scr.SCREENING_CODE) = UPPER(cw.SCREENING_CODE)\n  WHERE cw.QUESTION_CODE IS NULL\n  AND cw.SCREENING_CODE IS NOT NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Question Code',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid Question Code \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate Question Code with ahc cross walk reference data'\n      FROM valid_question_code_for_screening_code_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'ANSWER_CODE_DESCRIPTION' AS issue_column,\n           \"ANSWER_CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ANSWER_CODE_DESCRIPTION\" IS NULL\n        OR TRIM(CAST(\"ANSWER_CODE_DESCRIPTION\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'QUESTION_CODE_SYSTEM_NAME' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" NOT IN ('LN','LOINC','http://loinc.org')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''LN'',''LOINC'',''http://loinc.org'')',\n           'Use only allowed values ''LN'',''LOINC'',''http://loinc.org'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'ANSWER_CODE_SYSTEM_NAME' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" NOT IN ('LN','LOINC','http://loinc.org')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''LN'',''LOINC'',''http://loinc.org'')',\n           'Use only allowed values ''LN'',''LOINC'',''http://loinc.org'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'POTENTIAL_NEED_INDICATED' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" IS NULL\n        OR TRIM(CAST(\"POTENTIAL_NEED_INDICATED\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'POTENTIAL_NEED_INDICATED' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" NOT IN ('Yes','No','NA','yes','no','na')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'',''No'',''NA'',''yes'',''no'',''na'')',\n           'Use only allowed values ''Yes'',''No'',''NA'',''yes'',''no'',''na'' in ' || issue_column\n      FROM allowed_values;\nWITH valid_screening_potential_need_indicated_question_answer_values_in_all_rows AS (\n  SELECT  'POTENTIAL_NEED_INDICATED' AS issue_column,\n          coalesce(scr.\"POTENTIAL_NEED_INDICATED\",'NULL') AS invalid_value,\n          scr.ANSWER_CODE AS invalid_answer_value,\n          scr.QUESTION_CODE AS invalid_question_value,\n          scr.SCREENING_CODE AS invalid_screening_value,\n          scr.src_file_row_number AS issue_row\n  FROM screening_20240307 scr\n  LEFT JOIN ahc_cross_walk acw\n    ON UPPER(scr.SCREENING_CODE) = UPPER(acw.SCREENING_CODE)\n    AND UPPER(scr.QUESTION_CODE) = UPPER(acw.QUESTION_CODE)\n    AND UPPER(scr.ANSWER_CODE) = UPPER(acw.ANSWER_CODE)\n    AND UPPER(scr.\"POTENTIAL_NEED_INDICATED\") = UPPER(acw.\"POTENTIAL_NEED_INDICATED\")\n  WHERE acw.\"POTENTIAL_NEED_INDICATED\" IS NULL\n  AND  UPPER(scr.QUESTION_CODE_DESCRIPTION)\n  NOT IN(\n    'TOTAL SAFETY SCORE',\n    'CALCULATED WEEKLY PHYSICAL ACTIVITY',\n    'CALCULATED MENTAL HEALTH SCORE'\n  )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid value in POTENTIAL_NEED_INDICATED',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Provided Potential Need Indicated \"' || invalid_value || '\", Screening Code \"' || invalid_screening_value || '\", Question Code \"' || invalid_question_value || '\" and Answer Code \"' || invalid_answer_value || '\" are not matching with the reference data found in ' || issue_column,\n           'Validate Potential Need Indicated, Screening Code, Question Code and Answer Code with ahc cross walk reference data'\n      FROM valid_screening_potential_need_indicated_question_answer_values_in_all_rows;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('c50d9d2d-753b-5200-b2f6-e63309cf252d', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'd09ebe08-1b63-56d8-8f2b-8fff76c9828f', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'ScreeningCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('463a01b7-82ad-5633-939d-54a554d09923', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b9aac8ec-792a-511d-8107-25bd96085898', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'AhcCrossWalkCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('98f79424-a291-554e-aa6a-17c4c39e5c81', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b9aac8ec-792a-511d-8107-25bd96085898', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'AhcCrossWalkCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('1e8926d1-43b1-5485-9308-7addd10605ab', '52c6a395-5d83-4051-bb7c-39036f26ab29', '48eb0055-f06e-57f4-8019-f49266be3d22', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'EncounterClassReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('a76151ab-e619-51bb-9db7-57c686404756', '52c6a395-5d83-4051-bb7c-39036f26ab29', '48eb0055-f06e-57f4-8019-f49266be3d22', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'EncounterClassReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('81a8b5c0-5c79-5ff9-95d6-cfcf0749c550', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2e9c77e9-a664-5323-83e4-e6a92cf998ab', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'EncounterStatusCodeReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('731b9b5d-fbb0-541f-93bc-11778098ab71', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2e9c77e9-a664-5323-83e4-e6a92cf998ab', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'EncounterStatusCodeReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('2af573ce-4941-56c1-a703-f92928ad3a7d', '52c6a395-5d83-4051-bb7c-39036f26ab29', '4b3dd9ab-d81b-509a-9662-68dbd6d142f7', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'EncounterTypeCodeReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('8fe71cea-8904-5ba0-823d-de9955eee28d', '52c6a395-5d83-4051-bb7c-39036f26ab29', '4b3dd9ab-d81b-509a-9662-68dbd6d142f7', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'EncounterTypeCodeReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('b7082a36-d569-5f54-b0fe-23dfaca90466', '52c6a395-5d83-4051-bb7c-39036f26ab29', '1a152daa-273d-5411-88cf-84067822a8aa', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7d4a917b-2900-5b12-a89c-a246a342b27b', '52c6a395-5d83-4051-bb7c-39036f26ab29', '1a152daa-273d-5411-88cf-84067822a8aa', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('de2853a4-d787-5e6d-ba4c-58a0cd667eac', '52c6a395-5d83-4051-bb7c-39036f26ab29', '787ee7ff-3ef5-59aa-a055-659cf10b6202', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'GenderIdentityReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('51873a08-9517-54b6-982b-38b5e08677b8', '52c6a395-5d83-4051-bb7c-39036f26ab29', '787ee7ff-3ef5-59aa-a055-659cf10b6202', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'GenderIdentityReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('bd4d7db3-4490-5a2f-8b54-876cd96bb629', '52c6a395-5d83-4051-bb7c-39036f26ab29', '79f3d60e-c863-5759-8043-f122175a7cbb', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'AdministrativeSexReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('e6b6e4b0-6fdd-5d2b-a626-801aaaa4967f', '52c6a395-5d83-4051-bb7c-39036f26ab29', '79f3d60e-c863-5759-8043-f122175a7cbb', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'AdministrativeSexReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7b22a848-5153-5975-b74e-e9c3ea06640c', '52c6a395-5d83-4051-bb7c-39036f26ab29', '6c2d9879-7393-524d-9e9e-02ea961aca39', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'SexAtBirthReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('8a53e502-4b61-5596-88d5-e2e23a907935', '52c6a395-5d83-4051-bb7c-39036f26ab29', '6c2d9879-7393-524d-9e9e-02ea961aca39', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'SexAtBirthReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('0ab7227d-471c-5f13-9630-7f3c0c6cd120', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2239dca2-9dd4-5c3a-91c8-2585839b9584', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'SexualOrientationReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('63af23ca-ea46-53d2-a55c-459cb2419b54', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2239dca2-9dd4-5c3a-91c8-2585839b9584', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'SexualOrientationReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('41f3b3f2-2670-5600-96ca-a39e21943a0a', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'fc740f9e-863e-5dd1-b1a1-86d176cb549c', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'BusinessRulesReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('2bb73de9-1a11-58ac-bcda-74d30c2ace8e', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'fc740f9e-863e-5dd1-b1a1-86d176cb549c', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'BusinessRulesReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('baac722a-6a3b-5494-9df5-91e63f8c22b0', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f98a88dc-a929-5a9b-906a-277e62c93012', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'RaceReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('312774c2-4ed4-526a-a68c-64356a89466d', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f98a88dc-a929-5a9b-906a-277e62c93012', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'RaceReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('6cf18abf-2b0d-5ec5-9b5e-2a7e81d0bcc3', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b0cbca95-5c20-5b2b-b589-9e832c556bc6', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'EthnicityReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('66d2dfbd-511a-58c0-9092-fd1965efbe27', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b0cbca95-5c20-5b2b-b589-9e832c556bc6', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'EthnicityReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('905ccf58-6d99-5787-97b2-2534a35e55d6', '52c6a395-5d83-4051-bb7c-39036f26ab29', '3469db42-0066-5f23-9ee4-2b857bf339a4', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'PreferredLanguageReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('96ffe5ed-2b40-5e9b-8e13-a60d66430ceb', '52c6a395-5d83-4051-bb7c-39036f26ab29', '3469db42-0066-5f23-9ee4-2b857bf339a4', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'PreferredLanguageReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('83c7e8ef-bc1c-5726-a3f1-46ec9c63a4df', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f19d5ebb-ea63-5b1d-b1b1-758457a2da29', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'SdohDomainReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('aae34d6f-c822-51b7-b05a-b06cb3774a0f', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f19d5ebb-ea63-5b1d-b1b1-758457a2da29', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'SdohDomainReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      ","session_id":"52c6a395-5d83-4051-bb7c-39036f26ab29","narrative_md":"\n## ensureContent\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('630f992f-2d33-5d0b-9855-29fdb84f62ee', '52c6a395-5d83-4051-bb7c-39036f26ab29', '963ed7bf-d356-54ae-ba2a-739f7f164e1a', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'AdminDemographicCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT 'FIRST_NAME' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"FIRST_NAME\" IS NULL\n        OR TRIM(CAST(\"FIRST_NAME\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'FIRST_NAME' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"FIRST_NAME\" AS VARCHAR) NOT SIMILAR TO '^[A-Za-z]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]+$',\n           'Follow the pattern ^[A-Za-z]+$ in ' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT 'MIDDLE_NAME' AS issue_column,\n           \"MIDDLE_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"MIDDLE_NAME\" AS VARCHAR) NOT SIMILAR TO '^[A-Za-z]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]+$',\n           'Follow the pattern ^[A-Za-z]+$ in ' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT 'LAST_NAME' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"LAST_NAME\" IS NULL\n        OR TRIM(CAST(\"LAST_NAME\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'LAST_NAME' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"LAST_NAME\" AS VARCHAR) NOT SIMILAR TO '^[A-Za-z]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]+$',\n           'Follow the pattern ^[A-Za-z]+$ in ' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT 'ADMINISTRATIVE_SEX_CODE' AS issue_column,\n           \"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"ADMINISTRATIVE_SEX_CODE\" IS NULL\n        OR TRIM(CAST(\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'ADMINISTRATIVE_SEX_CODE_SYSTEM' AS issue_column,\n           \"ADMINISTRATIVE_SEX_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"ADMINISTRATIVE_SEX_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"ADMINISTRATIVE_SEX_CODE_SYSTEM\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_administrative_sex_code_in_all_rows AS (\n    SELECT 'ADMINISTRATIVE_SEX_CODE' AS issue_column,\n           sr.\"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN administrative_sex_reference ref\n      ON UPPER(sr.\"ADMINISTRATIVE_SEX_CODE\") = UPPER(ref.ADMINISTRATIVE_SEX_CODE)\n     WHERE sr.\"ADMINISTRATIVE_SEX_CODE\" IS NOT NULL\n      AND ref.ADMINISTRATIVE_SEX_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid ADMINISTRATIVE SEX CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ADMINISTRATIVE SEX CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ADMINISTRATIVE SEX CODE with administrative sex reference data'\n      FROM valid_administrative_sex_code_in_all_rows;\nWITH valid_administrative_sex_code_description_in_all_rows AS (\n    SELECT 'ADMINISTRATIVE_SEX_CODE_DESCRIPTION' AS issue_column,\n           sr.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN administrative_sex_reference ref\n      ON UPPER(sr.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\") = UPPER(ref.ADMINISTRATIVE_SEX_CODE_DESCRIPTION)\n     WHERE sr.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" IS NOT NULL\n      AND ref.ADMINISTRATIVE_SEX_CODE_DESCRIPTION IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid ADMINISTRATIVE SEX CODE DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ADMINISTRATIVE SEX CODE DESCRIPTION \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ADMINISTRATIVE SEX CODE DESCRIPTION with administrative sex reference data'\n      FROM valid_administrative_sex_code_description_in_all_rows;\nWITH valid_administrative_sex_code_system_in_all_rows AS (\n    SELECT 'ADMINISTRATIVE_SEX_CODE_SYSTEM' AS issue_column,\n           sr.\"ADMINISTRATIVE_SEX_CODE_SYSTEM\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN administrative_sex_reference ref\n      ON UPPER(sr.\"ADMINISTRATIVE_SEX_CODE_SYSTEM\") = UPPER(ref.ADMINISTRATIVE_SEX_CODE_SYSTEM)\n     WHERE sr.\"ADMINISTRATIVE_SEX_CODE_SYSTEM\" IS NOT NULL\n      AND ref.ADMINISTRATIVE_SEX_CODE_SYSTEM IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid ADMINISTRATIVE SEX CODE SYSTEM',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ADMINISTRATIVE SEX CODE SYSTEM \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ADMINISTRATIVE SEX CODE SYSTEM with administrative sex reference data'\n      FROM valid_administrative_sex_code_system_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'ADMINISTRATIVE_SEX_CODE' AS issue_column,\n      tbl.\"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n      tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"ADMINISTRATIVE_SEX_CODE\" is not null\n  and tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" FROM administrative_sex_reference WHERE UPPER(CAST(tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)) = UPPER(CAST(\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The ADMINISTRATIVE_SEX_CODE \"' || invalid_value || '\" of ADMINISTRATIVE_SEX_CODE_DESCRIPTION \"' || dependent_value || '\" is not matching with the ADMINISTRATIVE_SEX_CODE of ADMINISTRATIVE_SEX_CODE_DESCRIPTION in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'ADMINISTRATIVE_SEX_CODE_DESCRIPTION' AS issue_column,\n      tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ADMINISTRATIVE_SEX_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" is not null\n  and tbl.\"ADMINISTRATIVE_SEX_CODE\" is not null\n  and NOT EXISTS ( SELECT \"ADMINISTRATIVE_SEX_CODE\" FROM administrative_sex_reference WHERE UPPER(CAST(tbl.\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)) = UPPER(CAST(\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The ADMINISTRATIVE_SEX_CODE_DESCRIPTION \"' || invalid_value || '\" of ADMINISTRATIVE_SEX_CODE \"' || dependent_value || '\" is not matching with the ADMINISTRATIVE_SEX_CODE_DESCRIPTION of ADMINISTRATIVE_SEX_CODE in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_sex_at_birth_code_in_all_rows AS (\n    SELECT 'SEX_AT_BIRTH_CODE' AS issue_column,\n           sr.\"SEX_AT_BIRTH_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sex_at_birth_reference ref\n      ON UPPER(sr.SEX_AT_BIRTH_CODE) = UPPER(ref.SEX_AT_BIRTH_CODE)\n     WHERE sr.SEX_AT_BIRTH_CODE IS NOT NULL\n      AND ref.SEX_AT_BIRTH_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid SEX AT BIRTH CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid SEX AT BIRTH CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate SEX AT BIRTH CODE with sex at birth reference data'\n      FROM valid_sex_at_birth_code_in_all_rows;\nWITH valid_sex_at_birth_code_description_in_all_rows AS (\n    SELECT 'SEX_AT_BIRTH_CODE_DESCRIPTION' AS issue_column,\n           sr.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sex_at_birth_reference ref\n      ON UPPER(sr.SEX_AT_BIRTH_CODE_DESCRIPTION) = UPPER(ref.SEX_AT_BIRTH_CODE_DESCRIPTION)\n     WHERE sr.SEX_AT_BIRTH_CODE_DESCRIPTION IS NOT NULL\n      AND ref.SEX_AT_BIRTH_CODE_DESCRIPTION IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid SEX_AT_BIRTH_CODE_DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid SEX_AT_BIRTH_CODE_DESCRIPTION \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate SEX_AT_BIRTH_CODE_DESCRIPTION with sex at birth reference data'\n      FROM valid_sex_at_birth_code_description_in_all_rows;\nWITH valid_sex_at_birth_code_system_in_all_rows AS (\n    SELECT 'SEX_AT_BIRTH_CODE_SYSTEM' AS issue_column,\n           sr.\"SEX_AT_BIRTH_CODE_SYSTEM\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sex_at_birth_reference ref\n      ON UPPER(sr.SEX_AT_BIRTH_CODE_SYSTEM) = UPPER(ref.SEX_AT_BIRTH_CODE_SYSTEM)\n     WHERE sr.SEX_AT_BIRTH_CODE_SYSTEM IS NOT NULL\n      AND ref.SEX_AT_BIRTH_CODE_SYSTEM IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid SEX AT BIRTH CODE SYSTEM',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid SEX AT BIRTH CODE SYSTEM \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate SEX AT BIRTH CODE SYSTEM with sex at birth reference data'\n      FROM valid_sex_at_birth_code_system_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'SEX_AT_BIRTH_CODE' AS issue_column,\n      tbl.\"SEX_AT_BIRTH_CODE\" AS invalid_value,\n      tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"SEX_AT_BIRTH_CODE\" is not null\n  and tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"SEX_AT_BIRTH_CODE_DESCRIPTION\" FROM sex_at_birth_reference WHERE UPPER(CAST(tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SEX_AT_BIRTH_CODE\" AS VARCHAR)) = UPPER(CAST(\"SEX_AT_BIRTH_CODE\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The SEX_AT_BIRTH_CODE \"' || invalid_value || '\" of SEX_AT_BIRTH_CODE_DESCRIPTION \"' || dependent_value || '\" is not matching with the SEX_AT_BIRTH_CODE of SEX_AT_BIRTH_CODE_DESCRIPTION in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'SEX_AT_BIRTH_CODE_DESCRIPTION' AS issue_column,\n      tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"SEX_AT_BIRTH_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" is not null\n  and tbl.\"SEX_AT_BIRTH_CODE\" is not null\n  and NOT EXISTS ( SELECT \"SEX_AT_BIRTH_CODE\" FROM sex_at_birth_reference WHERE UPPER(CAST(tbl.\"SEX_AT_BIRTH_CODE\" AS VARCHAR)) = UPPER(CAST(\"SEX_AT_BIRTH_CODE\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The SEX_AT_BIRTH_CODE_DESCRIPTION \"' || invalid_value || '\" of SEX_AT_BIRTH_CODE \"' || dependent_value || '\" is not matching with the SEX_AT_BIRTH_CODE_DESCRIPTION of SEX_AT_BIRTH_CODE in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'PAT_BIRTH_DATE' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"PAT_BIRTH_DATE\" IS NULL\n        OR TRIM(CAST(\"PAT_BIRTH_DATE\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_date_time_in_all_rows AS (\n    SELECT 'PAT_BIRTH_DATE' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"PAT_BIRTH_DATE\" IS NOT NULL\n       AND TRY_CAST(\"PAT_BIRTH_DATE\" AS TIMESTAMP) IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid Date',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid timestamp \"' || invalid_value || '\" found in ' || issue_column,\n           'Please be sure to provide both a valid date and time.'\n      FROM valid_date_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'CITY' AS issue_column,\n           \"CITY\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"CITY\" IS NULL\n        OR TRIM(CAST(\"CITY\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'STATE' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"STATE\" IS NULL\n        OR TRIM(CAST(\"STATE\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'STATE' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"STATE\" NOT IN ('NY', 'New York')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''NY'', ''New York'')',\n           'Use only allowed values ''NY'', ''New York'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'ZIP' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"ZIP\" IS NULL\n        OR TRIM(CAST(\"ZIP\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'ZIP' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"ZIP\" AS VARCHAR) NOT SIMILAR TO '^\\d{5}(\\d{4})?$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^\\d{5}(\\d{4})?$',\n           'Follow the pattern ^\\d{5}(\\d{4})?$ in ' || issue_column\n      FROM pattern;\nWITH valid_integer_alphanumeric_string_in_all_rows AS (\n  SELECT 'ADDRESS1' AS issue_column,\n    t.\"ADDRESS1\" AS invalid_value,\n    t.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307 t\n  WHERE t.\"ADDRESS1\" SIMILAR TO '[0-9]+'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Data Type Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'Invalid string of numbers found'\n      FROM valid_integer_alphanumeric_string_in_all_rows;\nWITH valid_address1_or_medicaid_cin_in_all_rows AS (\n    SELECT 'ADDRESS1' AS issue_column,\n           ADDRESS1 AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM admin_demographics_20240307\n      WHERE (ADDRESS1 IS NULL OR TRIM(\"ADDRESS1\") = '') AND (MEDICAID_CIN IS NULL OR TRIM(\"MEDICAID_CIN\") = '')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid ADDRESS1',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field \"' || issue_column || '\" is empty',\n           'The required field value ADDRESS1 is missing. This is required due to the absence of the MEDICAID_CIN.'\n      FROM valid_address1_or_medicaid_cin_in_all_rows;\nWITH valid_gender_identity_code_in_all_rows AS (\n    SELECT 'GENDER_IDENTITY_CODE' AS issue_column,\n           sr.\"GENDER_IDENTITY_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN gender_identity_reference ref\n      ON UPPER(sr.GENDER_IDENTITY_CODE) = UPPER(ref.GENDER_IDENTITY_CODE)\n     WHERE sr.GENDER_IDENTITY_CODE IS NOT NULL\n      AND ref.GENDER_IDENTITY_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid GENDER IDENTITY CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid GENDER IDENTITY CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate GENDER IDENTITY CODE with gender identity reference data'\n      FROM valid_gender_identity_code_in_all_rows;\nWITH allowed_values AS (\n    SELECT 'GENDER_IDENTITY_CODE_SYSTEM_NAME' AS issue_column,\n           \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" NOT IN ('SNOMED-CT','SNOMED','http://snomed.info/sct')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''SNOMED-CT'',''SNOMED'',''http://snomed.info/sct'')',\n           'Use only allowed values ''SNOMED-CT'',''SNOMED'',''http://snomed.info/sct'' in ' || issue_column\n      FROM allowed_values;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'GENDER_IDENTITY_CODE' AS issue_column,\n      tbl.\"GENDER_IDENTITY_CODE\" AS invalid_value,\n      tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"GENDER_IDENTITY_CODE\" is not null\n  and tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"GENDER_IDENTITY_CODE_DESCRIPTION\" FROM gender_identity_reference WHERE UPPER(CAST(tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS VARCHAR)) AND UPPER(CAST(tbl.\"GENDER_IDENTITY_CODE\" AS VARCHAR)) = UPPER(CAST(\"GENDER_IDENTITY_CODE\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The GENDER_IDENTITY_CODE \"' || invalid_value || '\" of GENDER_IDENTITY_CODE_DESCRIPTION \"' || dependent_value || '\" is not matching with the GENDER_IDENTITY_CODE of GENDER_IDENTITY_CODE_DESCRIPTION in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'GENDER_IDENTITY_CODE_DESCRIPTION' AS issue_column,\n      tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"GENDER_IDENTITY_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" is not null\n  and tbl.\"GENDER_IDENTITY_CODE\" is not null\n  and NOT EXISTS ( SELECT \"GENDER_IDENTITY_CODE\" FROM gender_identity_reference WHERE UPPER(CAST(tbl.\"GENDER_IDENTITY_CODE\" AS VARCHAR)) = UPPER(CAST(\"GENDER_IDENTITY_CODE\" AS VARCHAR)) AND UPPER(CAST(tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The GENDER_IDENTITY_CODE_DESCRIPTION \"' || invalid_value || '\" of GENDER_IDENTITY_CODE \"' || dependent_value || '\" is not matching with the GENDER_IDENTITY_CODE_DESCRIPTION of GENDER_IDENTITY_CODE in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_sexual_orientation_code_in_all_rows AS (\n    SELECT 'SEXUAL_ORIENTATION_CODE' AS issue_column,\n           sr.\"SEXUAL_ORIENTATION_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sexual_orientation_reference ref\n      ON UPPER(sr.SEXUAL_ORIENTATION_CODE) = UPPER(ref.SEXUAL_ORIENTATION_CODE)\n     WHERE sr.SEXUAL_ORIENTATION_CODE IS NOT NULL\n      AND ref.SEXUAL_ORIENTATION_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid SEXUAL ORIENTATION CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid SEXUAL ORIENTATION CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate SEXUAL ORIENTATION CODE with sexual orientation reference data'\n      FROM valid_sexual_orientation_code_in_all_rows;\nWITH valid_sexual_orientation_description_in_all_rows AS (\n    SELECT 'SEXUAL_ORIENTATION_DESCRIPTION' AS issue_column,\n           sr.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sexual_orientation_reference ref\n      ON UPPER(sr.SEXUAL_ORIENTATION_DESCRIPTION) = UPPER(ref.SEXUAL_ORIENTATION_CODE_DESCRIPTION)\n     WHERE sr.SEXUAL_ORIENTATION_DESCRIPTION IS NOT NULL\n      AND ref.SEXUAL_ORIENTATION_CODE_DESCRIPTION IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid SEXUAL ORIENTATION CODE DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid SEXUAL ORIENTATION CODE DESCRIPTION \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate SEXUAL ORIENTATION CODE DESCRIPTION with sexual orientation reference data'\n      FROM valid_sexual_orientation_description_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'SEXUAL_ORIENTATION_CODE' AS issue_column,\n      tbl.\"SEXUAL_ORIENTATION_CODE\" AS invalid_value,\n      tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"SEXUAL_ORIENTATION_CODE\" is not null\n  and tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"SEXUAL_ORIENTATION_CODE_DESCRIPTION\" FROM sexual_orientation_reference WHERE UPPER(CAST(tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"SEXUAL_ORIENTATION_CODE_DESCRIPTION\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SEXUAL_ORIENTATION_CODE\" AS VARCHAR)) = UPPER(CAST(\"SEXUAL_ORIENTATION_CODE\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The SEXUAL_ORIENTATION_CODE \"' || invalid_value || '\" of SEXUAL_ORIENTATION_DESCRIPTION \"' || dependent_value || '\" is not matching with the SEXUAL_ORIENTATION_CODE of SEXUAL_ORIENTATION_DESCRIPTION in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'SEXUAL_ORIENTATION_DESCRIPTION' AS issue_column,\n      tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS invalid_value,\n      tbl.\"SEXUAL_ORIENTATION_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" is not null\n  and tbl.\"SEXUAL_ORIENTATION_CODE\" is not null\n  and NOT EXISTS ( SELECT \"SEXUAL_ORIENTATION_CODE\" FROM sexual_orientation_reference WHERE UPPER(CAST(tbl.\"SEXUAL_ORIENTATION_CODE\" AS VARCHAR)) = UPPER(CAST(\"SEXUAL_ORIENTATION_CODE\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"SEXUAL_ORIENTATION_CODE_DESCRIPTION\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The SEXUAL_ORIENTATION_DESCRIPTION \"' || invalid_value || '\" of SEXUAL_ORIENTATION_CODE \"' || dependent_value || '\" is not matching with the SEXUAL_ORIENTATION_DESCRIPTION of SEXUAL_ORIENTATION_CODE in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH allowed_values AS (\n    SELECT 'SEXUAL_ORIENTATION_CODE_SYSTEM_NAME' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" NOT IN ('SNOMED-CT','SNOMED','http://snomed.info/sct')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''SNOMED-CT'',''SNOMED'',''http://snomed.info/sct'')',\n           'Use only allowed values ''SNOMED-CT'',''SNOMED'',''http://snomed.info/sct'' in ' || issue_column\n      FROM allowed_values;\nWITH valid_ethnicity_code_in_all_rows AS (\n    SELECT 'ETHNICITY_CODE' AS issue_column,\n           ad.\"ETHNICITY_CODE\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN ethnicity_reference ref\n      ON UPPER(CAST(ad.\"ETHNICITY_CODE\" AS VARCHAR)) = UPPER(CAST(ref.\"Concept Code\" AS VARCHAR))\n     WHERE ad.\"ETHNICITY_CODE\" IS NOT NULL\n      AND ref.\"Concept Code\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid ETHNICITY CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ETHNICITY CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ETHNICITY CODE with ethnicity reference data'\n      FROM valid_ethnicity_code_in_all_rows;\nWITH valid_ethnicity_code_description_in_all_rows AS (\n    SELECT 'ETHNICITY_CODE_DESCRIPTION' AS issue_column,\n           ad.\"ETHNICITY_CODE_DESCRIPTION\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN ethnicity_reference ref\n      ON UPPER(CAST(ad.\"ETHNICITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(ref.\"Concept Name\" AS VARCHAR))\n     WHERE ad.\"ETHNICITY_CODE_DESCRIPTION\" IS NOT NULL\n      AND ref.\"Concept Name\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid ETHNICITY CODE DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ETHNICITY CODE DESCRIPTION \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ETHNICITY CODE DESCRIPTION with ethnicity reference data'\n      FROM valid_ethnicity_code_description_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'ETHNICITY_CODE' AS issue_column,\n      tbl.\"ETHNICITY_CODE\" AS invalid_value,\n      tbl.\"ETHNICITY_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"ETHNICITY_CODE\" is not null\n  and tbl.\"ETHNICITY_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Concept Name\" FROM ethnicity_reference WHERE UPPER(CAST(tbl.\"ETHNICITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Concept Name\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ETHNICITY_CODE\" AS VARCHAR)) = UPPER(CAST(\"Concept Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The ETHNICITY_CODE \"' || invalid_value || '\" of ETHNICITY_CODE_DESCRIPTION \"' || dependent_value || '\" is not matching with the ETHNICITY_CODE of ETHNICITY_CODE_DESCRIPTION in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'ETHNICITY_CODE_DESCRIPTION' AS issue_column,\n      tbl.\"ETHNICITY_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ETHNICITY_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"ETHNICITY_CODE_DESCRIPTION\" is not null\n  and tbl.\"ETHNICITY_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Concept Code\" FROM ethnicity_reference WHERE UPPER(CAST(tbl.\"ETHNICITY_CODE\" AS VARCHAR)) = UPPER(CAST(\"Concept Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ETHNICITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Concept Name\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The ETHNICITY_CODE_DESCRIPTION \"' || invalid_value || '\" of ETHNICITY_CODE \"' || dependent_value || '\" is not matching with the ETHNICITY_CODE_DESCRIPTION of ETHNICITY_CODE in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_race_code_in_all_rows AS (\n    SELECT 'RACE_CODE' AS issue_column,\n           ad.\"RACE_CODE\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN race_reference ref\n      ON UPPER(CAST(ad.\"RACE_CODE\" AS VARCHAR)) = UPPER(CAST(ref.\"Concept Code\" AS VARCHAR))\n     WHERE ad.\"RACE_CODE\" IS NOT NULL\n      AND ref.\"Concept Code\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid RACE CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid RACE CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate RACE CODE with race reference data'\n      FROM valid_race_code_in_all_rows;\nWITH valid_race_code_description_in_all_rows AS (\n    SELECT 'RACE_CODE_DESCRIPTION' AS issue_column,\n           ad.\"RACE_CODE_DESCRIPTION\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN race_reference ref\n      ON UPPER(CAST(ad.\"RACE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(ref.\"Concept Name\" AS VARCHAR))\n     WHERE ad.\"RACE_CODE_DESCRIPTION\" IS NOT NULL\n      AND ref.\"Concept Name\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid RACE CODE DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid RACE CODE DESCRIPTION \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate RACE CODE DESCRIPTION with race reference data'\n      FROM valid_race_code_description_in_all_rows;\nWITH valid_preferred_language_code_in_all_rows AS (\n    SELECT 'PREFERRED_LANGUAGE_CODE' AS issue_column,\n           ad.\"PREFERRED_LANGUAGE_CODE\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN preferred_language_reference ref\n      ON UPPER(CAST(ad.\"PREFERRED_LANGUAGE_CODE\" AS VARCHAR)) = UPPER(CAST(ref.\"ISO 639-2 Code\" AS VARCHAR))\n     WHERE ad.\"PREFERRED_LANGUAGE_CODE\" IS NOT NULL\n      AND ref.\"ISO 639-2 Code\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid PREFERRED LANGUAGE CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid PREFERRED LANGUAGE CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate PREFERRED LANGUAGE CODE with preferred language reference data'\n      FROM valid_preferred_language_code_in_all_rows;\nWITH valid_preferred_language_code_description_in_all_rows AS (\n    SELECT 'PREFERRED_LANGUAGE_DESCRIPTION' AS issue_column,\n           ad.\"PREFERRED_LANGUAGE_DESCRIPTION\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN preferred_language_reference ref\n      ON UPPER(CAST(ad.\"PREFERRED_LANGUAGE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(ref.\"English name of Language\" AS VARCHAR))\n     WHERE ad.\"PREFERRED_LANGUAGE_DESCRIPTION\" IS NOT NULL\n      AND ref.\"English name of Language\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid PREFERRED LANGUAGE CODE DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid PREFERRED LANGUAGE CODE DESCRIPTION \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate PREFERRED LANGUAGE CODE DESCRIPTION with preferred language reference data'\n      FROM valid_preferred_language_code_description_in_all_rows;\nWITH allowed_values AS (\n    SELECT 'PREFERRED_LANGUAGE_CODE_SYSTEM_NAME' AS issue_column,\n           \"PREFERRED_LANGUAGE_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"PREFERRED_LANGUAGE_CODE_SYSTEM_NAME\" NOT IN ('ISO','ISO 639-2','http://hl7.org/fhir/us/core/ValueSet/simple-language')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''ISO'',''ISO 639-2'',''http://hl7.org/fhir/us/core/ValueSet/simple-language'')',\n           'Use only allowed values ''ISO'',''ISO 639-2'',''http://hl7.org/fhir/us/core/ValueSet/simple-language'' in ' || issue_column\n      FROM allowed_values;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'RACE_CODE' AS issue_column,\n      tbl.\"RACE_CODE\" AS invalid_value,\n      tbl.\"RACE_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"RACE_CODE\" is not null\n  and tbl.\"RACE_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Concept Name\" FROM race_reference WHERE UPPER(CAST(tbl.\"RACE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Concept Name\" AS VARCHAR)) AND UPPER(CAST(tbl.\"RACE_CODE\" AS VARCHAR)) = UPPER(CAST(\"Concept Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The RACE_CODE \"' || invalid_value || '\" of RACE_CODE_DESCRIPTION \"' || dependent_value || '\" is not matching with the RACE_CODE of RACE_CODE_DESCRIPTION in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'PREFERRED_LANGUAGE_CODE' AS issue_column,\n      tbl.\"PREFERRED_LANGUAGE_CODE\" AS invalid_value,\n      tbl.\"PREFERRED_LANGUAGE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"PREFERRED_LANGUAGE_CODE\" is not null\n  and tbl.\"PREFERRED_LANGUAGE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"English name of Language\" FROM preferred_language_reference WHERE UPPER(CAST(tbl.\"PREFERRED_LANGUAGE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"English name of Language\" AS VARCHAR)) AND UPPER(CAST(tbl.\"PREFERRED_LANGUAGE_CODE\" AS VARCHAR)) = UPPER(CAST(\"ISO 639-2 Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The PREFERRED_LANGUAGE_CODE \"' || invalid_value || '\" of PREFERRED_LANGUAGE_DESCRIPTION \"' || dependent_value || '\" is not matching with the PREFERRED_LANGUAGE_CODE of PREFERRED_LANGUAGE_DESCRIPTION in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'RACE_CODE_DESCRIPTION' AS issue_column,\n      tbl.\"RACE_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"RACE_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"RACE_CODE_DESCRIPTION\" is not null\n  and tbl.\"RACE_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Concept Code\" FROM race_reference WHERE UPPER(CAST(tbl.\"RACE_CODE\" AS VARCHAR)) = UPPER(CAST(\"Concept Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"RACE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Concept Name\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The RACE_CODE_DESCRIPTION \"' || invalid_value || '\" of RACE_CODE \"' || dependent_value || '\" is not matching with the RACE_CODE_DESCRIPTION of RACE_CODE in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH allowed_values AS (\n    SELECT 'RACE_CODE_SYSTEM_NAME' AS issue_column,\n           \"RACE_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"RACE_CODE_SYSTEM_NAME\" NOT IN ('CDC','CDCRE','urn:oid:2.16.840.1.113883.6.238')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''CDC'',''CDCRE'',''urn:oid:2.16.840.1.113883.6.238'')',\n           'Use only allowed values ''CDC'',''CDCRE'',''urn:oid:2.16.840.1.113883.6.238'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'ETHNICITY_CODE_SYSTEM_NAME' AS issue_column,\n           \"ETHNICITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"ETHNICITY_CODE_SYSTEM_NAME\" NOT IN ('CDC','CDCRE','urn:oid:2.16.840.1.113883.6.238')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''CDC'',''CDCRE'',''urn:oid:2.16.840.1.113883.6.238'')',\n           'Use only allowed values ''CDC'',''CDCRE'',''urn:oid:2.16.840.1.113883.6.238'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'MPI_ID' AS issue_column,\n           \"MPI_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"MPI_ID\" IS NULL\n        OR TRIM(CAST(\"MPI_ID\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'PAT_MRN_ID' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(CAST(\"PAT_MRN_ID\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_mpi_id_per_pat_mrn_id_in_all_rows AS (\n    SELECT 'MPI_ID' AS issue_column,\n      MPI_ID AS invalid_value,\n      min(src_file_row_number) AS issue_row\n    FROM admin_demographics_20240307\n    GROUP BY MPI_ID\n    HAVING COUNT(DISTINCT PAT_MRN_ID) > 1\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid MPI_ID',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'The unique field \"' || issue_column || '\" \"' || invalid_value || '\"is not unique per PAT MRN ID',\n           'MPI_ID is not unique per PAT MRN ID.'\n      FROM valid_mpi_id_per_pat_mrn_id_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'FACILITY_ID' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ID\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'MEDICAID_CIN' AS issue_column,\n           \"MEDICAID_CIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"MEDICAID_CIN\" AS VARCHAR) NOT SIMILAR TO '^[A-Za-z]{2}\\d{5}[A-Za-z]$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$',\n           'Follow the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$ in ' || issue_column\n      FROM pattern;\nWITH valid_unique_medicaid_cin_per_mrn_in_all_rows AS (\n  SELECT 'MEDICAID_CIN' AS issue_column,\n          \"MEDICAID_CIN\" AS invalid_value,\n          min(src_file_row_number) AS issue_row\n    FROM admin_demographics_20240307\n    WHERE MEDICAID_CIN IS NOT NULL\n    GROUP BY pat_mrn_id, MEDICAID_CIN\n    HAVING COUNT(*) > 1\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid Unique Medicaid Cin Per Mrn',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid Unique Medicaid Cin Per Mrn \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate Unique Medicaid Cin Per Mrn'\n      FROM valid_unique_medicaid_cin_per_mrn_in_all_rows;\nWITH valid_address1_or_medicaid_cin_in_all_rows AS (\n    SELECT 'MEDICAID_CIN' AS issue_column,\n           MEDICAID_CIN AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM admin_demographics_20240307\n      WHERE (MEDICAID_CIN IS NULL OR TRIM(\"MEDICAID_CIN\") = '') AND (ADDRESS1 IS NULL OR TRIM(\"ADDRESS1\") = '')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid MEDICAID_CIN',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field \"' || issue_column || '\" is empty',\n           'The required field value MEDICAID_CIN is missing. This is required due to the absence of the ADDRESS1.'\n      FROM valid_address1_or_medicaid_cin_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'CONSENT' AS issue_column,\n           \"CONSENT\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"CONSENT\" IS NULL\n        OR TRIM(CAST(\"CONSENT\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'CONSENT' AS issue_column,\n           \"CONSENT\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"CONSENT\" NOT IN ('Yes', 'YES', 'yes', 'Y', 'y', 'No', 'NO', 'no','N', 'n','Unknown', 'UNKNOWN', 'unknown','UNK', 'Unk', 'unk')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '963ed7bf-d356-54ae-ba2a-739f7f164e1a',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'', ''YES'', ''yes'', ''Y'', ''y'', ''No'', ''NO'', ''no'',''N'', ''n'',''Unknown'', ''UNKNOWN'', ''unknown'',''UNK'', ''Unk'', ''unk'')',\n           'Use only allowed values ''Yes'', ''YES'', ''yes'', ''Y'', ''y'', ''No'', ''NO'', ''no'',''N'', ''n'',''Unknown'', ''UNKNOWN'', ''unknown'',''UNK'', ''Unk'', ''unk'' in ' || issue_column\n      FROM allowed_values;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('87f8bee3-8c83-518e-865a-740b0e3a45d3', '52c6a395-5d83-4051-bb7c-39036f26ab29', '963ed7bf-d356-54ae-ba2a-739f7f164e1a', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'AdminDemographicCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('f6f5cc47-43d2-5134-b3d4-e6d954f3e391', '52c6a395-5d83-4051-bb7c-39036f26ab29', '767cb8df-3ec0-5b59-998e-a91e75be32b3', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'QeAdminDataCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT 'PAT_MRN_ID' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(CAST(\"PAT_MRN_ID\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'FACILITY_ID' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ID\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_unique_facility_id_per_facility_in_all_rows AS (\n  SELECT 'FACILITY_ID' AS issue_column,\n    FACILITY_ID AS invalid_value,\n    min(src_file_row_number) AS issue_row\n  FROM qe_admin_data_20240307\n  GROUP BY FACILITY_ID\n  HAVING COUNT(DISTINCT FACILITY_LONG_NAME) > 1\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Invalid FACILITY_ID',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'The unique field \"' || issue_column || '\" \"' || invalid_value || '\"is not unique per facility',\n           'FACILITY_ID is not unique per facility.'\n      FROM valid_unique_facility_id_per_facility_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'FACILITY_LONG_NAME' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_LONG_NAME\" IS NULL\n        OR TRIM(CAST(\"FACILITY_LONG_NAME\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'ORGANIZATION_TYPE' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"ORGANIZATION_TYPE\" IS NULL\n        OR TRIM(CAST(\"ORGANIZATION_TYPE\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'ORGANIZATION_TYPE' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"ORGANIZATION_TYPE\" NOT IN ('Hospital', 'DTC', 'SNF', 'SCN', 'CBO', 'OMH', 'OASAS', 'Practice', 'Article 36', 'Article 40', 'MCO')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Hospital'', ''DTC'', ''SNF'', ''SCN'', ''CBO'', ''OMH'', ''OASAS'', ''Practice'', ''Article 36'', ''Article 40'', ''MCO'')',\n           'Use only allowed values ''Hospital'', ''DTC'', ''SNF'', ''SCN'', ''CBO'', ''OMH'', ''OASAS'', ''Practice'', ''Article 36'', ''Article 40'', ''MCO'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'FACILITY_ADDRESS1' AS issue_column,\n           \"FACILITY_ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_ADDRESS1\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ADDRESS1\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_unique_facility_address1_per_facility_in_all_rows AS (\n  SELECT 'FACILITY_ADDRESS1' AS issue_column,\n    FACILITY_ADDRESS1 AS invalid_value,\n    min(src_file_row_number) AS issue_row\n  FROM qe_admin_data_20240307\n  GROUP BY FACILITY_ADDRESS1\n  HAVING COUNT(DISTINCT FACILITY_LONG_NAME) > 1\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Invalid FACILITY_ADDRESS1',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'The unique field \"' || issue_column || '\" \"' || invalid_value || '\"is not unique per facility',\n           'FACILITY_ADDRESS1 is not unique per facility.'\n      FROM valid_unique_facility_address1_per_facility_in_all_rows;\nWITH valid_integer_alphanumeric_string_in_all_rows AS (\n  SELECT 'FACILITY_ADDRESS1' AS issue_column,\n    t.\"FACILITY_ADDRESS1\" AS invalid_value,\n    t.src_file_row_number AS issue_row\n  FROM qe_admin_data_20240307 t\n  WHERE t.\"FACILITY_ADDRESS1\" SIMILAR TO '[0-9]+'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Data Type Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'Invalid string of numbers found'\n      FROM valid_integer_alphanumeric_string_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'FACILITY_STATE' AS issue_column,\n           \"FACILITY_STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_STATE\" IS NULL\n        OR TRIM(CAST(\"FACILITY_STATE\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'FACILITY_STATE' AS issue_column,\n           \"FACILITY_STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_STATE\" NOT IN ('NY', 'New York')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''NY'', ''New York'')',\n           'Use only allowed values ''NY'', ''New York'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'FACILITY_ZIP' AS issue_column,\n           \"FACILITY_ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_ZIP\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ZIP\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'FACILITY_ZIP' AS issue_column,\n           \"FACILITY_ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE CAST(\"FACILITY_ZIP\" AS VARCHAR) NOT SIMILAR TO '^\\d{5}(\\d{4})?$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^\\d{5}(\\d{4})?$',\n           'Follow the pattern ^\\d{5}(\\d{4})?$ in ' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT 'VISIT_PART_2_FLAG' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_PART_2_FLAG\" IS NULL\n        OR TRIM(CAST(\"VISIT_PART_2_FLAG\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_PART_2_FLAG' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_PART_2_FLAG\" NOT IN ('Yes', 'No')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'', ''No'')',\n           'Use only allowed values ''Yes'', ''No'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'VISIT_OMH_FLAG' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_OMH_FLAG\" IS NULL\n        OR TRIM(CAST(\"VISIT_OMH_FLAG\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_OMH_FLAG' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_OMH_FLAG\" NOT IN ('Yes', 'No')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'', ''No'')',\n           'Use only allowed values ''Yes'', ''No'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'VISIT_OPWDD_FLAG' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_OPWDD_FLAG\" IS NULL\n        OR TRIM(CAST(\"VISIT_OPWDD_FLAG\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_OPWDD_FLAG' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_OPWDD_FLAG\" NOT IN ('Yes', 'No')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'', ''No'')',\n           'Use only allowed values ''Yes'', ''No'' in ' || issue_column\n      FROM allowed_values;\nWITH pattern AS (\n    SELECT 'FACILITY_LONG_NAME' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE CAST(\"FACILITY_LONG_NAME\" AS VARCHAR) NOT SIMILAR TO '^[a-zA-Z\\s]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           '767cb8df-3ec0-5b59-998e-a91e75be32b3',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[a-zA-Z\\s]+$',\n           'Follow the pattern ^[a-zA-Z\\s]+$ in ' || issue_column\n      FROM pattern;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7115f76c-32eb-563c-a1d5-040d0146651a', '52c6a395-5d83-4051-bb7c-39036f26ab29', '767cb8df-3ec0-5b59-998e-a91e75be32b3', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'QeAdminDataCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('26a2e6f5-6b62-5616-8b14-1059006f438b', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'd09ebe08-1b63-56d8-8f2b-8fff76c9828f', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'ScreeningCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n\nWITH mandatory_value AS (\n    SELECT 'PAT_MRN_ID' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(CAST(\"PAT_MRN_ID\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'FACILITY_ID' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ID\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_pat_mrn_id_across_all_three_tables AS (\n  WITH cte_qe_demographic_unmatched AS (\n      SELECT DISTINCT COALESCE(ad.PAT_MRN_ID, qe.PAT_MRN_ID) AS PAT_MRN_ID,\n              COALESCE(ad.FACILITY_ID, qe.FACILITY_ID) AS FACILITY_ID,\n                    CASE\n                        WHEN ad.PAT_MRN_ID IS NULL THEN 'QE_ADMIN_DATA'\n                        ELSE 'ADMIN_DEMOGRAPHIC'\n                    END AS unmatched_source,\n                    COALESCE(ad.src_file_row_number, qe.src_file_row_number) AS src_file_row_number,\n      FROM  admin_demographics_20240307 ad\n      FULL OUTER JOIN qe_admin_data_20240307 qe\n          ON ad.PAT_MRN_ID = qe.PAT_MRN_ID\n          AND ad.FACILITY_ID = qe.FACILITY_ID\n      WHERE ad.PAT_MRN_ID IS NULL OR qe.PAT_MRN_ID IS NULL\n  )\n  Select 'PAT_MRN_ID' AS issue_column, pat_mrn_id AS invalid_pat_value, FACILITY_ID AS invalid_facility_value, unmatched_source, src_file_row_number  AS issue_row,\n  case when unmatched_source = 'ADMIN_DEMOGRAPHIC' then 'admin_demographics_20240307'\n  when unmatched_source = 'QE_ADMIN_DATA' then 'qe_admin_data_20240307'\n  Else '' End As issue_table_name\n  from cte_qe_demographic_unmatched\n  UNION\n  Select DISTINCT 'PAT_MRN_ID' AS issue_column, s.PAT_MRN_ID AS invalid_pat_value,s.FACILITY_ID AS invalid_facility_value,'SCREENING' As unmatched_source, src_file_row_number  AS issue_row,\n  'screening_20240307' as issue_table_name\n  FROM screening_20240307 s\n    Left Outer Join (\n      SELECT  DISTINCT a.PAT_MRN_ID,a.FACILITY_ID From admin_demographics_20240307 a\n      Inner Join qe_admin_data_20240307 q\n      ON a.PAT_MRN_ID = q.PAT_MRN_ID\n      AND a.FACILITY_ID = q.FACILITY_ID\n      WHERE a.PAT_MRN_ID IS NOT NULL AND q.PAT_MRN_ID IS NOT NULL\n    ) aq\n    ON s.PAT_MRN_ID = aq.PAT_MRN_ID\n  AND aq.FACILITY_ID = s.FACILITY_ID\n  Where aq.PAT_MRN_ID IS  NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'PAT_MRN_ID that does not match the FACILITY_ID',\n           issue_row,\n           issue_column,\n           invalid_pat_value,\n           'PAT_MRN_ID (\"' || invalid_pat_value || '\") that does not match the FACILITY_ID (\"' || invalid_facility_value || '\") across the files was found in \"' || issue_table_name || '\".',\n           'Validate PAT_MRN_ID that maches the FACILITY_ID across the files'\n      FROM valid_pat_mrn_id_across_all_three_tables;\nWITH mandatory_value AS (\n    SELECT 'ENCOUNTER_CLASS_CODE' AS issue_column,\n           \"ENCOUNTER_CLASS_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_CLASS_CODE\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_CLASS_CODE\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_encounter_class_in_all_rows AS (\n    SELECT 'ENCOUNTER_CLASS_CODE' AS issue_column,\n           sr.\"ENCOUNTER_CLASS_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_class_reference ecr\n      ON UPPER(sr.ENCOUNTER_CLASS_CODE) = UPPER(ecr.Code)\n     WHERE sr.ENCOUNTER_CLASS_CODE IS NOT NULL\n      AND ecr.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid ENCOUNTER CLASS CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ENCOUNTER CLASS CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ENCOUNTER CLASS CODE with encounter class reference data'\n      FROM valid_encounter_class_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'ENCOUNTER_CLASS_CODE' AS issue_column,\n      tbl.\"ENCOUNTER_CLASS_CODE\" AS invalid_value,\n      tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_CLASS_CODE\" is not null\n  and tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Display\" FROM encounter_class_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_CLASS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The ENCOUNTER_CLASS_CODE \"' || invalid_value || '\" of ENCOUNTER_CLASS_CODE_DESCRIPTION \"' || dependent_value || '\" is not matching with the ENCOUNTER_CLASS_CODE of ENCOUNTER_CLASS_CODE_DESCRIPTION in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'ENCOUNTER_CLASS_CODE_DESCRIPTION' AS issue_column,\n      tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ENCOUNTER_CLASS_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" is not null\n  and tbl.\"ENCOUNTER_CLASS_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Code\" FROM encounter_class_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_CLASS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The ENCOUNTER_CLASS_CODE_DESCRIPTION \"' || invalid_value || '\" of ENCOUNTER_CLASS_CODE \"' || dependent_value || '\" is not matching with the ENCOUNTER_CLASS_CODE_DESCRIPTION of ENCOUNTER_CLASS_CODE in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'ENCOUNTER_CLASS_CODE_SYSTEM' AS issue_column,\n           \"ENCOUNTER_CLASS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_CLASS_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_CLASS_CODE_SYSTEM\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'ENCOUNTER_CLASS_CODE_SYSTEM' AS issue_column,\n           \"ENCOUNTER_CLASS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_CLASS_CODE_SYSTEM\" NOT IN ('http://terminology.hl7.org/CodeSystem/v3-ActCode')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''http://terminology.hl7.org/CodeSystem/v3-ActCode'')',\n           'Use only allowed values ''http://terminology.hl7.org/CodeSystem/v3-ActCode'' in ' || issue_column\n      FROM allowed_values;\nWITH valid_encounter_class_in_all_rows AS (\n    SELECT 'ENCOUNTER_CLASS_CODE_DESCRIPTION' AS issue_column,\n           sr.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_class_reference ecr\n      ON UPPER(sr.ENCOUNTER_CLASS_CODE_DESCRIPTION) = UPPER(ecr.Display)\n     WHERE sr.ENCOUNTER_CLASS_CODE_DESCRIPTION IS NOT NULL\n      AND ecr.Display IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid ENCOUNTER CLASS CODE DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ENCOUNTER CLASS CODE DESCRIPTION \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ENCOUNTER CLASS CODE DESCRIPTION with encounter class reference data'\n      FROM valid_encounter_class_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'ENCOUNTER_STATUS_CODE' AS issue_column,\n           \"ENCOUNTER_STATUS_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_STATUS_CODE\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_STATUS_CODE\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_encounter_status_code_in_all_rows AS (\n    SELECT 'ENCOUNTER_STATUS_CODE' AS issue_column,\n           sr.\"ENCOUNTER_STATUS_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_status_code_reference ecr\n      ON UPPER(sr.ENCOUNTER_STATUS_CODE) = UPPER(ecr.Code)\n     WHERE sr.ENCOUNTER_STATUS_CODE IS NOT NULL\n      AND ecr.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid ENCOUNTER STATUS CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ENCOUNTER STATUS CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ENCOUNTER STATUS CODE with encounter status reference data'\n      FROM valid_encounter_status_code_in_all_rows;\nWITH valid_encounter_status_code_in_all_rows AS (\n    SELECT 'ENCOUNTER_STATUS_CODE_DESCRIPTION' AS issue_column,\n           sr.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_status_code_reference ecr\n      ON UPPER(sr.ENCOUNTER_STATUS_CODE_DESCRIPTION) = UPPER(ecr.Display)\n     WHERE sr.ENCOUNTER_STATUS_CODE_DESCRIPTION IS NOT NULL\n      AND ecr.Display IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid ENCOUNTER STATUS CODE DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ENCOUNTER STATUS CODE DESCRIPTION \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ENCOUNTER STATUS CODE DESCRIPTION with encounter status reference data'\n      FROM valid_encounter_status_code_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'ENCOUNTER_STATUS_CODE' AS issue_column,\n      tbl.\"ENCOUNTER_STATUS_CODE\" AS invalid_value,\n      tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_STATUS_CODE\" is not null\n  and tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Display\" FROM encounter_status_code_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_STATUS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The ENCOUNTER_STATUS_CODE \"' || invalid_value || '\" of ENCOUNTER_STATUS_CODE_DESCRIPTION \"' || dependent_value || '\" is not matching with the ENCOUNTER_STATUS_CODE of ENCOUNTER_STATUS_CODE_DESCRIPTION in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'ENCOUNTER_STATUS_CODE_DESCRIPTION' AS issue_column,\n      tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ENCOUNTER_STATUS_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" is not null\n  and tbl.\"ENCOUNTER_STATUS_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Code\" FROM encounter_status_code_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_STATUS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The ENCOUNTER_STATUS_CODE_DESCRIPTION \"' || invalid_value || '\" of ENCOUNTER_STATUS_CODE \"' || dependent_value || '\" is not matching with the ENCOUNTER_STATUS_CODE_DESCRIPTION of ENCOUNTER_STATUS_CODE in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'ENCOUNTER_STATUS_CODE_SYSTEM' AS issue_column,\n           \"ENCOUNTER_STATUS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_STATUS_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_STATUS_CODE_SYSTEM\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'ENCOUNTER_STATUS_CODE_SYSTEM' AS issue_column,\n           \"ENCOUNTER_STATUS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_STATUS_CODE_SYSTEM\" NOT IN ('http://hl7.org/fhir/encounter-status')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''http://hl7.org/fhir/encounter-status'')',\n           'Use only allowed values ''http://hl7.org/fhir/encounter-status'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'ENCOUNTER_TYPE_CODE' AS issue_column,\n           \"ENCOUNTER_TYPE_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_TYPE_CODE\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_TYPE_CODE\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'ENCOUNTER_TYPE_CODE_SYSTEM' AS issue_column,\n           \"ENCOUNTER_TYPE_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_TYPE_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_TYPE_CODE_SYSTEM\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_encounter_type_code_in_all_rows AS (\n    SELECT 'ENCOUNTER_TYPE_CODE' AS issue_column,\n           sr.\"ENCOUNTER_TYPE_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_type_code_reference ecr\n      ON UPPER(CAST(sr.ENCOUNTER_TYPE_CODE AS VARCHAR)) = UPPER(CAST(ecr.Code AS VARCHAR))\n     WHERE sr.ENCOUNTER_TYPE_CODE IS NOT NULL\n      AND ecr.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid ENCOUNTER TYPE CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ENCOUNTER TYPE CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ENCOUNTER TYPE CODE with encounter type reference data'\n      FROM valid_encounter_type_code_in_all_rows;\nWITH allowed_values AS (\n    SELECT 'ENCOUNTER_TYPE_CODE_SYSTEM' AS issue_column,\n           \"ENCOUNTER_TYPE_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_TYPE_CODE_SYSTEM\" NOT IN ('SNOMED-CT', 'SNOMED', 'http://snomed.info/sct')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''SNOMED-CT'', ''SNOMED'', ''http://snomed.info/sct'')',\n           'Use only allowed values ''SNOMED-CT'', ''SNOMED'', ''http://snomed.info/sct'' in ' || issue_column\n      FROM allowed_values;\nWITH valid_encounter_type_code_in_all_rows AS (\n    SELECT 'ENCOUNTER_TYPE_CODE_DESCRIPTION' AS issue_column,\n           sr.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_type_code_reference ecr\n      ON UPPER(CAST(sr.ENCOUNTER_TYPE_CODE_DESCRIPTION AS VARCHAR)) = UPPER(CAST(ecr.Display AS VARCHAR))\n     WHERE sr.ENCOUNTER_TYPE_CODE_DESCRIPTION IS NOT NULL\n      AND ecr.Display IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid ENCOUNTER TYPE CODE DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ENCOUNTER TYPE CODE DESCRIPTION \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ENCOUNTER TYPE CODE DESCRIPTION with encounter type reference data'\n      FROM valid_encounter_type_code_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'ENCOUNTER_TYPE_CODE' AS issue_column,\n      tbl.\"ENCOUNTER_TYPE_CODE\" AS invalid_value,\n      tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_TYPE_CODE\" is not null\n  and tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Display\" FROM encounter_type_code_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_TYPE_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The ENCOUNTER_TYPE_CODE \"' || invalid_value || '\" of ENCOUNTER_TYPE_CODE_DESCRIPTION \"' || dependent_value || '\" is not matching with the ENCOUNTER_TYPE_CODE of ENCOUNTER_TYPE_CODE_DESCRIPTION in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'ENCOUNTER_TYPE_CODE_DESCRIPTION' AS issue_column,\n      tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ENCOUNTER_TYPE_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" is not null\n  and tbl.\"ENCOUNTER_TYPE_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Code\" FROM encounter_type_code_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_TYPE_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The ENCOUNTER_TYPE_CODE_DESCRIPTION \"' || invalid_value || '\" of ENCOUNTER_TYPE_CODE \"' || dependent_value || '\" is not matching with the ENCOUNTER_TYPE_CODE_DESCRIPTION of ENCOUNTER_TYPE_CODE in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'SCREENING_STATUS_CODE' AS issue_column,\n           \"SCREENING_STATUS_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_STATUS_CODE\" IS NULL\n        OR TRIM(CAST(\"SCREENING_STATUS_CODE\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_screening_status_code_in_all_rows AS (\n    SELECT 'SCREENING_STATUS_CODE' AS issue_column,\n           sr.\"SCREENING_STATUS_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN screening_status_code_reference ref\n      ON UPPER(sr.SCREENING_STATUS_CODE) = UPPER(ref.Code)\n     WHERE sr.SCREENING_STATUS_CODE IS NOT NULL\n      AND ref.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid SCREENING STATUS CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid SCREENING STATUS CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate SCREENING STATUS CODE with screening status code reference data'\n      FROM valid_screening_status_code_in_all_rows;\nWITH valid_screening_status_code_in_all_rows AS (\n    SELECT 'SCREENING_STATUS_CODE_DESCRIPTION' AS issue_column,\n           sr.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN screening_status_code_reference ecr\n      ON UPPER(sr.SCREENING_STATUS_CODE_DESCRIPTION) = UPPER(ecr.Display)\n     WHERE sr.SCREENING_STATUS_CODE_DESCRIPTION IS NOT NULL\n      AND ecr.Display IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid SCREENING STATUS CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid SCREENING STATUS CODE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate SCREENING STATUS CODE with screening status code reference data'\n      FROM valid_screening_status_code_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'SCREENING_STATUS_CODE' AS issue_column,\n      tbl.\"SCREENING_STATUS_CODE\" AS invalid_value,\n      tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"SCREENING_STATUS_CODE\" is not null\n  and tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Display\" FROM screening_status_code_reference WHERE UPPER(CAST(tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SCREENING_STATUS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The SCREENING_STATUS_CODE \"' || invalid_value || '\" of SCREENING_STATUS_CODE_DESCRIPTION \"' || dependent_value || '\" is not matching with the SCREENING_STATUS_CODE of SCREENING_STATUS_CODE_DESCRIPTION in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t'SCREENING_STATUS_CODE_DESCRIPTION' AS issue_column,\n      tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"SCREENING_STATUS_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" is not null\n  and tbl.\"SCREENING_STATUS_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Code\" FROM screening_status_code_reference WHERE UPPER(CAST(tbl.\"SCREENING_STATUS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Combination Not Matching',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid value \"' || invalid_value || '\" found in ' || issue_column,\n           'The SCREENING_STATUS_CODE_DESCRIPTION \"' || invalid_value || '\" of SCREENING_STATUS_CODE \"' || dependent_value || '\" is not matching with the SCREENING_STATUS_CODE_DESCRIPTION of SCREENING_STATUS_CODE in reference data'\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'SCREENING_STATUS_CODE_SYSTEM' AS issue_column,\n           \"SCREENING_STATUS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_STATUS_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"SCREENING_STATUS_CODE_SYSTEM\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'SCREENING_STATUS_CODE_SYSTEM' AS issue_column,\n           \"SCREENING_STATUS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_STATUS_CODE_SYSTEM\" NOT IN ('http://hl7.org/fhir/observation-status')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''http://hl7.org/fhir/observation-status'')',\n           'Use only allowed values ''http://hl7.org/fhir/observation-status'' in ' || issue_column\n      FROM allowed_values;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  'ANSWER_CODE' AS issue_column,\n              \"ANSWER_CODE\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (ANSWER_CODE IS NULL OR TRIM(\"ANSWER_CODE\") = '')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN ('TOTAL SAFETY SCORE',\n            'CALCULATED WEEKLY PHYSICAL ACTIVITY',\n            'CALCULATED MENTAL HEALTH SCORE')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid value in ANSWER_CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field \"' || issue_column || '\" is empty',\n           'The required field value ANSWER_CODE is missing'\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  'ANSWER_CODE_SYSTEM_NAME' AS issue_column,\n              \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (ANSWER_CODE_SYSTEM_NAME IS NULL OR TRIM(\"ANSWER_CODE_SYSTEM_NAME\") = '')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN ('TOTAL SAFETY SCORE',\n            'CALCULATED WEEKLY PHYSICAL ACTIVITY',\n            'CALCULATED MENTAL HEALTH SCORE')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid value in ANSWER_CODE_SYSTEM_NAME',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field \"' || issue_column || '\" is empty',\n           'The required field value ANSWER_CODE_SYSTEM_NAME is missing'\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  'QUESTION_CODE' AS issue_column,\n              \"QUESTION_CODE\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (QUESTION_CODE IS NULL OR TRIM(\"QUESTION_CODE\") = '')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN ('TOTAL SAFETY SCORE',\n            'CALCULATED WEEKLY PHYSICAL ACTIVITY',\n            'CALCULATED MENTAL HEALTH SCORE')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid value in QUESTION_CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field \"' || issue_column || '\" is empty',\n           'The required field value QUESTION_CODE is missing'\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  'QUESTION_CODE_SYSTEM_NAME' AS issue_column,\n              \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (QUESTION_CODE_SYSTEM_NAME IS NULL OR TRIM(\"QUESTION_CODE_SYSTEM_NAME\") = '')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN ('TOTAL SAFETY SCORE',\n            'CALCULATED WEEKLY PHYSICAL ACTIVITY',\n            'CALCULATED MENTAL HEALTH SCORE')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid value in QUESTION_CODE_SYSTEM_NAME',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field \"' || issue_column || '\" is empty',\n           'The required field value QUESTION_CODE_SYSTEM_NAME is missing'\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  'SCREENING_CODE_DESCRIPTION' AS issue_column,\n              \"SCREENING_CODE_DESCRIPTION\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (SCREENING_CODE_DESCRIPTION IS NULL OR TRIM(\"SCREENING_CODE_DESCRIPTION\") = '')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN ('TOTAL SAFETY SCORE',\n            'CALCULATED WEEKLY PHYSICAL ACTIVITY',\n            'CALCULATED MENTAL HEALTH SCORE')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid value in SCREENING_CODE_DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field \"' || issue_column || '\" is empty',\n           'The required field value SCREENING_CODE_DESCRIPTION is missing'\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH allowed_values AS (\n    SELECT 'SCREENING_CODE_DESCRIPTION' AS issue_column,\n           \"SCREENING_CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_CODE_DESCRIPTION\" NOT IN ('Accountable health communities (AHC) health-related social needs (HRSN) supplemental questions','Accountable health communities (AHC) health-related social needs screening (HRSN) tool')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Accountable health communities (AHC) health-related social needs (HRSN) supplemental questions'',''Accountable health communities (AHC) health-related social needs screening (HRSN) tool'')',\n           'Use only allowed values ''Accountable health communities (AHC) health-related social needs (HRSN) supplemental questions'',''Accountable health communities (AHC) health-related social needs screening (HRSN) tool'' in ' || issue_column\n      FROM allowed_values;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  'SCREENING_CODE_SYSTEM_NAME' AS issue_column,\n              \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (SCREENING_CODE_SYSTEM_NAME IS NULL OR TRIM(\"SCREENING_CODE_SYSTEM_NAME\") = '')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN ('TOTAL SAFETY SCORE',\n            'CALCULATED WEEKLY PHYSICAL ACTIVITY',\n            'CALCULATED MENTAL HEALTH SCORE')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid value in SCREENING_CODE_SYSTEM_NAME',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field \"' || issue_column || '\" is empty',\n           'The required field value SCREENING_CODE_SYSTEM_NAME is missing'\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  'SCREENING_CODE' AS issue_column,\n              \"SCREENING_CODE\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (SCREENING_CODE IS NULL OR TRIM(\"SCREENING_CODE\") = '')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN ('TOTAL SAFETY SCORE',\n            'CALCULATED WEEKLY PHYSICAL ACTIVITY',\n            'CALCULATED MENTAL HEALTH SCORE')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid value in SCREENING_CODE',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field \"' || issue_column || '\" is empty',\n           'The required field value SCREENING_CODE is missing'\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'QUESTION_CODE_DESCRIPTION' AS issue_column,\n           \"QUESTION_CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"QUESTION_CODE_DESCRIPTION\" IS NULL\n        OR TRIM(CAST(\"QUESTION_CODE_DESCRIPTION\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_answer_code_in_all_rows AS (\n  SELECT 'ANSWER_CODE' AS issue_column,\n    scr.\"ANSWER_CODE\" AS invalid_value,\n    scr.\"QUESTION_CODE\" AS invalid_question_value,\n    scr.SCREENING_CODE AS invalid_screening_value,\n    scr.src_file_row_number AS issue_row\n    FROM screening_20240307 scr\n    LEFT OUTER JOIN ahc_cross_walk crw\n      ON UPPER(scr.SCREENING_CODE) = UPPER(crw.SCREENING_CODE)\n      AND UPPER(scr.QUESTION_CODE) = UPPER(crw.QUESTION_CODE)\n      AND UPPER(scr.ANSWER_CODE) = UPPER(crw.ANSWER_CODE)\n    WHERE scr.SCREENING_CODE IS NOT NULL\n      AND scr.QUESTION_CODE IS NOT NULL\n      AND scr.ANSWER_CODE IS NOT NULL\n      AND crw.ANSWER_CODE IS NULL\n)\n\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Answer Code',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Provided Screening Code \"' || invalid_screening_value || '\", Question Code \"' || invalid_question_value || '\" and Answer Code \"' || invalid_value || '\" are not matching with the reference data found in ' || issue_column,\n           'Validate Screening Code, Question Code and Answer Code with ahc cross walk reference data'\n      FROM valid_answer_code_in_all_rows;\nWITH valid_total_safety_score_in_all_rows AS (\n  WITH cte_score AS (\n    SELECT\n        SUM(crw.Score) AS cross_walk_Score,\n        SUM(\n            CASE\n                WHEN UPPER(TRIM(scr.QUESTION_CODE_DESCRIPTION)) LIKE '%TOTAL SAFETY SCORE%' AND TRY_CAST(scr.ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL THEN CAST(scr.ANSWER_CODE_DESCRIPTION AS INTEGER)\n                ELSE 0\n            END\n        ) AS screening_score\n    FROM\n        screening_20240307 scr\n    LEFT OUTER JOIN (\n        SELECT \tacw.SCREENING_CODE,\n              acw.QUESTION_CODE,\n              acw.ANSWER_CODE,\n              acw.QUESTION_SLNO,\n              acw.Score AS Score\n        FROM ahc_cross_walk acw\n        Where QUESTION_SLNO_REFERENCE In(\n        SELECT QUESTION_SLNO\n            FROM ahc_cross_walk\n            WHERE UPPER(TRIM(QUESTION)) LIKE '%TOTAL SAFETY SCORE%'\n            )\n        AND acw.QUESTION_CODE = scr.QUESTION_CODE\n        AND acw.ANSWER_CODE = scr.ANSWER_CODE\n    ) AS crw ON crw.SCREENING_CODE = scr.SCREENING_CODE\n)\nSELECT \tcross_walk_Score,\n    screening_score AS invalid_value,\n    (SELECT src_file_row_number FROM screening_20240307 WHERE UPPER(TRIM(QUESTION_CODE_DESCRIPTION)) LIKE '%TOTAL SAFETY SCORE%') AS issue_row,\n  'ANSWER_CODE_DESCRIPTION' AS issue_column\nFROM cte_score\nWHERE screening_score <> cross_walk_Score\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid ANSWER_CODE_DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ANSWER_CODE_DESCRIPTION for TOTAL SAFETY SCORE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ANSWER_CODE_DESCRIPTION for TOTAL SAFETY SCORE (Calculated Score)'\n      FROM valid_total_safety_score_in_all_rows;\nWITH valid_calculated_mental_health_score_in_all_rows AS (\n  SELECT ANSWER_CODE_DESCRIPTION AS issue_column,\n  SCREENING_CALCULATED_SCORE AS invalid_value,\n  SRC_FILE_ROW_NUMBER AS issue_row\n  FROM\n  (\n  SELECT Sum(crw.score) As CROSSWALK_ANSWER_SCORE,\n      (SELECT CASE WHEN TRY_CAST(ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL THEN CAST(ANSWER_CODE_DESCRIPTION AS INTEGER) ELSE 0 END AS SCREENING_CALC_SCORE\n        FROM screening_20240307 scr2\n        WHERE UPPER(scr2.QUESTION_CODE_DESCRIPTION) LIKE '%CALCULATED MENTAL HEALTH SCORE%'\n    ) AS SCREENING_CALCULATED_SCORE,\n    (SELECT src_file_row_number FROM screening_20240307 WHERE UPPER(QUESTION_CODE_DESCRIPTION) LIKE '%CALCULATED MENTAL HEALTH SCORE%') AS SRC_FILE_ROW_NUMBER,\n    'ANSWER_CODE_DESCRIPTION' AS ANSWER_CODE_DESCRIPTION\n      FROM screening_20240307 scr\n      INNER JOIN (\n          SELECT \tacw.score As SCORE\n          FROM ahc_cross_walk acw\n          Where QUESTION_SLNO_REFERENCE In(\n          SELECT QUESTION_SLNO\n              FROM ahc_cross_walk\n              WHERE UPPER(QUESTION) LIKE '%CALCULATED MENTAL HEALTH SCORE%'\n              )\n          AND acw.QUESTION_CODE = scr.QUESTION_CODE\n          AND acw.ANSWER_CODE  = scr.ANSWER_CODE\n      ) AS crw ON 1 = 1\n  ) As calc_fld_val\n  Where calc_fld_val.CROSSWALK_ANSWER_SCORE <> calc_fld_val.SCREENING_CALCULATED_SCORE\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid ANSWER_CODE_DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ANSWER_CODE_DESCRIPTION for CALCULATED MENTAL HEALTH SCORE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ANSWER_CODE_DESCRIPTION for CALCULATED MENTAL HEALTH SCORE (Calculated Score)'\n      FROM valid_calculated_mental_health_score_in_all_rows;\nWITH valid_calculated_weekly_physical_activity_score_in_all_rows AS (\n  WITH cte_physical_activity AS (\n    SELECT\n      scr.SCREENING_CODE,\n      scr.QUESTION_CODE,\n      scr.ANSWER_CODE,\n      crw.ANSWER_VALUE,\n      scr.ANSWER_CODE_DESCRIPTION,\n      ROW_NUMBER() OVER (\n      ORDER BY scr.SCREENING_CODE) AS sequence_number\n    FROM\n      screening_20240307 scr\n    INNER JOIN (\n      SELECT\n        acw.SCREENING_CODE,\n        acw.QUESTION_CODE,\n        acw.ANSWER_CODE,\n        acw.QUESTION_SLNO,\n        CASE\n          WHEN TRY_CAST(acw.ANSWER_VALUE AS INTEGER) IS NOT NULL THEN CAST(acw.ANSWER_VALUE AS INTEGER)\n          ELSE CASE WHEN acw.ANSWER_CODE='LA32060-8' THEN 150 ELSE 0 END\n        END AS ANSWER_VALUE\n      FROM\n        ahc_cross_walk acw\n      Where\n        QUESTION_SLNO_REFERENCE In(\n        SELECT\n          QUESTION_SLNO\n        FROM\n          ahc_cross_walk\n        WHERE\n          UPPER(QUESTION) LIKE '%CALCULATED PHYSICAL ACTIVITY SCORE%'\n                )\n        AND acw.QUESTION_CODE = scr.QUESTION_CODE\n        AND acw.ANSWER_CODE = scr.ANSWER_CODE\n        ) AS crw ON\n      crw.SCREENING_CODE = scr.SCREENING_CODE\n    )\n    Select \tANSWER_CODE_DESCRIPTION AS issue_column,\n        CROSSWALK_ANSWER_VALUE AS CROSSWALK_ANSWER_VALUE,\n        SCREENING_CALCULATED_VALUE AS invalid_value,\n        SRC_FILE_ROW_NUMBER AS issue_row\n    FROM\n      (\n      Select\n        t1.ANSWER_VALUE * t2.ANSWER_VALUE As CROSSWALK_ANSWER_VALUE,\n        CASE\n          WHEN TRY_CAST(t1.ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL\n            AND TRY_CAST(t2.ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL THEN\n        CAST(t1.ANSWER_CODE_DESCRIPTION AS INTEGER) * CAST(t2.ANSWER_CODE_DESCRIPTION AS INTEGER)\n          ELSE CASE WHEN t2.ANSWER_CODE='LA32060-8' THEN 150 * CAST(t1.ANSWER_CODE_DESCRIPTION AS INTEGER) ELSE 0 END\n          END AS SCREENING_ANSWER_VALUE,\n          Scrn_Phycical_Act_Score.SCRN_PHYSICAL_ACTIVITY_VALUE AS SCREENING_CALCULATED_VALUE,\n          (SELECT src_file_row_number FROM screening_20240307 WHERE UPPER(QUESTION_CODE_DESCRIPTION) LIKE '%CALCULATED WEEKLY PHYSICAL ACTIVITY%') AS SRC_FILE_ROW_NUMBER,\n          'ANSWER_CODE_DESCRIPTION' AS ANSWER_CODE_DESCRIPTION\n\n        from\n          cte_physical_activity t1\n        Inner Join cte_physical_activity t2\n    On\n          t1.sequence_number = 1\n          and t2.sequence_number = 2\n        Left Outer Join (\n          Select\n            CASE\n              WHEN TRY_CAST(ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL THEN CAST(ANSWER_CODE_DESCRIPTION AS INTEGER)\n              ELSE 0\n            END SCRN_PHYSICAL_ACTIVITY_VALUE\n          From\n          screening_20240307 scr\n          Where\n            UPPER(scr.QUESTION_CODE_DESCRIPTION) LIKE '%CALCULATED WEEKLY PHYSICAL ACTIVITY%') AS Scrn_Phycical_Act_Score\n                On\n          1 = 1\n    ) As calc_fld\n    Where\n      (calc_fld.CROSSWALK_ANSWER_VALUE <> calc_fld.SCREENING_ANSWER_VALUE)\n      OR (calc_fld.SCREENING_ANSWER_VALUE <> calc_fld.SCREENING_CALCULATED_VALUE)\n      OR (calc_fld.CROSSWALK_ANSWER_VALUE <> calc_fld.SCREENING_CALCULATED_VALUE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid ANSWER_CODE_DESCRIPTION',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid ANSWER_CODE_DESCRIPTION for CALCULATED PHYSICAL ACTIVITY SCORE \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate ANSWER_CODE_DESCRIPTION for CALCULATED PHYSICAL ACTIVITY SCORE (Calculated Score)'\n      FROM valid_calculated_weekly_physical_activity_score_in_all_rows;\nWITH allowed_values AS (\n    SELECT 'SCREENING_CODE' AS issue_column,\n           \"SCREENING_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_CODE\" NOT IN ('96777-8', '97023-6')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''96777-8'', ''97023-6'')',\n           'Use only allowed values ''96777-8'', ''97023-6'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'SCREENING_CODE_SYSTEM_NAME' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" NOT IN ('LN', 'LOINC', 'http://loinc.org')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''LN'', ''LOINC'', ''http://loinc.org'')',\n           'Use only allowed values ''LN'', ''LOINC'', ''http://loinc.org'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'RECORDED_TIME' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"RECORDED_TIME\" IS NULL\n        OR TRIM(CAST(\"RECORDED_TIME\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_date_time_in_all_rows AS (\n        SELECT  'RECORDED_TIME' AS issue_column,\n              \"RECORDED_TIME\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM \"screening_20240307\"\n        WHERE \"RECORDED_TIME\" IS NOT NULL\n        AND \"RECORDED_TIME\" NOT SIMILAR TO '([0-9]([0-9]([0-9][1-9]|[1-9]0)|[1-9]00)|[1-9]000)-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])T([01][0-9]|2[0-3]):[0-5][0-9]:([0-5][0-9]|60)(\\.[0-9]+)?(Z|(\\+|-)((0[0-9]|1[0-3]):[0-5][0-9]|14:00))$'\n        OR TRY_CAST(\"RECORDED_TIME\" AS TIMESTAMP) IS NULL\n  )\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Date',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid timestamp \"' || invalid_value || '\" found in ' || issue_column,\n           'Please be sure to provide both a valid date and time.'\n      FROM valid_date_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'SDOH_DOMAIN' AS issue_column,\n           \"SDOH_DOMAIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SDOH_DOMAIN\" IS NULL\n        OR TRIM(CAST(\"SDOH_DOMAIN\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_sdoh_domain_in_all_rows AS (\n  SELECT DISTINCT scr.SDOH_DOMAIN AS invalid_value,\n    'SDOH_DOMAIN' AS issue_column,\n    scr.src_file_row_number AS issue_row\n  FROM screening_20240307 scr\n  LEFT JOIN ahc_cross_walk cw\n  ON UPPER(scr.SDOH_DOMAIN) = UPPER(cw.SDOH_DOMAIN)\n  WHERE cw.SDOH_DOMAIN IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid SDOH DOMAIN',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid SDOH DOMAIN \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate SDOH DOMAIN with ahc cross walk reference data'\n      FROM valid_sdoh_domain_in_all_rows;\nWITH valid_question_code_for_screening_code_in_all_rows AS (\n  SELECT DISTINCT scr.SCREENING_CODE AS issue_screening_value, scr.QUESTION_CODE AS invalid_value, 'QUESTION_CODE' AS issue_column, scr.src_file_row_number AS issue_row\n  FROM screening_20240307 scr\n  LEFT JOIN ahc_cross_walk cw ON UPPER(scr.QUESTION_CODE) = UPPER(cw.QUESTION_CODE)\n  AND UPPER(scr.SCREENING_CODE) = UPPER(cw.SCREENING_CODE)\n  WHERE cw.QUESTION_CODE IS NULL\n  AND cw.SCREENING_CODE IS NOT NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Question Code',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid Question Code \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate Question Code with ahc cross walk reference data'\n      FROM valid_question_code_for_screening_code_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'ANSWER_CODE_DESCRIPTION' AS issue_column,\n           \"ANSWER_CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ANSWER_CODE_DESCRIPTION\" IS NULL\n        OR TRIM(CAST(\"ANSWER_CODE_DESCRIPTION\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'QUESTION_CODE_SYSTEM_NAME' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" NOT IN ('LN','LOINC','http://loinc.org')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''LN'',''LOINC'',''http://loinc.org'')',\n           'Use only allowed values ''LN'',''LOINC'',''http://loinc.org'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'ANSWER_CODE_SYSTEM_NAME' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" NOT IN ('LN','LOINC','http://loinc.org')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''LN'',''LOINC'',''http://loinc.org'')',\n           'Use only allowed values ''LN'',''LOINC'',''http://loinc.org'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'POTENTIAL_NEED_INDICATED' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" IS NULL\n        OR TRIM(CAST(\"POTENTIAL_NEED_INDICATED\" AS VARCHAR)) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'POTENTIAL_NEED_INDICATED' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" NOT IN ('Yes','No','NA','yes','no','na')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'',''No'',''NA'',''yes'',''no'',''na'')',\n           'Use only allowed values ''Yes'',''No'',''NA'',''yes'',''no'',''na'' in ' || issue_column\n      FROM allowed_values;\nWITH valid_screening_potential_need_indicated_question_answer_values_in_all_rows AS (\n  SELECT  'POTENTIAL_NEED_INDICATED' AS issue_column,\n          coalesce(scr.\"POTENTIAL_NEED_INDICATED\",'NULL') AS invalid_value,\n          scr.ANSWER_CODE AS invalid_answer_value,\n          scr.QUESTION_CODE AS invalid_question_value,\n          scr.SCREENING_CODE AS invalid_screening_value,\n          scr.src_file_row_number AS issue_row\n  FROM screening_20240307 scr\n  LEFT JOIN ahc_cross_walk acw\n    ON UPPER(scr.SCREENING_CODE) = UPPER(acw.SCREENING_CODE)\n    AND UPPER(scr.QUESTION_CODE) = UPPER(acw.QUESTION_CODE)\n    AND UPPER(scr.ANSWER_CODE) = UPPER(acw.ANSWER_CODE)\n    AND UPPER(scr.\"POTENTIAL_NEED_INDICATED\") = UPPER(acw.\"POTENTIAL_NEED_INDICATED\")\n  WHERE acw.\"POTENTIAL_NEED_INDICATED\" IS NULL\n  AND  UPPER(scr.QUESTION_CODE_DESCRIPTION)\n  NOT IN(\n    'TOTAL SAFETY SCORE',\n    'CALCULATED WEEKLY PHYSICAL ACTIVITY',\n    'CALCULATED MENTAL HEALTH SCORE'\n  )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '52c6a395-5d83-4051-bb7c-39036f26ab29',\n           'd09ebe08-1b63-56d8-8f2b-8fff76c9828f',\n           'Invalid value in POTENTIAL_NEED_INDICATED',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Provided Potential Need Indicated \"' || invalid_value || '\", Screening Code \"' || invalid_screening_value || '\", Question Code \"' || invalid_question_value || '\" and Answer Code \"' || invalid_answer_value || '\" are not matching with the reference data found in ' || issue_column,\n           'Validate Potential Need Indicated, Screening Code, Question Code and Answer Code with ahc cross walk reference data'\n      FROM valid_screening_potential_need_indicated_question_answer_values_in_all_rows;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('c50d9d2d-753b-5200-b2f6-e63309cf252d', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'd09ebe08-1b63-56d8-8f2b-8fff76c9828f', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'ScreeningCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('463a01b7-82ad-5633-939d-54a554d09923', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b9aac8ec-792a-511d-8107-25bd96085898', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'AhcCrossWalkCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('98f79424-a291-554e-aa6a-17c4c39e5c81', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b9aac8ec-792a-511d-8107-25bd96085898', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'AhcCrossWalkCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('1e8926d1-43b1-5485-9308-7addd10605ab', '52c6a395-5d83-4051-bb7c-39036f26ab29', '48eb0055-f06e-57f4-8019-f49266be3d22', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'EncounterClassReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('a76151ab-e619-51bb-9db7-57c686404756', '52c6a395-5d83-4051-bb7c-39036f26ab29', '48eb0055-f06e-57f4-8019-f49266be3d22', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'EncounterClassReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('81a8b5c0-5c79-5ff9-95d6-cfcf0749c550', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2e9c77e9-a664-5323-83e4-e6a92cf998ab', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'EncounterStatusCodeReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('731b9b5d-fbb0-541f-93bc-11778098ab71', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2e9c77e9-a664-5323-83e4-e6a92cf998ab', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'EncounterStatusCodeReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('2af573ce-4941-56c1-a703-f92928ad3a7d', '52c6a395-5d83-4051-bb7c-39036f26ab29', '4b3dd9ab-d81b-509a-9662-68dbd6d142f7', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'EncounterTypeCodeReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('8fe71cea-8904-5ba0-823d-de9955eee28d', '52c6a395-5d83-4051-bb7c-39036f26ab29', '4b3dd9ab-d81b-509a-9662-68dbd6d142f7', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'EncounterTypeCodeReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('b7082a36-d569-5f54-b0fe-23dfaca90466', '52c6a395-5d83-4051-bb7c-39036f26ab29', '1a152daa-273d-5411-88cf-84067822a8aa', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7d4a917b-2900-5b12-a89c-a246a342b27b', '52c6a395-5d83-4051-bb7c-39036f26ab29', '1a152daa-273d-5411-88cf-84067822a8aa', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('de2853a4-d787-5e6d-ba4c-58a0cd667eac', '52c6a395-5d83-4051-bb7c-39036f26ab29', '787ee7ff-3ef5-59aa-a055-659cf10b6202', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'GenderIdentityReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('51873a08-9517-54b6-982b-38b5e08677b8', '52c6a395-5d83-4051-bb7c-39036f26ab29', '787ee7ff-3ef5-59aa-a055-659cf10b6202', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'GenderIdentityReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('bd4d7db3-4490-5a2f-8b54-876cd96bb629', '52c6a395-5d83-4051-bb7c-39036f26ab29', '79f3d60e-c863-5759-8043-f122175a7cbb', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'AdministrativeSexReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('e6b6e4b0-6fdd-5d2b-a626-801aaaa4967f', '52c6a395-5d83-4051-bb7c-39036f26ab29', '79f3d60e-c863-5759-8043-f122175a7cbb', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'AdministrativeSexReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7b22a848-5153-5975-b74e-e9c3ea06640c', '52c6a395-5d83-4051-bb7c-39036f26ab29', '6c2d9879-7393-524d-9e9e-02ea961aca39', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'SexAtBirthReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('8a53e502-4b61-5596-88d5-e2e23a907935', '52c6a395-5d83-4051-bb7c-39036f26ab29', '6c2d9879-7393-524d-9e9e-02ea961aca39', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'SexAtBirthReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('0ab7227d-471c-5f13-9630-7f3c0c6cd120', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2239dca2-9dd4-5c3a-91c8-2585839b9584', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'SexualOrientationReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('63af23ca-ea46-53d2-a55c-459cb2419b54', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2239dca2-9dd4-5c3a-91c8-2585839b9584', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'SexualOrientationReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('41f3b3f2-2670-5600-96ca-a39e21943a0a', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'fc740f9e-863e-5dd1-b1a1-86d176cb549c', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'BusinessRulesReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('2bb73de9-1a11-58ac-bcda-74d30c2ace8e', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'fc740f9e-863e-5dd1-b1a1-86d176cb549c', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'BusinessRulesReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('baac722a-6a3b-5494-9df5-91e63f8c22b0', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f98a88dc-a929-5a9b-906a-277e62c93012', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'RaceReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('312774c2-4ed4-526a-a68c-64356a89466d', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f98a88dc-a929-5a9b-906a-277e62c93012', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'RaceReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('6cf18abf-2b0d-5ec5-9b5e-2a7e81d0bcc3', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b0cbca95-5c20-5b2b-b589-9e832c556bc6', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'EthnicityReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('66d2dfbd-511a-58c0-9092-fd1965efbe27', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b0cbca95-5c20-5b2b-b589-9e832c556bc6', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'EthnicityReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('905ccf58-6d99-5787-97b2-2534a35e55d6', '52c6a395-5d83-4051-bb7c-39036f26ab29', '3469db42-0066-5f23-9ee4-2b857bf339a4', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'PreferredLanguageReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('96ffe5ed-2b40-5e9b-8e13-a60d66430ceb', '52c6a395-5d83-4051-bb7c-39036f26ab29', '3469db42-0066-5f23-9ee4-2b857bf339a4', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'PreferredLanguageReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('83c7e8ef-bc1c-5726-a3f1-46ec9c63a4df', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f19d5ebb-ea63-5b1d-b1b1-758457a2da29', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'SdohDomainReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('aae34d6f-c822-51b7-b05a-b06cb3774a0f', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f19d5ebb-ea63-5b1d-b1b1-758457a2da29', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'SdohDomainReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \n```\nNo STDOUT emitted by `ensureContent` (status: `0`).\n\nNo STDERR emitted by `ensureContent`.\n\n    "}},{"insertable":{"exec_identity":"emitResources","exec_code":"duckdb HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.workflow/ingestion-center.duckdb","sql":"-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('52196f78-69f4-585b-92cd-8c8ae034bd56', '52c6a395-5d83-4051-bb7c-39036f26ab29', NULL, 'NONE', 'ENTER(prepareInit)', NULL, 'rsEE.beforeCell', ('2024-05-03T10:18:41.940Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('9c7a9deb-310c-56b5-bcaf-a15c8364fd30', '52c6a395-5d83-4051-bb7c-39036f26ab29', NULL, 'EXIT(prepareInit)', 'ENTER(init)', NULL, 'rsEE.afterCell', ('2024-05-03T10:18:41.940Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('a55e9808-8c5b-5dbd-87fb-4b555db691b0', '52c6a395-5d83-4051-bb7c-39036f26ab29', NULL, 'EXIT(init)', 'ENTER(ingest)', NULL, 'rsEE.afterCell', ('2024-05-03T10:18:41.940Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('52b4baaf-8edd-5214-a0fd-5e6e3083f830', '52c6a395-5d83-4051-bb7c-39036f26ab29', NULL, 'EXIT(ingest)', 'ENTER(ensureContent)', NULL, 'rsEE.afterCell', ('2024-05-03T10:18:41.940Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('434be675-ad6c-5d22-8930-2dbef82f52a3', '52c6a395-5d83-4051-bb7c-39036f26ab29', NULL, 'EXIT(ensureContent)', 'ENTER(emitResources)', NULL, 'rsEE.afterCell', ('2024-05-03T10:18:41.940Z'), NULL);\n\n-- diagnostics-md-ignore-start \"SQLPage and execution diagnostics SQL DML\"\n-- emit all the SQLPage content\nCREATE TABLE IF NOT EXISTS \"sqlpage_files\" (\n    \"path\" TEXT PRIMARY KEY NOT NULL,\n    \"contents\" TEXT NOT NULL,\n    \"last_modified\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('sqlpage/templates/session_entries.handlebars', '<h1>{{title}}</h1>\n\n<ul>\n{{#each_row}}\n    <li><a href=\"?session_entry_id={{orch_session_entry_id}}\">{{ingest_src}}</a> ({{ingest_table_name}})</li>\n{{/each_row}}\n</ul>', (CURRENT_TIMESTAMP));\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('sqlpage/templates/info_model_schema_tables.handlebars', '{{caption}}\n<ul>\n{{#each_row}}\n    <li><a href=\"?table_nature={{nature}}&table_name={{table_name}}\">{{table_name}}</a> ({{nature}}, {{columns_count}} columns)</li>\n{{/each_row}}\n</ul>', (CURRENT_TIMESTAMP));\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('scripts/shell.js', 'function wrapSTDOUTInDetails() {\n    // Find all heading elements that could contain the STDOUT text\n    const headings = document.querySelectorAll(''h1, h2, h3, h4, h5, h6'');\n\n    headings.forEach(function(heading) {\n        if (heading.textContent.includes(''STDOUT'')) {\n            // Find the next <pre><code> block\n            var nextEl = heading.nextElementSibling;\n            while (nextEl) {\n                if (nextEl.matches(''pre'') && nextEl.querySelector(''code'')) {\n                    // Create the <details> and <summary> elements\n                    const details = document.createElement(''details'');\n                    const summary = document.createElement(''summary'');\n                    summary.textContent = heading.textContent;\n\n                    // Wrap the <pre><code> block in <details>\n                    nextEl.parentNode.insertBefore(details, nextEl);\n                    details.appendChild(summary);\n                    details.appendChild(nextEl);\n                    break;\n                }\n                nextEl = nextEl.nextElementSibling;\n            }\n        }\n    });\n\n    headings.forEach(function(heading) {\n        if (heading.textContent.includes(''STDOUT'')) {\n          heading.remove();\n        }\n    });\n}\n\ndocument.addEventListener(''DOMContentLoaded'', function() {\n  // find all code elements on the current page with the class ''language-sql'' and add the class ''line-numbers'' to each of them\n  document.querySelectorAll(''code.language-sql'').forEach(function(codeEl) {\n      var parentPre = codeEl.parentElement;\n      if (parentPre && parentPre.tagName === ''PRE'') {\n          parentPre.classList.add(''line-numbers'');\n      }\n  });\n  wrapSTDOUTInDetails();\n});\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('index.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\nSELECT ''list'' as component;\nSELECT ''1115 Waiver Screenings'' as title,''1115-waiver-screenings.sql'' as link;\nSELECT ''Orchestration Sessions'' as title,''sessions.sql'' as link;\nSELECT ''Orchestration Issues'' as title,''issues.sql'' as link;\nSELECT ''Orchestration State Schema'' as title,''schema.sql'' as link;', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('sessions.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''table'' as component;\nSELECT * FROM device;\n\nSELECT ''table'' as component, ''orch_session_id'' as markdown, ''SUMMARY'' as markdown;\nSELECT ''['' || orch_session_id || ''](session-diagnostics.sql?session_id=''|| orch_session_id ||'')'' as orch_session_id,''['' || ''Summary'' || ''](session-summary.sql?session_id=''|| orch_session_id ||'')'' as SUMMARY, device_id, orch_started_at, orch_finished_at FROM orch_session;\n\nSELECT ''table'' as component, ''true'' as search, ''ingest_src'' as markdown;\nSELECT ''['' || ingest_src || ''](issues.sql?session_entry_id=''|| orch_session_entry_id ||'')'' as ingest_src, ingest_table_name FROM \"orch_session_entry\";\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('reference.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''text'' as component, ''Encounter Class Reference'' as title;\n\nSELECT ''table'' as component;\nSELECT * FROM encounter_class_reference;\n\nSELECT ''text'' as component, ''Encounter Status Code Reference'' as title;\n\nSELECT ''table'' as component;\nSELECT * FROM encounter_status_code_reference;\n\nSELECT ''text'' as component, ''Encounter Type Code Reference'' as title;\n\nSELECT ''table'' as component;\nSELECT * FROM encounter_type_code_reference;\n\nSELECT ''text'' as component, ''Screening Status Code Reference'' as title;\n\nSELECT ''table'' as component;\nSELECT * FROM screening_status_code_reference;\n\nSELECT ''text'' as component, ''Business Rules'' as title;\n\nSELECT ''table'' as component;\nSELECT * FROM business_rules;\n\nSELECT ''text'' as component, ''AHC Cross Walk'' as title;\n\nSELECT ''table'' as component;\nSELECT * FROM ahc_cross_walk;\n\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('session-diagnostics.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''text'' as component, (''Session '' || $session_id || '' Arguments '') as title, (SELECT ''```json\n'' || args_json || ''\n```'' FROM orch_session WHERE orch_session_id = $session_id) as contents_md;\n\nSELECT ''text'' as component, (''Session '' || $session_id || '' Diagnostics '') as title, (SELECT diagnostics_md FROM orch_session WHERE orch_session_id = $session_id) as contents_md;', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('session-summary.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\nSELECT ''text'' as component, ''Summary'' as title;\nSELECT ''table'' as component, ''true'' as search;\nSELECT issue_type,COUNT(orch_session_issue_id) as issue_count from orch_session_issue group by issue_type;\n\n', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('issues.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''session_entries'' as component, ''Choose Session Entry'' as title;\nSELECT orch_session_entry_id, ingest_src, ingest_table_name\n  FROM orch_session_entry;\n\nSELECT ''table'' as component, ''true'' as search;\n\n            SELECT issue_type, issue_message, invalid_value, remediation\n              FROM orch_session_issue\n             WHERE session_entry_id = $session_entry_id;\n', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('1115-waiver-screenings.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort, ''pat_mrn_id'' as markdown;\n\n              SELECT format(''[%s](?pat_mrn_id=%s)'', pat_mrn_id, pat_mrn_id) as pat_mrn_id, facility_id\n                FROM screening\n            GROUP BY pat_mrn_id, facility_id\n            ORDER BY facility_id;\n\nSELECT ''text'' as component, (select format(''%s %s Answers'') from screening where pat_mrn_id = $pat_mrn_id) as title;\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort WHERE coalesce($pat_mrn_id, '''') <> '''';\n\n            SELECT QUESTION_CODE_DESCRIPTION, ANSWER_CODE_DESCRIPTION\n              FROM \"screening\"\n             WHERE pat_mrn_id = $pat_mrn_id;\nSELECT ''text'' as component, (select format(''%s %s FHIR Patient'', first_name, last_name) from demographic_data where pat_mrn_id = $pat_mrn_id) as title;\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort WHERE $pat_mrn_id is not null;\n\n            SELECT *\n              FROM \"demographic_data_fhir_patient\"\n             WHERE pat_mrn_id = $pat_mrn_id;\nSELECT ''text'' as component, (select format(''%s FHIR Observations'', display_name) from screening_fhir where pat_mrn_id = $pat_mrn_id) as title;\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort WHERE $pat_mrn_id is not null;\n\n            SELECT *\n              FROM \"screening_fhir\"\n             WHERE pat_mrn_id = $pat_mrn_id;\nSELECT ''text'' as component, (select format(''%s FHIR Questionnaire'', display_name) from screening_fhir_questionnaire where pat_mrn_id = $pat_mrn_id) as title;\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort WHERE $pat_mrn_id is not null;\n\n            SELECT *\n              FROM \"screening_fhir_questionnaire\"\n             WHERE pat_mrn_id = $pat_mrn_id;\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('schema.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\nSELECT ''text'' as component, ''Information Model (Schema) Documentation'' as title, ''TODO (description)'' as contents_md;\n\nSELECT ''table'' as component, ''table_name'' as markdown;\n\n          SELECT format(''[%s](?table_name=%s&table_nature)'', m.tbl_name, m.tbl_name, m.type) AS table_name,\n                 (SELECT COUNT(*) FROM sqlite_master sm2 JOIN pragma_table_info(m.tbl_name) cc ON 1=1 WHERE sm2.tbl_name = m.tbl_name) AS columns_count,\n                 m.type as nature\n            FROM sqlite_master m\n        ORDER BY table_name\n      ;\n\nSELECT ''text'' as component, ($table_name || '' '' || $table_nature || '' columns'' ) as title, ''TODO (lineage, governance, description, etc.)'' as contents_md WHERE coalesce($table_name, '''') <> '''';\nSELECT ''table'' as component WHERE coalesce($table_name, '''') <> '''';\n\n            SELECT\n              ROW_NUMBER() OVER (PARTITION BY m.tbl_name ORDER BY c.cid) AS column_num,\n              -- TODO: add governance information (e.g. description, etc. from SQLa)\n              CASE WHEN c.pk THEN ''*'' ELSE '''' END AS is_primary_key,\n              c.name AS column_name,\n              c.\"type\" AS column_type,\n              CASE WHEN c.\"notnull\" THEN ''*'' ELSE '''' END AS not_null,\n              COALESCE(c.dflt_value, '''') AS default_value,\n              COALESCE((SELECT pfkl.\"table\" || ''.'' || pfkl.\"to\" FROM pragma_foreign_key_list(m.tbl_name) AS pfkl WHERE pfkl.\"from\" = c.name), '''') as fk_refs\n              -- TODO: add \"is_indexed\" and other details\n            FROM sqlite_master m JOIN pragma_table_info(m.tbl_name) c ON 1=1\n            WHERE m.tbl_name = $table_name;\n\nSELECT ''text'' as component, ($table_name || '' indexes'') as title;\nSELECT ''table'' as component WHERE coalesce($table_name, '''') <> '''';\n\n            SELECT il.name as \"Index Name\", group_concat(ii.name, '', '') as columns\n              FROM sqlite_master as m, pragma_index_list(m.name) AS il, pragma_index_info(il.name) AS ii\n             WHERE m.tbl_name = $table_name\n             GROUP BY m.name, il.name;\n\n-- TODO: add PlantUML or Mermaid ERD through SQL as emitted by tbls (use ChatGPT to create)\n    ;\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;;\n\n-- emit all the execution diagnostics\nINSERT INTO \"orch_session_exec\" (\"orch_session_exec_id\", \"exec_nature\", \"session_id\", \"session_entry_id\", \"parent_exec_id\", \"namespace\", \"exec_identity\", \"exec_code\", \"exec_status\", \"input_text\", \"exec_error_text\", \"output_text\", \"output_nature\", \"narrative_md\", \"elaboration\") VALUES ('06e5cabe-6b22-5c95-b606-e15660eb1006', 'duckdb', '52c6a395-5d83-4051-bb7c-39036f26ab29', NULL, NULL, NULL, 'init', 'duckdb HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.workflow/ingestion-center.duckdb', 0, '-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"version\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMP,\n    \"elaboration\" TEXT,\n    \"args_json\" TEXT,\n    \"diagnostics_json\" TEXT,\n    \"diagnostics_md\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from ''orch_session''\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, ''%Y-%m-%d %H:%M:%S'') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, ''%Y-%m-%d %H:%M:%S'') AS orch_finished_at,\n    \n        -- Including all columns from ''orch_session_entry''\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from ''orch_session_issue''\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES (''fb100496-cb54-5e75-8a29-4fe36e78b522'', ''ALAN-FRANCIS'', ''SINGLETON'', ''UNKNOWN'', NULL, ''{\"os-arch\":\"x64\",\"os-platform\":\"linux\"}'', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"version\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\", \"args_json\", \"diagnostics_json\", \"diagnostics_md\") VALUES (''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''fb100496-cb54-5e75-8a29-4fe36e78b522'', ''0.17.2'', (''2024-05-03T10:18:40.514Z''), NULL, NULL, NULL, NULL, ''Session 52c6a395-5d83-4051-bb7c-39036f26ab29 markdown diagnostics not provided (not completed?)'');\n\n-- Load Reference data from csvs\n\n-- no after-init SQL found', NULL, NULL, NULL, '\n## init\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"version\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMP,\n    \"elaboration\" TEXT,\n    \"args_json\" TEXT,\n    \"diagnostics_json\" TEXT,\n    \"diagnostics_md\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from ''orch_session''\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, ''%Y-%m-%d %H:%M:%S'') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, ''%Y-%m-%d %H:%M:%S'') AS orch_finished_at,\n    \n        -- Including all columns from ''orch_session_entry''\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from ''orch_session_issue''\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES (''fb100496-cb54-5e75-8a29-4fe36e78b522'', ''ALAN-FRANCIS'', ''SINGLETON'', ''UNKNOWN'', NULL, ''{\"os-arch\":\"x64\",\"os-platform\":\"linux\"}'', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"version\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\", \"args_json\", \"diagnostics_json\", \"diagnostics_md\") VALUES (''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''fb100496-cb54-5e75-8a29-4fe36e78b522'', ''0.17.2'', (''2024-05-03T10:18:40.514Z''), NULL, NULL, NULL, NULL, ''Session 52c6a395-5d83-4051-bb7c-39036f26ab29 markdown diagnostics not provided (not completed?)'');\n\n-- Load Reference data from csvs\n\n-- no after-init SQL found\n```\nNo STDOUT emitted by `init` (status: `0`).\n\nNo STDERR emitted by `init`.\n\n    ', NULL);\nINSERT INTO \"orch_session_exec\" (\"orch_session_exec_id\", \"exec_nature\", \"session_id\", \"session_entry_id\", \"parent_exec_id\", \"namespace\", \"exec_identity\", \"exec_code\", \"exec_status\", \"input_text\", \"exec_error_text\", \"output_text\", \"output_nature\", \"narrative_md\", \"elaboration\") VALUES ('986fcfe7-9b44-5a16-b7cc-ea656710ca64', 'duckdb', '52c6a395-5d83-4051-bb7c-39036f26ab29', NULL, NULL, NULL, 'ingest', 'duckdb HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.workflow/ingestion-center.duckdb --json', 0, '-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- ingest HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/DEMOGRAPHIC_DATA_20240307.csv (admin_demographics_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''963ed7bf-d356-54ae-ba2a-739f7f164e1a'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/DEMOGRAPHIC_DATA_20240307.csv'', ''admin_demographics_20240307'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''9c13e37e-d059-582b-bfe1-3875f9c96436'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''AdminDemographicCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE admin_demographics_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'' as session_entry_id\n    FROM read_csv_auto(''HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/DEMOGRAPHIC_DATA_20240307.csv'', types={''MPI_ID'': ''VARCHAR'', ''SEX_AT_BIRTH_CODE'': ''VARCHAR'', ''ADMINISTRATIVE_SEX_CODE'': ''VARCHAR'', ''SEXUAL_ORIENTATION_CODE'': ''VARCHAR'', ''GENDER_IDENTITY_CODE'': ''VARCHAR''});\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''MPI_ID''), (''PAT_MRN_ID''), (''FACILITY_ID''), (''CONSENT''), (''FIRST_NAME''), (''MIDDLE_NAME''), (''LAST_NAME''), (''ADMINISTRATIVE_SEX_CODE''), (''ADMINISTRATIVE_SEX_CODE_DESCRIPTION''), (''ADMINISTRATIVE_SEX_CODE_SYSTEM''), (''SEX_AT_BIRTH_CODE''), (''SEX_AT_BIRTH_CODE_DESCRIPTION''), (''SEX_AT_BIRTH_CODE_SYSTEM''), (''PAT_BIRTH_DATE''), (''ADDRESS1''), (''ADDRESS2''), (''CITY''), (''STATE''), (''ZIP''), (''GENDER_IDENTITY_CODE_SYSTEM_NAME''), (''GENDER_IDENTITY_CODE''), (''GENDER_IDENTITY_CODE_DESCRIPTION''), (''SEXUAL_ORIENTATION_CODE_SYSTEM_NAME''), (''SEXUAL_ORIENTATION_CODE''), (''SEXUAL_ORIENTATION_DESCRIPTION''), (''PREFERRED_LANGUAGE_CODE_SYSTEM_NAME''), (''PREFERRED_LANGUAGE_CODE''), (''PREFERRED_LANGUAGE_DESCRIPTION''), (''RACE_CODE_SYSTEM_NAME''), (''RACE_CODE''), (''RACE_CODE_DESCRIPTION''), (''ETHNICITY_CODE_SYSTEM_NAME''), (''ETHNICITY_CODE''), (''ETHNICITY_CODE_DESCRIPTION''), (''MEDICAID_CIN'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''admin_demographics_20240307'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in admin_demographics_20240307.'',\n           ''Ensure admin_demographics_20240307 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''e5f8dcaa-aaab-5807-a510-a2478c89fc30'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''AdminDemographicCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/QE_ADMIN_DATA_20240307.csv (qe_admin_data_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''767cb8df-3ec0-5b59-998e-a91e75be32b3'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/QE_ADMIN_DATA_20240307.csv'', ''qe_admin_data_20240307'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''523de5c7-6ede-5e49-9570-5621dde1f65a'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''767cb8df-3ec0-5b59-998e-a91e75be32b3'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''QeAdminDataCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE qe_admin_data_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''767cb8df-3ec0-5b59-998e-a91e75be32b3'' as session_entry_id\n    FROM read_csv_auto(''HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/QE_ADMIN_DATA_20240307.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY_ID''), (''FACILITY_LONG_NAME''), (''ORGANIZATION_TYPE''), (''FACILITY_ADDRESS1''), (''FACILITY_ADDRESS2''), (''FACILITY_CITY''), (''FACILITY_STATE''), (''FACILITY_ZIP''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''qe_admin_data_20240307'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in qe_admin_data_20240307.'',\n           ''Ensure qe_admin_data_20240307 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''f70136eb-81d9-550f-8910-1c9d430c71e5'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''767cb8df-3ec0-5b59-998e-a91e75be32b3'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''QeAdminDataCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/SCREENING_20240307.csv (screening_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/SCREENING_20240307.csv'', ''screening_20240307'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''aebb9881-f0ee-54c4-be68-53ce86973e56'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE screening_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'' as session_entry_id\n    FROM read_csv_auto(''HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/SCREENING_20240307.csv'', types={''RECORDED_TIME'': ''VARCHAR'', ''ENCOUNTER_TYPE_CODE'': ''VARCHAR''});\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY_ID''), (''ENCOUNTER_ID''), (''ENCOUNTER_CLASS_CODE_SYSTEM''), (''ENCOUNTER_CLASS_CODE''), (''ENCOUNTER_CLASS_CODE_DESCRIPTION''), (''ENCOUNTER_STATUS_CODE_SYSTEM''), (''ENCOUNTER_STATUS_CODE''), (''ENCOUNTER_STATUS_CODE_DESCRIPTION''), (''ENCOUNTER_TYPE_CODE_SYSTEM''), (''ENCOUNTER_TYPE_CODE''), (''ENCOUNTER_TYPE_CODE_DESCRIPTION''), (''SCREENING_CODE_DESCRIPTION''), (''SCREENING_CODE_SYSTEM_NAME''), (''SCREENING_CODE''), (''SCREENING_STATUS_CODE_DESCRIPTION''), (''SCREENING_STATUS_CODE''), (''SCREENING_STATUS_CODE_SYSTEM''), (''RECORDED_TIME''), (''QUESTION_CODE_DESCRIPTION''), (''ANSWER_CODE_DESCRIPTION''), (''UCUM_UNITS''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''PARENT_QUESTION_CODE''), (''SDOH_DOMAIN''), (''POTENTIAL_NEED_INDICATED'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''screening_20240307'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in screening_20240307.'',\n           ''Ensure screening_20240307 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''6506f244-6870-581c-a47e-875c52326818'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ahc-cross-walk.csv (ahc_cross_walk)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''b9aac8ec-792a-511d-8107-25bd96085898'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ahc-cross-walk.csv'', ''ahc_cross_walk'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''5b7d69bd-b348-556b-8e3a-4a4c4397163c'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''b9aac8ec-792a-511d-8107-25bd96085898'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''AhcCrossWalkCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_cross_walk AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''b9aac8ec-792a-511d-8107-25bd96085898'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ahc-cross-walk.csv'', header = true);\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''SCREENING_CODE''), (''SCREENING_CODE_DESCRIPTION''), (''QUESTION_SLNO''), (''QUESTION''), (''QUESTION_CODE''), (''QUESTION_SLNO_REFERENCE''), (''ANSWER_VALUE''), (''ANSWER_CODE''), (''CALCULATED_FIELD''), (''SCORE''), (''UCUM_UNITS''), (''SDOH_DOMAIN''), (''POTENTIAL_NEED_INDICATED'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_cross_walk'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''b9aac8ec-792a-511d-8107-25bd96085898'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_cross_walk.'',\n           ''Ensure ahc_cross_walk contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7c00755d-cac1-5780-b386-435fac109c1e'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''b9aac8ec-792a-511d-8107-25bd96085898'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''AhcCrossWalkCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-class-reference.csv (encounter_class_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''48eb0055-f06e-57f4-8019-f49266be3d22'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-class-reference.csv'', ''encounter_class_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''a4d8a2c7-1ed0-532c-8617-9b840e0db2a1'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''48eb0055-f06e-57f4-8019-f49266be3d22'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''EncounterClassReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE encounter_class_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''48eb0055-f06e-57f4-8019-f49266be3d22'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-class-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Code''), (''System''), (''Display''), (''Definition'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''encounter_class_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''48eb0055-f06e-57f4-8019-f49266be3d22'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in encounter_class_reference.'',\n           ''Ensure encounter_class_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''60e9c67a-d11b-58a8-b606-fec8ae5534b4'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''48eb0055-f06e-57f4-8019-f49266be3d22'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''EncounterClassReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-status-code-reference.csv (encounter_status_code_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''2e9c77e9-a664-5323-83e4-e6a92cf998ab'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-status-code-reference.csv'', ''encounter_status_code_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''ff07588a-62bc-500b-a066-3dc216afa1c5'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''2e9c77e9-a664-5323-83e4-e6a92cf998ab'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''EncounterStatusCodeReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE encounter_status_code_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''2e9c77e9-a664-5323-83e4-e6a92cf998ab'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-status-code-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Code''), (''Display''), (''Definition'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''encounter_status_code_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''2e9c77e9-a664-5323-83e4-e6a92cf998ab'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in encounter_status_code_reference.'',\n           ''Ensure encounter_status_code_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''24cfaeaa-484a-5041-9d81-e7c4fb141c4d'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''2e9c77e9-a664-5323-83e4-e6a92cf998ab'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''EncounterStatusCodeReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-type-code-reference.csv (encounter_type_code_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''4b3dd9ab-d81b-509a-9662-68dbd6d142f7'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-type-code-reference.csv'', ''encounter_type_code_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''813b4f2b-cc81-5ed4-9305-625009c58ab7'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''4b3dd9ab-d81b-509a-9662-68dbd6d142f7'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''EncounterTypeCodeReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE encounter_type_code_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''4b3dd9ab-d81b-509a-9662-68dbd6d142f7'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-type-code-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Code''), (''System''), (''Display'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''encounter_type_code_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''4b3dd9ab-d81b-509a-9662-68dbd6d142f7'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in encounter_type_code_reference.'',\n           ''Ensure encounter_type_code_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''dc2b6f5f-7872-5968-a30f-f8df2e860803'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''4b3dd9ab-d81b-509a-9662-68dbd6d142f7'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''EncounterTypeCodeReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/screening-status-code-reference.csv (screening_status_code_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''1a152daa-273d-5411-88cf-84067822a8aa'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/screening-status-code-reference.csv'', ''screening_status_code_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''a1402393-e3cf-5cc3-a644-da19d3689fc7'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''1a152daa-273d-5411-88cf-84067822a8aa'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''ScreeningStatusCodeReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE screening_status_code_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''1a152daa-273d-5411-88cf-84067822a8aa'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/screening-status-code-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Lvl''), (''Code''), (''Display''), (''Definition'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''screening_status_code_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''1a152daa-273d-5411-88cf-84067822a8aa'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in screening_status_code_reference.'',\n           ''Ensure screening_status_code_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''72b2e7e1-545d-540e-bbd7-5ab6b566a52a'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''1a152daa-273d-5411-88cf-84067822a8aa'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''ScreeningStatusCodeReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/gender-identity-reference.csv (gender_identity_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''787ee7ff-3ef5-59aa-a055-659cf10b6202'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/gender-identity-reference.csv'', ''gender_identity_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''30f231bd-8ace-577e-ac7d-b7484a41cf8c'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''787ee7ff-3ef5-59aa-a055-659cf10b6202'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''GenderIdentityReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE gender_identity_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''787ee7ff-3ef5-59aa-a055-659cf10b6202'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/gender-identity-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''GENDER_IDENTITY_CODE''), (''GENDER_IDENTITY_CODE_DESCRIPTION''), (''GENDER_IDENTITY_CODE_SYSTEM_NAME'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''gender_identity_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''787ee7ff-3ef5-59aa-a055-659cf10b6202'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in gender_identity_reference.'',\n           ''Ensure gender_identity_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''c33e617a-4c3b-5907-b98a-f576ff4ac7bd'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''787ee7ff-3ef5-59aa-a055-659cf10b6202'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''GenderIdentityReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/administrative-sex-reference.csv (administrative_sex_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''79f3d60e-c863-5759-8043-f122175a7cbb'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/administrative-sex-reference.csv'', ''administrative_sex_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''6a920ce5-e480-5723-a3f5-e3167db5bd23'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''79f3d60e-c863-5759-8043-f122175a7cbb'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''AdministrativeSexReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE administrative_sex_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''79f3d60e-c863-5759-8043-f122175a7cbb'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/administrative-sex-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''ADMINISTRATIVE_SEX_CODE''), (''ADMINISTRATIVE_SEX_CODE_DESCRIPTION''), (''ADMINISTRATIVE_SEX_CODE_SYSTEM'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''administrative_sex_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''79f3d60e-c863-5759-8043-f122175a7cbb'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in administrative_sex_reference.'',\n           ''Ensure administrative_sex_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''476191aa-f321-5d08-be13-ba624ad50951'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''79f3d60e-c863-5759-8043-f122175a7cbb'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''AdministrativeSexReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sex-at-birth-reference.csv (sex_at_birth_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''6c2d9879-7393-524d-9e9e-02ea961aca39'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sex-at-birth-reference.csv'', ''sex_at_birth_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''438bb3e5-1ee9-5ed9-9763-4626ae804fad'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''6c2d9879-7393-524d-9e9e-02ea961aca39'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''SexAtBirthReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE sex_at_birth_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''6c2d9879-7393-524d-9e9e-02ea961aca39'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sex-at-birth-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''SEX_AT_BIRTH_CODE''), (''SEX_AT_BIRTH_CODE_DESCRIPTION''), (''SEX_AT_BIRTH_CODE_SYSTEM'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''sex_at_birth_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''6c2d9879-7393-524d-9e9e-02ea961aca39'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in sex_at_birth_reference.'',\n           ''Ensure sex_at_birth_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''4bf5c21f-f9bc-5798-a40f-49354972a8e7'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''6c2d9879-7393-524d-9e9e-02ea961aca39'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''SexAtBirthReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sexual-orientation-reference.csv (sexual_orientation_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''2239dca2-9dd4-5c3a-91c8-2585839b9584'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sexual-orientation-reference.csv'', ''sexual_orientation_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''f02a11b9-d2a8-547c-b57c-7a67b06a3716'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''2239dca2-9dd4-5c3a-91c8-2585839b9584'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''SexualOrientationReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE sexual_orientation_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''2239dca2-9dd4-5c3a-91c8-2585839b9584'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sexual-orientation-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''SEXUAL_ORIENTATION_CODE''), (''SEXUAL_ORIENTATION_CODE_DESCRIPTION''), (''SEXUAL_ORIENTATION_CODE_SYSTEM_NAME'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''sexual_orientation_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''2239dca2-9dd4-5c3a-91c8-2585839b9584'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in sexual_orientation_reference.'',\n           ''Ensure sexual_orientation_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''f3038d1f-a52a-597e-92b4-1e0be7e6d464'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''2239dca2-9dd4-5c3a-91c8-2585839b9584'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''SexualOrientationReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/business-rules.csv (business_rules)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''fc740f9e-863e-5dd1-b1a1-86d176cb549c'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/business-rules.csv'', ''business_rules'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''5f9ab8c7-65b5-5dd8-9e6b-1501c2a639a9'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''fc740f9e-863e-5dd1-b1a1-86d176cb549c'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''BusinessRulesReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE business_rules AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''fc740f9e-863e-5dd1-b1a1-86d176cb549c'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/business-rules.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Worksheet''), (''Field''), (''Required''), (''Permissible Values''), (''True Rejection''), (''Warning Layer''), (''Resolved by QE/QCS'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''business_rules'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''fc740f9e-863e-5dd1-b1a1-86d176cb549c'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in business_rules.'',\n           ''Ensure business_rules contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''939acb5c-0c8e-5d68-9797-9e37ecf7f0a1'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''fc740f9e-863e-5dd1-b1a1-86d176cb549c'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''BusinessRulesReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/race-reference.csv (race_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''f98a88dc-a929-5a9b-906a-277e62c93012'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/race-reference.csv'', ''race_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''48fd69a6-5ad7-5d32-aa35-f9c05860c3d3'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''f98a88dc-a929-5a9b-906a-277e62c93012'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''RaceReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE race_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''f98a88dc-a929-5a9b-906a-277e62c93012'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/race-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Concept Name''), (''Concept Code''), (''Hierarchical Code''), (''Race Category (Concept Name)''), (''Race Category (Concept Code)''), (''Hiearchical Code'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''race_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''f98a88dc-a929-5a9b-906a-277e62c93012'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in race_reference.'',\n           ''Ensure race_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''72451a16-9ba1-5038-a58a-c3aca50cfad6'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''f98a88dc-a929-5a9b-906a-277e62c93012'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''RaceReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ethnicity-reference.csv (ethnicity_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''b0cbca95-5c20-5b2b-b589-9e832c556bc6'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ethnicity-reference.csv'', ''ethnicity_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''d0ed9035-6320-5391-8d2e-509cdc185699'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''b0cbca95-5c20-5b2b-b589-9e832c556bc6'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''EthnicityReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ethnicity_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''b0cbca95-5c20-5b2b-b589-9e832c556bc6'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ethnicity-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Concept Code''), (''Concept Name''), (''Hierarchical Code''), (''Ethnicity Group (Concept Name)''), (''Ethnicity Group (Concept Code)'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''ethnicity_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''b0cbca95-5c20-5b2b-b589-9e832c556bc6'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ethnicity_reference.'',\n           ''Ensure ethnicity_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''f517a0e3-a9aa-5e82-83d1-5ace996332f0'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''b0cbca95-5c20-5b2b-b589-9e832c556bc6'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''EthnicityReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/preferred-language-reference.csv (preferred_language_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''3469db42-0066-5f23-9ee4-2b857bf339a4'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/preferred-language-reference.csv'', ''preferred_language_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''d65cb030-fbbf-55e3-b848-18fd81a32679'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''3469db42-0066-5f23-9ee4-2b857bf339a4'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''PreferredLanguageReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE preferred_language_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''3469db42-0066-5f23-9ee4-2b857bf339a4'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/preferred-language-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''ISO 639-2 Code''), (''ISO 639-1 Code''), (''English name of Language''), (''French name of Language''), (''German name of Language'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''preferred_language_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''3469db42-0066-5f23-9ee4-2b857bf339a4'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in preferred_language_reference.'',\n           ''Ensure preferred_language_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''f1c1a13a-58bf-51c3-92e0-12f2056f8a68'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''3469db42-0066-5f23-9ee4-2b857bf339a4'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''PreferredLanguageReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sdoh-domain-reference.csv (sdoh_domain_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''f19d5ebb-ea63-5b1d-b1b1-758457a2da29'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sdoh-domain-reference.csv'', ''sdoh_domain_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''34308a17-4300-50d6-96bd-b34982aa25db'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''f19d5ebb-ea63-5b1d-b1b1-758457a2da29'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''SdohDomainReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE sdoh_domain_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''f19d5ebb-ea63-5b1d-b1b1-758457a2da29'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sdoh-domain-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Code''), (''Display''), (''Definition'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''sdoh_domain_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''f19d5ebb-ea63-5b1d-b1b1-758457a2da29'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in sdoh_domain_reference.'',\n           ''Ensure sdoh_domain_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''3204b0bd-3443-59e9-9b22-d1881b9c7797'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''f19d5ebb-ea63-5b1d-b1b1-758457a2da29'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''SdohDomainReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''screening_20240307''\n        AS table_name,\n        ''SCREENING'' AS table_name_suffix\n      UNION ALL\n      SELECT ''admin_demographics_20240307''\n        AS table_name,\n        ''DEMOGRAPHIC_DATA'' AS table_name_suffix\n      UNION ALL\n      SELECT ''qe_admin_data_20240307''\n        AS table_name,\n        ''QE_ADMIN_DATA'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''admin_demographics_20240307'' IN (\n      ''screening_20240307'',\n      ''admin_demographics_20240307'',\n      ''qe_admin_data_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''screening_20240307''\n        AS table_name,\n        ''SCREENING'' AS table_name_suffix\n      UNION ALL\n      SELECT ''admin_demographics_20240307''\n        AS table_name,\n        ''DEMOGRAPHIC_DATA'' AS table_name_suffix\n      UNION ALL\n      SELECT ''qe_admin_data_20240307''\n        AS table_name,\n        ''QE_ADMIN_DATA'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''qe_admin_data_20240307'' IN (\n      ''screening_20240307'',\n      ''admin_demographics_20240307'',\n      ''qe_admin_data_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''screening_20240307''\n        AS table_name,\n        ''SCREENING'' AS table_name_suffix\n      UNION ALL\n      SELECT ''admin_demographics_20240307''\n        AS table_name,\n        ''DEMOGRAPHIC_DATA'' AS table_name_suffix\n      UNION ALL\n      SELECT ''qe_admin_data_20240307''\n        AS table_name,\n        ''QE_ADMIN_DATA'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''screening_20240307'' IN (\n      ''screening_20240307'',\n      ''admin_demographics_20240307'',\n      ''qe_admin_data_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''screening_20240307''\n        AS table_name,\n        ''SCREENING'' AS table_name_suffix\n      UNION ALL\n      SELECT ''admin_demographics_20240307''\n        AS table_name,\n        ''DEMOGRAPHIC_DATA'' AS table_name_suffix\n      UNION ALL\n      SELECT ''qe_admin_data_20240307''\n        AS table_name,\n        ''QE_ADMIN_DATA'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''screening_status_code_reference'' IN (\n      ''screening_20240307'',\n      ''admin_demographics_20240307'',\n      ''qe_admin_data_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''1a152daa-273d-5411-88cf-84067822a8aa'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nSELECT osi.session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value, ingest_table_name FROM orch_session_issue osi LEFT JOIN orch_session_entry ose ON osi.session_entry_id = ose.orch_session_entry_id WHERE osi.session_id = ''52c6a395-5d83-4051-bb7c-39036f26ab29''', NULL, NULL, 'JSON', '\n## ingest\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- ingest HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/DEMOGRAPHIC_DATA_20240307.csv (admin_demographics_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''963ed7bf-d356-54ae-ba2a-739f7f164e1a'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/DEMOGRAPHIC_DATA_20240307.csv'', ''admin_demographics_20240307'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''9c13e37e-d059-582b-bfe1-3875f9c96436'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''AdminDemographicCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE admin_demographics_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'' as session_entry_id\n    FROM read_csv_auto(''HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/DEMOGRAPHIC_DATA_20240307.csv'', types={''MPI_ID'': ''VARCHAR'', ''SEX_AT_BIRTH_CODE'': ''VARCHAR'', ''ADMINISTRATIVE_SEX_CODE'': ''VARCHAR'', ''SEXUAL_ORIENTATION_CODE'': ''VARCHAR'', ''GENDER_IDENTITY_CODE'': ''VARCHAR''});\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''MPI_ID''), (''PAT_MRN_ID''), (''FACILITY_ID''), (''CONSENT''), (''FIRST_NAME''), (''MIDDLE_NAME''), (''LAST_NAME''), (''ADMINISTRATIVE_SEX_CODE''), (''ADMINISTRATIVE_SEX_CODE_DESCRIPTION''), (''ADMINISTRATIVE_SEX_CODE_SYSTEM''), (''SEX_AT_BIRTH_CODE''), (''SEX_AT_BIRTH_CODE_DESCRIPTION''), (''SEX_AT_BIRTH_CODE_SYSTEM''), (''PAT_BIRTH_DATE''), (''ADDRESS1''), (''ADDRESS2''), (''CITY''), (''STATE''), (''ZIP''), (''GENDER_IDENTITY_CODE_SYSTEM_NAME''), (''GENDER_IDENTITY_CODE''), (''GENDER_IDENTITY_CODE_DESCRIPTION''), (''SEXUAL_ORIENTATION_CODE_SYSTEM_NAME''), (''SEXUAL_ORIENTATION_CODE''), (''SEXUAL_ORIENTATION_DESCRIPTION''), (''PREFERRED_LANGUAGE_CODE_SYSTEM_NAME''), (''PREFERRED_LANGUAGE_CODE''), (''PREFERRED_LANGUAGE_DESCRIPTION''), (''RACE_CODE_SYSTEM_NAME''), (''RACE_CODE''), (''RACE_CODE_DESCRIPTION''), (''ETHNICITY_CODE_SYSTEM_NAME''), (''ETHNICITY_CODE''), (''ETHNICITY_CODE_DESCRIPTION''), (''MEDICAID_CIN'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''admin_demographics_20240307'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in admin_demographics_20240307.'',\n           ''Ensure admin_demographics_20240307 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''e5f8dcaa-aaab-5807-a510-a2478c89fc30'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''AdminDemographicCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/QE_ADMIN_DATA_20240307.csv (qe_admin_data_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''767cb8df-3ec0-5b59-998e-a91e75be32b3'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/QE_ADMIN_DATA_20240307.csv'', ''qe_admin_data_20240307'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''523de5c7-6ede-5e49-9570-5621dde1f65a'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''767cb8df-3ec0-5b59-998e-a91e75be32b3'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''QeAdminDataCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE qe_admin_data_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''767cb8df-3ec0-5b59-998e-a91e75be32b3'' as session_entry_id\n    FROM read_csv_auto(''HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/QE_ADMIN_DATA_20240307.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY_ID''), (''FACILITY_LONG_NAME''), (''ORGANIZATION_TYPE''), (''FACILITY_ADDRESS1''), (''FACILITY_ADDRESS2''), (''FACILITY_CITY''), (''FACILITY_STATE''), (''FACILITY_ZIP''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''qe_admin_data_20240307'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in qe_admin_data_20240307.'',\n           ''Ensure qe_admin_data_20240307 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''f70136eb-81d9-550f-8910-1c9d430c71e5'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''767cb8df-3ec0-5b59-998e-a91e75be32b3'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''QeAdminDataCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/SCREENING_20240307.csv (screening_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/SCREENING_20240307.csv'', ''screening_20240307'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''aebb9881-f0ee-54c4-be68-53ce86973e56'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE screening_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'' as session_entry_id\n    FROM read_csv_auto(''HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/SCREENING_20240307.csv'', types={''RECORDED_TIME'': ''VARCHAR'', ''ENCOUNTER_TYPE_CODE'': ''VARCHAR''});\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY_ID''), (''ENCOUNTER_ID''), (''ENCOUNTER_CLASS_CODE_SYSTEM''), (''ENCOUNTER_CLASS_CODE''), (''ENCOUNTER_CLASS_CODE_DESCRIPTION''), (''ENCOUNTER_STATUS_CODE_SYSTEM''), (''ENCOUNTER_STATUS_CODE''), (''ENCOUNTER_STATUS_CODE_DESCRIPTION''), (''ENCOUNTER_TYPE_CODE_SYSTEM''), (''ENCOUNTER_TYPE_CODE''), (''ENCOUNTER_TYPE_CODE_DESCRIPTION''), (''SCREENING_CODE_DESCRIPTION''), (''SCREENING_CODE_SYSTEM_NAME''), (''SCREENING_CODE''), (''SCREENING_STATUS_CODE_DESCRIPTION''), (''SCREENING_STATUS_CODE''), (''SCREENING_STATUS_CODE_SYSTEM''), (''RECORDED_TIME''), (''QUESTION_CODE_DESCRIPTION''), (''ANSWER_CODE_DESCRIPTION''), (''UCUM_UNITS''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''PARENT_QUESTION_CODE''), (''SDOH_DOMAIN''), (''POTENTIAL_NEED_INDICATED'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''screening_20240307'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in screening_20240307.'',\n           ''Ensure screening_20240307 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''6506f244-6870-581c-a47e-875c52326818'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ahc-cross-walk.csv (ahc_cross_walk)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''b9aac8ec-792a-511d-8107-25bd96085898'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ahc-cross-walk.csv'', ''ahc_cross_walk'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''5b7d69bd-b348-556b-8e3a-4a4c4397163c'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''b9aac8ec-792a-511d-8107-25bd96085898'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''AhcCrossWalkCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_cross_walk AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''b9aac8ec-792a-511d-8107-25bd96085898'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ahc-cross-walk.csv'', header = true);\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''SCREENING_CODE''), (''SCREENING_CODE_DESCRIPTION''), (''QUESTION_SLNO''), (''QUESTION''), (''QUESTION_CODE''), (''QUESTION_SLNO_REFERENCE''), (''ANSWER_VALUE''), (''ANSWER_CODE''), (''CALCULATED_FIELD''), (''SCORE''), (''UCUM_UNITS''), (''SDOH_DOMAIN''), (''POTENTIAL_NEED_INDICATED'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_cross_walk'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''b9aac8ec-792a-511d-8107-25bd96085898'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_cross_walk.'',\n           ''Ensure ahc_cross_walk contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7c00755d-cac1-5780-b386-435fac109c1e'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''b9aac8ec-792a-511d-8107-25bd96085898'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''AhcCrossWalkCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-class-reference.csv (encounter_class_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''48eb0055-f06e-57f4-8019-f49266be3d22'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-class-reference.csv'', ''encounter_class_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''a4d8a2c7-1ed0-532c-8617-9b840e0db2a1'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''48eb0055-f06e-57f4-8019-f49266be3d22'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''EncounterClassReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE encounter_class_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''48eb0055-f06e-57f4-8019-f49266be3d22'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-class-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Code''), (''System''), (''Display''), (''Definition'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''encounter_class_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''48eb0055-f06e-57f4-8019-f49266be3d22'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in encounter_class_reference.'',\n           ''Ensure encounter_class_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''60e9c67a-d11b-58a8-b606-fec8ae5534b4'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''48eb0055-f06e-57f4-8019-f49266be3d22'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''EncounterClassReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-status-code-reference.csv (encounter_status_code_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''2e9c77e9-a664-5323-83e4-e6a92cf998ab'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-status-code-reference.csv'', ''encounter_status_code_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''ff07588a-62bc-500b-a066-3dc216afa1c5'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''2e9c77e9-a664-5323-83e4-e6a92cf998ab'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''EncounterStatusCodeReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE encounter_status_code_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''2e9c77e9-a664-5323-83e4-e6a92cf998ab'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-status-code-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Code''), (''Display''), (''Definition'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''encounter_status_code_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''2e9c77e9-a664-5323-83e4-e6a92cf998ab'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in encounter_status_code_reference.'',\n           ''Ensure encounter_status_code_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''24cfaeaa-484a-5041-9d81-e7c4fb141c4d'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''2e9c77e9-a664-5323-83e4-e6a92cf998ab'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''EncounterStatusCodeReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-type-code-reference.csv (encounter_type_code_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''4b3dd9ab-d81b-509a-9662-68dbd6d142f7'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-type-code-reference.csv'', ''encounter_type_code_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''813b4f2b-cc81-5ed4-9305-625009c58ab7'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''4b3dd9ab-d81b-509a-9662-68dbd6d142f7'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''EncounterTypeCodeReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE encounter_type_code_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''4b3dd9ab-d81b-509a-9662-68dbd6d142f7'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-type-code-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Code''), (''System''), (''Display'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''encounter_type_code_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''4b3dd9ab-d81b-509a-9662-68dbd6d142f7'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in encounter_type_code_reference.'',\n           ''Ensure encounter_type_code_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''dc2b6f5f-7872-5968-a30f-f8df2e860803'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''4b3dd9ab-d81b-509a-9662-68dbd6d142f7'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''EncounterTypeCodeReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/screening-status-code-reference.csv (screening_status_code_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''1a152daa-273d-5411-88cf-84067822a8aa'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/screening-status-code-reference.csv'', ''screening_status_code_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''a1402393-e3cf-5cc3-a644-da19d3689fc7'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''1a152daa-273d-5411-88cf-84067822a8aa'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''ScreeningStatusCodeReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE screening_status_code_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''1a152daa-273d-5411-88cf-84067822a8aa'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/screening-status-code-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Lvl''), (''Code''), (''Display''), (''Definition'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''screening_status_code_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''1a152daa-273d-5411-88cf-84067822a8aa'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in screening_status_code_reference.'',\n           ''Ensure screening_status_code_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''72b2e7e1-545d-540e-bbd7-5ab6b566a52a'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''1a152daa-273d-5411-88cf-84067822a8aa'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''ScreeningStatusCodeReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/gender-identity-reference.csv (gender_identity_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''787ee7ff-3ef5-59aa-a055-659cf10b6202'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/gender-identity-reference.csv'', ''gender_identity_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''30f231bd-8ace-577e-ac7d-b7484a41cf8c'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''787ee7ff-3ef5-59aa-a055-659cf10b6202'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''GenderIdentityReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE gender_identity_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''787ee7ff-3ef5-59aa-a055-659cf10b6202'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/gender-identity-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''GENDER_IDENTITY_CODE''), (''GENDER_IDENTITY_CODE_DESCRIPTION''), (''GENDER_IDENTITY_CODE_SYSTEM_NAME'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''gender_identity_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''787ee7ff-3ef5-59aa-a055-659cf10b6202'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in gender_identity_reference.'',\n           ''Ensure gender_identity_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''c33e617a-4c3b-5907-b98a-f576ff4ac7bd'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''787ee7ff-3ef5-59aa-a055-659cf10b6202'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''GenderIdentityReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/administrative-sex-reference.csv (administrative_sex_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''79f3d60e-c863-5759-8043-f122175a7cbb'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/administrative-sex-reference.csv'', ''administrative_sex_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''6a920ce5-e480-5723-a3f5-e3167db5bd23'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''79f3d60e-c863-5759-8043-f122175a7cbb'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''AdministrativeSexReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE administrative_sex_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''79f3d60e-c863-5759-8043-f122175a7cbb'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/administrative-sex-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''ADMINISTRATIVE_SEX_CODE''), (''ADMINISTRATIVE_SEX_CODE_DESCRIPTION''), (''ADMINISTRATIVE_SEX_CODE_SYSTEM'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''administrative_sex_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''79f3d60e-c863-5759-8043-f122175a7cbb'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in administrative_sex_reference.'',\n           ''Ensure administrative_sex_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''476191aa-f321-5d08-be13-ba624ad50951'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''79f3d60e-c863-5759-8043-f122175a7cbb'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''AdministrativeSexReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sex-at-birth-reference.csv (sex_at_birth_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''6c2d9879-7393-524d-9e9e-02ea961aca39'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sex-at-birth-reference.csv'', ''sex_at_birth_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''438bb3e5-1ee9-5ed9-9763-4626ae804fad'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''6c2d9879-7393-524d-9e9e-02ea961aca39'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''SexAtBirthReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE sex_at_birth_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''6c2d9879-7393-524d-9e9e-02ea961aca39'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sex-at-birth-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''SEX_AT_BIRTH_CODE''), (''SEX_AT_BIRTH_CODE_DESCRIPTION''), (''SEX_AT_BIRTH_CODE_SYSTEM'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''sex_at_birth_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''6c2d9879-7393-524d-9e9e-02ea961aca39'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in sex_at_birth_reference.'',\n           ''Ensure sex_at_birth_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''4bf5c21f-f9bc-5798-a40f-49354972a8e7'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''6c2d9879-7393-524d-9e9e-02ea961aca39'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''SexAtBirthReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sexual-orientation-reference.csv (sexual_orientation_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''2239dca2-9dd4-5c3a-91c8-2585839b9584'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sexual-orientation-reference.csv'', ''sexual_orientation_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''f02a11b9-d2a8-547c-b57c-7a67b06a3716'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''2239dca2-9dd4-5c3a-91c8-2585839b9584'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''SexualOrientationReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE sexual_orientation_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''2239dca2-9dd4-5c3a-91c8-2585839b9584'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sexual-orientation-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''SEXUAL_ORIENTATION_CODE''), (''SEXUAL_ORIENTATION_CODE_DESCRIPTION''), (''SEXUAL_ORIENTATION_CODE_SYSTEM_NAME'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''sexual_orientation_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''2239dca2-9dd4-5c3a-91c8-2585839b9584'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in sexual_orientation_reference.'',\n           ''Ensure sexual_orientation_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''f3038d1f-a52a-597e-92b4-1e0be7e6d464'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''2239dca2-9dd4-5c3a-91c8-2585839b9584'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''SexualOrientationReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/business-rules.csv (business_rules)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''fc740f9e-863e-5dd1-b1a1-86d176cb549c'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/business-rules.csv'', ''business_rules'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''5f9ab8c7-65b5-5dd8-9e6b-1501c2a639a9'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''fc740f9e-863e-5dd1-b1a1-86d176cb549c'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''BusinessRulesReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE business_rules AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''fc740f9e-863e-5dd1-b1a1-86d176cb549c'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/business-rules.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Worksheet''), (''Field''), (''Required''), (''Permissible Values''), (''True Rejection''), (''Warning Layer''), (''Resolved by QE/QCS'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''business_rules'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''fc740f9e-863e-5dd1-b1a1-86d176cb549c'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in business_rules.'',\n           ''Ensure business_rules contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''939acb5c-0c8e-5d68-9797-9e37ecf7f0a1'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''fc740f9e-863e-5dd1-b1a1-86d176cb549c'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''BusinessRulesReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/race-reference.csv (race_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''f98a88dc-a929-5a9b-906a-277e62c93012'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/race-reference.csv'', ''race_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''48fd69a6-5ad7-5d32-aa35-f9c05860c3d3'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''f98a88dc-a929-5a9b-906a-277e62c93012'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''RaceReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE race_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''f98a88dc-a929-5a9b-906a-277e62c93012'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/race-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Concept Name''), (''Concept Code''), (''Hierarchical Code''), (''Race Category (Concept Name)''), (''Race Category (Concept Code)''), (''Hiearchical Code'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''race_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''f98a88dc-a929-5a9b-906a-277e62c93012'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in race_reference.'',\n           ''Ensure race_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''72451a16-9ba1-5038-a58a-c3aca50cfad6'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''f98a88dc-a929-5a9b-906a-277e62c93012'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''RaceReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ethnicity-reference.csv (ethnicity_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''b0cbca95-5c20-5b2b-b589-9e832c556bc6'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ethnicity-reference.csv'', ''ethnicity_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''d0ed9035-6320-5391-8d2e-509cdc185699'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''b0cbca95-5c20-5b2b-b589-9e832c556bc6'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''EthnicityReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ethnicity_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''b0cbca95-5c20-5b2b-b589-9e832c556bc6'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ethnicity-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Concept Code''), (''Concept Name''), (''Hierarchical Code''), (''Ethnicity Group (Concept Name)''), (''Ethnicity Group (Concept Code)'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''ethnicity_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''b0cbca95-5c20-5b2b-b589-9e832c556bc6'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ethnicity_reference.'',\n           ''Ensure ethnicity_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''f517a0e3-a9aa-5e82-83d1-5ace996332f0'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''b0cbca95-5c20-5b2b-b589-9e832c556bc6'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''EthnicityReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/preferred-language-reference.csv (preferred_language_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''3469db42-0066-5f23-9ee4-2b857bf339a4'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/preferred-language-reference.csv'', ''preferred_language_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''d65cb030-fbbf-55e3-b848-18fd81a32679'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''3469db42-0066-5f23-9ee4-2b857bf339a4'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''PreferredLanguageReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE preferred_language_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''3469db42-0066-5f23-9ee4-2b857bf339a4'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/preferred-language-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''ISO 639-2 Code''), (''ISO 639-1 Code''), (''English name of Language''), (''French name of Language''), (''German name of Language'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''preferred_language_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''3469db42-0066-5f23-9ee4-2b857bf339a4'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in preferred_language_reference.'',\n           ''Ensure preferred_language_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''f1c1a13a-58bf-51c3-92e0-12f2056f8a68'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''3469db42-0066-5f23-9ee4-2b857bf339a4'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''PreferredLanguageReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sdoh-domain-reference.csv (sdoh_domain_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''f19d5ebb-ea63-5b1d-b1b1-758457a2da29'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sdoh-domain-reference.csv'', ''sdoh_domain_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''34308a17-4300-50d6-96bd-b34982aa25db'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''f19d5ebb-ea63-5b1d-b1b1-758457a2da29'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''SdohDomainReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE sdoh_domain_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''f19d5ebb-ea63-5b1d-b1b1-758457a2da29'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sdoh-domain-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Code''), (''Display''), (''Definition'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''sdoh_domain_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''f19d5ebb-ea63-5b1d-b1b1-758457a2da29'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in sdoh_domain_reference.'',\n           ''Ensure sdoh_domain_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''3204b0bd-3443-59e9-9b22-d1881b9c7797'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''f19d5ebb-ea63-5b1d-b1b1-758457a2da29'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''SdohDomainReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''screening_20240307''\n        AS table_name,\n        ''SCREENING'' AS table_name_suffix\n      UNION ALL\n      SELECT ''admin_demographics_20240307''\n        AS table_name,\n        ''DEMOGRAPHIC_DATA'' AS table_name_suffix\n      UNION ALL\n      SELECT ''qe_admin_data_20240307''\n        AS table_name,\n        ''QE_ADMIN_DATA'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''admin_demographics_20240307'' IN (\n      ''screening_20240307'',\n      ''admin_demographics_20240307'',\n      ''qe_admin_data_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''screening_20240307''\n        AS table_name,\n        ''SCREENING'' AS table_name_suffix\n      UNION ALL\n      SELECT ''admin_demographics_20240307''\n        AS table_name,\n        ''DEMOGRAPHIC_DATA'' AS table_name_suffix\n      UNION ALL\n      SELECT ''qe_admin_data_20240307''\n        AS table_name,\n        ''QE_ADMIN_DATA'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''qe_admin_data_20240307'' IN (\n      ''screening_20240307'',\n      ''admin_demographics_20240307'',\n      ''qe_admin_data_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''screening_20240307''\n        AS table_name,\n        ''SCREENING'' AS table_name_suffix\n      UNION ALL\n      SELECT ''admin_demographics_20240307''\n        AS table_name,\n        ''DEMOGRAPHIC_DATA'' AS table_name_suffix\n      UNION ALL\n      SELECT ''qe_admin_data_20240307''\n        AS table_name,\n        ''QE_ADMIN_DATA'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''screening_20240307'' IN (\n      ''screening_20240307'',\n      ''admin_demographics_20240307'',\n      ''qe_admin_data_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''screening_20240307''\n        AS table_name,\n        ''SCREENING'' AS table_name_suffix\n      UNION ALL\n      SELECT ''admin_demographics_20240307''\n        AS table_name,\n        ''DEMOGRAPHIC_DATA'' AS table_name_suffix\n      UNION ALL\n      SELECT ''qe_admin_data_20240307''\n        AS table_name,\n        ''QE_ADMIN_DATA'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''screening_status_code_reference'' IN (\n      ''screening_20240307'',\n      ''admin_demographics_20240307'',\n      ''qe_admin_data_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''1a152daa-273d-5411-88cf-84067822a8aa'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nSELECT osi.session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value, ingest_table_name FROM orch_session_issue osi LEFT JOIN orch_session_entry ose ON osi.session_entry_id = ose.orch_session_entry_id WHERE osi.session_id = ''52c6a395-5d83-4051-bb7c-39036f26ab29''\n```\nNo STDOUT emitted by `ingest` (status: `0`).\n\nNo STDERR emitted by `ingest`.\n\n    ', NULL);\nINSERT INTO \"orch_session_exec\" (\"orch_session_exec_id\", \"exec_nature\", \"session_id\", \"session_entry_id\", \"parent_exec_id\", \"namespace\", \"exec_identity\", \"exec_code\", \"exec_status\", \"input_text\", \"exec_error_text\", \"output_text\", \"output_nature\", \"narrative_md\", \"elaboration\") VALUES ('35df2d8c-7b46-52f7-b53e-aacbad11754e', 'duckdb', '52c6a395-5d83-4051-bb7c-39036f26ab29', NULL, NULL, NULL, 'ensureContent', 'duckdb HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.workflow/ingestion-center.duckdb', 0, '-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''630f992f-2d33-5d0b-9855-29fdb84f62ee'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''AdminDemographicCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''FIRST_NAME'' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"FIRST_NAME\" IS NULL\n        OR TRIM(CAST(\"FIRST_NAME\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''FIRST_NAME'' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"FIRST_NAME\" AS VARCHAR) NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT ''MIDDLE_NAME'' AS issue_column,\n           \"MIDDLE_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"MIDDLE_NAME\" AS VARCHAR) NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''LAST_NAME'' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"LAST_NAME\" IS NULL\n        OR TRIM(CAST(\"LAST_NAME\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''LAST_NAME'' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"LAST_NAME\" AS VARCHAR) NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''ADMINISTRATIVE_SEX_CODE'' AS issue_column,\n           \"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"ADMINISTRATIVE_SEX_CODE\" IS NULL\n        OR TRIM(CAST(\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''ADMINISTRATIVE_SEX_CODE_SYSTEM'' AS issue_column,\n           \"ADMINISTRATIVE_SEX_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"ADMINISTRATIVE_SEX_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"ADMINISTRATIVE_SEX_CODE_SYSTEM\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_administrative_sex_code_in_all_rows AS (\n    SELECT ''ADMINISTRATIVE_SEX_CODE'' AS issue_column,\n           sr.\"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN administrative_sex_reference ref\n      ON UPPER(sr.\"ADMINISTRATIVE_SEX_CODE\") = UPPER(ref.ADMINISTRATIVE_SEX_CODE)\n     WHERE sr.\"ADMINISTRATIVE_SEX_CODE\" IS NOT NULL\n      AND ref.ADMINISTRATIVE_SEX_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid ADMINISTRATIVE SEX CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ADMINISTRATIVE SEX CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ADMINISTRATIVE SEX CODE with administrative sex reference data''\n      FROM valid_administrative_sex_code_in_all_rows;\nWITH valid_administrative_sex_code_description_in_all_rows AS (\n    SELECT ''ADMINISTRATIVE_SEX_CODE_DESCRIPTION'' AS issue_column,\n           sr.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN administrative_sex_reference ref\n      ON UPPER(sr.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\") = UPPER(ref.ADMINISTRATIVE_SEX_CODE_DESCRIPTION)\n     WHERE sr.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" IS NOT NULL\n      AND ref.ADMINISTRATIVE_SEX_CODE_DESCRIPTION IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid ADMINISTRATIVE SEX CODE DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ADMINISTRATIVE SEX CODE DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ADMINISTRATIVE SEX CODE DESCRIPTION with administrative sex reference data''\n      FROM valid_administrative_sex_code_description_in_all_rows;\nWITH valid_administrative_sex_code_system_in_all_rows AS (\n    SELECT ''ADMINISTRATIVE_SEX_CODE_SYSTEM'' AS issue_column,\n           sr.\"ADMINISTRATIVE_SEX_CODE_SYSTEM\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN administrative_sex_reference ref\n      ON UPPER(sr.\"ADMINISTRATIVE_SEX_CODE_SYSTEM\") = UPPER(ref.ADMINISTRATIVE_SEX_CODE_SYSTEM)\n     WHERE sr.\"ADMINISTRATIVE_SEX_CODE_SYSTEM\" IS NOT NULL\n      AND ref.ADMINISTRATIVE_SEX_CODE_SYSTEM IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid ADMINISTRATIVE SEX CODE SYSTEM'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ADMINISTRATIVE SEX CODE SYSTEM \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ADMINISTRATIVE SEX CODE SYSTEM with administrative sex reference data''\n      FROM valid_administrative_sex_code_system_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ADMINISTRATIVE_SEX_CODE'' AS issue_column,\n      tbl.\"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n      tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"ADMINISTRATIVE_SEX_CODE\" is not null\n  and tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" FROM administrative_sex_reference WHERE UPPER(CAST(tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)) = UPPER(CAST(\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ADMINISTRATIVE_SEX_CODE \"'' || invalid_value || ''\" of ADMINISTRATIVE_SEX_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the ADMINISTRATIVE_SEX_CODE of ADMINISTRATIVE_SEX_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ADMINISTRATIVE_SEX_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ADMINISTRATIVE_SEX_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" is not null\n  and tbl.\"ADMINISTRATIVE_SEX_CODE\" is not null\n  and NOT EXISTS ( SELECT \"ADMINISTRATIVE_SEX_CODE\" FROM administrative_sex_reference WHERE UPPER(CAST(tbl.\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)) = UPPER(CAST(\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ADMINISTRATIVE_SEX_CODE_DESCRIPTION \"'' || invalid_value || ''\" of ADMINISTRATIVE_SEX_CODE \"'' || dependent_value || ''\" is not matching with the ADMINISTRATIVE_SEX_CODE_DESCRIPTION of ADMINISTRATIVE_SEX_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_sex_at_birth_code_in_all_rows AS (\n    SELECT ''SEX_AT_BIRTH_CODE'' AS issue_column,\n           sr.\"SEX_AT_BIRTH_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sex_at_birth_reference ref\n      ON UPPER(sr.SEX_AT_BIRTH_CODE) = UPPER(ref.SEX_AT_BIRTH_CODE)\n     WHERE sr.SEX_AT_BIRTH_CODE IS NOT NULL\n      AND ref.SEX_AT_BIRTH_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid SEX AT BIRTH CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid SEX AT BIRTH CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate SEX AT BIRTH CODE with sex at birth reference data''\n      FROM valid_sex_at_birth_code_in_all_rows;\nWITH valid_sex_at_birth_code_description_in_all_rows AS (\n    SELECT ''SEX_AT_BIRTH_CODE_DESCRIPTION'' AS issue_column,\n           sr.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sex_at_birth_reference ref\n      ON UPPER(sr.SEX_AT_BIRTH_CODE_DESCRIPTION) = UPPER(ref.SEX_AT_BIRTH_CODE_DESCRIPTION)\n     WHERE sr.SEX_AT_BIRTH_CODE_DESCRIPTION IS NOT NULL\n      AND ref.SEX_AT_BIRTH_CODE_DESCRIPTION IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid SEX_AT_BIRTH_CODE_DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid SEX_AT_BIRTH_CODE_DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate SEX_AT_BIRTH_CODE_DESCRIPTION with sex at birth reference data''\n      FROM valid_sex_at_birth_code_description_in_all_rows;\nWITH valid_sex_at_birth_code_system_in_all_rows AS (\n    SELECT ''SEX_AT_BIRTH_CODE_SYSTEM'' AS issue_column,\n           sr.\"SEX_AT_BIRTH_CODE_SYSTEM\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sex_at_birth_reference ref\n      ON UPPER(sr.SEX_AT_BIRTH_CODE_SYSTEM) = UPPER(ref.SEX_AT_BIRTH_CODE_SYSTEM)\n     WHERE sr.SEX_AT_BIRTH_CODE_SYSTEM IS NOT NULL\n      AND ref.SEX_AT_BIRTH_CODE_SYSTEM IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid SEX AT BIRTH CODE SYSTEM'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid SEX AT BIRTH CODE SYSTEM \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate SEX AT BIRTH CODE SYSTEM with sex at birth reference data''\n      FROM valid_sex_at_birth_code_system_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''SEX_AT_BIRTH_CODE'' AS issue_column,\n      tbl.\"SEX_AT_BIRTH_CODE\" AS invalid_value,\n      tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"SEX_AT_BIRTH_CODE\" is not null\n  and tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"SEX_AT_BIRTH_CODE_DESCRIPTION\" FROM sex_at_birth_reference WHERE UPPER(CAST(tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SEX_AT_BIRTH_CODE\" AS VARCHAR)) = UPPER(CAST(\"SEX_AT_BIRTH_CODE\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The SEX_AT_BIRTH_CODE \"'' || invalid_value || ''\" of SEX_AT_BIRTH_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the SEX_AT_BIRTH_CODE of SEX_AT_BIRTH_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''SEX_AT_BIRTH_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"SEX_AT_BIRTH_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" is not null\n  and tbl.\"SEX_AT_BIRTH_CODE\" is not null\n  and NOT EXISTS ( SELECT \"SEX_AT_BIRTH_CODE\" FROM sex_at_birth_reference WHERE UPPER(CAST(tbl.\"SEX_AT_BIRTH_CODE\" AS VARCHAR)) = UPPER(CAST(\"SEX_AT_BIRTH_CODE\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The SEX_AT_BIRTH_CODE_DESCRIPTION \"'' || invalid_value || ''\" of SEX_AT_BIRTH_CODE \"'' || dependent_value || ''\" is not matching with the SEX_AT_BIRTH_CODE_DESCRIPTION of SEX_AT_BIRTH_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''PAT_BIRTH_DATE'' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"PAT_BIRTH_DATE\" IS NULL\n        OR TRIM(CAST(\"PAT_BIRTH_DATE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_date_time_in_all_rows AS (\n    SELECT ''PAT_BIRTH_DATE'' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"PAT_BIRTH_DATE\" IS NOT NULL\n       AND TRY_CAST(\"PAT_BIRTH_DATE\" AS TIMESTAMP) IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Date'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid timestamp \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Please be sure to provide both a valid date and time.''\n      FROM valid_date_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''CITY'' AS issue_column,\n           \"CITY\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"CITY\" IS NULL\n        OR TRIM(CAST(\"CITY\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''STATE'' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"STATE\" IS NULL\n        OR TRIM(CAST(\"STATE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''STATE'' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"STATE\" NOT IN (''NY'', ''New York'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''NY'''', ''''New York'''')'',\n           ''Use only allowed values ''''NY'''', ''''New York'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''ZIP'' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"ZIP\" IS NULL\n        OR TRIM(CAST(\"ZIP\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''ZIP'' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"ZIP\" AS VARCHAR) NOT SIMILAR TO ''^\\d{5}(\\d{4})?$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^\\d{5}(\\d{4})?$'',\n           ''Follow the pattern ^\\d{5}(\\d{4})?$ in '' || issue_column\n      FROM pattern;\nWITH valid_integer_alphanumeric_string_in_all_rows AS (\n  SELECT ''ADDRESS1'' AS issue_column,\n    t.\"ADDRESS1\" AS invalid_value,\n    t.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307 t\n  WHERE t.\"ADDRESS1\" SIMILAR TO ''[0-9]+''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Data Type Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Invalid string of numbers found''\n      FROM valid_integer_alphanumeric_string_in_all_rows;\nWITH valid_address1_or_medicaid_cin_in_all_rows AS (\n    SELECT ''ADDRESS1'' AS issue_column,\n           ADDRESS1 AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM admin_demographics_20240307\n      WHERE (ADDRESS1 IS NULL OR TRIM(\"ADDRESS1\") = '''') AND (MEDICAID_CIN IS NULL OR TRIM(\"MEDICAID_CIN\") = '''')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid ADDRESS1'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value ADDRESS1 is missing. This is required due to the absence of the MEDICAID_CIN.''\n      FROM valid_address1_or_medicaid_cin_in_all_rows;\nWITH valid_gender_identity_code_in_all_rows AS (\n    SELECT ''GENDER_IDENTITY_CODE'' AS issue_column,\n           sr.\"GENDER_IDENTITY_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN gender_identity_reference ref\n      ON UPPER(sr.GENDER_IDENTITY_CODE) = UPPER(ref.GENDER_IDENTITY_CODE)\n     WHERE sr.GENDER_IDENTITY_CODE IS NOT NULL\n      AND ref.GENDER_IDENTITY_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid GENDER IDENTITY CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid GENDER IDENTITY CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate GENDER IDENTITY CODE with gender identity reference data''\n      FROM valid_gender_identity_code_in_all_rows;\nWITH allowed_values AS (\n    SELECT ''GENDER_IDENTITY_CODE_SYSTEM_NAME'' AS issue_column,\n           \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" NOT IN (''SNOMED-CT'',''SNOMED'',''http://snomed.info/sct'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''SNOMED-CT'''',''''SNOMED'''',''''http://snomed.info/sct'''')'',\n           ''Use only allowed values ''''SNOMED-CT'''',''''SNOMED'''',''''http://snomed.info/sct'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''GENDER_IDENTITY_CODE'' AS issue_column,\n      tbl.\"GENDER_IDENTITY_CODE\" AS invalid_value,\n      tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"GENDER_IDENTITY_CODE\" is not null\n  and tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"GENDER_IDENTITY_CODE_DESCRIPTION\" FROM gender_identity_reference WHERE UPPER(CAST(tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS VARCHAR)) AND UPPER(CAST(tbl.\"GENDER_IDENTITY_CODE\" AS VARCHAR)) = UPPER(CAST(\"GENDER_IDENTITY_CODE\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The GENDER_IDENTITY_CODE \"'' || invalid_value || ''\" of GENDER_IDENTITY_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the GENDER_IDENTITY_CODE of GENDER_IDENTITY_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''GENDER_IDENTITY_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"GENDER_IDENTITY_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" is not null\n  and tbl.\"GENDER_IDENTITY_CODE\" is not null\n  and NOT EXISTS ( SELECT \"GENDER_IDENTITY_CODE\" FROM gender_identity_reference WHERE UPPER(CAST(tbl.\"GENDER_IDENTITY_CODE\" AS VARCHAR)) = UPPER(CAST(\"GENDER_IDENTITY_CODE\" AS VARCHAR)) AND UPPER(CAST(tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The GENDER_IDENTITY_CODE_DESCRIPTION \"'' || invalid_value || ''\" of GENDER_IDENTITY_CODE \"'' || dependent_value || ''\" is not matching with the GENDER_IDENTITY_CODE_DESCRIPTION of GENDER_IDENTITY_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_sexual_orientation_code_in_all_rows AS (\n    SELECT ''SEXUAL_ORIENTATION_CODE'' AS issue_column,\n           sr.\"SEXUAL_ORIENTATION_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sexual_orientation_reference ref\n      ON UPPER(sr.SEXUAL_ORIENTATION_CODE) = UPPER(ref.SEXUAL_ORIENTATION_CODE)\n     WHERE sr.SEXUAL_ORIENTATION_CODE IS NOT NULL\n      AND ref.SEXUAL_ORIENTATION_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid SEXUAL ORIENTATION CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid SEXUAL ORIENTATION CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate SEXUAL ORIENTATION CODE with sexual orientation reference data''\n      FROM valid_sexual_orientation_code_in_all_rows;\nWITH valid_sexual_orientation_description_in_all_rows AS (\n    SELECT ''SEXUAL_ORIENTATION_DESCRIPTION'' AS issue_column,\n           sr.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sexual_orientation_reference ref\n      ON UPPER(sr.SEXUAL_ORIENTATION_DESCRIPTION) = UPPER(ref.SEXUAL_ORIENTATION_CODE_DESCRIPTION)\n     WHERE sr.SEXUAL_ORIENTATION_DESCRIPTION IS NOT NULL\n      AND ref.SEXUAL_ORIENTATION_CODE_DESCRIPTION IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid SEXUAL ORIENTATION CODE DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid SEXUAL ORIENTATION CODE DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate SEXUAL ORIENTATION CODE DESCRIPTION with sexual orientation reference data''\n      FROM valid_sexual_orientation_description_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''SEXUAL_ORIENTATION_CODE'' AS issue_column,\n      tbl.\"SEXUAL_ORIENTATION_CODE\" AS invalid_value,\n      tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"SEXUAL_ORIENTATION_CODE\" is not null\n  and tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"SEXUAL_ORIENTATION_CODE_DESCRIPTION\" FROM sexual_orientation_reference WHERE UPPER(CAST(tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"SEXUAL_ORIENTATION_CODE_DESCRIPTION\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SEXUAL_ORIENTATION_CODE\" AS VARCHAR)) = UPPER(CAST(\"SEXUAL_ORIENTATION_CODE\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The SEXUAL_ORIENTATION_CODE \"'' || invalid_value || ''\" of SEXUAL_ORIENTATION_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the SEXUAL_ORIENTATION_CODE of SEXUAL_ORIENTATION_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''SEXUAL_ORIENTATION_DESCRIPTION'' AS issue_column,\n      tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS invalid_value,\n      tbl.\"SEXUAL_ORIENTATION_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" is not null\n  and tbl.\"SEXUAL_ORIENTATION_CODE\" is not null\n  and NOT EXISTS ( SELECT \"SEXUAL_ORIENTATION_CODE\" FROM sexual_orientation_reference WHERE UPPER(CAST(tbl.\"SEXUAL_ORIENTATION_CODE\" AS VARCHAR)) = UPPER(CAST(\"SEXUAL_ORIENTATION_CODE\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"SEXUAL_ORIENTATION_CODE_DESCRIPTION\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The SEXUAL_ORIENTATION_DESCRIPTION \"'' || invalid_value || ''\" of SEXUAL_ORIENTATION_CODE \"'' || dependent_value || ''\" is not matching with the SEXUAL_ORIENTATION_DESCRIPTION of SEXUAL_ORIENTATION_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH allowed_values AS (\n    SELECT ''SEXUAL_ORIENTATION_CODE_SYSTEM_NAME'' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" NOT IN (''SNOMED-CT'',''SNOMED'',''http://snomed.info/sct'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''SNOMED-CT'''',''''SNOMED'''',''''http://snomed.info/sct'''')'',\n           ''Use only allowed values ''''SNOMED-CT'''',''''SNOMED'''',''''http://snomed.info/sct'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_ethnicity_code_in_all_rows AS (\n    SELECT ''ETHNICITY_CODE'' AS issue_column,\n           ad.\"ETHNICITY_CODE\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN ethnicity_reference ref\n      ON UPPER(CAST(ad.\"ETHNICITY_CODE\" AS VARCHAR)) = UPPER(CAST(ref.\"Concept Code\" AS VARCHAR))\n     WHERE ad.\"ETHNICITY_CODE\" IS NOT NULL\n      AND ref.\"Concept Code\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid ETHNICITY CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ETHNICITY CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ETHNICITY CODE with ethnicity reference data''\n      FROM valid_ethnicity_code_in_all_rows;\nWITH valid_ethnicity_code_description_in_all_rows AS (\n    SELECT ''ETHNICITY_CODE_DESCRIPTION'' AS issue_column,\n           ad.\"ETHNICITY_CODE_DESCRIPTION\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN ethnicity_reference ref\n      ON UPPER(CAST(ad.\"ETHNICITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(ref.\"Concept Name\" AS VARCHAR))\n     WHERE ad.\"ETHNICITY_CODE_DESCRIPTION\" IS NOT NULL\n      AND ref.\"Concept Name\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid ETHNICITY CODE DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ETHNICITY CODE DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ETHNICITY CODE DESCRIPTION with ethnicity reference data''\n      FROM valid_ethnicity_code_description_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ETHNICITY_CODE'' AS issue_column,\n      tbl.\"ETHNICITY_CODE\" AS invalid_value,\n      tbl.\"ETHNICITY_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"ETHNICITY_CODE\" is not null\n  and tbl.\"ETHNICITY_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Concept Name\" FROM ethnicity_reference WHERE UPPER(CAST(tbl.\"ETHNICITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Concept Name\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ETHNICITY_CODE\" AS VARCHAR)) = UPPER(CAST(\"Concept Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ETHNICITY_CODE \"'' || invalid_value || ''\" of ETHNICITY_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the ETHNICITY_CODE of ETHNICITY_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ETHNICITY_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"ETHNICITY_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ETHNICITY_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"ETHNICITY_CODE_DESCRIPTION\" is not null\n  and tbl.\"ETHNICITY_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Concept Code\" FROM ethnicity_reference WHERE UPPER(CAST(tbl.\"ETHNICITY_CODE\" AS VARCHAR)) = UPPER(CAST(\"Concept Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ETHNICITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Concept Name\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ETHNICITY_CODE_DESCRIPTION \"'' || invalid_value || ''\" of ETHNICITY_CODE \"'' || dependent_value || ''\" is not matching with the ETHNICITY_CODE_DESCRIPTION of ETHNICITY_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_race_code_in_all_rows AS (\n    SELECT ''RACE_CODE'' AS issue_column,\n           ad.\"RACE_CODE\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN race_reference ref\n      ON UPPER(CAST(ad.\"RACE_CODE\" AS VARCHAR)) = UPPER(CAST(ref.\"Concept Code\" AS VARCHAR))\n     WHERE ad.\"RACE_CODE\" IS NOT NULL\n      AND ref.\"Concept Code\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid RACE CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid RACE CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate RACE CODE with race reference data''\n      FROM valid_race_code_in_all_rows;\nWITH valid_race_code_description_in_all_rows AS (\n    SELECT ''RACE_CODE_DESCRIPTION'' AS issue_column,\n           ad.\"RACE_CODE_DESCRIPTION\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN race_reference ref\n      ON UPPER(CAST(ad.\"RACE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(ref.\"Concept Name\" AS VARCHAR))\n     WHERE ad.\"RACE_CODE_DESCRIPTION\" IS NOT NULL\n      AND ref.\"Concept Name\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid RACE CODE DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid RACE CODE DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate RACE CODE DESCRIPTION with race reference data''\n      FROM valid_race_code_description_in_all_rows;\nWITH valid_preferred_language_code_in_all_rows AS (\n    SELECT ''PREFERRED_LANGUAGE_CODE'' AS issue_column,\n           ad.\"PREFERRED_LANGUAGE_CODE\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN preferred_language_reference ref\n      ON UPPER(CAST(ad.\"PREFERRED_LANGUAGE_CODE\" AS VARCHAR)) = UPPER(CAST(ref.\"ISO 639-2 Code\" AS VARCHAR))\n     WHERE ad.\"PREFERRED_LANGUAGE_CODE\" IS NOT NULL\n      AND ref.\"ISO 639-2 Code\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid PREFERRED LANGUAGE CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid PREFERRED LANGUAGE CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate PREFERRED LANGUAGE CODE with preferred language reference data''\n      FROM valid_preferred_language_code_in_all_rows;\nWITH valid_preferred_language_code_description_in_all_rows AS (\n    SELECT ''PREFERRED_LANGUAGE_DESCRIPTION'' AS issue_column,\n           ad.\"PREFERRED_LANGUAGE_DESCRIPTION\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN preferred_language_reference ref\n      ON UPPER(CAST(ad.\"PREFERRED_LANGUAGE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(ref.\"English name of Language\" AS VARCHAR))\n     WHERE ad.\"PREFERRED_LANGUAGE_DESCRIPTION\" IS NOT NULL\n      AND ref.\"English name of Language\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid PREFERRED LANGUAGE CODE DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid PREFERRED LANGUAGE CODE DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate PREFERRED LANGUAGE CODE DESCRIPTION with preferred language reference data''\n      FROM valid_preferred_language_code_description_in_all_rows;\nWITH allowed_values AS (\n    SELECT ''PREFERRED_LANGUAGE_CODE_SYSTEM_NAME'' AS issue_column,\n           \"PREFERRED_LANGUAGE_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"PREFERRED_LANGUAGE_CODE_SYSTEM_NAME\" NOT IN (''ISO'',''ISO 639-2'',''http://hl7.org/fhir/us/core/ValueSet/simple-language'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''ISO'''',''''ISO 639-2'''',''''http://hl7.org/fhir/us/core/ValueSet/simple-language'''')'',\n           ''Use only allowed values ''''ISO'''',''''ISO 639-2'''',''''http://hl7.org/fhir/us/core/ValueSet/simple-language'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''RACE_CODE'' AS issue_column,\n      tbl.\"RACE_CODE\" AS invalid_value,\n      tbl.\"RACE_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"RACE_CODE\" is not null\n  and tbl.\"RACE_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Concept Name\" FROM race_reference WHERE UPPER(CAST(tbl.\"RACE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Concept Name\" AS VARCHAR)) AND UPPER(CAST(tbl.\"RACE_CODE\" AS VARCHAR)) = UPPER(CAST(\"Concept Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The RACE_CODE \"'' || invalid_value || ''\" of RACE_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the RACE_CODE of RACE_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''PREFERRED_LANGUAGE_CODE'' AS issue_column,\n      tbl.\"PREFERRED_LANGUAGE_CODE\" AS invalid_value,\n      tbl.\"PREFERRED_LANGUAGE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"PREFERRED_LANGUAGE_CODE\" is not null\n  and tbl.\"PREFERRED_LANGUAGE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"English name of Language\" FROM preferred_language_reference WHERE UPPER(CAST(tbl.\"PREFERRED_LANGUAGE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"English name of Language\" AS VARCHAR)) AND UPPER(CAST(tbl.\"PREFERRED_LANGUAGE_CODE\" AS VARCHAR)) = UPPER(CAST(\"ISO 639-2 Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The PREFERRED_LANGUAGE_CODE \"'' || invalid_value || ''\" of PREFERRED_LANGUAGE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the PREFERRED_LANGUAGE_CODE of PREFERRED_LANGUAGE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''RACE_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"RACE_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"RACE_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"RACE_CODE_DESCRIPTION\" is not null\n  and tbl.\"RACE_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Concept Code\" FROM race_reference WHERE UPPER(CAST(tbl.\"RACE_CODE\" AS VARCHAR)) = UPPER(CAST(\"Concept Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"RACE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Concept Name\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The RACE_CODE_DESCRIPTION \"'' || invalid_value || ''\" of RACE_CODE \"'' || dependent_value || ''\" is not matching with the RACE_CODE_DESCRIPTION of RACE_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH allowed_values AS (\n    SELECT ''RACE_CODE_SYSTEM_NAME'' AS issue_column,\n           \"RACE_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"RACE_CODE_SYSTEM_NAME\" NOT IN (''CDC'',''CDCRE'',''urn:oid:2.16.840.1.113883.6.238'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''CDC'''',''''CDCRE'''',''''urn:oid:2.16.840.1.113883.6.238'''')'',\n           ''Use only allowed values ''''CDC'''',''''CDCRE'''',''''urn:oid:2.16.840.1.113883.6.238'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''ETHNICITY_CODE_SYSTEM_NAME'' AS issue_column,\n           \"ETHNICITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"ETHNICITY_CODE_SYSTEM_NAME\" NOT IN (''CDC'',''CDCRE'',''urn:oid:2.16.840.1.113883.6.238'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''CDC'''',''''CDCRE'''',''''urn:oid:2.16.840.1.113883.6.238'''')'',\n           ''Use only allowed values ''''CDC'''',''''CDCRE'''',''''urn:oid:2.16.840.1.113883.6.238'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''MPI_ID'' AS issue_column,\n           \"MPI_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"MPI_ID\" IS NULL\n        OR TRIM(CAST(\"MPI_ID\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(CAST(\"PAT_MRN_ID\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_mpi_id_per_pat_mrn_id_in_all_rows AS (\n    SELECT ''MPI_ID'' AS issue_column,\n      MPI_ID AS invalid_value,\n      min(src_file_row_number) AS issue_row\n    FROM admin_demographics_20240307\n    GROUP BY MPI_ID\n    HAVING COUNT(DISTINCT PAT_MRN_ID) > 1\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid MPI_ID'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''The unique field \"'' || issue_column || ''\" \"'' || invalid_value || ''\"is not unique per PAT MRN ID'',\n           ''MPI_ID is not unique per PAT MRN ID.''\n      FROM valid_mpi_id_per_pat_mrn_id_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_ID'' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ID\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''MEDICAID_CIN'' AS issue_column,\n           \"MEDICAID_CIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"MEDICAID_CIN\" AS VARCHAR) NOT SIMILAR TO ''^[A-Za-z]{2}\\d{5}[A-Za-z]$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$'',\n           ''Follow the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$ in '' || issue_column\n      FROM pattern;\nWITH valid_unique_medicaid_cin_per_mrn_in_all_rows AS (\n  SELECT ''MEDICAID_CIN'' AS issue_column,\n          \"MEDICAID_CIN\" AS invalid_value,\n          min(src_file_row_number) AS issue_row\n    FROM admin_demographics_20240307\n    WHERE MEDICAID_CIN IS NOT NULL\n    GROUP BY pat_mrn_id, MEDICAID_CIN\n    HAVING COUNT(*) > 1\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Unique Medicaid Cin Per Mrn'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid Unique Medicaid Cin Per Mrn \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate Unique Medicaid Cin Per Mrn''\n      FROM valid_unique_medicaid_cin_per_mrn_in_all_rows;\nWITH valid_address1_or_medicaid_cin_in_all_rows AS (\n    SELECT ''MEDICAID_CIN'' AS issue_column,\n           MEDICAID_CIN AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM admin_demographics_20240307\n      WHERE (MEDICAID_CIN IS NULL OR TRIM(\"MEDICAID_CIN\") = '''') AND (ADDRESS1 IS NULL OR TRIM(\"ADDRESS1\") = '''')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid MEDICAID_CIN'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value MEDICAID_CIN is missing. This is required due to the absence of the ADDRESS1.''\n      FROM valid_address1_or_medicaid_cin_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''CONSENT'' AS issue_column,\n           \"CONSENT\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"CONSENT\" IS NULL\n        OR TRIM(CAST(\"CONSENT\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''CONSENT'' AS issue_column,\n           \"CONSENT\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"CONSENT\" NOT IN (''Yes'', ''YES'', ''yes'', ''Y'', ''y'', ''No'', ''NO'', ''no'',''N'', ''n'',''Unknown'', ''UNKNOWN'', ''unknown'',''UNK'', ''Unk'', ''unk'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''YES'''', ''''yes'''', ''''Y'''', ''''y'''', ''''No'''', ''''NO'''', ''''no'''',''''N'''', ''''n'''',''''Unknown'''', ''''UNKNOWN'''', ''''unknown'''',''''UNK'''', ''''Unk'''', ''''unk'''')'',\n           ''Use only allowed values ''''Yes'''', ''''YES'''', ''''yes'''', ''''Y'''', ''''y'''', ''''No'''', ''''NO'''', ''''no'''',''''N'''', ''''n'''',''''Unknown'''', ''''UNKNOWN'''', ''''unknown'''',''''UNK'''', ''''Unk'''', ''''unk'''' in '' || issue_column\n      FROM allowed_values;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''87f8bee3-8c83-518e-865a-740b0e3a45d3'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''AdminDemographicCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''f6f5cc47-43d2-5134-b3d4-e6d954f3e391'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''767cb8df-3ec0-5b59-998e-a91e75be32b3'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''QeAdminDataCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(CAST(\"PAT_MRN_ID\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_ID'' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ID\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_unique_facility_id_per_facility_in_all_rows AS (\n  SELECT ''FACILITY_ID'' AS issue_column,\n    FACILITY_ID AS invalid_value,\n    min(src_file_row_number) AS issue_row\n  FROM qe_admin_data_20240307\n  GROUP BY FACILITY_ID\n  HAVING COUNT(DISTINCT FACILITY_LONG_NAME) > 1\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Invalid FACILITY_ID'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''The unique field \"'' || issue_column || ''\" \"'' || invalid_value || ''\"is not unique per facility'',\n           ''FACILITY_ID is not unique per facility.''\n      FROM valid_unique_facility_id_per_facility_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_LONG_NAME'' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_LONG_NAME\" IS NULL\n        OR TRIM(CAST(\"FACILITY_LONG_NAME\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''ORGANIZATION_TYPE'' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"ORGANIZATION_TYPE\" IS NULL\n        OR TRIM(CAST(\"ORGANIZATION_TYPE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''ORGANIZATION_TYPE'' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"ORGANIZATION_TYPE\" NOT IN (''Hospital'', ''DTC'', ''SNF'', ''SCN'', ''CBO'', ''OMH'', ''OASAS'', ''Practice'', ''Article 36'', ''Article 40'', ''MCO'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Hospital'''', ''''DTC'''', ''''SNF'''', ''''SCN'''', ''''CBO'''', ''''OMH'''', ''''OASAS'''', ''''Practice'''', ''''Article 36'''', ''''Article 40'''', ''''MCO'''')'',\n           ''Use only allowed values ''''Hospital'''', ''''DTC'''', ''''SNF'''', ''''SCN'''', ''''CBO'''', ''''OMH'''', ''''OASAS'''', ''''Practice'''', ''''Article 36'''', ''''Article 40'''', ''''MCO'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_ADDRESS1'' AS issue_column,\n           \"FACILITY_ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_ADDRESS1\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ADDRESS1\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_unique_facility_address1_per_facility_in_all_rows AS (\n  SELECT ''FACILITY_ADDRESS1'' AS issue_column,\n    FACILITY_ADDRESS1 AS invalid_value,\n    min(src_file_row_number) AS issue_row\n  FROM qe_admin_data_20240307\n  GROUP BY FACILITY_ADDRESS1\n  HAVING COUNT(DISTINCT FACILITY_LONG_NAME) > 1\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Invalid FACILITY_ADDRESS1'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''The unique field \"'' || issue_column || ''\" \"'' || invalid_value || ''\"is not unique per facility'',\n           ''FACILITY_ADDRESS1 is not unique per facility.''\n      FROM valid_unique_facility_address1_per_facility_in_all_rows;\nWITH valid_integer_alphanumeric_string_in_all_rows AS (\n  SELECT ''FACILITY_ADDRESS1'' AS issue_column,\n    t.\"FACILITY_ADDRESS1\" AS invalid_value,\n    t.src_file_row_number AS issue_row\n  FROM qe_admin_data_20240307 t\n  WHERE t.\"FACILITY_ADDRESS1\" SIMILAR TO ''[0-9]+''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Data Type Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Invalid string of numbers found''\n      FROM valid_integer_alphanumeric_string_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_STATE'' AS issue_column,\n           \"FACILITY_STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_STATE\" IS NULL\n        OR TRIM(CAST(\"FACILITY_STATE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''FACILITY_STATE'' AS issue_column,\n           \"FACILITY_STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_STATE\" NOT IN (''NY'', ''New York'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''NY'''', ''''New York'''')'',\n           ''Use only allowed values ''''NY'''', ''''New York'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_ZIP'' AS issue_column,\n           \"FACILITY_ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_ZIP\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ZIP\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''FACILITY_ZIP'' AS issue_column,\n           \"FACILITY_ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE CAST(\"FACILITY_ZIP\" AS VARCHAR) NOT SIMILAR TO ''^\\d{5}(\\d{4})?$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^\\d{5}(\\d{4})?$'',\n           ''Follow the pattern ^\\d{5}(\\d{4})?$ in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''VISIT_PART_2_FLAG'' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_PART_2_FLAG\" IS NULL\n        OR TRIM(CAST(\"VISIT_PART_2_FLAG\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_PART_2_FLAG'' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_PART_2_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_OMH_FLAG'' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_OMH_FLAG\" IS NULL\n        OR TRIM(CAST(\"VISIT_OMH_FLAG\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_OMH_FLAG'' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_OMH_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_OPWDD_FLAG'' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_OPWDD_FLAG\" IS NULL\n        OR TRIM(CAST(\"VISIT_OPWDD_FLAG\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_OPWDD_FLAG'' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_OPWDD_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH pattern AS (\n    SELECT ''FACILITY_LONG_NAME'' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE CAST(\"FACILITY_LONG_NAME\" AS VARCHAR) NOT SIMILAR TO ''^[a-zA-Z\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z\\s]+$ in '' || issue_column\n      FROM pattern;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7115f76c-32eb-563c-a1d5-040d0146651a'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''767cb8df-3ec0-5b59-998e-a91e75be32b3'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''QeAdminDataCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''26a2e6f5-6b62-5616-8b14-1059006f438b'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''ScreeningCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n\nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(CAST(\"PAT_MRN_ID\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_ID'' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ID\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_pat_mrn_id_across_all_three_tables AS (\n  WITH cte_qe_demographic_unmatched AS (\n      SELECT DISTINCT COALESCE(ad.PAT_MRN_ID, qe.PAT_MRN_ID) AS PAT_MRN_ID,\n              COALESCE(ad.FACILITY_ID, qe.FACILITY_ID) AS FACILITY_ID,\n                    CASE\n                        WHEN ad.PAT_MRN_ID IS NULL THEN ''QE_ADMIN_DATA''\n                        ELSE ''ADMIN_DEMOGRAPHIC''\n                    END AS unmatched_source,\n                    COALESCE(ad.src_file_row_number, qe.src_file_row_number) AS src_file_row_number,\n      FROM  admin_demographics_20240307 ad\n      FULL OUTER JOIN qe_admin_data_20240307 qe\n          ON ad.PAT_MRN_ID = qe.PAT_MRN_ID\n          AND ad.FACILITY_ID = qe.FACILITY_ID\n      WHERE ad.PAT_MRN_ID IS NULL OR qe.PAT_MRN_ID IS NULL\n  )\n  Select ''PAT_MRN_ID'' AS issue_column, pat_mrn_id AS invalid_pat_value, FACILITY_ID AS invalid_facility_value, unmatched_source, src_file_row_number  AS issue_row,\n  case when unmatched_source = ''ADMIN_DEMOGRAPHIC'' then ''admin_demographics_20240307''\n  when unmatched_source = ''QE_ADMIN_DATA'' then ''qe_admin_data_20240307''\n  Else '''' End As issue_table_name\n  from cte_qe_demographic_unmatched\n  UNION\n  Select DISTINCT ''PAT_MRN_ID'' AS issue_column, s.PAT_MRN_ID AS invalid_pat_value,s.FACILITY_ID AS invalid_facility_value,''SCREENING'' As unmatched_source, src_file_row_number  AS issue_row,\n  ''screening_20240307'' as issue_table_name\n  FROM screening_20240307 s\n    Left Outer Join (\n      SELECT  DISTINCT a.PAT_MRN_ID,a.FACILITY_ID From admin_demographics_20240307 a\n      Inner Join qe_admin_data_20240307 q\n      ON a.PAT_MRN_ID = q.PAT_MRN_ID\n      AND a.FACILITY_ID = q.FACILITY_ID\n      WHERE a.PAT_MRN_ID IS NOT NULL AND q.PAT_MRN_ID IS NOT NULL\n    ) aq\n    ON s.PAT_MRN_ID = aq.PAT_MRN_ID\n  AND aq.FACILITY_ID = s.FACILITY_ID\n  Where aq.PAT_MRN_ID IS  NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''PAT_MRN_ID that does not match the FACILITY_ID'',\n           issue_row,\n           issue_column,\n           invalid_pat_value,\n           ''PAT_MRN_ID (\"'' || invalid_pat_value || ''\") that does not match the FACILITY_ID (\"'' || invalid_facility_value || ''\") across the files was found in \"'' || issue_table_name || ''\".'',\n           ''Validate PAT_MRN_ID that maches the FACILITY_ID across the files''\n      FROM valid_pat_mrn_id_across_all_three_tables;\nWITH mandatory_value AS (\n    SELECT ''ENCOUNTER_CLASS_CODE'' AS issue_column,\n           \"ENCOUNTER_CLASS_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_CLASS_CODE\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_CLASS_CODE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_encounter_class_in_all_rows AS (\n    SELECT ''ENCOUNTER_CLASS_CODE'' AS issue_column,\n           sr.\"ENCOUNTER_CLASS_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_class_reference ecr\n      ON UPPER(sr.ENCOUNTER_CLASS_CODE) = UPPER(ecr.Code)\n     WHERE sr.ENCOUNTER_CLASS_CODE IS NOT NULL\n      AND ecr.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ENCOUNTER CLASS CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ENCOUNTER CLASS CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ENCOUNTER CLASS CODE with encounter class reference data''\n      FROM valid_encounter_class_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ENCOUNTER_CLASS_CODE'' AS issue_column,\n      tbl.\"ENCOUNTER_CLASS_CODE\" AS invalid_value,\n      tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_CLASS_CODE\" is not null\n  and tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Display\" FROM encounter_class_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_CLASS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ENCOUNTER_CLASS_CODE \"'' || invalid_value || ''\" of ENCOUNTER_CLASS_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the ENCOUNTER_CLASS_CODE of ENCOUNTER_CLASS_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ENCOUNTER_CLASS_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ENCOUNTER_CLASS_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" is not null\n  and tbl.\"ENCOUNTER_CLASS_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Code\" FROM encounter_class_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_CLASS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ENCOUNTER_CLASS_CODE_DESCRIPTION \"'' || invalid_value || ''\" of ENCOUNTER_CLASS_CODE \"'' || dependent_value || ''\" is not matching with the ENCOUNTER_CLASS_CODE_DESCRIPTION of ENCOUNTER_CLASS_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''ENCOUNTER_CLASS_CODE_SYSTEM'' AS issue_column,\n           \"ENCOUNTER_CLASS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_CLASS_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_CLASS_CODE_SYSTEM\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''ENCOUNTER_CLASS_CODE_SYSTEM'' AS issue_column,\n           \"ENCOUNTER_CLASS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_CLASS_CODE_SYSTEM\" NOT IN (''http://terminology.hl7.org/CodeSystem/v3-ActCode'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''http://terminology.hl7.org/CodeSystem/v3-ActCode'''')'',\n           ''Use only allowed values ''''http://terminology.hl7.org/CodeSystem/v3-ActCode'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_encounter_class_in_all_rows AS (\n    SELECT ''ENCOUNTER_CLASS_CODE_DESCRIPTION'' AS issue_column,\n           sr.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_class_reference ecr\n      ON UPPER(sr.ENCOUNTER_CLASS_CODE_DESCRIPTION) = UPPER(ecr.Display)\n     WHERE sr.ENCOUNTER_CLASS_CODE_DESCRIPTION IS NOT NULL\n      AND ecr.Display IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ENCOUNTER CLASS CODE DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ENCOUNTER CLASS CODE DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ENCOUNTER CLASS CODE DESCRIPTION with encounter class reference data''\n      FROM valid_encounter_class_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''ENCOUNTER_STATUS_CODE'' AS issue_column,\n           \"ENCOUNTER_STATUS_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_STATUS_CODE\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_STATUS_CODE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_encounter_status_code_in_all_rows AS (\n    SELECT ''ENCOUNTER_STATUS_CODE'' AS issue_column,\n           sr.\"ENCOUNTER_STATUS_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_status_code_reference ecr\n      ON UPPER(sr.ENCOUNTER_STATUS_CODE) = UPPER(ecr.Code)\n     WHERE sr.ENCOUNTER_STATUS_CODE IS NOT NULL\n      AND ecr.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ENCOUNTER STATUS CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ENCOUNTER STATUS CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ENCOUNTER STATUS CODE with encounter status reference data''\n      FROM valid_encounter_status_code_in_all_rows;\nWITH valid_encounter_status_code_in_all_rows AS (\n    SELECT ''ENCOUNTER_STATUS_CODE_DESCRIPTION'' AS issue_column,\n           sr.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_status_code_reference ecr\n      ON UPPER(sr.ENCOUNTER_STATUS_CODE_DESCRIPTION) = UPPER(ecr.Display)\n     WHERE sr.ENCOUNTER_STATUS_CODE_DESCRIPTION IS NOT NULL\n      AND ecr.Display IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ENCOUNTER STATUS CODE DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ENCOUNTER STATUS CODE DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ENCOUNTER STATUS CODE DESCRIPTION with encounter status reference data''\n      FROM valid_encounter_status_code_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ENCOUNTER_STATUS_CODE'' AS issue_column,\n      tbl.\"ENCOUNTER_STATUS_CODE\" AS invalid_value,\n      tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_STATUS_CODE\" is not null\n  and tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Display\" FROM encounter_status_code_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_STATUS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ENCOUNTER_STATUS_CODE \"'' || invalid_value || ''\" of ENCOUNTER_STATUS_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the ENCOUNTER_STATUS_CODE of ENCOUNTER_STATUS_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ENCOUNTER_STATUS_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ENCOUNTER_STATUS_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" is not null\n  and tbl.\"ENCOUNTER_STATUS_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Code\" FROM encounter_status_code_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_STATUS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ENCOUNTER_STATUS_CODE_DESCRIPTION \"'' || invalid_value || ''\" of ENCOUNTER_STATUS_CODE \"'' || dependent_value || ''\" is not matching with the ENCOUNTER_STATUS_CODE_DESCRIPTION of ENCOUNTER_STATUS_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''ENCOUNTER_STATUS_CODE_SYSTEM'' AS issue_column,\n           \"ENCOUNTER_STATUS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_STATUS_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_STATUS_CODE_SYSTEM\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''ENCOUNTER_STATUS_CODE_SYSTEM'' AS issue_column,\n           \"ENCOUNTER_STATUS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_STATUS_CODE_SYSTEM\" NOT IN (''http://hl7.org/fhir/encounter-status'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''http://hl7.org/fhir/encounter-status'''')'',\n           ''Use only allowed values ''''http://hl7.org/fhir/encounter-status'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''ENCOUNTER_TYPE_CODE'' AS issue_column,\n           \"ENCOUNTER_TYPE_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_TYPE_CODE\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_TYPE_CODE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''ENCOUNTER_TYPE_CODE_SYSTEM'' AS issue_column,\n           \"ENCOUNTER_TYPE_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_TYPE_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_TYPE_CODE_SYSTEM\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_encounter_type_code_in_all_rows AS (\n    SELECT ''ENCOUNTER_TYPE_CODE'' AS issue_column,\n           sr.\"ENCOUNTER_TYPE_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_type_code_reference ecr\n      ON UPPER(CAST(sr.ENCOUNTER_TYPE_CODE AS VARCHAR)) = UPPER(CAST(ecr.Code AS VARCHAR))\n     WHERE sr.ENCOUNTER_TYPE_CODE IS NOT NULL\n      AND ecr.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ENCOUNTER TYPE CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ENCOUNTER TYPE CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ENCOUNTER TYPE CODE with encounter type reference data''\n      FROM valid_encounter_type_code_in_all_rows;\nWITH allowed_values AS (\n    SELECT ''ENCOUNTER_TYPE_CODE_SYSTEM'' AS issue_column,\n           \"ENCOUNTER_TYPE_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_TYPE_CODE_SYSTEM\" NOT IN (''SNOMED-CT'', ''SNOMED'', ''http://snomed.info/sct'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''SNOMED-CT'''', ''''SNOMED'''', ''''http://snomed.info/sct'''')'',\n           ''Use only allowed values ''''SNOMED-CT'''', ''''SNOMED'''', ''''http://snomed.info/sct'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_encounter_type_code_in_all_rows AS (\n    SELECT ''ENCOUNTER_TYPE_CODE_DESCRIPTION'' AS issue_column,\n           sr.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_type_code_reference ecr\n      ON UPPER(CAST(sr.ENCOUNTER_TYPE_CODE_DESCRIPTION AS VARCHAR)) = UPPER(CAST(ecr.Display AS VARCHAR))\n     WHERE sr.ENCOUNTER_TYPE_CODE_DESCRIPTION IS NOT NULL\n      AND ecr.Display IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ENCOUNTER TYPE CODE DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ENCOUNTER TYPE CODE DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ENCOUNTER TYPE CODE DESCRIPTION with encounter type reference data''\n      FROM valid_encounter_type_code_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ENCOUNTER_TYPE_CODE'' AS issue_column,\n      tbl.\"ENCOUNTER_TYPE_CODE\" AS invalid_value,\n      tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_TYPE_CODE\" is not null\n  and tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Display\" FROM encounter_type_code_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_TYPE_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ENCOUNTER_TYPE_CODE \"'' || invalid_value || ''\" of ENCOUNTER_TYPE_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the ENCOUNTER_TYPE_CODE of ENCOUNTER_TYPE_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ENCOUNTER_TYPE_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ENCOUNTER_TYPE_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" is not null\n  and tbl.\"ENCOUNTER_TYPE_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Code\" FROM encounter_type_code_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_TYPE_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ENCOUNTER_TYPE_CODE_DESCRIPTION \"'' || invalid_value || ''\" of ENCOUNTER_TYPE_CODE \"'' || dependent_value || ''\" is not matching with the ENCOUNTER_TYPE_CODE_DESCRIPTION of ENCOUNTER_TYPE_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''SCREENING_STATUS_CODE'' AS issue_column,\n           \"SCREENING_STATUS_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_STATUS_CODE\" IS NULL\n        OR TRIM(CAST(\"SCREENING_STATUS_CODE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_screening_status_code_in_all_rows AS (\n    SELECT ''SCREENING_STATUS_CODE'' AS issue_column,\n           sr.\"SCREENING_STATUS_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN screening_status_code_reference ref\n      ON UPPER(sr.SCREENING_STATUS_CODE) = UPPER(ref.Code)\n     WHERE sr.SCREENING_STATUS_CODE IS NOT NULL\n      AND ref.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid SCREENING STATUS CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid SCREENING STATUS CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate SCREENING STATUS CODE with screening status code reference data''\n      FROM valid_screening_status_code_in_all_rows;\nWITH valid_screening_status_code_in_all_rows AS (\n    SELECT ''SCREENING_STATUS_CODE_DESCRIPTION'' AS issue_column,\n           sr.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN screening_status_code_reference ecr\n      ON UPPER(sr.SCREENING_STATUS_CODE_DESCRIPTION) = UPPER(ecr.Display)\n     WHERE sr.SCREENING_STATUS_CODE_DESCRIPTION IS NOT NULL\n      AND ecr.Display IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid SCREENING STATUS CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid SCREENING STATUS CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate SCREENING STATUS CODE with screening status code reference data''\n      FROM valid_screening_status_code_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''SCREENING_STATUS_CODE'' AS issue_column,\n      tbl.\"SCREENING_STATUS_CODE\" AS invalid_value,\n      tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"SCREENING_STATUS_CODE\" is not null\n  and tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Display\" FROM screening_status_code_reference WHERE UPPER(CAST(tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SCREENING_STATUS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The SCREENING_STATUS_CODE \"'' || invalid_value || ''\" of SCREENING_STATUS_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the SCREENING_STATUS_CODE of SCREENING_STATUS_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''SCREENING_STATUS_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"SCREENING_STATUS_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" is not null\n  and tbl.\"SCREENING_STATUS_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Code\" FROM screening_status_code_reference WHERE UPPER(CAST(tbl.\"SCREENING_STATUS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The SCREENING_STATUS_CODE_DESCRIPTION \"'' || invalid_value || ''\" of SCREENING_STATUS_CODE \"'' || dependent_value || ''\" is not matching with the SCREENING_STATUS_CODE_DESCRIPTION of SCREENING_STATUS_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''SCREENING_STATUS_CODE_SYSTEM'' AS issue_column,\n           \"SCREENING_STATUS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_STATUS_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"SCREENING_STATUS_CODE_SYSTEM\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''SCREENING_STATUS_CODE_SYSTEM'' AS issue_column,\n           \"SCREENING_STATUS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_STATUS_CODE_SYSTEM\" NOT IN (''http://hl7.org/fhir/observation-status'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''http://hl7.org/fhir/observation-status'''')'',\n           ''Use only allowed values ''''http://hl7.org/fhir/observation-status'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  ''ANSWER_CODE'' AS issue_column,\n              \"ANSWER_CODE\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (ANSWER_CODE IS NULL OR TRIM(\"ANSWER_CODE\") = '''')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN (''TOTAL SAFETY SCORE'',\n            ''CALCULATED WEEKLY PHYSICAL ACTIVITY'',\n            ''CALCULATED MENTAL HEALTH SCORE'')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid value in ANSWER_CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value ANSWER_CODE is missing''\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  ''ANSWER_CODE_SYSTEM_NAME'' AS issue_column,\n              \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (ANSWER_CODE_SYSTEM_NAME IS NULL OR TRIM(\"ANSWER_CODE_SYSTEM_NAME\") = '''')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN (''TOTAL SAFETY SCORE'',\n            ''CALCULATED WEEKLY PHYSICAL ACTIVITY'',\n            ''CALCULATED MENTAL HEALTH SCORE'')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid value in ANSWER_CODE_SYSTEM_NAME'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value ANSWER_CODE_SYSTEM_NAME is missing''\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  ''QUESTION_CODE'' AS issue_column,\n              \"QUESTION_CODE\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (QUESTION_CODE IS NULL OR TRIM(\"QUESTION_CODE\") = '''')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN (''TOTAL SAFETY SCORE'',\n            ''CALCULATED WEEKLY PHYSICAL ACTIVITY'',\n            ''CALCULATED MENTAL HEALTH SCORE'')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid value in QUESTION_CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value QUESTION_CODE is missing''\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  ''QUESTION_CODE_SYSTEM_NAME'' AS issue_column,\n              \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (QUESTION_CODE_SYSTEM_NAME IS NULL OR TRIM(\"QUESTION_CODE_SYSTEM_NAME\") = '''')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN (''TOTAL SAFETY SCORE'',\n            ''CALCULATED WEEKLY PHYSICAL ACTIVITY'',\n            ''CALCULATED MENTAL HEALTH SCORE'')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid value in QUESTION_CODE_SYSTEM_NAME'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value QUESTION_CODE_SYSTEM_NAME is missing''\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  ''SCREENING_CODE_DESCRIPTION'' AS issue_column,\n              \"SCREENING_CODE_DESCRIPTION\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (SCREENING_CODE_DESCRIPTION IS NULL OR TRIM(\"SCREENING_CODE_DESCRIPTION\") = '''')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN (''TOTAL SAFETY SCORE'',\n            ''CALCULATED WEEKLY PHYSICAL ACTIVITY'',\n            ''CALCULATED MENTAL HEALTH SCORE'')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid value in SCREENING_CODE_DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value SCREENING_CODE_DESCRIPTION is missing''\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH allowed_values AS (\n    SELECT ''SCREENING_CODE_DESCRIPTION'' AS issue_column,\n           \"SCREENING_CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_CODE_DESCRIPTION\" NOT IN (''Accountable health communities (AHC) health-related social needs (HRSN) supplemental questions'',''Accountable health communities (AHC) health-related social needs screening (HRSN) tool'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Accountable health communities (AHC) health-related social needs (HRSN) supplemental questions'''',''''Accountable health communities (AHC) health-related social needs screening (HRSN) tool'''')'',\n           ''Use only allowed values ''''Accountable health communities (AHC) health-related social needs (HRSN) supplemental questions'''',''''Accountable health communities (AHC) health-related social needs screening (HRSN) tool'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  ''SCREENING_CODE_SYSTEM_NAME'' AS issue_column,\n              \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (SCREENING_CODE_SYSTEM_NAME IS NULL OR TRIM(\"SCREENING_CODE_SYSTEM_NAME\") = '''')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN (''TOTAL SAFETY SCORE'',\n            ''CALCULATED WEEKLY PHYSICAL ACTIVITY'',\n            ''CALCULATED MENTAL HEALTH SCORE'')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid value in SCREENING_CODE_SYSTEM_NAME'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value SCREENING_CODE_SYSTEM_NAME is missing''\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  ''SCREENING_CODE'' AS issue_column,\n              \"SCREENING_CODE\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (SCREENING_CODE IS NULL OR TRIM(\"SCREENING_CODE\") = '''')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN (''TOTAL SAFETY SCORE'',\n            ''CALCULATED WEEKLY PHYSICAL ACTIVITY'',\n            ''CALCULATED MENTAL HEALTH SCORE'')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid value in SCREENING_CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value SCREENING_CODE is missing''\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''QUESTION_CODE_DESCRIPTION'' AS issue_column,\n           \"QUESTION_CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"QUESTION_CODE_DESCRIPTION\" IS NULL\n        OR TRIM(CAST(\"QUESTION_CODE_DESCRIPTION\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_answer_code_in_all_rows AS (\n  SELECT ''ANSWER_CODE'' AS issue_column,\n    scr.\"ANSWER_CODE\" AS invalid_value,\n    scr.\"QUESTION_CODE\" AS invalid_question_value,\n    scr.SCREENING_CODE AS invalid_screening_value,\n    scr.src_file_row_number AS issue_row\n    FROM screening_20240307 scr\n    LEFT OUTER JOIN ahc_cross_walk crw\n      ON UPPER(scr.SCREENING_CODE) = UPPER(crw.SCREENING_CODE)\n      AND UPPER(scr.QUESTION_CODE) = UPPER(crw.QUESTION_CODE)\n      AND UPPER(scr.ANSWER_CODE) = UPPER(crw.ANSWER_CODE)\n    WHERE scr.SCREENING_CODE IS NOT NULL\n      AND scr.QUESTION_CODE IS NOT NULL\n      AND scr.ANSWER_CODE IS NOT NULL\n      AND crw.ANSWER_CODE IS NULL\n)\n\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Answer Code'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Provided Screening Code \"'' || invalid_screening_value || ''\", Question Code \"'' || invalid_question_value || ''\" and Answer Code \"'' || invalid_value || ''\" are not matching with the reference data found in '' || issue_column,\n           ''Validate Screening Code, Question Code and Answer Code with ahc cross walk reference data''\n      FROM valid_answer_code_in_all_rows;\nWITH valid_total_safety_score_in_all_rows AS (\n  WITH cte_score AS (\n    SELECT\n        SUM(crw.Score) AS cross_walk_Score,\n        SUM(\n            CASE\n                WHEN UPPER(TRIM(scr.QUESTION_CODE_DESCRIPTION)) LIKE ''%TOTAL SAFETY SCORE%'' AND TRY_CAST(scr.ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL THEN CAST(scr.ANSWER_CODE_DESCRIPTION AS INTEGER)\n                ELSE 0\n            END\n        ) AS screening_score\n    FROM\n        screening_20240307 scr\n    LEFT OUTER JOIN (\n        SELECT \tacw.SCREENING_CODE,\n              acw.QUESTION_CODE,\n              acw.ANSWER_CODE,\n              acw.QUESTION_SLNO,\n              acw.Score AS Score\n        FROM ahc_cross_walk acw\n        Where QUESTION_SLNO_REFERENCE In(\n        SELECT QUESTION_SLNO\n            FROM ahc_cross_walk\n            WHERE UPPER(TRIM(QUESTION)) LIKE ''%TOTAL SAFETY SCORE%''\n            )\n        AND acw.QUESTION_CODE = scr.QUESTION_CODE\n        AND acw.ANSWER_CODE = scr.ANSWER_CODE\n    ) AS crw ON crw.SCREENING_CODE = scr.SCREENING_CODE\n)\nSELECT \tcross_walk_Score,\n    screening_score AS invalid_value,\n    (SELECT src_file_row_number FROM screening_20240307 WHERE UPPER(TRIM(QUESTION_CODE_DESCRIPTION)) LIKE ''%TOTAL SAFETY SCORE%'') AS issue_row,\n  ''ANSWER_CODE_DESCRIPTION'' AS issue_column\nFROM cte_score\nWHERE screening_score <> cross_walk_Score\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ANSWER_CODE_DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ANSWER_CODE_DESCRIPTION for TOTAL SAFETY SCORE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ANSWER_CODE_DESCRIPTION for TOTAL SAFETY SCORE (Calculated Score)''\n      FROM valid_total_safety_score_in_all_rows;\nWITH valid_calculated_mental_health_score_in_all_rows AS (\n  SELECT ANSWER_CODE_DESCRIPTION AS issue_column,\n  SCREENING_CALCULATED_SCORE AS invalid_value,\n  SRC_FILE_ROW_NUMBER AS issue_row\n  FROM\n  (\n  SELECT Sum(crw.score) As CROSSWALK_ANSWER_SCORE,\n      (SELECT CASE WHEN TRY_CAST(ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL THEN CAST(ANSWER_CODE_DESCRIPTION AS INTEGER) ELSE 0 END AS SCREENING_CALC_SCORE\n        FROM screening_20240307 scr2\n        WHERE UPPER(scr2.QUESTION_CODE_DESCRIPTION) LIKE ''%CALCULATED MENTAL HEALTH SCORE%''\n    ) AS SCREENING_CALCULATED_SCORE,\n    (SELECT src_file_row_number FROM screening_20240307 WHERE UPPER(QUESTION_CODE_DESCRIPTION) LIKE ''%CALCULATED MENTAL HEALTH SCORE%'') AS SRC_FILE_ROW_NUMBER,\n    ''ANSWER_CODE_DESCRIPTION'' AS ANSWER_CODE_DESCRIPTION\n      FROM screening_20240307 scr\n      INNER JOIN (\n          SELECT \tacw.score As SCORE\n          FROM ahc_cross_walk acw\n          Where QUESTION_SLNO_REFERENCE In(\n          SELECT QUESTION_SLNO\n              FROM ahc_cross_walk\n              WHERE UPPER(QUESTION) LIKE ''%CALCULATED MENTAL HEALTH SCORE%''\n              )\n          AND acw.QUESTION_CODE = scr.QUESTION_CODE\n          AND acw.ANSWER_CODE  = scr.ANSWER_CODE\n      ) AS crw ON 1 = 1\n  ) As calc_fld_val\n  Where calc_fld_val.CROSSWALK_ANSWER_SCORE <> calc_fld_val.SCREENING_CALCULATED_SCORE\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ANSWER_CODE_DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ANSWER_CODE_DESCRIPTION for CALCULATED MENTAL HEALTH SCORE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ANSWER_CODE_DESCRIPTION for CALCULATED MENTAL HEALTH SCORE (Calculated Score)''\n      FROM valid_calculated_mental_health_score_in_all_rows;\nWITH valid_calculated_weekly_physical_activity_score_in_all_rows AS (\n  WITH cte_physical_activity AS (\n    SELECT\n      scr.SCREENING_CODE,\n      scr.QUESTION_CODE,\n      scr.ANSWER_CODE,\n      crw.ANSWER_VALUE,\n      scr.ANSWER_CODE_DESCRIPTION,\n      ROW_NUMBER() OVER (\n      ORDER BY scr.SCREENING_CODE) AS sequence_number\n    FROM\n      screening_20240307 scr\n    INNER JOIN (\n      SELECT\n        acw.SCREENING_CODE,\n        acw.QUESTION_CODE,\n        acw.ANSWER_CODE,\n        acw.QUESTION_SLNO,\n        CASE\n          WHEN TRY_CAST(acw.ANSWER_VALUE AS INTEGER) IS NOT NULL THEN CAST(acw.ANSWER_VALUE AS INTEGER)\n          ELSE CASE WHEN acw.ANSWER_CODE=''LA32060-8'' THEN 150 ELSE 0 END\n        END AS ANSWER_VALUE\n      FROM\n        ahc_cross_walk acw\n      Where\n        QUESTION_SLNO_REFERENCE In(\n        SELECT\n          QUESTION_SLNO\n        FROM\n          ahc_cross_walk\n        WHERE\n          UPPER(QUESTION) LIKE ''%CALCULATED PHYSICAL ACTIVITY SCORE%''\n                )\n        AND acw.QUESTION_CODE = scr.QUESTION_CODE\n        AND acw.ANSWER_CODE = scr.ANSWER_CODE\n        ) AS crw ON\n      crw.SCREENING_CODE = scr.SCREENING_CODE\n    )\n    Select \tANSWER_CODE_DESCRIPTION AS issue_column,\n        CROSSWALK_ANSWER_VALUE AS CROSSWALK_ANSWER_VALUE,\n        SCREENING_CALCULATED_VALUE AS invalid_value,\n        SRC_FILE_ROW_NUMBER AS issue_row\n    FROM\n      (\n      Select\n        t1.ANSWER_VALUE * t2.ANSWER_VALUE As CROSSWALK_ANSWER_VALUE,\n        CASE\n          WHEN TRY_CAST(t1.ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL\n            AND TRY_CAST(t2.ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL THEN\n        CAST(t1.ANSWER_CODE_DESCRIPTION AS INTEGER) * CAST(t2.ANSWER_CODE_DESCRIPTION AS INTEGER)\n          ELSE CASE WHEN t2.ANSWER_CODE=''LA32060-8'' THEN 150 * CAST(t1.ANSWER_CODE_DESCRIPTION AS INTEGER) ELSE 0 END\n          END AS SCREENING_ANSWER_VALUE,\n          Scrn_Phycical_Act_Score.SCRN_PHYSICAL_ACTIVITY_VALUE AS SCREENING_CALCULATED_VALUE,\n          (SELECT src_file_row_number FROM screening_20240307 WHERE UPPER(QUESTION_CODE_DESCRIPTION) LIKE ''%CALCULATED WEEKLY PHYSICAL ACTIVITY%'') AS SRC_FILE_ROW_NUMBER,\n          ''ANSWER_CODE_DESCRIPTION'' AS ANSWER_CODE_DESCRIPTION\n\n        from\n          cte_physical_activity t1\n        Inner Join cte_physical_activity t2\n    On\n          t1.sequence_number = 1\n          and t2.sequence_number = 2\n        Left Outer Join (\n          Select\n            CASE\n              WHEN TRY_CAST(ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL THEN CAST(ANSWER_CODE_DESCRIPTION AS INTEGER)\n              ELSE 0\n            END SCRN_PHYSICAL_ACTIVITY_VALUE\n          From\n          screening_20240307 scr\n          Where\n            UPPER(scr.QUESTION_CODE_DESCRIPTION) LIKE ''%CALCULATED WEEKLY PHYSICAL ACTIVITY%'') AS Scrn_Phycical_Act_Score\n                On\n          1 = 1\n    ) As calc_fld\n    Where\n      (calc_fld.CROSSWALK_ANSWER_VALUE <> calc_fld.SCREENING_ANSWER_VALUE)\n      OR (calc_fld.SCREENING_ANSWER_VALUE <> calc_fld.SCREENING_CALCULATED_VALUE)\n      OR (calc_fld.CROSSWALK_ANSWER_VALUE <> calc_fld.SCREENING_CALCULATED_VALUE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ANSWER_CODE_DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ANSWER_CODE_DESCRIPTION for CALCULATED PHYSICAL ACTIVITY SCORE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ANSWER_CODE_DESCRIPTION for CALCULATED PHYSICAL ACTIVITY SCORE (Calculated Score)''\n      FROM valid_calculated_weekly_physical_activity_score_in_all_rows;\nWITH allowed_values AS (\n    SELECT ''SCREENING_CODE'' AS issue_column,\n           \"SCREENING_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_CODE\" NOT IN (''96777-8'', ''97023-6'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''96777-8'''', ''''97023-6'''')'',\n           ''Use only allowed values ''''96777-8'''', ''''97023-6'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''SCREENING_CODE_SYSTEM_NAME'' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" NOT IN (''LN'', ''LOINC'', ''http://loinc.org'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''', ''''LOINC'''', ''''http://loinc.org'''')'',\n           ''Use only allowed values ''''LN'''', ''''LOINC'''', ''''http://loinc.org'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''RECORDED_TIME'' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"RECORDED_TIME\" IS NULL\n        OR TRIM(CAST(\"RECORDED_TIME\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_date_time_in_all_rows AS (\n        SELECT  ''RECORDED_TIME'' AS issue_column,\n              \"RECORDED_TIME\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM \"screening_20240307\"\n        WHERE \"RECORDED_TIME\" IS NOT NULL\n        AND \"RECORDED_TIME\" NOT SIMILAR TO ''([0-9]([0-9]([0-9][1-9]|[1-9]0)|[1-9]00)|[1-9]000)-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])T([01][0-9]|2[0-3]):[0-5][0-9]:([0-5][0-9]|60)(\\.[0-9]+)?(Z|(\\+|-)((0[0-9]|1[0-3]):[0-5][0-9]|14:00))$''\n        OR TRY_CAST(\"RECORDED_TIME\" AS TIMESTAMP) IS NULL\n  )\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Date'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid timestamp \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Please be sure to provide both a valid date and time.''\n      FROM valid_date_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''SDOH_DOMAIN'' AS issue_column,\n           \"SDOH_DOMAIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SDOH_DOMAIN\" IS NULL\n        OR TRIM(CAST(\"SDOH_DOMAIN\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_sdoh_domain_in_all_rows AS (\n  SELECT DISTINCT scr.SDOH_DOMAIN AS invalid_value,\n    ''SDOH_DOMAIN'' AS issue_column,\n    scr.src_file_row_number AS issue_row\n  FROM screening_20240307 scr\n  LEFT JOIN ahc_cross_walk cw\n  ON UPPER(scr.SDOH_DOMAIN) = UPPER(cw.SDOH_DOMAIN)\n  WHERE cw.SDOH_DOMAIN IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid SDOH DOMAIN'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid SDOH DOMAIN \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate SDOH DOMAIN with ahc cross walk reference data''\n      FROM valid_sdoh_domain_in_all_rows;\nWITH valid_question_code_for_screening_code_in_all_rows AS (\n  SELECT DISTINCT scr.SCREENING_CODE AS issue_screening_value, scr.QUESTION_CODE AS invalid_value, ''QUESTION_CODE'' AS issue_column, scr.src_file_row_number AS issue_row\n  FROM screening_20240307 scr\n  LEFT JOIN ahc_cross_walk cw ON UPPER(scr.QUESTION_CODE) = UPPER(cw.QUESTION_CODE)\n  AND UPPER(scr.SCREENING_CODE) = UPPER(cw.SCREENING_CODE)\n  WHERE cw.QUESTION_CODE IS NULL\n  AND cw.SCREENING_CODE IS NOT NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Question Code'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid Question Code \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate Question Code with ahc cross walk reference data''\n      FROM valid_question_code_for_screening_code_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''ANSWER_CODE_DESCRIPTION'' AS issue_column,\n           \"ANSWER_CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ANSWER_CODE_DESCRIPTION\" IS NULL\n        OR TRIM(CAST(\"ANSWER_CODE_DESCRIPTION\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''QUESTION_CODE_SYSTEM_NAME'' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" NOT IN (''LN'',''LOINC'',''http://loinc.org'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''',''''LOINC'''',''''http://loinc.org'''')'',\n           ''Use only allowed values ''''LN'''',''''LOINC'''',''''http://loinc.org'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''ANSWER_CODE_SYSTEM_NAME'' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" NOT IN (''LN'',''LOINC'',''http://loinc.org'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''',''''LOINC'''',''''http://loinc.org'''')'',\n           ''Use only allowed values ''''LN'''',''''LOINC'''',''''http://loinc.org'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''POTENTIAL_NEED_INDICATED'' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" IS NULL\n        OR TRIM(CAST(\"POTENTIAL_NEED_INDICATED\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''POTENTIAL_NEED_INDICATED'' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" NOT IN (''Yes'',''No'',''NA'',''yes'',''no'',''na'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''',''''No'''',''''NA'''',''''yes'''',''''no'''',''''na'''')'',\n           ''Use only allowed values ''''Yes'''',''''No'''',''''NA'''',''''yes'''',''''no'''',''''na'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_screening_potential_need_indicated_question_answer_values_in_all_rows AS (\n  SELECT  ''POTENTIAL_NEED_INDICATED'' AS issue_column,\n          coalesce(scr.\"POTENTIAL_NEED_INDICATED\",''NULL'') AS invalid_value,\n          scr.ANSWER_CODE AS invalid_answer_value,\n          scr.QUESTION_CODE AS invalid_question_value,\n          scr.SCREENING_CODE AS invalid_screening_value,\n          scr.src_file_row_number AS issue_row\n  FROM screening_20240307 scr\n  LEFT JOIN ahc_cross_walk acw\n    ON UPPER(scr.SCREENING_CODE) = UPPER(acw.SCREENING_CODE)\n    AND UPPER(scr.QUESTION_CODE) = UPPER(acw.QUESTION_CODE)\n    AND UPPER(scr.ANSWER_CODE) = UPPER(acw.ANSWER_CODE)\n    AND UPPER(scr.\"POTENTIAL_NEED_INDICATED\") = UPPER(acw.\"POTENTIAL_NEED_INDICATED\")\n  WHERE acw.\"POTENTIAL_NEED_INDICATED\" IS NULL\n  AND  UPPER(scr.QUESTION_CODE_DESCRIPTION)\n  NOT IN(\n    ''TOTAL SAFETY SCORE'',\n    ''CALCULATED WEEKLY PHYSICAL ACTIVITY'',\n    ''CALCULATED MENTAL HEALTH SCORE''\n  )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid value in POTENTIAL_NEED_INDICATED'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Provided Potential Need Indicated \"'' || invalid_value || ''\", Screening Code \"'' || invalid_screening_value || ''\", Question Code \"'' || invalid_question_value || ''\" and Answer Code \"'' || invalid_answer_value || ''\" are not matching with the reference data found in '' || issue_column,\n           ''Validate Potential Need Indicated, Screening Code, Question Code and Answer Code with ahc cross walk reference data''\n      FROM valid_screening_potential_need_indicated_question_answer_values_in_all_rows;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''c50d9d2d-753b-5200-b2f6-e63309cf252d'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''ScreeningCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''463a01b7-82ad-5633-939d-54a554d09923'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''b9aac8ec-792a-511d-8107-25bd96085898'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''AhcCrossWalkCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''98f79424-a291-554e-aa6a-17c4c39e5c81'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''b9aac8ec-792a-511d-8107-25bd96085898'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''AhcCrossWalkCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''1e8926d1-43b1-5485-9308-7addd10605ab'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''48eb0055-f06e-57f4-8019-f49266be3d22'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''EncounterClassReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''a76151ab-e619-51bb-9db7-57c686404756'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''48eb0055-f06e-57f4-8019-f49266be3d22'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''EncounterClassReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''81a8b5c0-5c79-5ff9-95d6-cfcf0749c550'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''2e9c77e9-a664-5323-83e4-e6a92cf998ab'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''EncounterStatusCodeReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''731b9b5d-fbb0-541f-93bc-11778098ab71'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''2e9c77e9-a664-5323-83e4-e6a92cf998ab'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''EncounterStatusCodeReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''2af573ce-4941-56c1-a703-f92928ad3a7d'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''4b3dd9ab-d81b-509a-9662-68dbd6d142f7'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''EncounterTypeCodeReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''8fe71cea-8904-5ba0-823d-de9955eee28d'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''4b3dd9ab-d81b-509a-9662-68dbd6d142f7'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''EncounterTypeCodeReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''b7082a36-d569-5f54-b0fe-23dfaca90466'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''1a152daa-273d-5411-88cf-84067822a8aa'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''ScreeningStatusCodeReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7d4a917b-2900-5b12-a89c-a246a342b27b'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''1a152daa-273d-5411-88cf-84067822a8aa'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''ScreeningStatusCodeReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''de2853a4-d787-5e6d-ba4c-58a0cd667eac'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''787ee7ff-3ef5-59aa-a055-659cf10b6202'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''GenderIdentityReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''51873a08-9517-54b6-982b-38b5e08677b8'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''787ee7ff-3ef5-59aa-a055-659cf10b6202'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''GenderIdentityReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''bd4d7db3-4490-5a2f-8b54-876cd96bb629'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''79f3d60e-c863-5759-8043-f122175a7cbb'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''AdministrativeSexReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''e6b6e4b0-6fdd-5d2b-a626-801aaaa4967f'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''79f3d60e-c863-5759-8043-f122175a7cbb'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''AdministrativeSexReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7b22a848-5153-5975-b74e-e9c3ea06640c'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''6c2d9879-7393-524d-9e9e-02ea961aca39'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''SexAtBirthReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''8a53e502-4b61-5596-88d5-e2e23a907935'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''6c2d9879-7393-524d-9e9e-02ea961aca39'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''SexAtBirthReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''0ab7227d-471c-5f13-9630-7f3c0c6cd120'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''2239dca2-9dd4-5c3a-91c8-2585839b9584'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''SexualOrientationReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''63af23ca-ea46-53d2-a55c-459cb2419b54'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''2239dca2-9dd4-5c3a-91c8-2585839b9584'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''SexualOrientationReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''41f3b3f2-2670-5600-96ca-a39e21943a0a'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''fc740f9e-863e-5dd1-b1a1-86d176cb549c'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''BusinessRulesReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''2bb73de9-1a11-58ac-bcda-74d30c2ace8e'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''fc740f9e-863e-5dd1-b1a1-86d176cb549c'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''BusinessRulesReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''baac722a-6a3b-5494-9df5-91e63f8c22b0'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''f98a88dc-a929-5a9b-906a-277e62c93012'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''RaceReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''312774c2-4ed4-526a-a68c-64356a89466d'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''f98a88dc-a929-5a9b-906a-277e62c93012'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''RaceReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''6cf18abf-2b0d-5ec5-9b5e-2a7e81d0bcc3'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''b0cbca95-5c20-5b2b-b589-9e832c556bc6'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''EthnicityReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''66d2dfbd-511a-58c0-9092-fd1965efbe27'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''b0cbca95-5c20-5b2b-b589-9e832c556bc6'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''EthnicityReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''905ccf58-6d99-5787-97b2-2534a35e55d6'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''3469db42-0066-5f23-9ee4-2b857bf339a4'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''PreferredLanguageReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''96ffe5ed-2b40-5e9b-8e13-a60d66430ceb'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''3469db42-0066-5f23-9ee4-2b857bf339a4'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''PreferredLanguageReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''83c7e8ef-bc1c-5726-a3f1-46ec9c63a4df'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''f19d5ebb-ea63-5b1d-b1b1-758457a2da29'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''SdohDomainReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''aae34d6f-c822-51b7-b05a-b06cb3774a0f'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''f19d5ebb-ea63-5b1d-b1b1-758457a2da29'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''SdohDomainReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      ', NULL, NULL, NULL, '\n## ensureContent\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''630f992f-2d33-5d0b-9855-29fdb84f62ee'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''AdminDemographicCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''FIRST_NAME'' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"FIRST_NAME\" IS NULL\n        OR TRIM(CAST(\"FIRST_NAME\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''FIRST_NAME'' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"FIRST_NAME\" AS VARCHAR) NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT ''MIDDLE_NAME'' AS issue_column,\n           \"MIDDLE_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"MIDDLE_NAME\" AS VARCHAR) NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''LAST_NAME'' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"LAST_NAME\" IS NULL\n        OR TRIM(CAST(\"LAST_NAME\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''LAST_NAME'' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"LAST_NAME\" AS VARCHAR) NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''ADMINISTRATIVE_SEX_CODE'' AS issue_column,\n           \"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"ADMINISTRATIVE_SEX_CODE\" IS NULL\n        OR TRIM(CAST(\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''ADMINISTRATIVE_SEX_CODE_SYSTEM'' AS issue_column,\n           \"ADMINISTRATIVE_SEX_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"ADMINISTRATIVE_SEX_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"ADMINISTRATIVE_SEX_CODE_SYSTEM\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_administrative_sex_code_in_all_rows AS (\n    SELECT ''ADMINISTRATIVE_SEX_CODE'' AS issue_column,\n           sr.\"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN administrative_sex_reference ref\n      ON UPPER(sr.\"ADMINISTRATIVE_SEX_CODE\") = UPPER(ref.ADMINISTRATIVE_SEX_CODE)\n     WHERE sr.\"ADMINISTRATIVE_SEX_CODE\" IS NOT NULL\n      AND ref.ADMINISTRATIVE_SEX_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid ADMINISTRATIVE SEX CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ADMINISTRATIVE SEX CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ADMINISTRATIVE SEX CODE with administrative sex reference data''\n      FROM valid_administrative_sex_code_in_all_rows;\nWITH valid_administrative_sex_code_description_in_all_rows AS (\n    SELECT ''ADMINISTRATIVE_SEX_CODE_DESCRIPTION'' AS issue_column,\n           sr.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN administrative_sex_reference ref\n      ON UPPER(sr.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\") = UPPER(ref.ADMINISTRATIVE_SEX_CODE_DESCRIPTION)\n     WHERE sr.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" IS NOT NULL\n      AND ref.ADMINISTRATIVE_SEX_CODE_DESCRIPTION IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid ADMINISTRATIVE SEX CODE DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ADMINISTRATIVE SEX CODE DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ADMINISTRATIVE SEX CODE DESCRIPTION with administrative sex reference data''\n      FROM valid_administrative_sex_code_description_in_all_rows;\nWITH valid_administrative_sex_code_system_in_all_rows AS (\n    SELECT ''ADMINISTRATIVE_SEX_CODE_SYSTEM'' AS issue_column,\n           sr.\"ADMINISTRATIVE_SEX_CODE_SYSTEM\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN administrative_sex_reference ref\n      ON UPPER(sr.\"ADMINISTRATIVE_SEX_CODE_SYSTEM\") = UPPER(ref.ADMINISTRATIVE_SEX_CODE_SYSTEM)\n     WHERE sr.\"ADMINISTRATIVE_SEX_CODE_SYSTEM\" IS NOT NULL\n      AND ref.ADMINISTRATIVE_SEX_CODE_SYSTEM IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid ADMINISTRATIVE SEX CODE SYSTEM'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ADMINISTRATIVE SEX CODE SYSTEM \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ADMINISTRATIVE SEX CODE SYSTEM with administrative sex reference data''\n      FROM valid_administrative_sex_code_system_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ADMINISTRATIVE_SEX_CODE'' AS issue_column,\n      tbl.\"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n      tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"ADMINISTRATIVE_SEX_CODE\" is not null\n  and tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" FROM administrative_sex_reference WHERE UPPER(CAST(tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)) = UPPER(CAST(\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ADMINISTRATIVE_SEX_CODE \"'' || invalid_value || ''\" of ADMINISTRATIVE_SEX_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the ADMINISTRATIVE_SEX_CODE of ADMINISTRATIVE_SEX_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ADMINISTRATIVE_SEX_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ADMINISTRATIVE_SEX_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" is not null\n  and tbl.\"ADMINISTRATIVE_SEX_CODE\" is not null\n  and NOT EXISTS ( SELECT \"ADMINISTRATIVE_SEX_CODE\" FROM administrative_sex_reference WHERE UPPER(CAST(tbl.\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)) = UPPER(CAST(\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ADMINISTRATIVE_SEX_CODE_DESCRIPTION \"'' || invalid_value || ''\" of ADMINISTRATIVE_SEX_CODE \"'' || dependent_value || ''\" is not matching with the ADMINISTRATIVE_SEX_CODE_DESCRIPTION of ADMINISTRATIVE_SEX_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_sex_at_birth_code_in_all_rows AS (\n    SELECT ''SEX_AT_BIRTH_CODE'' AS issue_column,\n           sr.\"SEX_AT_BIRTH_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sex_at_birth_reference ref\n      ON UPPER(sr.SEX_AT_BIRTH_CODE) = UPPER(ref.SEX_AT_BIRTH_CODE)\n     WHERE sr.SEX_AT_BIRTH_CODE IS NOT NULL\n      AND ref.SEX_AT_BIRTH_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid SEX AT BIRTH CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid SEX AT BIRTH CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate SEX AT BIRTH CODE with sex at birth reference data''\n      FROM valid_sex_at_birth_code_in_all_rows;\nWITH valid_sex_at_birth_code_description_in_all_rows AS (\n    SELECT ''SEX_AT_BIRTH_CODE_DESCRIPTION'' AS issue_column,\n           sr.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sex_at_birth_reference ref\n      ON UPPER(sr.SEX_AT_BIRTH_CODE_DESCRIPTION) = UPPER(ref.SEX_AT_BIRTH_CODE_DESCRIPTION)\n     WHERE sr.SEX_AT_BIRTH_CODE_DESCRIPTION IS NOT NULL\n      AND ref.SEX_AT_BIRTH_CODE_DESCRIPTION IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid SEX_AT_BIRTH_CODE_DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid SEX_AT_BIRTH_CODE_DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate SEX_AT_BIRTH_CODE_DESCRIPTION with sex at birth reference data''\n      FROM valid_sex_at_birth_code_description_in_all_rows;\nWITH valid_sex_at_birth_code_system_in_all_rows AS (\n    SELECT ''SEX_AT_BIRTH_CODE_SYSTEM'' AS issue_column,\n           sr.\"SEX_AT_BIRTH_CODE_SYSTEM\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sex_at_birth_reference ref\n      ON UPPER(sr.SEX_AT_BIRTH_CODE_SYSTEM) = UPPER(ref.SEX_AT_BIRTH_CODE_SYSTEM)\n     WHERE sr.SEX_AT_BIRTH_CODE_SYSTEM IS NOT NULL\n      AND ref.SEX_AT_BIRTH_CODE_SYSTEM IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid SEX AT BIRTH CODE SYSTEM'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid SEX AT BIRTH CODE SYSTEM \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate SEX AT BIRTH CODE SYSTEM with sex at birth reference data''\n      FROM valid_sex_at_birth_code_system_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''SEX_AT_BIRTH_CODE'' AS issue_column,\n      tbl.\"SEX_AT_BIRTH_CODE\" AS invalid_value,\n      tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"SEX_AT_BIRTH_CODE\" is not null\n  and tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"SEX_AT_BIRTH_CODE_DESCRIPTION\" FROM sex_at_birth_reference WHERE UPPER(CAST(tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SEX_AT_BIRTH_CODE\" AS VARCHAR)) = UPPER(CAST(\"SEX_AT_BIRTH_CODE\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The SEX_AT_BIRTH_CODE \"'' || invalid_value || ''\" of SEX_AT_BIRTH_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the SEX_AT_BIRTH_CODE of SEX_AT_BIRTH_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''SEX_AT_BIRTH_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"SEX_AT_BIRTH_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" is not null\n  and tbl.\"SEX_AT_BIRTH_CODE\" is not null\n  and NOT EXISTS ( SELECT \"SEX_AT_BIRTH_CODE\" FROM sex_at_birth_reference WHERE UPPER(CAST(tbl.\"SEX_AT_BIRTH_CODE\" AS VARCHAR)) = UPPER(CAST(\"SEX_AT_BIRTH_CODE\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The SEX_AT_BIRTH_CODE_DESCRIPTION \"'' || invalid_value || ''\" of SEX_AT_BIRTH_CODE \"'' || dependent_value || ''\" is not matching with the SEX_AT_BIRTH_CODE_DESCRIPTION of SEX_AT_BIRTH_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''PAT_BIRTH_DATE'' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"PAT_BIRTH_DATE\" IS NULL\n        OR TRIM(CAST(\"PAT_BIRTH_DATE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_date_time_in_all_rows AS (\n    SELECT ''PAT_BIRTH_DATE'' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"PAT_BIRTH_DATE\" IS NOT NULL\n       AND TRY_CAST(\"PAT_BIRTH_DATE\" AS TIMESTAMP) IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Date'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid timestamp \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Please be sure to provide both a valid date and time.''\n      FROM valid_date_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''CITY'' AS issue_column,\n           \"CITY\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"CITY\" IS NULL\n        OR TRIM(CAST(\"CITY\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''STATE'' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"STATE\" IS NULL\n        OR TRIM(CAST(\"STATE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''STATE'' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"STATE\" NOT IN (''NY'', ''New York'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''NY'''', ''''New York'''')'',\n           ''Use only allowed values ''''NY'''', ''''New York'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''ZIP'' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"ZIP\" IS NULL\n        OR TRIM(CAST(\"ZIP\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''ZIP'' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"ZIP\" AS VARCHAR) NOT SIMILAR TO ''^\\d{5}(\\d{4})?$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^\\d{5}(\\d{4})?$'',\n           ''Follow the pattern ^\\d{5}(\\d{4})?$ in '' || issue_column\n      FROM pattern;\nWITH valid_integer_alphanumeric_string_in_all_rows AS (\n  SELECT ''ADDRESS1'' AS issue_column,\n    t.\"ADDRESS1\" AS invalid_value,\n    t.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307 t\n  WHERE t.\"ADDRESS1\" SIMILAR TO ''[0-9]+''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Data Type Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Invalid string of numbers found''\n      FROM valid_integer_alphanumeric_string_in_all_rows;\nWITH valid_address1_or_medicaid_cin_in_all_rows AS (\n    SELECT ''ADDRESS1'' AS issue_column,\n           ADDRESS1 AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM admin_demographics_20240307\n      WHERE (ADDRESS1 IS NULL OR TRIM(\"ADDRESS1\") = '''') AND (MEDICAID_CIN IS NULL OR TRIM(\"MEDICAID_CIN\") = '''')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid ADDRESS1'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value ADDRESS1 is missing. This is required due to the absence of the MEDICAID_CIN.''\n      FROM valid_address1_or_medicaid_cin_in_all_rows;\nWITH valid_gender_identity_code_in_all_rows AS (\n    SELECT ''GENDER_IDENTITY_CODE'' AS issue_column,\n           sr.\"GENDER_IDENTITY_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN gender_identity_reference ref\n      ON UPPER(sr.GENDER_IDENTITY_CODE) = UPPER(ref.GENDER_IDENTITY_CODE)\n     WHERE sr.GENDER_IDENTITY_CODE IS NOT NULL\n      AND ref.GENDER_IDENTITY_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid GENDER IDENTITY CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid GENDER IDENTITY CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate GENDER IDENTITY CODE with gender identity reference data''\n      FROM valid_gender_identity_code_in_all_rows;\nWITH allowed_values AS (\n    SELECT ''GENDER_IDENTITY_CODE_SYSTEM_NAME'' AS issue_column,\n           \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" NOT IN (''SNOMED-CT'',''SNOMED'',''http://snomed.info/sct'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''SNOMED-CT'''',''''SNOMED'''',''''http://snomed.info/sct'''')'',\n           ''Use only allowed values ''''SNOMED-CT'''',''''SNOMED'''',''''http://snomed.info/sct'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''GENDER_IDENTITY_CODE'' AS issue_column,\n      tbl.\"GENDER_IDENTITY_CODE\" AS invalid_value,\n      tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"GENDER_IDENTITY_CODE\" is not null\n  and tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"GENDER_IDENTITY_CODE_DESCRIPTION\" FROM gender_identity_reference WHERE UPPER(CAST(tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS VARCHAR)) AND UPPER(CAST(tbl.\"GENDER_IDENTITY_CODE\" AS VARCHAR)) = UPPER(CAST(\"GENDER_IDENTITY_CODE\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The GENDER_IDENTITY_CODE \"'' || invalid_value || ''\" of GENDER_IDENTITY_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the GENDER_IDENTITY_CODE of GENDER_IDENTITY_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''GENDER_IDENTITY_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"GENDER_IDENTITY_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" is not null\n  and tbl.\"GENDER_IDENTITY_CODE\" is not null\n  and NOT EXISTS ( SELECT \"GENDER_IDENTITY_CODE\" FROM gender_identity_reference WHERE UPPER(CAST(tbl.\"GENDER_IDENTITY_CODE\" AS VARCHAR)) = UPPER(CAST(\"GENDER_IDENTITY_CODE\" AS VARCHAR)) AND UPPER(CAST(tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The GENDER_IDENTITY_CODE_DESCRIPTION \"'' || invalid_value || ''\" of GENDER_IDENTITY_CODE \"'' || dependent_value || ''\" is not matching with the GENDER_IDENTITY_CODE_DESCRIPTION of GENDER_IDENTITY_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_sexual_orientation_code_in_all_rows AS (\n    SELECT ''SEXUAL_ORIENTATION_CODE'' AS issue_column,\n           sr.\"SEXUAL_ORIENTATION_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sexual_orientation_reference ref\n      ON UPPER(sr.SEXUAL_ORIENTATION_CODE) = UPPER(ref.SEXUAL_ORIENTATION_CODE)\n     WHERE sr.SEXUAL_ORIENTATION_CODE IS NOT NULL\n      AND ref.SEXUAL_ORIENTATION_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid SEXUAL ORIENTATION CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid SEXUAL ORIENTATION CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate SEXUAL ORIENTATION CODE with sexual orientation reference data''\n      FROM valid_sexual_orientation_code_in_all_rows;\nWITH valid_sexual_orientation_description_in_all_rows AS (\n    SELECT ''SEXUAL_ORIENTATION_DESCRIPTION'' AS issue_column,\n           sr.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sexual_orientation_reference ref\n      ON UPPER(sr.SEXUAL_ORIENTATION_DESCRIPTION) = UPPER(ref.SEXUAL_ORIENTATION_CODE_DESCRIPTION)\n     WHERE sr.SEXUAL_ORIENTATION_DESCRIPTION IS NOT NULL\n      AND ref.SEXUAL_ORIENTATION_CODE_DESCRIPTION IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid SEXUAL ORIENTATION CODE DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid SEXUAL ORIENTATION CODE DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate SEXUAL ORIENTATION CODE DESCRIPTION with sexual orientation reference data''\n      FROM valid_sexual_orientation_description_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''SEXUAL_ORIENTATION_CODE'' AS issue_column,\n      tbl.\"SEXUAL_ORIENTATION_CODE\" AS invalid_value,\n      tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"SEXUAL_ORIENTATION_CODE\" is not null\n  and tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"SEXUAL_ORIENTATION_CODE_DESCRIPTION\" FROM sexual_orientation_reference WHERE UPPER(CAST(tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"SEXUAL_ORIENTATION_CODE_DESCRIPTION\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SEXUAL_ORIENTATION_CODE\" AS VARCHAR)) = UPPER(CAST(\"SEXUAL_ORIENTATION_CODE\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The SEXUAL_ORIENTATION_CODE \"'' || invalid_value || ''\" of SEXUAL_ORIENTATION_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the SEXUAL_ORIENTATION_CODE of SEXUAL_ORIENTATION_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''SEXUAL_ORIENTATION_DESCRIPTION'' AS issue_column,\n      tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS invalid_value,\n      tbl.\"SEXUAL_ORIENTATION_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" is not null\n  and tbl.\"SEXUAL_ORIENTATION_CODE\" is not null\n  and NOT EXISTS ( SELECT \"SEXUAL_ORIENTATION_CODE\" FROM sexual_orientation_reference WHERE UPPER(CAST(tbl.\"SEXUAL_ORIENTATION_CODE\" AS VARCHAR)) = UPPER(CAST(\"SEXUAL_ORIENTATION_CODE\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"SEXUAL_ORIENTATION_CODE_DESCRIPTION\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The SEXUAL_ORIENTATION_DESCRIPTION \"'' || invalid_value || ''\" of SEXUAL_ORIENTATION_CODE \"'' || dependent_value || ''\" is not matching with the SEXUAL_ORIENTATION_DESCRIPTION of SEXUAL_ORIENTATION_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH allowed_values AS (\n    SELECT ''SEXUAL_ORIENTATION_CODE_SYSTEM_NAME'' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" NOT IN (''SNOMED-CT'',''SNOMED'',''http://snomed.info/sct'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''SNOMED-CT'''',''''SNOMED'''',''''http://snomed.info/sct'''')'',\n           ''Use only allowed values ''''SNOMED-CT'''',''''SNOMED'''',''''http://snomed.info/sct'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_ethnicity_code_in_all_rows AS (\n    SELECT ''ETHNICITY_CODE'' AS issue_column,\n           ad.\"ETHNICITY_CODE\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN ethnicity_reference ref\n      ON UPPER(CAST(ad.\"ETHNICITY_CODE\" AS VARCHAR)) = UPPER(CAST(ref.\"Concept Code\" AS VARCHAR))\n     WHERE ad.\"ETHNICITY_CODE\" IS NOT NULL\n      AND ref.\"Concept Code\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid ETHNICITY CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ETHNICITY CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ETHNICITY CODE with ethnicity reference data''\n      FROM valid_ethnicity_code_in_all_rows;\nWITH valid_ethnicity_code_description_in_all_rows AS (\n    SELECT ''ETHNICITY_CODE_DESCRIPTION'' AS issue_column,\n           ad.\"ETHNICITY_CODE_DESCRIPTION\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN ethnicity_reference ref\n      ON UPPER(CAST(ad.\"ETHNICITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(ref.\"Concept Name\" AS VARCHAR))\n     WHERE ad.\"ETHNICITY_CODE_DESCRIPTION\" IS NOT NULL\n      AND ref.\"Concept Name\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid ETHNICITY CODE DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ETHNICITY CODE DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ETHNICITY CODE DESCRIPTION with ethnicity reference data''\n      FROM valid_ethnicity_code_description_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ETHNICITY_CODE'' AS issue_column,\n      tbl.\"ETHNICITY_CODE\" AS invalid_value,\n      tbl.\"ETHNICITY_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"ETHNICITY_CODE\" is not null\n  and tbl.\"ETHNICITY_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Concept Name\" FROM ethnicity_reference WHERE UPPER(CAST(tbl.\"ETHNICITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Concept Name\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ETHNICITY_CODE\" AS VARCHAR)) = UPPER(CAST(\"Concept Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ETHNICITY_CODE \"'' || invalid_value || ''\" of ETHNICITY_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the ETHNICITY_CODE of ETHNICITY_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ETHNICITY_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"ETHNICITY_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ETHNICITY_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"ETHNICITY_CODE_DESCRIPTION\" is not null\n  and tbl.\"ETHNICITY_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Concept Code\" FROM ethnicity_reference WHERE UPPER(CAST(tbl.\"ETHNICITY_CODE\" AS VARCHAR)) = UPPER(CAST(\"Concept Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ETHNICITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Concept Name\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ETHNICITY_CODE_DESCRIPTION \"'' || invalid_value || ''\" of ETHNICITY_CODE \"'' || dependent_value || ''\" is not matching with the ETHNICITY_CODE_DESCRIPTION of ETHNICITY_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_race_code_in_all_rows AS (\n    SELECT ''RACE_CODE'' AS issue_column,\n           ad.\"RACE_CODE\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN race_reference ref\n      ON UPPER(CAST(ad.\"RACE_CODE\" AS VARCHAR)) = UPPER(CAST(ref.\"Concept Code\" AS VARCHAR))\n     WHERE ad.\"RACE_CODE\" IS NOT NULL\n      AND ref.\"Concept Code\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid RACE CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid RACE CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate RACE CODE with race reference data''\n      FROM valid_race_code_in_all_rows;\nWITH valid_race_code_description_in_all_rows AS (\n    SELECT ''RACE_CODE_DESCRIPTION'' AS issue_column,\n           ad.\"RACE_CODE_DESCRIPTION\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN race_reference ref\n      ON UPPER(CAST(ad.\"RACE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(ref.\"Concept Name\" AS VARCHAR))\n     WHERE ad.\"RACE_CODE_DESCRIPTION\" IS NOT NULL\n      AND ref.\"Concept Name\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid RACE CODE DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid RACE CODE DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate RACE CODE DESCRIPTION with race reference data''\n      FROM valid_race_code_description_in_all_rows;\nWITH valid_preferred_language_code_in_all_rows AS (\n    SELECT ''PREFERRED_LANGUAGE_CODE'' AS issue_column,\n           ad.\"PREFERRED_LANGUAGE_CODE\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN preferred_language_reference ref\n      ON UPPER(CAST(ad.\"PREFERRED_LANGUAGE_CODE\" AS VARCHAR)) = UPPER(CAST(ref.\"ISO 639-2 Code\" AS VARCHAR))\n     WHERE ad.\"PREFERRED_LANGUAGE_CODE\" IS NOT NULL\n      AND ref.\"ISO 639-2 Code\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid PREFERRED LANGUAGE CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid PREFERRED LANGUAGE CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate PREFERRED LANGUAGE CODE with preferred language reference data''\n      FROM valid_preferred_language_code_in_all_rows;\nWITH valid_preferred_language_code_description_in_all_rows AS (\n    SELECT ''PREFERRED_LANGUAGE_DESCRIPTION'' AS issue_column,\n           ad.\"PREFERRED_LANGUAGE_DESCRIPTION\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN preferred_language_reference ref\n      ON UPPER(CAST(ad.\"PREFERRED_LANGUAGE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(ref.\"English name of Language\" AS VARCHAR))\n     WHERE ad.\"PREFERRED_LANGUAGE_DESCRIPTION\" IS NOT NULL\n      AND ref.\"English name of Language\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid PREFERRED LANGUAGE CODE DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid PREFERRED LANGUAGE CODE DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate PREFERRED LANGUAGE CODE DESCRIPTION with preferred language reference data''\n      FROM valid_preferred_language_code_description_in_all_rows;\nWITH allowed_values AS (\n    SELECT ''PREFERRED_LANGUAGE_CODE_SYSTEM_NAME'' AS issue_column,\n           \"PREFERRED_LANGUAGE_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"PREFERRED_LANGUAGE_CODE_SYSTEM_NAME\" NOT IN (''ISO'',''ISO 639-2'',''http://hl7.org/fhir/us/core/ValueSet/simple-language'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''ISO'''',''''ISO 639-2'''',''''http://hl7.org/fhir/us/core/ValueSet/simple-language'''')'',\n           ''Use only allowed values ''''ISO'''',''''ISO 639-2'''',''''http://hl7.org/fhir/us/core/ValueSet/simple-language'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''RACE_CODE'' AS issue_column,\n      tbl.\"RACE_CODE\" AS invalid_value,\n      tbl.\"RACE_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"RACE_CODE\" is not null\n  and tbl.\"RACE_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Concept Name\" FROM race_reference WHERE UPPER(CAST(tbl.\"RACE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Concept Name\" AS VARCHAR)) AND UPPER(CAST(tbl.\"RACE_CODE\" AS VARCHAR)) = UPPER(CAST(\"Concept Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The RACE_CODE \"'' || invalid_value || ''\" of RACE_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the RACE_CODE of RACE_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''PREFERRED_LANGUAGE_CODE'' AS issue_column,\n      tbl.\"PREFERRED_LANGUAGE_CODE\" AS invalid_value,\n      tbl.\"PREFERRED_LANGUAGE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"PREFERRED_LANGUAGE_CODE\" is not null\n  and tbl.\"PREFERRED_LANGUAGE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"English name of Language\" FROM preferred_language_reference WHERE UPPER(CAST(tbl.\"PREFERRED_LANGUAGE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"English name of Language\" AS VARCHAR)) AND UPPER(CAST(tbl.\"PREFERRED_LANGUAGE_CODE\" AS VARCHAR)) = UPPER(CAST(\"ISO 639-2 Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The PREFERRED_LANGUAGE_CODE \"'' || invalid_value || ''\" of PREFERRED_LANGUAGE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the PREFERRED_LANGUAGE_CODE of PREFERRED_LANGUAGE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''RACE_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"RACE_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"RACE_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"RACE_CODE_DESCRIPTION\" is not null\n  and tbl.\"RACE_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Concept Code\" FROM race_reference WHERE UPPER(CAST(tbl.\"RACE_CODE\" AS VARCHAR)) = UPPER(CAST(\"Concept Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"RACE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Concept Name\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The RACE_CODE_DESCRIPTION \"'' || invalid_value || ''\" of RACE_CODE \"'' || dependent_value || ''\" is not matching with the RACE_CODE_DESCRIPTION of RACE_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH allowed_values AS (\n    SELECT ''RACE_CODE_SYSTEM_NAME'' AS issue_column,\n           \"RACE_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"RACE_CODE_SYSTEM_NAME\" NOT IN (''CDC'',''CDCRE'',''urn:oid:2.16.840.1.113883.6.238'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''CDC'''',''''CDCRE'''',''''urn:oid:2.16.840.1.113883.6.238'''')'',\n           ''Use only allowed values ''''CDC'''',''''CDCRE'''',''''urn:oid:2.16.840.1.113883.6.238'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''ETHNICITY_CODE_SYSTEM_NAME'' AS issue_column,\n           \"ETHNICITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"ETHNICITY_CODE_SYSTEM_NAME\" NOT IN (''CDC'',''CDCRE'',''urn:oid:2.16.840.1.113883.6.238'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''CDC'''',''''CDCRE'''',''''urn:oid:2.16.840.1.113883.6.238'''')'',\n           ''Use only allowed values ''''CDC'''',''''CDCRE'''',''''urn:oid:2.16.840.1.113883.6.238'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''MPI_ID'' AS issue_column,\n           \"MPI_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"MPI_ID\" IS NULL\n        OR TRIM(CAST(\"MPI_ID\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(CAST(\"PAT_MRN_ID\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_mpi_id_per_pat_mrn_id_in_all_rows AS (\n    SELECT ''MPI_ID'' AS issue_column,\n      MPI_ID AS invalid_value,\n      min(src_file_row_number) AS issue_row\n    FROM admin_demographics_20240307\n    GROUP BY MPI_ID\n    HAVING COUNT(DISTINCT PAT_MRN_ID) > 1\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid MPI_ID'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''The unique field \"'' || issue_column || ''\" \"'' || invalid_value || ''\"is not unique per PAT MRN ID'',\n           ''MPI_ID is not unique per PAT MRN ID.''\n      FROM valid_mpi_id_per_pat_mrn_id_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_ID'' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ID\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''MEDICAID_CIN'' AS issue_column,\n           \"MEDICAID_CIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"MEDICAID_CIN\" AS VARCHAR) NOT SIMILAR TO ''^[A-Za-z]{2}\\d{5}[A-Za-z]$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$'',\n           ''Follow the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$ in '' || issue_column\n      FROM pattern;\nWITH valid_unique_medicaid_cin_per_mrn_in_all_rows AS (\n  SELECT ''MEDICAID_CIN'' AS issue_column,\n          \"MEDICAID_CIN\" AS invalid_value,\n          min(src_file_row_number) AS issue_row\n    FROM admin_demographics_20240307\n    WHERE MEDICAID_CIN IS NOT NULL\n    GROUP BY pat_mrn_id, MEDICAID_CIN\n    HAVING COUNT(*) > 1\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Unique Medicaid Cin Per Mrn'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid Unique Medicaid Cin Per Mrn \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate Unique Medicaid Cin Per Mrn''\n      FROM valid_unique_medicaid_cin_per_mrn_in_all_rows;\nWITH valid_address1_or_medicaid_cin_in_all_rows AS (\n    SELECT ''MEDICAID_CIN'' AS issue_column,\n           MEDICAID_CIN AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM admin_demographics_20240307\n      WHERE (MEDICAID_CIN IS NULL OR TRIM(\"MEDICAID_CIN\") = '''') AND (ADDRESS1 IS NULL OR TRIM(\"ADDRESS1\") = '''')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid MEDICAID_CIN'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value MEDICAID_CIN is missing. This is required due to the absence of the ADDRESS1.''\n      FROM valid_address1_or_medicaid_cin_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''CONSENT'' AS issue_column,\n           \"CONSENT\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"CONSENT\" IS NULL\n        OR TRIM(CAST(\"CONSENT\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''CONSENT'' AS issue_column,\n           \"CONSENT\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"CONSENT\" NOT IN (''Yes'', ''YES'', ''yes'', ''Y'', ''y'', ''No'', ''NO'', ''no'',''N'', ''n'',''Unknown'', ''UNKNOWN'', ''unknown'',''UNK'', ''Unk'', ''unk'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''YES'''', ''''yes'''', ''''Y'''', ''''y'''', ''''No'''', ''''NO'''', ''''no'''',''''N'''', ''''n'''',''''Unknown'''', ''''UNKNOWN'''', ''''unknown'''',''''UNK'''', ''''Unk'''', ''''unk'''')'',\n           ''Use only allowed values ''''Yes'''', ''''YES'''', ''''yes'''', ''''Y'''', ''''y'''', ''''No'''', ''''NO'''', ''''no'''',''''N'''', ''''n'''',''''Unknown'''', ''''UNKNOWN'''', ''''unknown'''',''''UNK'''', ''''Unk'''', ''''unk'''' in '' || issue_column\n      FROM allowed_values;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''87f8bee3-8c83-518e-865a-740b0e3a45d3'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''AdminDemographicCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''f6f5cc47-43d2-5134-b3d4-e6d954f3e391'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''767cb8df-3ec0-5b59-998e-a91e75be32b3'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''QeAdminDataCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(CAST(\"PAT_MRN_ID\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_ID'' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ID\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_unique_facility_id_per_facility_in_all_rows AS (\n  SELECT ''FACILITY_ID'' AS issue_column,\n    FACILITY_ID AS invalid_value,\n    min(src_file_row_number) AS issue_row\n  FROM qe_admin_data_20240307\n  GROUP BY FACILITY_ID\n  HAVING COUNT(DISTINCT FACILITY_LONG_NAME) > 1\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Invalid FACILITY_ID'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''The unique field \"'' || issue_column || ''\" \"'' || invalid_value || ''\"is not unique per facility'',\n           ''FACILITY_ID is not unique per facility.''\n      FROM valid_unique_facility_id_per_facility_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_LONG_NAME'' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_LONG_NAME\" IS NULL\n        OR TRIM(CAST(\"FACILITY_LONG_NAME\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''ORGANIZATION_TYPE'' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"ORGANIZATION_TYPE\" IS NULL\n        OR TRIM(CAST(\"ORGANIZATION_TYPE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''ORGANIZATION_TYPE'' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"ORGANIZATION_TYPE\" NOT IN (''Hospital'', ''DTC'', ''SNF'', ''SCN'', ''CBO'', ''OMH'', ''OASAS'', ''Practice'', ''Article 36'', ''Article 40'', ''MCO'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Hospital'''', ''''DTC'''', ''''SNF'''', ''''SCN'''', ''''CBO'''', ''''OMH'''', ''''OASAS'''', ''''Practice'''', ''''Article 36'''', ''''Article 40'''', ''''MCO'''')'',\n           ''Use only allowed values ''''Hospital'''', ''''DTC'''', ''''SNF'''', ''''SCN'''', ''''CBO'''', ''''OMH'''', ''''OASAS'''', ''''Practice'''', ''''Article 36'''', ''''Article 40'''', ''''MCO'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_ADDRESS1'' AS issue_column,\n           \"FACILITY_ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_ADDRESS1\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ADDRESS1\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_unique_facility_address1_per_facility_in_all_rows AS (\n  SELECT ''FACILITY_ADDRESS1'' AS issue_column,\n    FACILITY_ADDRESS1 AS invalid_value,\n    min(src_file_row_number) AS issue_row\n  FROM qe_admin_data_20240307\n  GROUP BY FACILITY_ADDRESS1\n  HAVING COUNT(DISTINCT FACILITY_LONG_NAME) > 1\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Invalid FACILITY_ADDRESS1'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''The unique field \"'' || issue_column || ''\" \"'' || invalid_value || ''\"is not unique per facility'',\n           ''FACILITY_ADDRESS1 is not unique per facility.''\n      FROM valid_unique_facility_address1_per_facility_in_all_rows;\nWITH valid_integer_alphanumeric_string_in_all_rows AS (\n  SELECT ''FACILITY_ADDRESS1'' AS issue_column,\n    t.\"FACILITY_ADDRESS1\" AS invalid_value,\n    t.src_file_row_number AS issue_row\n  FROM qe_admin_data_20240307 t\n  WHERE t.\"FACILITY_ADDRESS1\" SIMILAR TO ''[0-9]+''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Data Type Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Invalid string of numbers found''\n      FROM valid_integer_alphanumeric_string_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_STATE'' AS issue_column,\n           \"FACILITY_STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_STATE\" IS NULL\n        OR TRIM(CAST(\"FACILITY_STATE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''FACILITY_STATE'' AS issue_column,\n           \"FACILITY_STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_STATE\" NOT IN (''NY'', ''New York'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''NY'''', ''''New York'''')'',\n           ''Use only allowed values ''''NY'''', ''''New York'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_ZIP'' AS issue_column,\n           \"FACILITY_ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_ZIP\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ZIP\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''FACILITY_ZIP'' AS issue_column,\n           \"FACILITY_ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE CAST(\"FACILITY_ZIP\" AS VARCHAR) NOT SIMILAR TO ''^\\d{5}(\\d{4})?$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^\\d{5}(\\d{4})?$'',\n           ''Follow the pattern ^\\d{5}(\\d{4})?$ in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''VISIT_PART_2_FLAG'' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_PART_2_FLAG\" IS NULL\n        OR TRIM(CAST(\"VISIT_PART_2_FLAG\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_PART_2_FLAG'' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_PART_2_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_OMH_FLAG'' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_OMH_FLAG\" IS NULL\n        OR TRIM(CAST(\"VISIT_OMH_FLAG\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_OMH_FLAG'' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_OMH_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_OPWDD_FLAG'' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_OPWDD_FLAG\" IS NULL\n        OR TRIM(CAST(\"VISIT_OPWDD_FLAG\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_OPWDD_FLAG'' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_OPWDD_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH pattern AS (\n    SELECT ''FACILITY_LONG_NAME'' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE CAST(\"FACILITY_LONG_NAME\" AS VARCHAR) NOT SIMILAR TO ''^[a-zA-Z\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z\\s]+$ in '' || issue_column\n      FROM pattern;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7115f76c-32eb-563c-a1d5-040d0146651a'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''767cb8df-3ec0-5b59-998e-a91e75be32b3'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''QeAdminDataCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''26a2e6f5-6b62-5616-8b14-1059006f438b'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''ScreeningCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n\nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(CAST(\"PAT_MRN_ID\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_ID'' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ID\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_pat_mrn_id_across_all_three_tables AS (\n  WITH cte_qe_demographic_unmatched AS (\n      SELECT DISTINCT COALESCE(ad.PAT_MRN_ID, qe.PAT_MRN_ID) AS PAT_MRN_ID,\n              COALESCE(ad.FACILITY_ID, qe.FACILITY_ID) AS FACILITY_ID,\n                    CASE\n                        WHEN ad.PAT_MRN_ID IS NULL THEN ''QE_ADMIN_DATA''\n                        ELSE ''ADMIN_DEMOGRAPHIC''\n                    END AS unmatched_source,\n                    COALESCE(ad.src_file_row_number, qe.src_file_row_number) AS src_file_row_number,\n      FROM  admin_demographics_20240307 ad\n      FULL OUTER JOIN qe_admin_data_20240307 qe\n          ON ad.PAT_MRN_ID = qe.PAT_MRN_ID\n          AND ad.FACILITY_ID = qe.FACILITY_ID\n      WHERE ad.PAT_MRN_ID IS NULL OR qe.PAT_MRN_ID IS NULL\n  )\n  Select ''PAT_MRN_ID'' AS issue_column, pat_mrn_id AS invalid_pat_value, FACILITY_ID AS invalid_facility_value, unmatched_source, src_file_row_number  AS issue_row,\n  case when unmatched_source = ''ADMIN_DEMOGRAPHIC'' then ''admin_demographics_20240307''\n  when unmatched_source = ''QE_ADMIN_DATA'' then ''qe_admin_data_20240307''\n  Else '''' End As issue_table_name\n  from cte_qe_demographic_unmatched\n  UNION\n  Select DISTINCT ''PAT_MRN_ID'' AS issue_column, s.PAT_MRN_ID AS invalid_pat_value,s.FACILITY_ID AS invalid_facility_value,''SCREENING'' As unmatched_source, src_file_row_number  AS issue_row,\n  ''screening_20240307'' as issue_table_name\n  FROM screening_20240307 s\n    Left Outer Join (\n      SELECT  DISTINCT a.PAT_MRN_ID,a.FACILITY_ID From admin_demographics_20240307 a\n      Inner Join qe_admin_data_20240307 q\n      ON a.PAT_MRN_ID = q.PAT_MRN_ID\n      AND a.FACILITY_ID = q.FACILITY_ID\n      WHERE a.PAT_MRN_ID IS NOT NULL AND q.PAT_MRN_ID IS NOT NULL\n    ) aq\n    ON s.PAT_MRN_ID = aq.PAT_MRN_ID\n  AND aq.FACILITY_ID = s.FACILITY_ID\n  Where aq.PAT_MRN_ID IS  NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''PAT_MRN_ID that does not match the FACILITY_ID'',\n           issue_row,\n           issue_column,\n           invalid_pat_value,\n           ''PAT_MRN_ID (\"'' || invalid_pat_value || ''\") that does not match the FACILITY_ID (\"'' || invalid_facility_value || ''\") across the files was found in \"'' || issue_table_name || ''\".'',\n           ''Validate PAT_MRN_ID that maches the FACILITY_ID across the files''\n      FROM valid_pat_mrn_id_across_all_three_tables;\nWITH mandatory_value AS (\n    SELECT ''ENCOUNTER_CLASS_CODE'' AS issue_column,\n           \"ENCOUNTER_CLASS_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_CLASS_CODE\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_CLASS_CODE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_encounter_class_in_all_rows AS (\n    SELECT ''ENCOUNTER_CLASS_CODE'' AS issue_column,\n           sr.\"ENCOUNTER_CLASS_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_class_reference ecr\n      ON UPPER(sr.ENCOUNTER_CLASS_CODE) = UPPER(ecr.Code)\n     WHERE sr.ENCOUNTER_CLASS_CODE IS NOT NULL\n      AND ecr.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ENCOUNTER CLASS CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ENCOUNTER CLASS CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ENCOUNTER CLASS CODE with encounter class reference data''\n      FROM valid_encounter_class_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ENCOUNTER_CLASS_CODE'' AS issue_column,\n      tbl.\"ENCOUNTER_CLASS_CODE\" AS invalid_value,\n      tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_CLASS_CODE\" is not null\n  and tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Display\" FROM encounter_class_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_CLASS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ENCOUNTER_CLASS_CODE \"'' || invalid_value || ''\" of ENCOUNTER_CLASS_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the ENCOUNTER_CLASS_CODE of ENCOUNTER_CLASS_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ENCOUNTER_CLASS_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ENCOUNTER_CLASS_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" is not null\n  and tbl.\"ENCOUNTER_CLASS_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Code\" FROM encounter_class_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_CLASS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ENCOUNTER_CLASS_CODE_DESCRIPTION \"'' || invalid_value || ''\" of ENCOUNTER_CLASS_CODE \"'' || dependent_value || ''\" is not matching with the ENCOUNTER_CLASS_CODE_DESCRIPTION of ENCOUNTER_CLASS_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''ENCOUNTER_CLASS_CODE_SYSTEM'' AS issue_column,\n           \"ENCOUNTER_CLASS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_CLASS_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_CLASS_CODE_SYSTEM\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''ENCOUNTER_CLASS_CODE_SYSTEM'' AS issue_column,\n           \"ENCOUNTER_CLASS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_CLASS_CODE_SYSTEM\" NOT IN (''http://terminology.hl7.org/CodeSystem/v3-ActCode'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''http://terminology.hl7.org/CodeSystem/v3-ActCode'''')'',\n           ''Use only allowed values ''''http://terminology.hl7.org/CodeSystem/v3-ActCode'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_encounter_class_in_all_rows AS (\n    SELECT ''ENCOUNTER_CLASS_CODE_DESCRIPTION'' AS issue_column,\n           sr.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_class_reference ecr\n      ON UPPER(sr.ENCOUNTER_CLASS_CODE_DESCRIPTION) = UPPER(ecr.Display)\n     WHERE sr.ENCOUNTER_CLASS_CODE_DESCRIPTION IS NOT NULL\n      AND ecr.Display IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ENCOUNTER CLASS CODE DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ENCOUNTER CLASS CODE DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ENCOUNTER CLASS CODE DESCRIPTION with encounter class reference data''\n      FROM valid_encounter_class_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''ENCOUNTER_STATUS_CODE'' AS issue_column,\n           \"ENCOUNTER_STATUS_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_STATUS_CODE\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_STATUS_CODE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_encounter_status_code_in_all_rows AS (\n    SELECT ''ENCOUNTER_STATUS_CODE'' AS issue_column,\n           sr.\"ENCOUNTER_STATUS_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_status_code_reference ecr\n      ON UPPER(sr.ENCOUNTER_STATUS_CODE) = UPPER(ecr.Code)\n     WHERE sr.ENCOUNTER_STATUS_CODE IS NOT NULL\n      AND ecr.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ENCOUNTER STATUS CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ENCOUNTER STATUS CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ENCOUNTER STATUS CODE with encounter status reference data''\n      FROM valid_encounter_status_code_in_all_rows;\nWITH valid_encounter_status_code_in_all_rows AS (\n    SELECT ''ENCOUNTER_STATUS_CODE_DESCRIPTION'' AS issue_column,\n           sr.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_status_code_reference ecr\n      ON UPPER(sr.ENCOUNTER_STATUS_CODE_DESCRIPTION) = UPPER(ecr.Display)\n     WHERE sr.ENCOUNTER_STATUS_CODE_DESCRIPTION IS NOT NULL\n      AND ecr.Display IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ENCOUNTER STATUS CODE DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ENCOUNTER STATUS CODE DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ENCOUNTER STATUS CODE DESCRIPTION with encounter status reference data''\n      FROM valid_encounter_status_code_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ENCOUNTER_STATUS_CODE'' AS issue_column,\n      tbl.\"ENCOUNTER_STATUS_CODE\" AS invalid_value,\n      tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_STATUS_CODE\" is not null\n  and tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Display\" FROM encounter_status_code_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_STATUS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ENCOUNTER_STATUS_CODE \"'' || invalid_value || ''\" of ENCOUNTER_STATUS_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the ENCOUNTER_STATUS_CODE of ENCOUNTER_STATUS_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ENCOUNTER_STATUS_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ENCOUNTER_STATUS_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" is not null\n  and tbl.\"ENCOUNTER_STATUS_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Code\" FROM encounter_status_code_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_STATUS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ENCOUNTER_STATUS_CODE_DESCRIPTION \"'' || invalid_value || ''\" of ENCOUNTER_STATUS_CODE \"'' || dependent_value || ''\" is not matching with the ENCOUNTER_STATUS_CODE_DESCRIPTION of ENCOUNTER_STATUS_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''ENCOUNTER_STATUS_CODE_SYSTEM'' AS issue_column,\n           \"ENCOUNTER_STATUS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_STATUS_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_STATUS_CODE_SYSTEM\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''ENCOUNTER_STATUS_CODE_SYSTEM'' AS issue_column,\n           \"ENCOUNTER_STATUS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_STATUS_CODE_SYSTEM\" NOT IN (''http://hl7.org/fhir/encounter-status'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''http://hl7.org/fhir/encounter-status'''')'',\n           ''Use only allowed values ''''http://hl7.org/fhir/encounter-status'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''ENCOUNTER_TYPE_CODE'' AS issue_column,\n           \"ENCOUNTER_TYPE_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_TYPE_CODE\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_TYPE_CODE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''ENCOUNTER_TYPE_CODE_SYSTEM'' AS issue_column,\n           \"ENCOUNTER_TYPE_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_TYPE_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_TYPE_CODE_SYSTEM\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_encounter_type_code_in_all_rows AS (\n    SELECT ''ENCOUNTER_TYPE_CODE'' AS issue_column,\n           sr.\"ENCOUNTER_TYPE_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_type_code_reference ecr\n      ON UPPER(CAST(sr.ENCOUNTER_TYPE_CODE AS VARCHAR)) = UPPER(CAST(ecr.Code AS VARCHAR))\n     WHERE sr.ENCOUNTER_TYPE_CODE IS NOT NULL\n      AND ecr.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ENCOUNTER TYPE CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ENCOUNTER TYPE CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ENCOUNTER TYPE CODE with encounter type reference data''\n      FROM valid_encounter_type_code_in_all_rows;\nWITH allowed_values AS (\n    SELECT ''ENCOUNTER_TYPE_CODE_SYSTEM'' AS issue_column,\n           \"ENCOUNTER_TYPE_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_TYPE_CODE_SYSTEM\" NOT IN (''SNOMED-CT'', ''SNOMED'', ''http://snomed.info/sct'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''SNOMED-CT'''', ''''SNOMED'''', ''''http://snomed.info/sct'''')'',\n           ''Use only allowed values ''''SNOMED-CT'''', ''''SNOMED'''', ''''http://snomed.info/sct'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_encounter_type_code_in_all_rows AS (\n    SELECT ''ENCOUNTER_TYPE_CODE_DESCRIPTION'' AS issue_column,\n           sr.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_type_code_reference ecr\n      ON UPPER(CAST(sr.ENCOUNTER_TYPE_CODE_DESCRIPTION AS VARCHAR)) = UPPER(CAST(ecr.Display AS VARCHAR))\n     WHERE sr.ENCOUNTER_TYPE_CODE_DESCRIPTION IS NOT NULL\n      AND ecr.Display IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ENCOUNTER TYPE CODE DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ENCOUNTER TYPE CODE DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ENCOUNTER TYPE CODE DESCRIPTION with encounter type reference data''\n      FROM valid_encounter_type_code_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ENCOUNTER_TYPE_CODE'' AS issue_column,\n      tbl.\"ENCOUNTER_TYPE_CODE\" AS invalid_value,\n      tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_TYPE_CODE\" is not null\n  and tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Display\" FROM encounter_type_code_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_TYPE_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ENCOUNTER_TYPE_CODE \"'' || invalid_value || ''\" of ENCOUNTER_TYPE_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the ENCOUNTER_TYPE_CODE of ENCOUNTER_TYPE_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ENCOUNTER_TYPE_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ENCOUNTER_TYPE_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" is not null\n  and tbl.\"ENCOUNTER_TYPE_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Code\" FROM encounter_type_code_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_TYPE_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ENCOUNTER_TYPE_CODE_DESCRIPTION \"'' || invalid_value || ''\" of ENCOUNTER_TYPE_CODE \"'' || dependent_value || ''\" is not matching with the ENCOUNTER_TYPE_CODE_DESCRIPTION of ENCOUNTER_TYPE_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''SCREENING_STATUS_CODE'' AS issue_column,\n           \"SCREENING_STATUS_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_STATUS_CODE\" IS NULL\n        OR TRIM(CAST(\"SCREENING_STATUS_CODE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_screening_status_code_in_all_rows AS (\n    SELECT ''SCREENING_STATUS_CODE'' AS issue_column,\n           sr.\"SCREENING_STATUS_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN screening_status_code_reference ref\n      ON UPPER(sr.SCREENING_STATUS_CODE) = UPPER(ref.Code)\n     WHERE sr.SCREENING_STATUS_CODE IS NOT NULL\n      AND ref.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid SCREENING STATUS CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid SCREENING STATUS CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate SCREENING STATUS CODE with screening status code reference data''\n      FROM valid_screening_status_code_in_all_rows;\nWITH valid_screening_status_code_in_all_rows AS (\n    SELECT ''SCREENING_STATUS_CODE_DESCRIPTION'' AS issue_column,\n           sr.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN screening_status_code_reference ecr\n      ON UPPER(sr.SCREENING_STATUS_CODE_DESCRIPTION) = UPPER(ecr.Display)\n     WHERE sr.SCREENING_STATUS_CODE_DESCRIPTION IS NOT NULL\n      AND ecr.Display IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid SCREENING STATUS CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid SCREENING STATUS CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate SCREENING STATUS CODE with screening status code reference data''\n      FROM valid_screening_status_code_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''SCREENING_STATUS_CODE'' AS issue_column,\n      tbl.\"SCREENING_STATUS_CODE\" AS invalid_value,\n      tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"SCREENING_STATUS_CODE\" is not null\n  and tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Display\" FROM screening_status_code_reference WHERE UPPER(CAST(tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SCREENING_STATUS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The SCREENING_STATUS_CODE \"'' || invalid_value || ''\" of SCREENING_STATUS_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the SCREENING_STATUS_CODE of SCREENING_STATUS_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''SCREENING_STATUS_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"SCREENING_STATUS_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" is not null\n  and tbl.\"SCREENING_STATUS_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Code\" FROM screening_status_code_reference WHERE UPPER(CAST(tbl.\"SCREENING_STATUS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The SCREENING_STATUS_CODE_DESCRIPTION \"'' || invalid_value || ''\" of SCREENING_STATUS_CODE \"'' || dependent_value || ''\" is not matching with the SCREENING_STATUS_CODE_DESCRIPTION of SCREENING_STATUS_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''SCREENING_STATUS_CODE_SYSTEM'' AS issue_column,\n           \"SCREENING_STATUS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_STATUS_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"SCREENING_STATUS_CODE_SYSTEM\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''SCREENING_STATUS_CODE_SYSTEM'' AS issue_column,\n           \"SCREENING_STATUS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_STATUS_CODE_SYSTEM\" NOT IN (''http://hl7.org/fhir/observation-status'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''http://hl7.org/fhir/observation-status'''')'',\n           ''Use only allowed values ''''http://hl7.org/fhir/observation-status'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  ''ANSWER_CODE'' AS issue_column,\n              \"ANSWER_CODE\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (ANSWER_CODE IS NULL OR TRIM(\"ANSWER_CODE\") = '''')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN (''TOTAL SAFETY SCORE'',\n            ''CALCULATED WEEKLY PHYSICAL ACTIVITY'',\n            ''CALCULATED MENTAL HEALTH SCORE'')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid value in ANSWER_CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value ANSWER_CODE is missing''\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  ''ANSWER_CODE_SYSTEM_NAME'' AS issue_column,\n              \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (ANSWER_CODE_SYSTEM_NAME IS NULL OR TRIM(\"ANSWER_CODE_SYSTEM_NAME\") = '''')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN (''TOTAL SAFETY SCORE'',\n            ''CALCULATED WEEKLY PHYSICAL ACTIVITY'',\n            ''CALCULATED MENTAL HEALTH SCORE'')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid value in ANSWER_CODE_SYSTEM_NAME'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value ANSWER_CODE_SYSTEM_NAME is missing''\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  ''QUESTION_CODE'' AS issue_column,\n              \"QUESTION_CODE\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (QUESTION_CODE IS NULL OR TRIM(\"QUESTION_CODE\") = '''')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN (''TOTAL SAFETY SCORE'',\n            ''CALCULATED WEEKLY PHYSICAL ACTIVITY'',\n            ''CALCULATED MENTAL HEALTH SCORE'')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid value in QUESTION_CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value QUESTION_CODE is missing''\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  ''QUESTION_CODE_SYSTEM_NAME'' AS issue_column,\n              \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (QUESTION_CODE_SYSTEM_NAME IS NULL OR TRIM(\"QUESTION_CODE_SYSTEM_NAME\") = '''')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN (''TOTAL SAFETY SCORE'',\n            ''CALCULATED WEEKLY PHYSICAL ACTIVITY'',\n            ''CALCULATED MENTAL HEALTH SCORE'')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid value in QUESTION_CODE_SYSTEM_NAME'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value QUESTION_CODE_SYSTEM_NAME is missing''\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  ''SCREENING_CODE_DESCRIPTION'' AS issue_column,\n              \"SCREENING_CODE_DESCRIPTION\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (SCREENING_CODE_DESCRIPTION IS NULL OR TRIM(\"SCREENING_CODE_DESCRIPTION\") = '''')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN (''TOTAL SAFETY SCORE'',\n            ''CALCULATED WEEKLY PHYSICAL ACTIVITY'',\n            ''CALCULATED MENTAL HEALTH SCORE'')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid value in SCREENING_CODE_DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value SCREENING_CODE_DESCRIPTION is missing''\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH allowed_values AS (\n    SELECT ''SCREENING_CODE_DESCRIPTION'' AS issue_column,\n           \"SCREENING_CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_CODE_DESCRIPTION\" NOT IN (''Accountable health communities (AHC) health-related social needs (HRSN) supplemental questions'',''Accountable health communities (AHC) health-related social needs screening (HRSN) tool'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Accountable health communities (AHC) health-related social needs (HRSN) supplemental questions'''',''''Accountable health communities (AHC) health-related social needs screening (HRSN) tool'''')'',\n           ''Use only allowed values ''''Accountable health communities (AHC) health-related social needs (HRSN) supplemental questions'''',''''Accountable health communities (AHC) health-related social needs screening (HRSN) tool'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  ''SCREENING_CODE_SYSTEM_NAME'' AS issue_column,\n              \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (SCREENING_CODE_SYSTEM_NAME IS NULL OR TRIM(\"SCREENING_CODE_SYSTEM_NAME\") = '''')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN (''TOTAL SAFETY SCORE'',\n            ''CALCULATED WEEKLY PHYSICAL ACTIVITY'',\n            ''CALCULATED MENTAL HEALTH SCORE'')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid value in SCREENING_CODE_SYSTEM_NAME'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value SCREENING_CODE_SYSTEM_NAME is missing''\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  ''SCREENING_CODE'' AS issue_column,\n              \"SCREENING_CODE\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (SCREENING_CODE IS NULL OR TRIM(\"SCREENING_CODE\") = '''')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN (''TOTAL SAFETY SCORE'',\n            ''CALCULATED WEEKLY PHYSICAL ACTIVITY'',\n            ''CALCULATED MENTAL HEALTH SCORE'')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid value in SCREENING_CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value SCREENING_CODE is missing''\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''QUESTION_CODE_DESCRIPTION'' AS issue_column,\n           \"QUESTION_CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"QUESTION_CODE_DESCRIPTION\" IS NULL\n        OR TRIM(CAST(\"QUESTION_CODE_DESCRIPTION\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_answer_code_in_all_rows AS (\n  SELECT ''ANSWER_CODE'' AS issue_column,\n    scr.\"ANSWER_CODE\" AS invalid_value,\n    scr.\"QUESTION_CODE\" AS invalid_question_value,\n    scr.SCREENING_CODE AS invalid_screening_value,\n    scr.src_file_row_number AS issue_row\n    FROM screening_20240307 scr\n    LEFT OUTER JOIN ahc_cross_walk crw\n      ON UPPER(scr.SCREENING_CODE) = UPPER(crw.SCREENING_CODE)\n      AND UPPER(scr.QUESTION_CODE) = UPPER(crw.QUESTION_CODE)\n      AND UPPER(scr.ANSWER_CODE) = UPPER(crw.ANSWER_CODE)\n    WHERE scr.SCREENING_CODE IS NOT NULL\n      AND scr.QUESTION_CODE IS NOT NULL\n      AND scr.ANSWER_CODE IS NOT NULL\n      AND crw.ANSWER_CODE IS NULL\n)\n\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Answer Code'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Provided Screening Code \"'' || invalid_screening_value || ''\", Question Code \"'' || invalid_question_value || ''\" and Answer Code \"'' || invalid_value || ''\" are not matching with the reference data found in '' || issue_column,\n           ''Validate Screening Code, Question Code and Answer Code with ahc cross walk reference data''\n      FROM valid_answer_code_in_all_rows;\nWITH valid_total_safety_score_in_all_rows AS (\n  WITH cte_score AS (\n    SELECT\n        SUM(crw.Score) AS cross_walk_Score,\n        SUM(\n            CASE\n                WHEN UPPER(TRIM(scr.QUESTION_CODE_DESCRIPTION)) LIKE ''%TOTAL SAFETY SCORE%'' AND TRY_CAST(scr.ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL THEN CAST(scr.ANSWER_CODE_DESCRIPTION AS INTEGER)\n                ELSE 0\n            END\n        ) AS screening_score\n    FROM\n        screening_20240307 scr\n    LEFT OUTER JOIN (\n        SELECT \tacw.SCREENING_CODE,\n              acw.QUESTION_CODE,\n              acw.ANSWER_CODE,\n              acw.QUESTION_SLNO,\n              acw.Score AS Score\n        FROM ahc_cross_walk acw\n        Where QUESTION_SLNO_REFERENCE In(\n        SELECT QUESTION_SLNO\n            FROM ahc_cross_walk\n            WHERE UPPER(TRIM(QUESTION)) LIKE ''%TOTAL SAFETY SCORE%''\n            )\n        AND acw.QUESTION_CODE = scr.QUESTION_CODE\n        AND acw.ANSWER_CODE = scr.ANSWER_CODE\n    ) AS crw ON crw.SCREENING_CODE = scr.SCREENING_CODE\n)\nSELECT \tcross_walk_Score,\n    screening_score AS invalid_value,\n    (SELECT src_file_row_number FROM screening_20240307 WHERE UPPER(TRIM(QUESTION_CODE_DESCRIPTION)) LIKE ''%TOTAL SAFETY SCORE%'') AS issue_row,\n  ''ANSWER_CODE_DESCRIPTION'' AS issue_column\nFROM cte_score\nWHERE screening_score <> cross_walk_Score\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ANSWER_CODE_DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ANSWER_CODE_DESCRIPTION for TOTAL SAFETY SCORE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ANSWER_CODE_DESCRIPTION for TOTAL SAFETY SCORE (Calculated Score)''\n      FROM valid_total_safety_score_in_all_rows;\nWITH valid_calculated_mental_health_score_in_all_rows AS (\n  SELECT ANSWER_CODE_DESCRIPTION AS issue_column,\n  SCREENING_CALCULATED_SCORE AS invalid_value,\n  SRC_FILE_ROW_NUMBER AS issue_row\n  FROM\n  (\n  SELECT Sum(crw.score) As CROSSWALK_ANSWER_SCORE,\n      (SELECT CASE WHEN TRY_CAST(ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL THEN CAST(ANSWER_CODE_DESCRIPTION AS INTEGER) ELSE 0 END AS SCREENING_CALC_SCORE\n        FROM screening_20240307 scr2\n        WHERE UPPER(scr2.QUESTION_CODE_DESCRIPTION) LIKE ''%CALCULATED MENTAL HEALTH SCORE%''\n    ) AS SCREENING_CALCULATED_SCORE,\n    (SELECT src_file_row_number FROM screening_20240307 WHERE UPPER(QUESTION_CODE_DESCRIPTION) LIKE ''%CALCULATED MENTAL HEALTH SCORE%'') AS SRC_FILE_ROW_NUMBER,\n    ''ANSWER_CODE_DESCRIPTION'' AS ANSWER_CODE_DESCRIPTION\n      FROM screening_20240307 scr\n      INNER JOIN (\n          SELECT \tacw.score As SCORE\n          FROM ahc_cross_walk acw\n          Where QUESTION_SLNO_REFERENCE In(\n          SELECT QUESTION_SLNO\n              FROM ahc_cross_walk\n              WHERE UPPER(QUESTION) LIKE ''%CALCULATED MENTAL HEALTH SCORE%''\n              )\n          AND acw.QUESTION_CODE = scr.QUESTION_CODE\n          AND acw.ANSWER_CODE  = scr.ANSWER_CODE\n      ) AS crw ON 1 = 1\n  ) As calc_fld_val\n  Where calc_fld_val.CROSSWALK_ANSWER_SCORE <> calc_fld_val.SCREENING_CALCULATED_SCORE\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ANSWER_CODE_DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ANSWER_CODE_DESCRIPTION for CALCULATED MENTAL HEALTH SCORE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ANSWER_CODE_DESCRIPTION for CALCULATED MENTAL HEALTH SCORE (Calculated Score)''\n      FROM valid_calculated_mental_health_score_in_all_rows;\nWITH valid_calculated_weekly_physical_activity_score_in_all_rows AS (\n  WITH cte_physical_activity AS (\n    SELECT\n      scr.SCREENING_CODE,\n      scr.QUESTION_CODE,\n      scr.ANSWER_CODE,\n      crw.ANSWER_VALUE,\n      scr.ANSWER_CODE_DESCRIPTION,\n      ROW_NUMBER() OVER (\n      ORDER BY scr.SCREENING_CODE) AS sequence_number\n    FROM\n      screening_20240307 scr\n    INNER JOIN (\n      SELECT\n        acw.SCREENING_CODE,\n        acw.QUESTION_CODE,\n        acw.ANSWER_CODE,\n        acw.QUESTION_SLNO,\n        CASE\n          WHEN TRY_CAST(acw.ANSWER_VALUE AS INTEGER) IS NOT NULL THEN CAST(acw.ANSWER_VALUE AS INTEGER)\n          ELSE CASE WHEN acw.ANSWER_CODE=''LA32060-8'' THEN 150 ELSE 0 END\n        END AS ANSWER_VALUE\n      FROM\n        ahc_cross_walk acw\n      Where\n        QUESTION_SLNO_REFERENCE In(\n        SELECT\n          QUESTION_SLNO\n        FROM\n          ahc_cross_walk\n        WHERE\n          UPPER(QUESTION) LIKE ''%CALCULATED PHYSICAL ACTIVITY SCORE%''\n                )\n        AND acw.QUESTION_CODE = scr.QUESTION_CODE\n        AND acw.ANSWER_CODE = scr.ANSWER_CODE\n        ) AS crw ON\n      crw.SCREENING_CODE = scr.SCREENING_CODE\n    )\n    Select \tANSWER_CODE_DESCRIPTION AS issue_column,\n        CROSSWALK_ANSWER_VALUE AS CROSSWALK_ANSWER_VALUE,\n        SCREENING_CALCULATED_VALUE AS invalid_value,\n        SRC_FILE_ROW_NUMBER AS issue_row\n    FROM\n      (\n      Select\n        t1.ANSWER_VALUE * t2.ANSWER_VALUE As CROSSWALK_ANSWER_VALUE,\n        CASE\n          WHEN TRY_CAST(t1.ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL\n            AND TRY_CAST(t2.ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL THEN\n        CAST(t1.ANSWER_CODE_DESCRIPTION AS INTEGER) * CAST(t2.ANSWER_CODE_DESCRIPTION AS INTEGER)\n          ELSE CASE WHEN t2.ANSWER_CODE=''LA32060-8'' THEN 150 * CAST(t1.ANSWER_CODE_DESCRIPTION AS INTEGER) ELSE 0 END\n          END AS SCREENING_ANSWER_VALUE,\n          Scrn_Phycical_Act_Score.SCRN_PHYSICAL_ACTIVITY_VALUE AS SCREENING_CALCULATED_VALUE,\n          (SELECT src_file_row_number FROM screening_20240307 WHERE UPPER(QUESTION_CODE_DESCRIPTION) LIKE ''%CALCULATED WEEKLY PHYSICAL ACTIVITY%'') AS SRC_FILE_ROW_NUMBER,\n          ''ANSWER_CODE_DESCRIPTION'' AS ANSWER_CODE_DESCRIPTION\n\n        from\n          cte_physical_activity t1\n        Inner Join cte_physical_activity t2\n    On\n          t1.sequence_number = 1\n          and t2.sequence_number = 2\n        Left Outer Join (\n          Select\n            CASE\n              WHEN TRY_CAST(ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL THEN CAST(ANSWER_CODE_DESCRIPTION AS INTEGER)\n              ELSE 0\n            END SCRN_PHYSICAL_ACTIVITY_VALUE\n          From\n          screening_20240307 scr\n          Where\n            UPPER(scr.QUESTION_CODE_DESCRIPTION) LIKE ''%CALCULATED WEEKLY PHYSICAL ACTIVITY%'') AS Scrn_Phycical_Act_Score\n                On\n          1 = 1\n    ) As calc_fld\n    Where\n      (calc_fld.CROSSWALK_ANSWER_VALUE <> calc_fld.SCREENING_ANSWER_VALUE)\n      OR (calc_fld.SCREENING_ANSWER_VALUE <> calc_fld.SCREENING_CALCULATED_VALUE)\n      OR (calc_fld.CROSSWALK_ANSWER_VALUE <> calc_fld.SCREENING_CALCULATED_VALUE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ANSWER_CODE_DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ANSWER_CODE_DESCRIPTION for CALCULATED PHYSICAL ACTIVITY SCORE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ANSWER_CODE_DESCRIPTION for CALCULATED PHYSICAL ACTIVITY SCORE (Calculated Score)''\n      FROM valid_calculated_weekly_physical_activity_score_in_all_rows;\nWITH allowed_values AS (\n    SELECT ''SCREENING_CODE'' AS issue_column,\n           \"SCREENING_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_CODE\" NOT IN (''96777-8'', ''97023-6'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''96777-8'''', ''''97023-6'''')'',\n           ''Use only allowed values ''''96777-8'''', ''''97023-6'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''SCREENING_CODE_SYSTEM_NAME'' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" NOT IN (''LN'', ''LOINC'', ''http://loinc.org'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''', ''''LOINC'''', ''''http://loinc.org'''')'',\n           ''Use only allowed values ''''LN'''', ''''LOINC'''', ''''http://loinc.org'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''RECORDED_TIME'' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"RECORDED_TIME\" IS NULL\n        OR TRIM(CAST(\"RECORDED_TIME\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_date_time_in_all_rows AS (\n        SELECT  ''RECORDED_TIME'' AS issue_column,\n              \"RECORDED_TIME\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM \"screening_20240307\"\n        WHERE \"RECORDED_TIME\" IS NOT NULL\n        AND \"RECORDED_TIME\" NOT SIMILAR TO ''([0-9]([0-9]([0-9][1-9]|[1-9]0)|[1-9]00)|[1-9]000)-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])T([01][0-9]|2[0-3]):[0-5][0-9]:([0-5][0-9]|60)(\\.[0-9]+)?(Z|(\\+|-)((0[0-9]|1[0-3]):[0-5][0-9]|14:00))$''\n        OR TRY_CAST(\"RECORDED_TIME\" AS TIMESTAMP) IS NULL\n  )\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Date'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid timestamp \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Please be sure to provide both a valid date and time.''\n      FROM valid_date_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''SDOH_DOMAIN'' AS issue_column,\n           \"SDOH_DOMAIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SDOH_DOMAIN\" IS NULL\n        OR TRIM(CAST(\"SDOH_DOMAIN\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_sdoh_domain_in_all_rows AS (\n  SELECT DISTINCT scr.SDOH_DOMAIN AS invalid_value,\n    ''SDOH_DOMAIN'' AS issue_column,\n    scr.src_file_row_number AS issue_row\n  FROM screening_20240307 scr\n  LEFT JOIN ahc_cross_walk cw\n  ON UPPER(scr.SDOH_DOMAIN) = UPPER(cw.SDOH_DOMAIN)\n  WHERE cw.SDOH_DOMAIN IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid SDOH DOMAIN'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid SDOH DOMAIN \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate SDOH DOMAIN with ahc cross walk reference data''\n      FROM valid_sdoh_domain_in_all_rows;\nWITH valid_question_code_for_screening_code_in_all_rows AS (\n  SELECT DISTINCT scr.SCREENING_CODE AS issue_screening_value, scr.QUESTION_CODE AS invalid_value, ''QUESTION_CODE'' AS issue_column, scr.src_file_row_number AS issue_row\n  FROM screening_20240307 scr\n  LEFT JOIN ahc_cross_walk cw ON UPPER(scr.QUESTION_CODE) = UPPER(cw.QUESTION_CODE)\n  AND UPPER(scr.SCREENING_CODE) = UPPER(cw.SCREENING_CODE)\n  WHERE cw.QUESTION_CODE IS NULL\n  AND cw.SCREENING_CODE IS NOT NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Question Code'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid Question Code \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate Question Code with ahc cross walk reference data''\n      FROM valid_question_code_for_screening_code_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''ANSWER_CODE_DESCRIPTION'' AS issue_column,\n           \"ANSWER_CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ANSWER_CODE_DESCRIPTION\" IS NULL\n        OR TRIM(CAST(\"ANSWER_CODE_DESCRIPTION\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''QUESTION_CODE_SYSTEM_NAME'' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" NOT IN (''LN'',''LOINC'',''http://loinc.org'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''',''''LOINC'''',''''http://loinc.org'''')'',\n           ''Use only allowed values ''''LN'''',''''LOINC'''',''''http://loinc.org'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''ANSWER_CODE_SYSTEM_NAME'' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" NOT IN (''LN'',''LOINC'',''http://loinc.org'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''',''''LOINC'''',''''http://loinc.org'''')'',\n           ''Use only allowed values ''''LN'''',''''LOINC'''',''''http://loinc.org'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''POTENTIAL_NEED_INDICATED'' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" IS NULL\n        OR TRIM(CAST(\"POTENTIAL_NEED_INDICATED\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''POTENTIAL_NEED_INDICATED'' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" NOT IN (''Yes'',''No'',''NA'',''yes'',''no'',''na'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''',''''No'''',''''NA'''',''''yes'''',''''no'''',''''na'''')'',\n           ''Use only allowed values ''''Yes'''',''''No'''',''''NA'''',''''yes'''',''''no'''',''''na'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_screening_potential_need_indicated_question_answer_values_in_all_rows AS (\n  SELECT  ''POTENTIAL_NEED_INDICATED'' AS issue_column,\n          coalesce(scr.\"POTENTIAL_NEED_INDICATED\",''NULL'') AS invalid_value,\n          scr.ANSWER_CODE AS invalid_answer_value,\n          scr.QUESTION_CODE AS invalid_question_value,\n          scr.SCREENING_CODE AS invalid_screening_value,\n          scr.src_file_row_number AS issue_row\n  FROM screening_20240307 scr\n  LEFT JOIN ahc_cross_walk acw\n    ON UPPER(scr.SCREENING_CODE) = UPPER(acw.SCREENING_CODE)\n    AND UPPER(scr.QUESTION_CODE) = UPPER(acw.QUESTION_CODE)\n    AND UPPER(scr.ANSWER_CODE) = UPPER(acw.ANSWER_CODE)\n    AND UPPER(scr.\"POTENTIAL_NEED_INDICATED\") = UPPER(acw.\"POTENTIAL_NEED_INDICATED\")\n  WHERE acw.\"POTENTIAL_NEED_INDICATED\" IS NULL\n  AND  UPPER(scr.QUESTION_CODE_DESCRIPTION)\n  NOT IN(\n    ''TOTAL SAFETY SCORE'',\n    ''CALCULATED WEEKLY PHYSICAL ACTIVITY'',\n    ''CALCULATED MENTAL HEALTH SCORE''\n  )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid value in POTENTIAL_NEED_INDICATED'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Provided Potential Need Indicated \"'' || invalid_value || ''\", Screening Code \"'' || invalid_screening_value || ''\", Question Code \"'' || invalid_question_value || ''\" and Answer Code \"'' || invalid_answer_value || ''\" are not matching with the reference data found in '' || issue_column,\n           ''Validate Potential Need Indicated, Screening Code, Question Code and Answer Code with ahc cross walk reference data''\n      FROM valid_screening_potential_need_indicated_question_answer_values_in_all_rows;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''c50d9d2d-753b-5200-b2f6-e63309cf252d'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''ScreeningCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''463a01b7-82ad-5633-939d-54a554d09923'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''b9aac8ec-792a-511d-8107-25bd96085898'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''AhcCrossWalkCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''98f79424-a291-554e-aa6a-17c4c39e5c81'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''b9aac8ec-792a-511d-8107-25bd96085898'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''AhcCrossWalkCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''1e8926d1-43b1-5485-9308-7addd10605ab'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''48eb0055-f06e-57f4-8019-f49266be3d22'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''EncounterClassReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''a76151ab-e619-51bb-9db7-57c686404756'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''48eb0055-f06e-57f4-8019-f49266be3d22'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''EncounterClassReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''81a8b5c0-5c79-5ff9-95d6-cfcf0749c550'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''2e9c77e9-a664-5323-83e4-e6a92cf998ab'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''EncounterStatusCodeReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''731b9b5d-fbb0-541f-93bc-11778098ab71'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''2e9c77e9-a664-5323-83e4-e6a92cf998ab'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''EncounterStatusCodeReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''2af573ce-4941-56c1-a703-f92928ad3a7d'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''4b3dd9ab-d81b-509a-9662-68dbd6d142f7'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''EncounterTypeCodeReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''8fe71cea-8904-5ba0-823d-de9955eee28d'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''4b3dd9ab-d81b-509a-9662-68dbd6d142f7'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''EncounterTypeCodeReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''b7082a36-d569-5f54-b0fe-23dfaca90466'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''1a152daa-273d-5411-88cf-84067822a8aa'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''ScreeningStatusCodeReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7d4a917b-2900-5b12-a89c-a246a342b27b'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''1a152daa-273d-5411-88cf-84067822a8aa'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''ScreeningStatusCodeReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''de2853a4-d787-5e6d-ba4c-58a0cd667eac'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''787ee7ff-3ef5-59aa-a055-659cf10b6202'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''GenderIdentityReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''51873a08-9517-54b6-982b-38b5e08677b8'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''787ee7ff-3ef5-59aa-a055-659cf10b6202'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''GenderIdentityReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''bd4d7db3-4490-5a2f-8b54-876cd96bb629'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''79f3d60e-c863-5759-8043-f122175a7cbb'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''AdministrativeSexReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''e6b6e4b0-6fdd-5d2b-a626-801aaaa4967f'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''79f3d60e-c863-5759-8043-f122175a7cbb'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''AdministrativeSexReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7b22a848-5153-5975-b74e-e9c3ea06640c'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''6c2d9879-7393-524d-9e9e-02ea961aca39'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''SexAtBirthReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''8a53e502-4b61-5596-88d5-e2e23a907935'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''6c2d9879-7393-524d-9e9e-02ea961aca39'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''SexAtBirthReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''0ab7227d-471c-5f13-9630-7f3c0c6cd120'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''2239dca2-9dd4-5c3a-91c8-2585839b9584'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''SexualOrientationReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''63af23ca-ea46-53d2-a55c-459cb2419b54'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''2239dca2-9dd4-5c3a-91c8-2585839b9584'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''SexualOrientationReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''41f3b3f2-2670-5600-96ca-a39e21943a0a'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''fc740f9e-863e-5dd1-b1a1-86d176cb549c'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''BusinessRulesReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''2bb73de9-1a11-58ac-bcda-74d30c2ace8e'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''fc740f9e-863e-5dd1-b1a1-86d176cb549c'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''BusinessRulesReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''baac722a-6a3b-5494-9df5-91e63f8c22b0'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''f98a88dc-a929-5a9b-906a-277e62c93012'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''RaceReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''312774c2-4ed4-526a-a68c-64356a89466d'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''f98a88dc-a929-5a9b-906a-277e62c93012'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''RaceReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''6cf18abf-2b0d-5ec5-9b5e-2a7e81d0bcc3'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''b0cbca95-5c20-5b2b-b589-9e832c556bc6'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''EthnicityReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''66d2dfbd-511a-58c0-9092-fd1965efbe27'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''b0cbca95-5c20-5b2b-b589-9e832c556bc6'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''EthnicityReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''905ccf58-6d99-5787-97b2-2534a35e55d6'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''3469db42-0066-5f23-9ee4-2b857bf339a4'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''PreferredLanguageReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''96ffe5ed-2b40-5e9b-8e13-a60d66430ceb'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''3469db42-0066-5f23-9ee4-2b857bf339a4'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''PreferredLanguageReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''83c7e8ef-bc1c-5726-a3f1-46ec9c63a4df'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''f19d5ebb-ea63-5b1d-b1b1-758457a2da29'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''SdohDomainReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''aae34d6f-c822-51b7-b05a-b06cb3774a0f'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''f19d5ebb-ea63-5b1d-b1b1-758457a2da29'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''SdohDomainReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n```\nNo STDOUT emitted by `ensureContent` (status: `0`).\n\nNo STDERR emitted by `ensureContent`.\n\n    ', NULL);;\n-- diagnostics-md-ignore-finish \"SQLPage and execution diagnostics SQL DML\"\n\nCREATE VIEW orch_session_issue_classification AS\nWITH cte_business_rule AS (\n  SELECT worksheet as worksheet,\n      field as field,\n      required as required,\n      \"Resolved by QE/QCS\" as resolved_by_qe_qcs,\n      CONCAT(\n          CASE WHEN UPPER(\"True Rejection\") = 'YES' THEN 'REJECTION' ELSE '' END,\n          CASE WHEN UPPER(\"Warning Layer\") = 'YES' THEN 'WARNING' ELSE '' END\n      ) AS record_action\n  FROM\n      \"ingestion-center\".main.business_rules\n)\n--select * from cte_business_rule\n\nSELECT\n  -- Including all other columns from 'orch_session'\n  ises.* EXCLUDE (orch_started_at, orch_finished_at),\n  -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n    -- strftime(timestamptz orch_started_at, '%Y-%m-%d %H:%M:%S') AS orch_started_at,\n    -- strftime(timestamptz orch_finished_at, '%Y-%m-%d %H:%M:%S') AS orch_finished_at,\n  -- Including all columns from 'orch_session_entry'\n  isee.* EXCLUDE (session_id),\n  -- Including all other columns from 'orch_session_issue'\n  isi.* EXCLUDE (session_id, session_entry_id),\n  CASE\n    WHEN\n        UPPER(isi.issue_type) = 'MISSING COLUMN'\n      THEN\n        'STRUCTURAL ISSUE'\n      ELSE\n        br.record_action\n    END\n  AS disposition,\n  case when UPPER(br.resolved_by_qe_qcs) = 'YES' then 'Resolved By QE/QCS' else null end AS remediation\n  FROM orch_session AS ises\n  JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n  LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id\n  --LEFT JOIN business_rules br ON isi.issue_column = br.FIELD\n  LEFT OUTER JOIN cte_business_rule br ON br.field = isi.issue_column\n  WHERE isi.orch_session_issue_id IS NOT NULL\n;\n\nATTACH 'HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/resource.sqlite.db' AS resource_db (TYPE SQLITE);\n\n-- copy relevant orchestration engine admin tables into the the attached database\nCREATE TABLE resource_db.device AS SELECT * FROM device;\nCREATE TABLE resource_db.orch_session AS SELECT * FROM orch_session;\nCREATE TABLE resource_db.orch_session_entry AS SELECT * FROM orch_session_entry;\nCREATE TABLE resource_db.orch_session_state AS SELECT * FROM orch_session_state;\nCREATE TABLE resource_db.orch_session_exec AS SELECT * FROM orch_session_exec;\nCREATE TABLE resource_db.orch_session_issue AS SELECT * FROM orch_session_issue;\nCREATE TABLE resource_db.sqlpage_files AS SELECT * FROM sqlpage_files;\n\n-- export content tables from DuckDb into the attached database (nature-dependent)\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('ee41c26e-0432-5c46-8e87-4493240aa872', '52c6a395-5d83-4051-bb7c-39036f26ab29', '963ed7bf-d356-54ae-ba2a-739f7f164e1a', 'ASSURED_CSV', 'EXIT(AdminDemographicCsvFileIngestSource)', NULL, 'AdminDemographicCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS demographic_data AS SELECT *, CAST(NULL AS VARCHAR) AS source_table FROM admin_demographics_20240307 WHERE 0=1;\nINSERT INTO demographic_data SELECT *, 'admin_demographics_20240307' AS source_table FROM admin_demographics_20240307;\n\nCREATE TABLE resource_db.admin_demographics_20240307 AS SELECT * FROM admin_demographics_20240307;\n\nCREATE TABLE IF NOT EXISTS resource_db.demographic_data AS SELECT *, CAST(NULL AS VARCHAR) AS source_table FROM admin_demographics_20240307 WHERE 0=1;\nINSERT INTO resource_db.demographic_data SELECT *, 'admin_demographics_20240307' AS source_table FROM admin_demographics_20240307;\n\n\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('e8659af4-7259-5edd-bdcc-ac0a4efd58c0', '52c6a395-5d83-4051-bb7c-39036f26ab29', '963ed7bf-d356-54ae-ba2a-739f7f164e1a', 'ATTEMPT_CSV_EXPORT', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'AdminDemographicCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('13c54df5-b695-5291-babd-c8b267e9d523', '52c6a395-5d83-4051-bb7c-39036f26ab29', '767cb8df-3ec0-5b59-998e-a91e75be32b3', 'ASSURED_CSV', 'EXIT(QeAdminDataCsvFileIngestSource)', NULL, 'QeAdminDataCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS qe_admin_data AS SELECT *, CAST(NULL AS VARCHAR) AS source_table FROM qe_admin_data_20240307 WHERE 0=1;\nINSERT INTO qe_admin_data SELECT *, 'qe_admin_data_20240307' AS source_table FROM qe_admin_data_20240307;\n\nCREATE TABLE resource_db.qe_admin_data_20240307 AS SELECT * FROM qe_admin_data_20240307;\n\nCREATE TABLE IF NOT EXISTS resource_db.qe_admin_data AS SELECT *, CAST(NULL AS VARCHAR) AS source_table FROM qe_admin_data_20240307 WHERE 0=1;\nINSERT INTO resource_db.qe_admin_data SELECT *, 'qe_admin_data_20240307' AS source_table FROM qe_admin_data_20240307;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('17ef47cc-33c1-5c18-93c5-72e549769537', '52c6a395-5d83-4051-bb7c-39036f26ab29', '767cb8df-3ec0-5b59-998e-a91e75be32b3', 'ATTEMPT_CSV_EXPORT', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'QeAdminDataCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('e9acf2a4-e063-5ece-beed-7053b11e9181', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'd09ebe08-1b63-56d8-8f2b-8fff76c9828f', 'ASSURED_CSV', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'ScreeningCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS screening AS SELECT *, CAST(NULL AS VARCHAR) AS source_table FROM screening_20240307 WHERE 0=1;\nINSERT INTO screening SELECT *, 'screening_20240307' AS source_table FROM screening_20240307;\n\nCREATE TABLE resource_db.screening_20240307 AS SELECT * FROM screening_20240307;\n\nCREATE TABLE IF NOT EXISTS resource_db.screening AS SELECT *, CAST(NULL AS VARCHAR) AS source_table FROM screening_20240307 WHERE 0=1;\nINSERT INTO resource_db.screening SELECT *, 'screening_20240307' AS source_table FROM screening_20240307;\n\n-- try sqltofhir Visual Studio Code extension for writing FHIR resources with SQL.\n-- see https://marketplace.visualstudio.com/items?itemName=arkhn.sqltofhir-vscode\nCREATE VIEW IF NOT EXISTS screening_fhir AS\n  SELECT tab_screening.PAT_MRN_ID, CONCAT(tab_demograph.FIRST_NAME,' ', tab_demograph.LAST_NAME) as display_name, json_object(\n        'resourceType', 'Observation',\n        'id', tab_screening.ENCOUNTER_ID,\n        'status', 'final',\n        'code', json_object(\n            'coding', json_array(\n                json_object(\n                    'system', tab_screening.QUESTION_CODE_SYSTEM_NAME,\n                    'code', tab_screening.QUESTION_CODE,\n                    'display', tab_screening.QUESTION_CODE_DESCRIPTION\n                )\n            )\n        ),\n        'subject', json_object(\n            'reference', 'Patient/' || tab_screening.PAT_MRN_ID,\n            'display',  CONCAT(tab_demograph.FIRST_NAME,' ', tab_demograph.LAST_NAME)\n        ),\n        'effectiveDateTime', tab_screening.RECORDED_TIME,\n        'valueString', tab_screening.ANSWER_CODE_DESCRIPTION,\n        'performer', json_array(\n            json_object(\n                'reference', 'Practitioner/' || tab_screening.session_id\n            )\n        ),\n        'context', json_object(\n            'reference', 'Encounter/' || tab_screening.ENCOUNTER_ID\n        )\n    ) AS FHIR_Observation\n  FROM screening_20240307 as tab_screening LEFT JOIN admin_demographics_20240307 as tab_demograph\n  ON tab_screening.PAT_MRN_ID = tab_demograph.PAT_MRN_ID;\n\nCREATE VIEW IF NOT EXISTS resource_db.screening_fhir AS\n  SELECT tab_screening.PAT_MRN_ID, CONCAT(tab_demograph.FIRST_NAME,' ', tab_demograph.LAST_NAME) as display_name, json_object(\n        'resourceType', 'Observation',\n        'id', tab_screening.ENCOUNTER_ID,\n        'status', 'final',\n        'code', json_object(\n            'coding', json_array(\n                json_object(\n                    'system', tab_screening.QUESTION_CODE_SYSTEM_NAME,\n                    'code', tab_screening.QUESTION_CODE,\n                    'display', tab_screening.QUESTION_CODE_DESCRIPTION\n                )\n            )\n        ),\n        'subject', json_object(\n            'reference', 'Patient/' || tab_screening.PAT_MRN_ID,\n            'display',  CONCAT(tab_demograph.FIRST_NAME,' ', tab_demograph.LAST_NAME)\n        ),\n        'effectiveDateTime', tab_screening.RECORDED_TIME,\n        'valueString', tab_screening.ANSWER_CODE_DESCRIPTION,\n        'performer', json_array(\n            json_object(\n                'reference', 'Practitioner/' || tab_screening.session_id\n            )\n        ),\n        'context', json_object(\n            'reference', 'Encounter/' || tab_screening.ENCOUNTER_ID\n        )\n    ) AS FHIR_Observation\n  FROM screening_20240307 as tab_screening LEFT JOIN admin_demographics_20240307 as tab_demograph\n  ON tab_screening.PAT_MRN_ID = tab_demograph.PAT_MRN_ID;\n\n        -- TODO: Need to fill out subject->display, source->display, questionnaire\nCREATE VIEW IF NOT EXISTS resource_db.screening_fhir_questionnaire AS\n  SELECT tab_screening.PAT_MRN_ID, CONCAT(tab_demograph.FIRST_NAME,' ', tab_demograph.LAST_NAME) as display_name, json_object(\n        'resourceType', 'QuestionnaireResponse',\n        'id', tab_screening.ENCOUNTER_ID,\n        'status', 'completed',\n        'questionnaire', '',\n        '_questionnaire', json_object(\n            'extension', json_array(\n                json_object(\n                    'url', tab_screening.QUESTION_CODE_SYSTEM_NAME,\n                    'valueString', tab_screening.QUESTION_CODE\n                )\n            )\n        ),\n        'subject', json_object(\n            'reference', 'Patient/' || tab_screening.PAT_MRN_ID,\n            'display',  CONCAT(tab_demograph.FIRST_NAME,' ', tab_demograph.LAST_NAME)\n        ),\n        'authored', tab_screening.RECORDED_TIME,\n        'source', json_object(\n            'reference', 'Patient/' || tab_screening.PAT_MRN_ID,\n            'display',  CONCAT(tab_demograph.FIRST_NAME,' ', tab_demograph.LAST_NAME)\n        ),\n        'item', json_array(\n            json_object(\n                'linkId', tab_screening.QUESTION_CODE,\n                'text', tab_screening.QUESTION_CODE_DESCRIPTION,\n                'answer',  json_array(\n                  json_object(\n                      'valueCoding', json_object(\n                        'system', 'http://loinc.org',\n                        'code', tab_screening.ANSWER_CODE,\n                        'display', tab_screening.ANSWER_CODE_DESCRIPTION\n                      )\n                  )\n                )\n            )\n        )\n    ) AS FHIR_Questionnaire\n  FROM screening_20240307 as tab_screening LEFT JOIN admin_demographics_20240307 as tab_demograph\n  ON tab_screening.PAT_MRN_ID = tab_demograph.PAT_MRN_ID;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('52d390d5-4f35-5707-857e-eb43f4b41fe5', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'd09ebe08-1b63-56d8-8f2b-8fff76c9828f', 'ATTEMPT_CSV_EXPORT', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'ScreeningCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('3c858698-491c-5134-863e-cf43cc958e87', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b9aac8ec-792a-511d-8107-25bd96085898', 'ASSURED_CSV', 'EXIT(AhcCrossWalkCsvFileIngestSource)', NULL, 'AhcCrossWalkCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.ahc_cross_walk AS SELECT * FROM ahc_cross_walk WHERE 0=1;\nINSERT INTO resource_db.ahc_cross_walk SELECT * FROM ahc_cross_walk;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('3bac5767-3a72-5522-8f53-b289c94ae153', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b9aac8ec-792a-511d-8107-25bd96085898', 'ATTEMPT_CSV_EXPORT', 'EXIT(AhcCrossWalkCsvFileIngestSource)', NULL, 'AhcCrossWalkCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('d1f279e8-6732-5bb6-9700-1c8c3d75cbfc', '52c6a395-5d83-4051-bb7c-39036f26ab29', '48eb0055-f06e-57f4-8019-f49266be3d22', 'ASSURED_CSV', 'EXIT(EncounterClassReferenceCsvFileIngestSource)', NULL, 'EncounterClassReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.encounter_class_reference AS SELECT * FROM encounter_class_reference WHERE 0=1;\nINSERT INTO resource_db.encounter_class_reference SELECT * FROM encounter_class_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('ab6a85a4-6397-5cef-a429-936f795c5f40', '52c6a395-5d83-4051-bb7c-39036f26ab29', '48eb0055-f06e-57f4-8019-f49266be3d22', 'ATTEMPT_CSV_EXPORT', 'EXIT(EncounterClassReferenceCsvFileIngestSource)', NULL, 'EncounterClassReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('e49e6abb-371b-538d-848c-5d77b42df2be', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2e9c77e9-a664-5323-83e4-e6a92cf998ab', 'ASSURED_CSV', 'EXIT(EncounterStatusCodeReferenceCsvFileIngestSource)', NULL, 'EncounterStatusCodeReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.encounter_status_code_reference AS SELECT * FROM encounter_status_code_reference WHERE 0=1;\nINSERT INTO resource_db.encounter_status_code_reference SELECT * FROM encounter_status_code_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('aa16821b-d305-58cf-9634-ccfa8b43ff4a', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2e9c77e9-a664-5323-83e4-e6a92cf998ab', 'ATTEMPT_CSV_EXPORT', 'EXIT(EncounterStatusCodeReferenceCsvFileIngestSource)', NULL, 'EncounterStatusCodeReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('24772d54-226d-50f7-91cb-cbacccfb13cc', '52c6a395-5d83-4051-bb7c-39036f26ab29', '4b3dd9ab-d81b-509a-9662-68dbd6d142f7', 'ASSURED_CSV', 'EXIT(EncounterTypeCodeReferenceCsvFileIngestSource)', NULL, 'EncounterTypeCodeReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.encounter_type_code_reference AS SELECT * FROM encounter_type_code_reference WHERE 0=1;\nINSERT INTO resource_db.encounter_type_code_reference SELECT * FROM encounter_type_code_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('4894f5a0-e42a-58d1-a1a0-68c60927e244', '52c6a395-5d83-4051-bb7c-39036f26ab29', '4b3dd9ab-d81b-509a-9662-68dbd6d142f7', 'ATTEMPT_CSV_EXPORT', 'EXIT(EncounterTypeCodeReferenceCsvFileIngestSource)', NULL, 'EncounterTypeCodeReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('108d080a-3c8d-55d0-a4b3-093d808e9425', '52c6a395-5d83-4051-bb7c-39036f26ab29', '1a152daa-273d-5411-88cf-84067822a8aa', 'ASSURED_CSV', 'EXIT(ScreeningStatusCodeReferenceCsvFileIngestSource)', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.screening_status_code_reference AS SELECT * FROM screening_status_code_reference WHERE 0=1;\nINSERT INTO resource_db.screening_status_code_reference SELECT * FROM screening_status_code_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('5d72401f-6126-5936-b487-72b814b067b4', '52c6a395-5d83-4051-bb7c-39036f26ab29', '1a152daa-273d-5411-88cf-84067822a8aa', 'ATTEMPT_CSV_EXPORT', 'EXIT(ScreeningStatusCodeReferenceCsvFileIngestSource)', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('50e2f362-b5e5-5b66-ab03-7885e3c4a94e', '52c6a395-5d83-4051-bb7c-39036f26ab29', '787ee7ff-3ef5-59aa-a055-659cf10b6202', 'ASSURED_CSV', 'EXIT(GenderIdentityReferenceCsvFileIngestSource)', NULL, 'GenderIdentityReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.gender_identity_reference AS SELECT * FROM gender_identity_reference WHERE 0=1;\nINSERT INTO resource_db.gender_identity_reference SELECT * FROM gender_identity_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('603210af-d8eb-50b0-a901-62445eff8227', '52c6a395-5d83-4051-bb7c-39036f26ab29', '787ee7ff-3ef5-59aa-a055-659cf10b6202', 'ATTEMPT_CSV_EXPORT', 'EXIT(GenderIdentityReferenceCsvFileIngestSource)', NULL, 'GenderIdentityReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('93378ce6-e53a-5f14-a6dd-68de9f44e5e6', '52c6a395-5d83-4051-bb7c-39036f26ab29', '79f3d60e-c863-5759-8043-f122175a7cbb', 'ASSURED_CSV', 'EXIT(AdministrativeSexReferenceCsvFileIngestSource)', NULL, 'AdministrativeSexReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.administrative_sex_reference AS SELECT * FROM administrative_sex_reference WHERE 0=1;\nINSERT INTO resource_db.administrative_sex_reference SELECT * FROM administrative_sex_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('11f32278-5dd7-5997-9014-9afe5f5d841b', '52c6a395-5d83-4051-bb7c-39036f26ab29', '79f3d60e-c863-5759-8043-f122175a7cbb', 'ATTEMPT_CSV_EXPORT', 'EXIT(AdministrativeSexReferenceCsvFileIngestSource)', NULL, 'AdministrativeSexReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('16182dbd-064e-5083-b5c6-fb741d8afc03', '52c6a395-5d83-4051-bb7c-39036f26ab29', '6c2d9879-7393-524d-9e9e-02ea961aca39', 'ASSURED_CSV', 'EXIT(SexAtBirthReferenceCsvFileIngestSource)', NULL, 'SexAtBirthReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.sex_at_birth_reference AS SELECT * FROM sex_at_birth_reference WHERE 0=1;\nINSERT INTO resource_db.sex_at_birth_reference SELECT * FROM sex_at_birth_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('b6058e56-de5f-50ac-9e58-cf0c98e33157', '52c6a395-5d83-4051-bb7c-39036f26ab29', '6c2d9879-7393-524d-9e9e-02ea961aca39', 'ATTEMPT_CSV_EXPORT', 'EXIT(SexAtBirthReferenceCsvFileIngestSource)', NULL, 'SexAtBirthReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('eb9733e4-31a4-545e-91d4-917dea346b56', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2239dca2-9dd4-5c3a-91c8-2585839b9584', 'ASSURED_CSV', 'EXIT(SexualOrientationReferenceCsvFileIngestSource)', NULL, 'SexualOrientationReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.sexual_orientation_reference AS SELECT * FROM sexual_orientation_reference WHERE 0=1;\nINSERT INTO resource_db.sexual_orientation_reference SELECT * FROM sexual_orientation_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('daa222d9-a8cd-5aa0-8489-812498651ca7', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2239dca2-9dd4-5c3a-91c8-2585839b9584', 'ATTEMPT_CSV_EXPORT', 'EXIT(SexualOrientationReferenceCsvFileIngestSource)', NULL, 'SexualOrientationReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('10533670-17e2-5485-8865-5bc5e8849dae', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'fc740f9e-863e-5dd1-b1a1-86d176cb549c', 'ASSURED_CSV', 'EXIT(BusinessRulesReferenceCsvFileIngestSource)', NULL, 'BusinessRulesReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.business_rules AS SELECT * FROM business_rules WHERE 0=1;\nINSERT INTO resource_db.business_rules SELECT * FROM business_rules;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('6bc40a02-418f-54d9-856e-32e10ba5d280', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'fc740f9e-863e-5dd1-b1a1-86d176cb549c', 'ATTEMPT_CSV_EXPORT', 'EXIT(BusinessRulesReferenceCsvFileIngestSource)', NULL, 'BusinessRulesReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('33878364-0076-5616-a9bb-f76f79412d48', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f98a88dc-a929-5a9b-906a-277e62c93012', 'ASSURED_CSV', 'EXIT(RaceReferenceCsvFileIngestSource)', NULL, 'RaceReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.race_reference AS SELECT * FROM race_reference WHERE 0=1;\nINSERT INTO resource_db.race_reference SELECT * FROM race_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('cac60ec5-d280-5042-a525-084f0a113be3', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f98a88dc-a929-5a9b-906a-277e62c93012', 'ATTEMPT_CSV_EXPORT', 'EXIT(RaceReferenceCsvFileIngestSource)', NULL, 'RaceReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('294f670b-cd60-579d-8a89-2e4278d859d7', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b0cbca95-5c20-5b2b-b589-9e832c556bc6', 'ASSURED_CSV', 'EXIT(EthnicityReferenceCsvFileIngestSource)', NULL, 'EthnicityReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.ethnicity_reference AS SELECT * FROM ethnicity_reference WHERE 0=1;\nINSERT INTO resource_db.ethnicity_reference SELECT * FROM ethnicity_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('c99907f4-d324-55e3-84b1-6173237c8ddd', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b0cbca95-5c20-5b2b-b589-9e832c556bc6', 'ATTEMPT_CSV_EXPORT', 'EXIT(EthnicityReferenceCsvFileIngestSource)', NULL, 'EthnicityReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('5ba09e54-ee01-59a9-a418-ad161bfe897d', '52c6a395-5d83-4051-bb7c-39036f26ab29', '3469db42-0066-5f23-9ee4-2b857bf339a4', 'ASSURED_CSV', 'EXIT(PreferredLanguageReferenceCsvFileIngestSource)', NULL, 'PreferredLanguageReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.preferred_language_reference AS SELECT * FROM preferred_language_reference WHERE 0=1;\nINSERT INTO resource_db.preferred_language_reference SELECT * FROM preferred_language_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('0a849a74-98b5-5d39-8ff2-6e844d08d68a', '52c6a395-5d83-4051-bb7c-39036f26ab29', '3469db42-0066-5f23-9ee4-2b857bf339a4', 'ATTEMPT_CSV_EXPORT', 'EXIT(PreferredLanguageReferenceCsvFileIngestSource)', NULL, 'PreferredLanguageReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('23bc7407-0e9b-5ac6-a614-4156c5fabe9c', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f19d5ebb-ea63-5b1d-b1b1-758457a2da29', 'ASSURED_CSV', 'EXIT(SdohDomainReferenceCsvFileIngestSource)', NULL, 'SdohDomainReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.sdoh_domain_reference AS SELECT * FROM sdoh_domain_reference WHERE 0=1;\nINSERT INTO resource_db.sdoh_domain_reference SELECT * FROM sdoh_domain_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('00d9e8a2-7805-5ea6-9026-1c0a4caf99ee', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f19d5ebb-ea63-5b1d-b1b1-758457a2da29', 'ATTEMPT_CSV_EXPORT', 'EXIT(SdohDomainReferenceCsvFileIngestSource)', NULL, 'SdohDomainReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  ;\n\n\nDETACH DATABASE resource_db;\n\n-- no after-finalize SQL provided","orch_session_exec_id":"82af32da-0a2e-5279-8819-3da4b3274663","exec_nature":"duckdb","exec_status":0,"input_text":"-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('52196f78-69f4-585b-92cd-8c8ae034bd56', '52c6a395-5d83-4051-bb7c-39036f26ab29', NULL, 'NONE', 'ENTER(prepareInit)', NULL, 'rsEE.beforeCell', ('2024-05-03T10:18:41.940Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('9c7a9deb-310c-56b5-bcaf-a15c8364fd30', '52c6a395-5d83-4051-bb7c-39036f26ab29', NULL, 'EXIT(prepareInit)', 'ENTER(init)', NULL, 'rsEE.afterCell', ('2024-05-03T10:18:41.940Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('a55e9808-8c5b-5dbd-87fb-4b555db691b0', '52c6a395-5d83-4051-bb7c-39036f26ab29', NULL, 'EXIT(init)', 'ENTER(ingest)', NULL, 'rsEE.afterCell', ('2024-05-03T10:18:41.940Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('52b4baaf-8edd-5214-a0fd-5e6e3083f830', '52c6a395-5d83-4051-bb7c-39036f26ab29', NULL, 'EXIT(ingest)', 'ENTER(ensureContent)', NULL, 'rsEE.afterCell', ('2024-05-03T10:18:41.940Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('434be675-ad6c-5d22-8930-2dbef82f52a3', '52c6a395-5d83-4051-bb7c-39036f26ab29', NULL, 'EXIT(ensureContent)', 'ENTER(emitResources)', NULL, 'rsEE.afterCell', ('2024-05-03T10:18:41.940Z'), NULL);\n\n-- diagnostics-md-ignore-start \"SQLPage and execution diagnostics SQL DML\"\n-- emit all the SQLPage content\nCREATE TABLE IF NOT EXISTS \"sqlpage_files\" (\n    \"path\" TEXT PRIMARY KEY NOT NULL,\n    \"contents\" TEXT NOT NULL,\n    \"last_modified\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('sqlpage/templates/session_entries.handlebars', '<h1>{{title}}</h1>\n\n<ul>\n{{#each_row}}\n    <li><a href=\"?session_entry_id={{orch_session_entry_id}}\">{{ingest_src}}</a> ({{ingest_table_name}})</li>\n{{/each_row}}\n</ul>', (CURRENT_TIMESTAMP));\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('sqlpage/templates/info_model_schema_tables.handlebars', '{{caption}}\n<ul>\n{{#each_row}}\n    <li><a href=\"?table_nature={{nature}}&table_name={{table_name}}\">{{table_name}}</a> ({{nature}}, {{columns_count}} columns)</li>\n{{/each_row}}\n</ul>', (CURRENT_TIMESTAMP));\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('scripts/shell.js', 'function wrapSTDOUTInDetails() {\n    // Find all heading elements that could contain the STDOUT text\n    const headings = document.querySelectorAll(''h1, h2, h3, h4, h5, h6'');\n\n    headings.forEach(function(heading) {\n        if (heading.textContent.includes(''STDOUT'')) {\n            // Find the next <pre><code> block\n            var nextEl = heading.nextElementSibling;\n            while (nextEl) {\n                if (nextEl.matches(''pre'') && nextEl.querySelector(''code'')) {\n                    // Create the <details> and <summary> elements\n                    const details = document.createElement(''details'');\n                    const summary = document.createElement(''summary'');\n                    summary.textContent = heading.textContent;\n\n                    // Wrap the <pre><code> block in <details>\n                    nextEl.parentNode.insertBefore(details, nextEl);\n                    details.appendChild(summary);\n                    details.appendChild(nextEl);\n                    break;\n                }\n                nextEl = nextEl.nextElementSibling;\n            }\n        }\n    });\n\n    headings.forEach(function(heading) {\n        if (heading.textContent.includes(''STDOUT'')) {\n          heading.remove();\n        }\n    });\n}\n\ndocument.addEventListener(''DOMContentLoaded'', function() {\n  // find all code elements on the current page with the class ''language-sql'' and add the class ''line-numbers'' to each of them\n  document.querySelectorAll(''code.language-sql'').forEach(function(codeEl) {\n      var parentPre = codeEl.parentElement;\n      if (parentPre && parentPre.tagName === ''PRE'') {\n          parentPre.classList.add(''line-numbers'');\n      }\n  });\n  wrapSTDOUTInDetails();\n});\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('index.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\nSELECT ''list'' as component;\nSELECT ''1115 Waiver Screenings'' as title,''1115-waiver-screenings.sql'' as link;\nSELECT ''Orchestration Sessions'' as title,''sessions.sql'' as link;\nSELECT ''Orchestration Issues'' as title,''issues.sql'' as link;\nSELECT ''Orchestration State Schema'' as title,''schema.sql'' as link;', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('sessions.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''table'' as component;\nSELECT * FROM device;\n\nSELECT ''table'' as component, ''orch_session_id'' as markdown, ''SUMMARY'' as markdown;\nSELECT ''['' || orch_session_id || ''](session-diagnostics.sql?session_id=''|| orch_session_id ||'')'' as orch_session_id,''['' || ''Summary'' || ''](session-summary.sql?session_id=''|| orch_session_id ||'')'' as SUMMARY, device_id, orch_started_at, orch_finished_at FROM orch_session;\n\nSELECT ''table'' as component, ''true'' as search, ''ingest_src'' as markdown;\nSELECT ''['' || ingest_src || ''](issues.sql?session_entry_id=''|| orch_session_entry_id ||'')'' as ingest_src, ingest_table_name FROM \"orch_session_entry\";\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('reference.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''text'' as component, ''Encounter Class Reference'' as title;\n\nSELECT ''table'' as component;\nSELECT * FROM encounter_class_reference;\n\nSELECT ''text'' as component, ''Encounter Status Code Reference'' as title;\n\nSELECT ''table'' as component;\nSELECT * FROM encounter_status_code_reference;\n\nSELECT ''text'' as component, ''Encounter Type Code Reference'' as title;\n\nSELECT ''table'' as component;\nSELECT * FROM encounter_type_code_reference;\n\nSELECT ''text'' as component, ''Screening Status Code Reference'' as title;\n\nSELECT ''table'' as component;\nSELECT * FROM screening_status_code_reference;\n\nSELECT ''text'' as component, ''Business Rules'' as title;\n\nSELECT ''table'' as component;\nSELECT * FROM business_rules;\n\nSELECT ''text'' as component, ''AHC Cross Walk'' as title;\n\nSELECT ''table'' as component;\nSELECT * FROM ahc_cross_walk;\n\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('session-diagnostics.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''text'' as component, (''Session '' || $session_id || '' Arguments '') as title, (SELECT ''```json\n'' || args_json || ''\n```'' FROM orch_session WHERE orch_session_id = $session_id) as contents_md;\n\nSELECT ''text'' as component, (''Session '' || $session_id || '' Diagnostics '') as title, (SELECT diagnostics_md FROM orch_session WHERE orch_session_id = $session_id) as contents_md;', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('session-summary.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\nSELECT ''text'' as component, ''Summary'' as title;\nSELECT ''table'' as component, ''true'' as search;\nSELECT issue_type,COUNT(orch_session_issue_id) as issue_count from orch_session_issue group by issue_type;\n\n', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('issues.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''session_entries'' as component, ''Choose Session Entry'' as title;\nSELECT orch_session_entry_id, ingest_src, ingest_table_name\n  FROM orch_session_entry;\n\nSELECT ''table'' as component, ''true'' as search;\n\n            SELECT issue_type, issue_message, invalid_value, remediation\n              FROM orch_session_issue\n             WHERE session_entry_id = $session_entry_id;\n', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('1115-waiver-screenings.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort, ''pat_mrn_id'' as markdown;\n\n              SELECT format(''[%s](?pat_mrn_id=%s)'', pat_mrn_id, pat_mrn_id) as pat_mrn_id, facility_id\n                FROM screening\n            GROUP BY pat_mrn_id, facility_id\n            ORDER BY facility_id;\n\nSELECT ''text'' as component, (select format(''%s %s Answers'') from screening where pat_mrn_id = $pat_mrn_id) as title;\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort WHERE coalesce($pat_mrn_id, '''') <> '''';\n\n            SELECT QUESTION_CODE_DESCRIPTION, ANSWER_CODE_DESCRIPTION\n              FROM \"screening\"\n             WHERE pat_mrn_id = $pat_mrn_id;\nSELECT ''text'' as component, (select format(''%s %s FHIR Patient'', first_name, last_name) from demographic_data where pat_mrn_id = $pat_mrn_id) as title;\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort WHERE $pat_mrn_id is not null;\n\n            SELECT *\n              FROM \"demographic_data_fhir_patient\"\n             WHERE pat_mrn_id = $pat_mrn_id;\nSELECT ''text'' as component, (select format(''%s FHIR Observations'', display_name) from screening_fhir where pat_mrn_id = $pat_mrn_id) as title;\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort WHERE $pat_mrn_id is not null;\n\n            SELECT *\n              FROM \"screening_fhir\"\n             WHERE pat_mrn_id = $pat_mrn_id;\nSELECT ''text'' as component, (select format(''%s FHIR Questionnaire'', display_name) from screening_fhir_questionnaire where pat_mrn_id = $pat_mrn_id) as title;\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort WHERE $pat_mrn_id is not null;\n\n            SELECT *\n              FROM \"screening_fhir_questionnaire\"\n             WHERE pat_mrn_id = $pat_mrn_id;\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('schema.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\nSELECT ''text'' as component, ''Information Model (Schema) Documentation'' as title, ''TODO (description)'' as contents_md;\n\nSELECT ''table'' as component, ''table_name'' as markdown;\n\n          SELECT format(''[%s](?table_name=%s&table_nature)'', m.tbl_name, m.tbl_name, m.type) AS table_name,\n                 (SELECT COUNT(*) FROM sqlite_master sm2 JOIN pragma_table_info(m.tbl_name) cc ON 1=1 WHERE sm2.tbl_name = m.tbl_name) AS columns_count,\n                 m.type as nature\n            FROM sqlite_master m\n        ORDER BY table_name\n      ;\n\nSELECT ''text'' as component, ($table_name || '' '' || $table_nature || '' columns'' ) as title, ''TODO (lineage, governance, description, etc.)'' as contents_md WHERE coalesce($table_name, '''') <> '''';\nSELECT ''table'' as component WHERE coalesce($table_name, '''') <> '''';\n\n            SELECT\n              ROW_NUMBER() OVER (PARTITION BY m.tbl_name ORDER BY c.cid) AS column_num,\n              -- TODO: add governance information (e.g. description, etc. from SQLa)\n              CASE WHEN c.pk THEN ''*'' ELSE '''' END AS is_primary_key,\n              c.name AS column_name,\n              c.\"type\" AS column_type,\n              CASE WHEN c.\"notnull\" THEN ''*'' ELSE '''' END AS not_null,\n              COALESCE(c.dflt_value, '''') AS default_value,\n              COALESCE((SELECT pfkl.\"table\" || ''.'' || pfkl.\"to\" FROM pragma_foreign_key_list(m.tbl_name) AS pfkl WHERE pfkl.\"from\" = c.name), '''') as fk_refs\n              -- TODO: add \"is_indexed\" and other details\n            FROM sqlite_master m JOIN pragma_table_info(m.tbl_name) c ON 1=1\n            WHERE m.tbl_name = $table_name;\n\nSELECT ''text'' as component, ($table_name || '' indexes'') as title;\nSELECT ''table'' as component WHERE coalesce($table_name, '''') <> '''';\n\n            SELECT il.name as \"Index Name\", group_concat(ii.name, '', '') as columns\n              FROM sqlite_master as m, pragma_index_list(m.name) AS il, pragma_index_info(il.name) AS ii\n             WHERE m.tbl_name = $table_name\n             GROUP BY m.name, il.name;\n\n-- TODO: add PlantUML or Mermaid ERD through SQL as emitted by tbls (use ChatGPT to create)\n    ;\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;;\n\n-- emit all the execution diagnostics\nINSERT INTO \"orch_session_exec\" (\"orch_session_exec_id\", \"exec_nature\", \"session_id\", \"session_entry_id\", \"parent_exec_id\", \"namespace\", \"exec_identity\", \"exec_code\", \"exec_status\", \"input_text\", \"exec_error_text\", \"output_text\", \"output_nature\", \"narrative_md\", \"elaboration\") VALUES ('06e5cabe-6b22-5c95-b606-e15660eb1006', 'duckdb', '52c6a395-5d83-4051-bb7c-39036f26ab29', NULL, NULL, NULL, 'init', 'duckdb HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.workflow/ingestion-center.duckdb', 0, '-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"version\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMP,\n    \"elaboration\" TEXT,\n    \"args_json\" TEXT,\n    \"diagnostics_json\" TEXT,\n    \"diagnostics_md\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from ''orch_session''\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, ''%Y-%m-%d %H:%M:%S'') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, ''%Y-%m-%d %H:%M:%S'') AS orch_finished_at,\n    \n        -- Including all columns from ''orch_session_entry''\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from ''orch_session_issue''\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES (''fb100496-cb54-5e75-8a29-4fe36e78b522'', ''ALAN-FRANCIS'', ''SINGLETON'', ''UNKNOWN'', NULL, ''{\"os-arch\":\"x64\",\"os-platform\":\"linux\"}'', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"version\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\", \"args_json\", \"diagnostics_json\", \"diagnostics_md\") VALUES (''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''fb100496-cb54-5e75-8a29-4fe36e78b522'', ''0.17.2'', (''2024-05-03T10:18:40.514Z''), NULL, NULL, NULL, NULL, ''Session 52c6a395-5d83-4051-bb7c-39036f26ab29 markdown diagnostics not provided (not completed?)'');\n\n-- Load Reference data from csvs\n\n-- no after-init SQL found', NULL, NULL, NULL, '\n## init\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"version\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMP,\n    \"elaboration\" TEXT,\n    \"args_json\" TEXT,\n    \"diagnostics_json\" TEXT,\n    \"diagnostics_md\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from ''orch_session''\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, ''%Y-%m-%d %H:%M:%S'') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, ''%Y-%m-%d %H:%M:%S'') AS orch_finished_at,\n    \n        -- Including all columns from ''orch_session_entry''\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from ''orch_session_issue''\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES (''fb100496-cb54-5e75-8a29-4fe36e78b522'', ''ALAN-FRANCIS'', ''SINGLETON'', ''UNKNOWN'', NULL, ''{\"os-arch\":\"x64\",\"os-platform\":\"linux\"}'', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"version\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\", \"args_json\", \"diagnostics_json\", \"diagnostics_md\") VALUES (''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''fb100496-cb54-5e75-8a29-4fe36e78b522'', ''0.17.2'', (''2024-05-03T10:18:40.514Z''), NULL, NULL, NULL, NULL, ''Session 52c6a395-5d83-4051-bb7c-39036f26ab29 markdown diagnostics not provided (not completed?)'');\n\n-- Load Reference data from csvs\n\n-- no after-init SQL found\n```\nNo STDOUT emitted by `init` (status: `0`).\n\nNo STDERR emitted by `init`.\n\n    ', NULL);\nINSERT INTO \"orch_session_exec\" (\"orch_session_exec_id\", \"exec_nature\", \"session_id\", \"session_entry_id\", \"parent_exec_id\", \"namespace\", \"exec_identity\", \"exec_code\", \"exec_status\", \"input_text\", \"exec_error_text\", \"output_text\", \"output_nature\", \"narrative_md\", \"elaboration\") VALUES ('986fcfe7-9b44-5a16-b7cc-ea656710ca64', 'duckdb', '52c6a395-5d83-4051-bb7c-39036f26ab29', NULL, NULL, NULL, 'ingest', 'duckdb HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.workflow/ingestion-center.duckdb --json', 0, '-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- ingest HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/DEMOGRAPHIC_DATA_20240307.csv (admin_demographics_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''963ed7bf-d356-54ae-ba2a-739f7f164e1a'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/DEMOGRAPHIC_DATA_20240307.csv'', ''admin_demographics_20240307'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''9c13e37e-d059-582b-bfe1-3875f9c96436'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''AdminDemographicCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE admin_demographics_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'' as session_entry_id\n    FROM read_csv_auto(''HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/DEMOGRAPHIC_DATA_20240307.csv'', types={''MPI_ID'': ''VARCHAR'', ''SEX_AT_BIRTH_CODE'': ''VARCHAR'', ''ADMINISTRATIVE_SEX_CODE'': ''VARCHAR'', ''SEXUAL_ORIENTATION_CODE'': ''VARCHAR'', ''GENDER_IDENTITY_CODE'': ''VARCHAR''});\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''MPI_ID''), (''PAT_MRN_ID''), (''FACILITY_ID''), (''CONSENT''), (''FIRST_NAME''), (''MIDDLE_NAME''), (''LAST_NAME''), (''ADMINISTRATIVE_SEX_CODE''), (''ADMINISTRATIVE_SEX_CODE_DESCRIPTION''), (''ADMINISTRATIVE_SEX_CODE_SYSTEM''), (''SEX_AT_BIRTH_CODE''), (''SEX_AT_BIRTH_CODE_DESCRIPTION''), (''SEX_AT_BIRTH_CODE_SYSTEM''), (''PAT_BIRTH_DATE''), (''ADDRESS1''), (''ADDRESS2''), (''CITY''), (''STATE''), (''ZIP''), (''GENDER_IDENTITY_CODE_SYSTEM_NAME''), (''GENDER_IDENTITY_CODE''), (''GENDER_IDENTITY_CODE_DESCRIPTION''), (''SEXUAL_ORIENTATION_CODE_SYSTEM_NAME''), (''SEXUAL_ORIENTATION_CODE''), (''SEXUAL_ORIENTATION_DESCRIPTION''), (''PREFERRED_LANGUAGE_CODE_SYSTEM_NAME''), (''PREFERRED_LANGUAGE_CODE''), (''PREFERRED_LANGUAGE_DESCRIPTION''), (''RACE_CODE_SYSTEM_NAME''), (''RACE_CODE''), (''RACE_CODE_DESCRIPTION''), (''ETHNICITY_CODE_SYSTEM_NAME''), (''ETHNICITY_CODE''), (''ETHNICITY_CODE_DESCRIPTION''), (''MEDICAID_CIN'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''admin_demographics_20240307'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in admin_demographics_20240307.'',\n           ''Ensure admin_demographics_20240307 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''e5f8dcaa-aaab-5807-a510-a2478c89fc30'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''AdminDemographicCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/QE_ADMIN_DATA_20240307.csv (qe_admin_data_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''767cb8df-3ec0-5b59-998e-a91e75be32b3'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/QE_ADMIN_DATA_20240307.csv'', ''qe_admin_data_20240307'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''523de5c7-6ede-5e49-9570-5621dde1f65a'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''767cb8df-3ec0-5b59-998e-a91e75be32b3'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''QeAdminDataCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE qe_admin_data_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''767cb8df-3ec0-5b59-998e-a91e75be32b3'' as session_entry_id\n    FROM read_csv_auto(''HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/QE_ADMIN_DATA_20240307.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY_ID''), (''FACILITY_LONG_NAME''), (''ORGANIZATION_TYPE''), (''FACILITY_ADDRESS1''), (''FACILITY_ADDRESS2''), (''FACILITY_CITY''), (''FACILITY_STATE''), (''FACILITY_ZIP''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''qe_admin_data_20240307'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in qe_admin_data_20240307.'',\n           ''Ensure qe_admin_data_20240307 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''f70136eb-81d9-550f-8910-1c9d430c71e5'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''767cb8df-3ec0-5b59-998e-a91e75be32b3'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''QeAdminDataCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/SCREENING_20240307.csv (screening_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/SCREENING_20240307.csv'', ''screening_20240307'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''aebb9881-f0ee-54c4-be68-53ce86973e56'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE screening_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'' as session_entry_id\n    FROM read_csv_auto(''HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/SCREENING_20240307.csv'', types={''RECORDED_TIME'': ''VARCHAR'', ''ENCOUNTER_TYPE_CODE'': ''VARCHAR''});\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY_ID''), (''ENCOUNTER_ID''), (''ENCOUNTER_CLASS_CODE_SYSTEM''), (''ENCOUNTER_CLASS_CODE''), (''ENCOUNTER_CLASS_CODE_DESCRIPTION''), (''ENCOUNTER_STATUS_CODE_SYSTEM''), (''ENCOUNTER_STATUS_CODE''), (''ENCOUNTER_STATUS_CODE_DESCRIPTION''), (''ENCOUNTER_TYPE_CODE_SYSTEM''), (''ENCOUNTER_TYPE_CODE''), (''ENCOUNTER_TYPE_CODE_DESCRIPTION''), (''SCREENING_CODE_DESCRIPTION''), (''SCREENING_CODE_SYSTEM_NAME''), (''SCREENING_CODE''), (''SCREENING_STATUS_CODE_DESCRIPTION''), (''SCREENING_STATUS_CODE''), (''SCREENING_STATUS_CODE_SYSTEM''), (''RECORDED_TIME''), (''QUESTION_CODE_DESCRIPTION''), (''ANSWER_CODE_DESCRIPTION''), (''UCUM_UNITS''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''PARENT_QUESTION_CODE''), (''SDOH_DOMAIN''), (''POTENTIAL_NEED_INDICATED'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''screening_20240307'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in screening_20240307.'',\n           ''Ensure screening_20240307 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''6506f244-6870-581c-a47e-875c52326818'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ahc-cross-walk.csv (ahc_cross_walk)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''b9aac8ec-792a-511d-8107-25bd96085898'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ahc-cross-walk.csv'', ''ahc_cross_walk'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''5b7d69bd-b348-556b-8e3a-4a4c4397163c'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''b9aac8ec-792a-511d-8107-25bd96085898'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''AhcCrossWalkCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_cross_walk AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''b9aac8ec-792a-511d-8107-25bd96085898'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ahc-cross-walk.csv'', header = true);\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''SCREENING_CODE''), (''SCREENING_CODE_DESCRIPTION''), (''QUESTION_SLNO''), (''QUESTION''), (''QUESTION_CODE''), (''QUESTION_SLNO_REFERENCE''), (''ANSWER_VALUE''), (''ANSWER_CODE''), (''CALCULATED_FIELD''), (''SCORE''), (''UCUM_UNITS''), (''SDOH_DOMAIN''), (''POTENTIAL_NEED_INDICATED'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_cross_walk'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''b9aac8ec-792a-511d-8107-25bd96085898'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_cross_walk.'',\n           ''Ensure ahc_cross_walk contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7c00755d-cac1-5780-b386-435fac109c1e'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''b9aac8ec-792a-511d-8107-25bd96085898'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''AhcCrossWalkCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-class-reference.csv (encounter_class_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''48eb0055-f06e-57f4-8019-f49266be3d22'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-class-reference.csv'', ''encounter_class_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''a4d8a2c7-1ed0-532c-8617-9b840e0db2a1'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''48eb0055-f06e-57f4-8019-f49266be3d22'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''EncounterClassReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE encounter_class_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''48eb0055-f06e-57f4-8019-f49266be3d22'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-class-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Code''), (''System''), (''Display''), (''Definition'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''encounter_class_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''48eb0055-f06e-57f4-8019-f49266be3d22'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in encounter_class_reference.'',\n           ''Ensure encounter_class_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''60e9c67a-d11b-58a8-b606-fec8ae5534b4'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''48eb0055-f06e-57f4-8019-f49266be3d22'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''EncounterClassReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-status-code-reference.csv (encounter_status_code_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''2e9c77e9-a664-5323-83e4-e6a92cf998ab'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-status-code-reference.csv'', ''encounter_status_code_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''ff07588a-62bc-500b-a066-3dc216afa1c5'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''2e9c77e9-a664-5323-83e4-e6a92cf998ab'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''EncounterStatusCodeReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE encounter_status_code_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''2e9c77e9-a664-5323-83e4-e6a92cf998ab'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-status-code-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Code''), (''Display''), (''Definition'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''encounter_status_code_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''2e9c77e9-a664-5323-83e4-e6a92cf998ab'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in encounter_status_code_reference.'',\n           ''Ensure encounter_status_code_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''24cfaeaa-484a-5041-9d81-e7c4fb141c4d'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''2e9c77e9-a664-5323-83e4-e6a92cf998ab'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''EncounterStatusCodeReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-type-code-reference.csv (encounter_type_code_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''4b3dd9ab-d81b-509a-9662-68dbd6d142f7'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-type-code-reference.csv'', ''encounter_type_code_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''813b4f2b-cc81-5ed4-9305-625009c58ab7'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''4b3dd9ab-d81b-509a-9662-68dbd6d142f7'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''EncounterTypeCodeReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE encounter_type_code_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''4b3dd9ab-d81b-509a-9662-68dbd6d142f7'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-type-code-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Code''), (''System''), (''Display'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''encounter_type_code_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''4b3dd9ab-d81b-509a-9662-68dbd6d142f7'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in encounter_type_code_reference.'',\n           ''Ensure encounter_type_code_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''dc2b6f5f-7872-5968-a30f-f8df2e860803'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''4b3dd9ab-d81b-509a-9662-68dbd6d142f7'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''EncounterTypeCodeReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/screening-status-code-reference.csv (screening_status_code_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''1a152daa-273d-5411-88cf-84067822a8aa'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/screening-status-code-reference.csv'', ''screening_status_code_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''a1402393-e3cf-5cc3-a644-da19d3689fc7'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''1a152daa-273d-5411-88cf-84067822a8aa'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''ScreeningStatusCodeReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE screening_status_code_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''1a152daa-273d-5411-88cf-84067822a8aa'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/screening-status-code-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Lvl''), (''Code''), (''Display''), (''Definition'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''screening_status_code_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''1a152daa-273d-5411-88cf-84067822a8aa'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in screening_status_code_reference.'',\n           ''Ensure screening_status_code_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''72b2e7e1-545d-540e-bbd7-5ab6b566a52a'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''1a152daa-273d-5411-88cf-84067822a8aa'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''ScreeningStatusCodeReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/gender-identity-reference.csv (gender_identity_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''787ee7ff-3ef5-59aa-a055-659cf10b6202'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/gender-identity-reference.csv'', ''gender_identity_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''30f231bd-8ace-577e-ac7d-b7484a41cf8c'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''787ee7ff-3ef5-59aa-a055-659cf10b6202'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''GenderIdentityReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE gender_identity_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''787ee7ff-3ef5-59aa-a055-659cf10b6202'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/gender-identity-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''GENDER_IDENTITY_CODE''), (''GENDER_IDENTITY_CODE_DESCRIPTION''), (''GENDER_IDENTITY_CODE_SYSTEM_NAME'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''gender_identity_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''787ee7ff-3ef5-59aa-a055-659cf10b6202'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in gender_identity_reference.'',\n           ''Ensure gender_identity_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''c33e617a-4c3b-5907-b98a-f576ff4ac7bd'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''787ee7ff-3ef5-59aa-a055-659cf10b6202'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''GenderIdentityReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/administrative-sex-reference.csv (administrative_sex_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''79f3d60e-c863-5759-8043-f122175a7cbb'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/administrative-sex-reference.csv'', ''administrative_sex_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''6a920ce5-e480-5723-a3f5-e3167db5bd23'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''79f3d60e-c863-5759-8043-f122175a7cbb'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''AdministrativeSexReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE administrative_sex_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''79f3d60e-c863-5759-8043-f122175a7cbb'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/administrative-sex-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''ADMINISTRATIVE_SEX_CODE''), (''ADMINISTRATIVE_SEX_CODE_DESCRIPTION''), (''ADMINISTRATIVE_SEX_CODE_SYSTEM'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''administrative_sex_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''79f3d60e-c863-5759-8043-f122175a7cbb'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in administrative_sex_reference.'',\n           ''Ensure administrative_sex_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''476191aa-f321-5d08-be13-ba624ad50951'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''79f3d60e-c863-5759-8043-f122175a7cbb'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''AdministrativeSexReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sex-at-birth-reference.csv (sex_at_birth_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''6c2d9879-7393-524d-9e9e-02ea961aca39'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sex-at-birth-reference.csv'', ''sex_at_birth_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''438bb3e5-1ee9-5ed9-9763-4626ae804fad'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''6c2d9879-7393-524d-9e9e-02ea961aca39'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''SexAtBirthReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE sex_at_birth_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''6c2d9879-7393-524d-9e9e-02ea961aca39'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sex-at-birth-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''SEX_AT_BIRTH_CODE''), (''SEX_AT_BIRTH_CODE_DESCRIPTION''), (''SEX_AT_BIRTH_CODE_SYSTEM'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''sex_at_birth_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''6c2d9879-7393-524d-9e9e-02ea961aca39'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in sex_at_birth_reference.'',\n           ''Ensure sex_at_birth_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''4bf5c21f-f9bc-5798-a40f-49354972a8e7'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''6c2d9879-7393-524d-9e9e-02ea961aca39'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''SexAtBirthReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sexual-orientation-reference.csv (sexual_orientation_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''2239dca2-9dd4-5c3a-91c8-2585839b9584'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sexual-orientation-reference.csv'', ''sexual_orientation_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''f02a11b9-d2a8-547c-b57c-7a67b06a3716'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''2239dca2-9dd4-5c3a-91c8-2585839b9584'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''SexualOrientationReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE sexual_orientation_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''2239dca2-9dd4-5c3a-91c8-2585839b9584'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sexual-orientation-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''SEXUAL_ORIENTATION_CODE''), (''SEXUAL_ORIENTATION_CODE_DESCRIPTION''), (''SEXUAL_ORIENTATION_CODE_SYSTEM_NAME'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''sexual_orientation_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''2239dca2-9dd4-5c3a-91c8-2585839b9584'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in sexual_orientation_reference.'',\n           ''Ensure sexual_orientation_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''f3038d1f-a52a-597e-92b4-1e0be7e6d464'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''2239dca2-9dd4-5c3a-91c8-2585839b9584'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''SexualOrientationReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/business-rules.csv (business_rules)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''fc740f9e-863e-5dd1-b1a1-86d176cb549c'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/business-rules.csv'', ''business_rules'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''5f9ab8c7-65b5-5dd8-9e6b-1501c2a639a9'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''fc740f9e-863e-5dd1-b1a1-86d176cb549c'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''BusinessRulesReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE business_rules AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''fc740f9e-863e-5dd1-b1a1-86d176cb549c'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/business-rules.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Worksheet''), (''Field''), (''Required''), (''Permissible Values''), (''True Rejection''), (''Warning Layer''), (''Resolved by QE/QCS'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''business_rules'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''fc740f9e-863e-5dd1-b1a1-86d176cb549c'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in business_rules.'',\n           ''Ensure business_rules contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''939acb5c-0c8e-5d68-9797-9e37ecf7f0a1'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''fc740f9e-863e-5dd1-b1a1-86d176cb549c'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''BusinessRulesReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/race-reference.csv (race_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''f98a88dc-a929-5a9b-906a-277e62c93012'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/race-reference.csv'', ''race_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''48fd69a6-5ad7-5d32-aa35-f9c05860c3d3'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''f98a88dc-a929-5a9b-906a-277e62c93012'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''RaceReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE race_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''f98a88dc-a929-5a9b-906a-277e62c93012'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/race-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Concept Name''), (''Concept Code''), (''Hierarchical Code''), (''Race Category (Concept Name)''), (''Race Category (Concept Code)''), (''Hiearchical Code'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''race_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''f98a88dc-a929-5a9b-906a-277e62c93012'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in race_reference.'',\n           ''Ensure race_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''72451a16-9ba1-5038-a58a-c3aca50cfad6'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''f98a88dc-a929-5a9b-906a-277e62c93012'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''RaceReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ethnicity-reference.csv (ethnicity_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''b0cbca95-5c20-5b2b-b589-9e832c556bc6'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ethnicity-reference.csv'', ''ethnicity_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''d0ed9035-6320-5391-8d2e-509cdc185699'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''b0cbca95-5c20-5b2b-b589-9e832c556bc6'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''EthnicityReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ethnicity_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''b0cbca95-5c20-5b2b-b589-9e832c556bc6'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ethnicity-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Concept Code''), (''Concept Name''), (''Hierarchical Code''), (''Ethnicity Group (Concept Name)''), (''Ethnicity Group (Concept Code)'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''ethnicity_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''b0cbca95-5c20-5b2b-b589-9e832c556bc6'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ethnicity_reference.'',\n           ''Ensure ethnicity_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''f517a0e3-a9aa-5e82-83d1-5ace996332f0'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''b0cbca95-5c20-5b2b-b589-9e832c556bc6'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''EthnicityReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/preferred-language-reference.csv (preferred_language_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''3469db42-0066-5f23-9ee4-2b857bf339a4'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/preferred-language-reference.csv'', ''preferred_language_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''d65cb030-fbbf-55e3-b848-18fd81a32679'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''3469db42-0066-5f23-9ee4-2b857bf339a4'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''PreferredLanguageReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE preferred_language_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''3469db42-0066-5f23-9ee4-2b857bf339a4'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/preferred-language-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''ISO 639-2 Code''), (''ISO 639-1 Code''), (''English name of Language''), (''French name of Language''), (''German name of Language'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''preferred_language_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''3469db42-0066-5f23-9ee4-2b857bf339a4'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in preferred_language_reference.'',\n           ''Ensure preferred_language_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''f1c1a13a-58bf-51c3-92e0-12f2056f8a68'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''3469db42-0066-5f23-9ee4-2b857bf339a4'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''PreferredLanguageReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sdoh-domain-reference.csv (sdoh_domain_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''f19d5ebb-ea63-5b1d-b1b1-758457a2da29'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sdoh-domain-reference.csv'', ''sdoh_domain_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''34308a17-4300-50d6-96bd-b34982aa25db'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''f19d5ebb-ea63-5b1d-b1b1-758457a2da29'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''SdohDomainReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE sdoh_domain_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''f19d5ebb-ea63-5b1d-b1b1-758457a2da29'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sdoh-domain-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Code''), (''Display''), (''Definition'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''sdoh_domain_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''f19d5ebb-ea63-5b1d-b1b1-758457a2da29'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in sdoh_domain_reference.'',\n           ''Ensure sdoh_domain_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''3204b0bd-3443-59e9-9b22-d1881b9c7797'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''f19d5ebb-ea63-5b1d-b1b1-758457a2da29'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''SdohDomainReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''screening_20240307''\n        AS table_name,\n        ''SCREENING'' AS table_name_suffix\n      UNION ALL\n      SELECT ''admin_demographics_20240307''\n        AS table_name,\n        ''DEMOGRAPHIC_DATA'' AS table_name_suffix\n      UNION ALL\n      SELECT ''qe_admin_data_20240307''\n        AS table_name,\n        ''QE_ADMIN_DATA'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''admin_demographics_20240307'' IN (\n      ''screening_20240307'',\n      ''admin_demographics_20240307'',\n      ''qe_admin_data_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''screening_20240307''\n        AS table_name,\n        ''SCREENING'' AS table_name_suffix\n      UNION ALL\n      SELECT ''admin_demographics_20240307''\n        AS table_name,\n        ''DEMOGRAPHIC_DATA'' AS table_name_suffix\n      UNION ALL\n      SELECT ''qe_admin_data_20240307''\n        AS table_name,\n        ''QE_ADMIN_DATA'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''qe_admin_data_20240307'' IN (\n      ''screening_20240307'',\n      ''admin_demographics_20240307'',\n      ''qe_admin_data_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''screening_20240307''\n        AS table_name,\n        ''SCREENING'' AS table_name_suffix\n      UNION ALL\n      SELECT ''admin_demographics_20240307''\n        AS table_name,\n        ''DEMOGRAPHIC_DATA'' AS table_name_suffix\n      UNION ALL\n      SELECT ''qe_admin_data_20240307''\n        AS table_name,\n        ''QE_ADMIN_DATA'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''screening_20240307'' IN (\n      ''screening_20240307'',\n      ''admin_demographics_20240307'',\n      ''qe_admin_data_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''screening_20240307''\n        AS table_name,\n        ''SCREENING'' AS table_name_suffix\n      UNION ALL\n      SELECT ''admin_demographics_20240307''\n        AS table_name,\n        ''DEMOGRAPHIC_DATA'' AS table_name_suffix\n      UNION ALL\n      SELECT ''qe_admin_data_20240307''\n        AS table_name,\n        ''QE_ADMIN_DATA'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''screening_status_code_reference'' IN (\n      ''screening_20240307'',\n      ''admin_demographics_20240307'',\n      ''qe_admin_data_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''1a152daa-273d-5411-88cf-84067822a8aa'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nSELECT osi.session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value, ingest_table_name FROM orch_session_issue osi LEFT JOIN orch_session_entry ose ON osi.session_entry_id = ose.orch_session_entry_id WHERE osi.session_id = ''52c6a395-5d83-4051-bb7c-39036f26ab29''', NULL, NULL, 'JSON', '\n## ingest\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- ingest HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/DEMOGRAPHIC_DATA_20240307.csv (admin_demographics_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''963ed7bf-d356-54ae-ba2a-739f7f164e1a'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/DEMOGRAPHIC_DATA_20240307.csv'', ''admin_demographics_20240307'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''9c13e37e-d059-582b-bfe1-3875f9c96436'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''AdminDemographicCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE admin_demographics_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'' as session_entry_id\n    FROM read_csv_auto(''HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/DEMOGRAPHIC_DATA_20240307.csv'', types={''MPI_ID'': ''VARCHAR'', ''SEX_AT_BIRTH_CODE'': ''VARCHAR'', ''ADMINISTRATIVE_SEX_CODE'': ''VARCHAR'', ''SEXUAL_ORIENTATION_CODE'': ''VARCHAR'', ''GENDER_IDENTITY_CODE'': ''VARCHAR''});\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''MPI_ID''), (''PAT_MRN_ID''), (''FACILITY_ID''), (''CONSENT''), (''FIRST_NAME''), (''MIDDLE_NAME''), (''LAST_NAME''), (''ADMINISTRATIVE_SEX_CODE''), (''ADMINISTRATIVE_SEX_CODE_DESCRIPTION''), (''ADMINISTRATIVE_SEX_CODE_SYSTEM''), (''SEX_AT_BIRTH_CODE''), (''SEX_AT_BIRTH_CODE_DESCRIPTION''), (''SEX_AT_BIRTH_CODE_SYSTEM''), (''PAT_BIRTH_DATE''), (''ADDRESS1''), (''ADDRESS2''), (''CITY''), (''STATE''), (''ZIP''), (''GENDER_IDENTITY_CODE_SYSTEM_NAME''), (''GENDER_IDENTITY_CODE''), (''GENDER_IDENTITY_CODE_DESCRIPTION''), (''SEXUAL_ORIENTATION_CODE_SYSTEM_NAME''), (''SEXUAL_ORIENTATION_CODE''), (''SEXUAL_ORIENTATION_DESCRIPTION''), (''PREFERRED_LANGUAGE_CODE_SYSTEM_NAME''), (''PREFERRED_LANGUAGE_CODE''), (''PREFERRED_LANGUAGE_DESCRIPTION''), (''RACE_CODE_SYSTEM_NAME''), (''RACE_CODE''), (''RACE_CODE_DESCRIPTION''), (''ETHNICITY_CODE_SYSTEM_NAME''), (''ETHNICITY_CODE''), (''ETHNICITY_CODE_DESCRIPTION''), (''MEDICAID_CIN'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''admin_demographics_20240307'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in admin_demographics_20240307.'',\n           ''Ensure admin_demographics_20240307 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''e5f8dcaa-aaab-5807-a510-a2478c89fc30'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''AdminDemographicCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/QE_ADMIN_DATA_20240307.csv (qe_admin_data_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''767cb8df-3ec0-5b59-998e-a91e75be32b3'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/QE_ADMIN_DATA_20240307.csv'', ''qe_admin_data_20240307'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''523de5c7-6ede-5e49-9570-5621dde1f65a'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''767cb8df-3ec0-5b59-998e-a91e75be32b3'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''QeAdminDataCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE qe_admin_data_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''767cb8df-3ec0-5b59-998e-a91e75be32b3'' as session_entry_id\n    FROM read_csv_auto(''HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/QE_ADMIN_DATA_20240307.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY_ID''), (''FACILITY_LONG_NAME''), (''ORGANIZATION_TYPE''), (''FACILITY_ADDRESS1''), (''FACILITY_ADDRESS2''), (''FACILITY_CITY''), (''FACILITY_STATE''), (''FACILITY_ZIP''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''qe_admin_data_20240307'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in qe_admin_data_20240307.'',\n           ''Ensure qe_admin_data_20240307 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''f70136eb-81d9-550f-8910-1c9d430c71e5'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''767cb8df-3ec0-5b59-998e-a91e75be32b3'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''QeAdminDataCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/SCREENING_20240307.csv (screening_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/SCREENING_20240307.csv'', ''screening_20240307'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''aebb9881-f0ee-54c4-be68-53ce86973e56'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE screening_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'' as session_entry_id\n    FROM read_csv_auto(''HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.ingress-tx/SCREENING_20240307.csv'', types={''RECORDED_TIME'': ''VARCHAR'', ''ENCOUNTER_TYPE_CODE'': ''VARCHAR''});\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY_ID''), (''ENCOUNTER_ID''), (''ENCOUNTER_CLASS_CODE_SYSTEM''), (''ENCOUNTER_CLASS_CODE''), (''ENCOUNTER_CLASS_CODE_DESCRIPTION''), (''ENCOUNTER_STATUS_CODE_SYSTEM''), (''ENCOUNTER_STATUS_CODE''), (''ENCOUNTER_STATUS_CODE_DESCRIPTION''), (''ENCOUNTER_TYPE_CODE_SYSTEM''), (''ENCOUNTER_TYPE_CODE''), (''ENCOUNTER_TYPE_CODE_DESCRIPTION''), (''SCREENING_CODE_DESCRIPTION''), (''SCREENING_CODE_SYSTEM_NAME''), (''SCREENING_CODE''), (''SCREENING_STATUS_CODE_DESCRIPTION''), (''SCREENING_STATUS_CODE''), (''SCREENING_STATUS_CODE_SYSTEM''), (''RECORDED_TIME''), (''QUESTION_CODE_DESCRIPTION''), (''ANSWER_CODE_DESCRIPTION''), (''UCUM_UNITS''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''PARENT_QUESTION_CODE''), (''SDOH_DOMAIN''), (''POTENTIAL_NEED_INDICATED'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''screening_20240307'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in screening_20240307.'',\n           ''Ensure screening_20240307 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''6506f244-6870-581c-a47e-875c52326818'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ahc-cross-walk.csv (ahc_cross_walk)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''b9aac8ec-792a-511d-8107-25bd96085898'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ahc-cross-walk.csv'', ''ahc_cross_walk'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''5b7d69bd-b348-556b-8e3a-4a4c4397163c'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''b9aac8ec-792a-511d-8107-25bd96085898'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''AhcCrossWalkCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_cross_walk AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''b9aac8ec-792a-511d-8107-25bd96085898'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ahc-cross-walk.csv'', header = true);\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''SCREENING_CODE''), (''SCREENING_CODE_DESCRIPTION''), (''QUESTION_SLNO''), (''QUESTION''), (''QUESTION_CODE''), (''QUESTION_SLNO_REFERENCE''), (''ANSWER_VALUE''), (''ANSWER_CODE''), (''CALCULATED_FIELD''), (''SCORE''), (''UCUM_UNITS''), (''SDOH_DOMAIN''), (''POTENTIAL_NEED_INDICATED'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_cross_walk'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''b9aac8ec-792a-511d-8107-25bd96085898'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_cross_walk.'',\n           ''Ensure ahc_cross_walk contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7c00755d-cac1-5780-b386-435fac109c1e'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''b9aac8ec-792a-511d-8107-25bd96085898'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''AhcCrossWalkCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-class-reference.csv (encounter_class_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''48eb0055-f06e-57f4-8019-f49266be3d22'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-class-reference.csv'', ''encounter_class_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''a4d8a2c7-1ed0-532c-8617-9b840e0db2a1'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''48eb0055-f06e-57f4-8019-f49266be3d22'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''EncounterClassReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE encounter_class_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''48eb0055-f06e-57f4-8019-f49266be3d22'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-class-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Code''), (''System''), (''Display''), (''Definition'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''encounter_class_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''48eb0055-f06e-57f4-8019-f49266be3d22'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in encounter_class_reference.'',\n           ''Ensure encounter_class_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''60e9c67a-d11b-58a8-b606-fec8ae5534b4'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''48eb0055-f06e-57f4-8019-f49266be3d22'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''EncounterClassReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-status-code-reference.csv (encounter_status_code_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''2e9c77e9-a664-5323-83e4-e6a92cf998ab'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-status-code-reference.csv'', ''encounter_status_code_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''ff07588a-62bc-500b-a066-3dc216afa1c5'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''2e9c77e9-a664-5323-83e4-e6a92cf998ab'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''EncounterStatusCodeReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE encounter_status_code_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''2e9c77e9-a664-5323-83e4-e6a92cf998ab'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-status-code-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Code''), (''Display''), (''Definition'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''encounter_status_code_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''2e9c77e9-a664-5323-83e4-e6a92cf998ab'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in encounter_status_code_reference.'',\n           ''Ensure encounter_status_code_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''24cfaeaa-484a-5041-9d81-e7c4fb141c4d'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''2e9c77e9-a664-5323-83e4-e6a92cf998ab'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''EncounterStatusCodeReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-type-code-reference.csv (encounter_type_code_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''4b3dd9ab-d81b-509a-9662-68dbd6d142f7'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-type-code-reference.csv'', ''encounter_type_code_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''813b4f2b-cc81-5ed4-9305-625009c58ab7'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''4b3dd9ab-d81b-509a-9662-68dbd6d142f7'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''EncounterTypeCodeReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE encounter_type_code_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''4b3dd9ab-d81b-509a-9662-68dbd6d142f7'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-type-code-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Code''), (''System''), (''Display'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''encounter_type_code_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''4b3dd9ab-d81b-509a-9662-68dbd6d142f7'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in encounter_type_code_reference.'',\n           ''Ensure encounter_type_code_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''dc2b6f5f-7872-5968-a30f-f8df2e860803'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''4b3dd9ab-d81b-509a-9662-68dbd6d142f7'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''EncounterTypeCodeReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/screening-status-code-reference.csv (screening_status_code_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''1a152daa-273d-5411-88cf-84067822a8aa'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/screening-status-code-reference.csv'', ''screening_status_code_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''a1402393-e3cf-5cc3-a644-da19d3689fc7'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''1a152daa-273d-5411-88cf-84067822a8aa'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''ScreeningStatusCodeReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE screening_status_code_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''1a152daa-273d-5411-88cf-84067822a8aa'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/screening-status-code-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Lvl''), (''Code''), (''Display''), (''Definition'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''screening_status_code_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''1a152daa-273d-5411-88cf-84067822a8aa'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in screening_status_code_reference.'',\n           ''Ensure screening_status_code_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''72b2e7e1-545d-540e-bbd7-5ab6b566a52a'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''1a152daa-273d-5411-88cf-84067822a8aa'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''ScreeningStatusCodeReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/gender-identity-reference.csv (gender_identity_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''787ee7ff-3ef5-59aa-a055-659cf10b6202'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/gender-identity-reference.csv'', ''gender_identity_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''30f231bd-8ace-577e-ac7d-b7484a41cf8c'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''787ee7ff-3ef5-59aa-a055-659cf10b6202'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''GenderIdentityReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE gender_identity_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''787ee7ff-3ef5-59aa-a055-659cf10b6202'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/gender-identity-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''GENDER_IDENTITY_CODE''), (''GENDER_IDENTITY_CODE_DESCRIPTION''), (''GENDER_IDENTITY_CODE_SYSTEM_NAME'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''gender_identity_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''787ee7ff-3ef5-59aa-a055-659cf10b6202'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in gender_identity_reference.'',\n           ''Ensure gender_identity_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''c33e617a-4c3b-5907-b98a-f576ff4ac7bd'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''787ee7ff-3ef5-59aa-a055-659cf10b6202'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''GenderIdentityReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/administrative-sex-reference.csv (administrative_sex_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''79f3d60e-c863-5759-8043-f122175a7cbb'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/administrative-sex-reference.csv'', ''administrative_sex_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''6a920ce5-e480-5723-a3f5-e3167db5bd23'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''79f3d60e-c863-5759-8043-f122175a7cbb'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''AdministrativeSexReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE administrative_sex_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''79f3d60e-c863-5759-8043-f122175a7cbb'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/administrative-sex-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''ADMINISTRATIVE_SEX_CODE''), (''ADMINISTRATIVE_SEX_CODE_DESCRIPTION''), (''ADMINISTRATIVE_SEX_CODE_SYSTEM'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''administrative_sex_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''79f3d60e-c863-5759-8043-f122175a7cbb'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in administrative_sex_reference.'',\n           ''Ensure administrative_sex_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''476191aa-f321-5d08-be13-ba624ad50951'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''79f3d60e-c863-5759-8043-f122175a7cbb'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''AdministrativeSexReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sex-at-birth-reference.csv (sex_at_birth_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''6c2d9879-7393-524d-9e9e-02ea961aca39'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sex-at-birth-reference.csv'', ''sex_at_birth_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''438bb3e5-1ee9-5ed9-9763-4626ae804fad'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''6c2d9879-7393-524d-9e9e-02ea961aca39'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''SexAtBirthReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE sex_at_birth_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''6c2d9879-7393-524d-9e9e-02ea961aca39'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sex-at-birth-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''SEX_AT_BIRTH_CODE''), (''SEX_AT_BIRTH_CODE_DESCRIPTION''), (''SEX_AT_BIRTH_CODE_SYSTEM'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''sex_at_birth_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''6c2d9879-7393-524d-9e9e-02ea961aca39'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in sex_at_birth_reference.'',\n           ''Ensure sex_at_birth_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''4bf5c21f-f9bc-5798-a40f-49354972a8e7'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''6c2d9879-7393-524d-9e9e-02ea961aca39'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''SexAtBirthReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sexual-orientation-reference.csv (sexual_orientation_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''2239dca2-9dd4-5c3a-91c8-2585839b9584'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sexual-orientation-reference.csv'', ''sexual_orientation_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''f02a11b9-d2a8-547c-b57c-7a67b06a3716'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''2239dca2-9dd4-5c3a-91c8-2585839b9584'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''SexualOrientationReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE sexual_orientation_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''2239dca2-9dd4-5c3a-91c8-2585839b9584'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sexual-orientation-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''SEXUAL_ORIENTATION_CODE''), (''SEXUAL_ORIENTATION_CODE_DESCRIPTION''), (''SEXUAL_ORIENTATION_CODE_SYSTEM_NAME'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''sexual_orientation_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''2239dca2-9dd4-5c3a-91c8-2585839b9584'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in sexual_orientation_reference.'',\n           ''Ensure sexual_orientation_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''f3038d1f-a52a-597e-92b4-1e0be7e6d464'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''2239dca2-9dd4-5c3a-91c8-2585839b9584'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''SexualOrientationReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/business-rules.csv (business_rules)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''fc740f9e-863e-5dd1-b1a1-86d176cb549c'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/business-rules.csv'', ''business_rules'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''5f9ab8c7-65b5-5dd8-9e6b-1501c2a639a9'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''fc740f9e-863e-5dd1-b1a1-86d176cb549c'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''BusinessRulesReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE business_rules AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''fc740f9e-863e-5dd1-b1a1-86d176cb549c'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/business-rules.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Worksheet''), (''Field''), (''Required''), (''Permissible Values''), (''True Rejection''), (''Warning Layer''), (''Resolved by QE/QCS'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''business_rules'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''fc740f9e-863e-5dd1-b1a1-86d176cb549c'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in business_rules.'',\n           ''Ensure business_rules contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''939acb5c-0c8e-5d68-9797-9e37ecf7f0a1'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''fc740f9e-863e-5dd1-b1a1-86d176cb549c'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''BusinessRulesReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/race-reference.csv (race_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''f98a88dc-a929-5a9b-906a-277e62c93012'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/race-reference.csv'', ''race_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''48fd69a6-5ad7-5d32-aa35-f9c05860c3d3'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''f98a88dc-a929-5a9b-906a-277e62c93012'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''RaceReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE race_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''f98a88dc-a929-5a9b-906a-277e62c93012'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/race-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Concept Name''), (''Concept Code''), (''Hierarchical Code''), (''Race Category (Concept Name)''), (''Race Category (Concept Code)''), (''Hiearchical Code'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''race_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''f98a88dc-a929-5a9b-906a-277e62c93012'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in race_reference.'',\n           ''Ensure race_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''72451a16-9ba1-5038-a58a-c3aca50cfad6'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''f98a88dc-a929-5a9b-906a-277e62c93012'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''RaceReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ethnicity-reference.csv (ethnicity_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''b0cbca95-5c20-5b2b-b589-9e832c556bc6'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ethnicity-reference.csv'', ''ethnicity_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''d0ed9035-6320-5391-8d2e-509cdc185699'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''b0cbca95-5c20-5b2b-b589-9e832c556bc6'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''EthnicityReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ethnicity_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''b0cbca95-5c20-5b2b-b589-9e832c556bc6'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/ethnicity-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Concept Code''), (''Concept Name''), (''Hierarchical Code''), (''Ethnicity Group (Concept Name)''), (''Ethnicity Group (Concept Code)'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''ethnicity_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''b0cbca95-5c20-5b2b-b589-9e832c556bc6'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ethnicity_reference.'',\n           ''Ensure ethnicity_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''f517a0e3-a9aa-5e82-83d1-5ace996332f0'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''b0cbca95-5c20-5b2b-b589-9e832c556bc6'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''EthnicityReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/preferred-language-reference.csv (preferred_language_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''3469db42-0066-5f23-9ee4-2b857bf339a4'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/preferred-language-reference.csv'', ''preferred_language_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''d65cb030-fbbf-55e3-b848-18fd81a32679'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''3469db42-0066-5f23-9ee4-2b857bf339a4'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''PreferredLanguageReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE preferred_language_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''3469db42-0066-5f23-9ee4-2b857bf339a4'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/preferred-language-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''ISO 639-2 Code''), (''ISO 639-1 Code''), (''English name of Language''), (''French name of Language''), (''German name of Language'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''preferred_language_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''3469db42-0066-5f23-9ee4-2b857bf339a4'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in preferred_language_reference.'',\n           ''Ensure preferred_language_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''f1c1a13a-58bf-51c3-92e0-12f2056f8a68'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''3469db42-0066-5f23-9ee4-2b857bf339a4'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''PreferredLanguageReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sdoh-domain-reference.csv (sdoh_domain_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''f19d5ebb-ea63-5b1d-b1b1-758457a2da29'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sdoh-domain-reference.csv'', ''sdoh_domain_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''34308a17-4300-50d6-96bd-b34982aa25db'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''f19d5ebb-ea63-5b1d-b1b1-758457a2da29'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''SdohDomainReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE sdoh_domain_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''52c6a395-5d83-4051-bb7c-39036f26ab29'' as session_id, ''f19d5ebb-ea63-5b1d-b1b1-758457a2da29'' as session_entry_id\n    FROM read_csv_auto(''/home/alan/workspaces/github.com/alan-francis/1115-hub/src/ahc-hrsn-elt/reference-data/sdoh-domain-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Code''), (''Display''), (''Definition'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''sdoh_domain_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''f19d5ebb-ea63-5b1d-b1b1-758457a2da29'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in sdoh_domain_reference.'',\n           ''Ensure sdoh_domain_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''3204b0bd-3443-59e9-9b22-d1881b9c7797'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''f19d5ebb-ea63-5b1d-b1b1-758457a2da29'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''SdohDomainReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''screening_20240307''\n        AS table_name,\n        ''SCREENING'' AS table_name_suffix\n      UNION ALL\n      SELECT ''admin_demographics_20240307''\n        AS table_name,\n        ''DEMOGRAPHIC_DATA'' AS table_name_suffix\n      UNION ALL\n      SELECT ''qe_admin_data_20240307''\n        AS table_name,\n        ''QE_ADMIN_DATA'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''admin_demographics_20240307'' IN (\n      ''screening_20240307'',\n      ''admin_demographics_20240307'',\n      ''qe_admin_data_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''screening_20240307''\n        AS table_name,\n        ''SCREENING'' AS table_name_suffix\n      UNION ALL\n      SELECT ''admin_demographics_20240307''\n        AS table_name,\n        ''DEMOGRAPHIC_DATA'' AS table_name_suffix\n      UNION ALL\n      SELECT ''qe_admin_data_20240307''\n        AS table_name,\n        ''QE_ADMIN_DATA'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''qe_admin_data_20240307'' IN (\n      ''screening_20240307'',\n      ''admin_demographics_20240307'',\n      ''qe_admin_data_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''screening_20240307''\n        AS table_name,\n        ''SCREENING'' AS table_name_suffix\n      UNION ALL\n      SELECT ''admin_demographics_20240307''\n        AS table_name,\n        ''DEMOGRAPHIC_DATA'' AS table_name_suffix\n      UNION ALL\n      SELECT ''qe_admin_data_20240307''\n        AS table_name,\n        ''QE_ADMIN_DATA'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''screening_20240307'' IN (\n      ''screening_20240307'',\n      ''admin_demographics_20240307'',\n      ''qe_admin_data_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''screening_20240307''\n        AS table_name,\n        ''SCREENING'' AS table_name_suffix\n      UNION ALL\n      SELECT ''admin_demographics_20240307''\n        AS table_name,\n        ''DEMOGRAPHIC_DATA'' AS table_name_suffix\n      UNION ALL\n      SELECT ''qe_admin_data_20240307''\n        AS table_name,\n        ''QE_ADMIN_DATA'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''screening_status_code_reference'' IN (\n      ''screening_20240307'',\n      ''admin_demographics_20240307'',\n      ''qe_admin_data_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''1a152daa-273d-5411-88cf-84067822a8aa'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nSELECT osi.session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value, ingest_table_name FROM orch_session_issue osi LEFT JOIN orch_session_entry ose ON osi.session_entry_id = ose.orch_session_entry_id WHERE osi.session_id = ''52c6a395-5d83-4051-bb7c-39036f26ab29''\n```\nNo STDOUT emitted by `ingest` (status: `0`).\n\nNo STDERR emitted by `ingest`.\n\n    ', NULL);\nINSERT INTO \"orch_session_exec\" (\"orch_session_exec_id\", \"exec_nature\", \"session_id\", \"session_entry_id\", \"parent_exec_id\", \"namespace\", \"exec_identity\", \"exec_code\", \"exec_status\", \"input_text\", \"exec_error_text\", \"output_text\", \"output_nature\", \"narrative_md\", \"elaboration\") VALUES ('35df2d8c-7b46-52f7-b53e-aacbad11754e', 'duckdb', '52c6a395-5d83-4051-bb7c-39036f26ab29', NULL, NULL, NULL, 'ensureContent', 'duckdb HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.workflow/ingestion-center.duckdb', 0, '-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''630f992f-2d33-5d0b-9855-29fdb84f62ee'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''AdminDemographicCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''FIRST_NAME'' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"FIRST_NAME\" IS NULL\n        OR TRIM(CAST(\"FIRST_NAME\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''FIRST_NAME'' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"FIRST_NAME\" AS VARCHAR) NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT ''MIDDLE_NAME'' AS issue_column,\n           \"MIDDLE_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"MIDDLE_NAME\" AS VARCHAR) NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''LAST_NAME'' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"LAST_NAME\" IS NULL\n        OR TRIM(CAST(\"LAST_NAME\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''LAST_NAME'' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"LAST_NAME\" AS VARCHAR) NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''ADMINISTRATIVE_SEX_CODE'' AS issue_column,\n           \"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"ADMINISTRATIVE_SEX_CODE\" IS NULL\n        OR TRIM(CAST(\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''ADMINISTRATIVE_SEX_CODE_SYSTEM'' AS issue_column,\n           \"ADMINISTRATIVE_SEX_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"ADMINISTRATIVE_SEX_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"ADMINISTRATIVE_SEX_CODE_SYSTEM\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_administrative_sex_code_in_all_rows AS (\n    SELECT ''ADMINISTRATIVE_SEX_CODE'' AS issue_column,\n           sr.\"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN administrative_sex_reference ref\n      ON UPPER(sr.\"ADMINISTRATIVE_SEX_CODE\") = UPPER(ref.ADMINISTRATIVE_SEX_CODE)\n     WHERE sr.\"ADMINISTRATIVE_SEX_CODE\" IS NOT NULL\n      AND ref.ADMINISTRATIVE_SEX_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid ADMINISTRATIVE SEX CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ADMINISTRATIVE SEX CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ADMINISTRATIVE SEX CODE with administrative sex reference data''\n      FROM valid_administrative_sex_code_in_all_rows;\nWITH valid_administrative_sex_code_description_in_all_rows AS (\n    SELECT ''ADMINISTRATIVE_SEX_CODE_DESCRIPTION'' AS issue_column,\n           sr.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN administrative_sex_reference ref\n      ON UPPER(sr.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\") = UPPER(ref.ADMINISTRATIVE_SEX_CODE_DESCRIPTION)\n     WHERE sr.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" IS NOT NULL\n      AND ref.ADMINISTRATIVE_SEX_CODE_DESCRIPTION IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid ADMINISTRATIVE SEX CODE DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ADMINISTRATIVE SEX CODE DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ADMINISTRATIVE SEX CODE DESCRIPTION with administrative sex reference data''\n      FROM valid_administrative_sex_code_description_in_all_rows;\nWITH valid_administrative_sex_code_system_in_all_rows AS (\n    SELECT ''ADMINISTRATIVE_SEX_CODE_SYSTEM'' AS issue_column,\n           sr.\"ADMINISTRATIVE_SEX_CODE_SYSTEM\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN administrative_sex_reference ref\n      ON UPPER(sr.\"ADMINISTRATIVE_SEX_CODE_SYSTEM\") = UPPER(ref.ADMINISTRATIVE_SEX_CODE_SYSTEM)\n     WHERE sr.\"ADMINISTRATIVE_SEX_CODE_SYSTEM\" IS NOT NULL\n      AND ref.ADMINISTRATIVE_SEX_CODE_SYSTEM IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid ADMINISTRATIVE SEX CODE SYSTEM'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ADMINISTRATIVE SEX CODE SYSTEM \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ADMINISTRATIVE SEX CODE SYSTEM with administrative sex reference data''\n      FROM valid_administrative_sex_code_system_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ADMINISTRATIVE_SEX_CODE'' AS issue_column,\n      tbl.\"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n      tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"ADMINISTRATIVE_SEX_CODE\" is not null\n  and tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" FROM administrative_sex_reference WHERE UPPER(CAST(tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)) = UPPER(CAST(\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ADMINISTRATIVE_SEX_CODE \"'' || invalid_value || ''\" of ADMINISTRATIVE_SEX_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the ADMINISTRATIVE_SEX_CODE of ADMINISTRATIVE_SEX_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ADMINISTRATIVE_SEX_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ADMINISTRATIVE_SEX_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" is not null\n  and tbl.\"ADMINISTRATIVE_SEX_CODE\" is not null\n  and NOT EXISTS ( SELECT \"ADMINISTRATIVE_SEX_CODE\" FROM administrative_sex_reference WHERE UPPER(CAST(tbl.\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)) = UPPER(CAST(\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ADMINISTRATIVE_SEX_CODE_DESCRIPTION \"'' || invalid_value || ''\" of ADMINISTRATIVE_SEX_CODE \"'' || dependent_value || ''\" is not matching with the ADMINISTRATIVE_SEX_CODE_DESCRIPTION of ADMINISTRATIVE_SEX_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_sex_at_birth_code_in_all_rows AS (\n    SELECT ''SEX_AT_BIRTH_CODE'' AS issue_column,\n           sr.\"SEX_AT_BIRTH_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sex_at_birth_reference ref\n      ON UPPER(sr.SEX_AT_BIRTH_CODE) = UPPER(ref.SEX_AT_BIRTH_CODE)\n     WHERE sr.SEX_AT_BIRTH_CODE IS NOT NULL\n      AND ref.SEX_AT_BIRTH_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid SEX AT BIRTH CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid SEX AT BIRTH CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate SEX AT BIRTH CODE with sex at birth reference data''\n      FROM valid_sex_at_birth_code_in_all_rows;\nWITH valid_sex_at_birth_code_description_in_all_rows AS (\n    SELECT ''SEX_AT_BIRTH_CODE_DESCRIPTION'' AS issue_column,\n           sr.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sex_at_birth_reference ref\n      ON UPPER(sr.SEX_AT_BIRTH_CODE_DESCRIPTION) = UPPER(ref.SEX_AT_BIRTH_CODE_DESCRIPTION)\n     WHERE sr.SEX_AT_BIRTH_CODE_DESCRIPTION IS NOT NULL\n      AND ref.SEX_AT_BIRTH_CODE_DESCRIPTION IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid SEX_AT_BIRTH_CODE_DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid SEX_AT_BIRTH_CODE_DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate SEX_AT_BIRTH_CODE_DESCRIPTION with sex at birth reference data''\n      FROM valid_sex_at_birth_code_description_in_all_rows;\nWITH valid_sex_at_birth_code_system_in_all_rows AS (\n    SELECT ''SEX_AT_BIRTH_CODE_SYSTEM'' AS issue_column,\n           sr.\"SEX_AT_BIRTH_CODE_SYSTEM\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sex_at_birth_reference ref\n      ON UPPER(sr.SEX_AT_BIRTH_CODE_SYSTEM) = UPPER(ref.SEX_AT_BIRTH_CODE_SYSTEM)\n     WHERE sr.SEX_AT_BIRTH_CODE_SYSTEM IS NOT NULL\n      AND ref.SEX_AT_BIRTH_CODE_SYSTEM IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid SEX AT BIRTH CODE SYSTEM'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid SEX AT BIRTH CODE SYSTEM \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate SEX AT BIRTH CODE SYSTEM with sex at birth reference data''\n      FROM valid_sex_at_birth_code_system_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''SEX_AT_BIRTH_CODE'' AS issue_column,\n      tbl.\"SEX_AT_BIRTH_CODE\" AS invalid_value,\n      tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"SEX_AT_BIRTH_CODE\" is not null\n  and tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"SEX_AT_BIRTH_CODE_DESCRIPTION\" FROM sex_at_birth_reference WHERE UPPER(CAST(tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SEX_AT_BIRTH_CODE\" AS VARCHAR)) = UPPER(CAST(\"SEX_AT_BIRTH_CODE\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The SEX_AT_BIRTH_CODE \"'' || invalid_value || ''\" of SEX_AT_BIRTH_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the SEX_AT_BIRTH_CODE of SEX_AT_BIRTH_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''SEX_AT_BIRTH_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"SEX_AT_BIRTH_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" is not null\n  and tbl.\"SEX_AT_BIRTH_CODE\" is not null\n  and NOT EXISTS ( SELECT \"SEX_AT_BIRTH_CODE\" FROM sex_at_birth_reference WHERE UPPER(CAST(tbl.\"SEX_AT_BIRTH_CODE\" AS VARCHAR)) = UPPER(CAST(\"SEX_AT_BIRTH_CODE\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The SEX_AT_BIRTH_CODE_DESCRIPTION \"'' || invalid_value || ''\" of SEX_AT_BIRTH_CODE \"'' || dependent_value || ''\" is not matching with the SEX_AT_BIRTH_CODE_DESCRIPTION of SEX_AT_BIRTH_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''PAT_BIRTH_DATE'' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"PAT_BIRTH_DATE\" IS NULL\n        OR TRIM(CAST(\"PAT_BIRTH_DATE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_date_time_in_all_rows AS (\n    SELECT ''PAT_BIRTH_DATE'' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"PAT_BIRTH_DATE\" IS NOT NULL\n       AND TRY_CAST(\"PAT_BIRTH_DATE\" AS TIMESTAMP) IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Date'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid timestamp \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Please be sure to provide both a valid date and time.''\n      FROM valid_date_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''CITY'' AS issue_column,\n           \"CITY\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"CITY\" IS NULL\n        OR TRIM(CAST(\"CITY\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''STATE'' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"STATE\" IS NULL\n        OR TRIM(CAST(\"STATE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''STATE'' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"STATE\" NOT IN (''NY'', ''New York'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''NY'''', ''''New York'''')'',\n           ''Use only allowed values ''''NY'''', ''''New York'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''ZIP'' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"ZIP\" IS NULL\n        OR TRIM(CAST(\"ZIP\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''ZIP'' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"ZIP\" AS VARCHAR) NOT SIMILAR TO ''^\\d{5}(\\d{4})?$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^\\d{5}(\\d{4})?$'',\n           ''Follow the pattern ^\\d{5}(\\d{4})?$ in '' || issue_column\n      FROM pattern;\nWITH valid_integer_alphanumeric_string_in_all_rows AS (\n  SELECT ''ADDRESS1'' AS issue_column,\n    t.\"ADDRESS1\" AS invalid_value,\n    t.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307 t\n  WHERE t.\"ADDRESS1\" SIMILAR TO ''[0-9]+''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Data Type Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Invalid string of numbers found''\n      FROM valid_integer_alphanumeric_string_in_all_rows;\nWITH valid_address1_or_medicaid_cin_in_all_rows AS (\n    SELECT ''ADDRESS1'' AS issue_column,\n           ADDRESS1 AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM admin_demographics_20240307\n      WHERE (ADDRESS1 IS NULL OR TRIM(\"ADDRESS1\") = '''') AND (MEDICAID_CIN IS NULL OR TRIM(\"MEDICAID_CIN\") = '''')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid ADDRESS1'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value ADDRESS1 is missing. This is required due to the absence of the MEDICAID_CIN.''\n      FROM valid_address1_or_medicaid_cin_in_all_rows;\nWITH valid_gender_identity_code_in_all_rows AS (\n    SELECT ''GENDER_IDENTITY_CODE'' AS issue_column,\n           sr.\"GENDER_IDENTITY_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN gender_identity_reference ref\n      ON UPPER(sr.GENDER_IDENTITY_CODE) = UPPER(ref.GENDER_IDENTITY_CODE)\n     WHERE sr.GENDER_IDENTITY_CODE IS NOT NULL\n      AND ref.GENDER_IDENTITY_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid GENDER IDENTITY CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid GENDER IDENTITY CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate GENDER IDENTITY CODE with gender identity reference data''\n      FROM valid_gender_identity_code_in_all_rows;\nWITH allowed_values AS (\n    SELECT ''GENDER_IDENTITY_CODE_SYSTEM_NAME'' AS issue_column,\n           \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" NOT IN (''SNOMED-CT'',''SNOMED'',''http://snomed.info/sct'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''SNOMED-CT'''',''''SNOMED'''',''''http://snomed.info/sct'''')'',\n           ''Use only allowed values ''''SNOMED-CT'''',''''SNOMED'''',''''http://snomed.info/sct'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''GENDER_IDENTITY_CODE'' AS issue_column,\n      tbl.\"GENDER_IDENTITY_CODE\" AS invalid_value,\n      tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"GENDER_IDENTITY_CODE\" is not null\n  and tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"GENDER_IDENTITY_CODE_DESCRIPTION\" FROM gender_identity_reference WHERE UPPER(CAST(tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS VARCHAR)) AND UPPER(CAST(tbl.\"GENDER_IDENTITY_CODE\" AS VARCHAR)) = UPPER(CAST(\"GENDER_IDENTITY_CODE\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The GENDER_IDENTITY_CODE \"'' || invalid_value || ''\" of GENDER_IDENTITY_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the GENDER_IDENTITY_CODE of GENDER_IDENTITY_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''GENDER_IDENTITY_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"GENDER_IDENTITY_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" is not null\n  and tbl.\"GENDER_IDENTITY_CODE\" is not null\n  and NOT EXISTS ( SELECT \"GENDER_IDENTITY_CODE\" FROM gender_identity_reference WHERE UPPER(CAST(tbl.\"GENDER_IDENTITY_CODE\" AS VARCHAR)) = UPPER(CAST(\"GENDER_IDENTITY_CODE\" AS VARCHAR)) AND UPPER(CAST(tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The GENDER_IDENTITY_CODE_DESCRIPTION \"'' || invalid_value || ''\" of GENDER_IDENTITY_CODE \"'' || dependent_value || ''\" is not matching with the GENDER_IDENTITY_CODE_DESCRIPTION of GENDER_IDENTITY_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_sexual_orientation_code_in_all_rows AS (\n    SELECT ''SEXUAL_ORIENTATION_CODE'' AS issue_column,\n           sr.\"SEXUAL_ORIENTATION_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sexual_orientation_reference ref\n      ON UPPER(sr.SEXUAL_ORIENTATION_CODE) = UPPER(ref.SEXUAL_ORIENTATION_CODE)\n     WHERE sr.SEXUAL_ORIENTATION_CODE IS NOT NULL\n      AND ref.SEXUAL_ORIENTATION_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid SEXUAL ORIENTATION CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid SEXUAL ORIENTATION CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate SEXUAL ORIENTATION CODE with sexual orientation reference data''\n      FROM valid_sexual_orientation_code_in_all_rows;\nWITH valid_sexual_orientation_description_in_all_rows AS (\n    SELECT ''SEXUAL_ORIENTATION_DESCRIPTION'' AS issue_column,\n           sr.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sexual_orientation_reference ref\n      ON UPPER(sr.SEXUAL_ORIENTATION_DESCRIPTION) = UPPER(ref.SEXUAL_ORIENTATION_CODE_DESCRIPTION)\n     WHERE sr.SEXUAL_ORIENTATION_DESCRIPTION IS NOT NULL\n      AND ref.SEXUAL_ORIENTATION_CODE_DESCRIPTION IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid SEXUAL ORIENTATION CODE DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid SEXUAL ORIENTATION CODE DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate SEXUAL ORIENTATION CODE DESCRIPTION with sexual orientation reference data''\n      FROM valid_sexual_orientation_description_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''SEXUAL_ORIENTATION_CODE'' AS issue_column,\n      tbl.\"SEXUAL_ORIENTATION_CODE\" AS invalid_value,\n      tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"SEXUAL_ORIENTATION_CODE\" is not null\n  and tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"SEXUAL_ORIENTATION_CODE_DESCRIPTION\" FROM sexual_orientation_reference WHERE UPPER(CAST(tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"SEXUAL_ORIENTATION_CODE_DESCRIPTION\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SEXUAL_ORIENTATION_CODE\" AS VARCHAR)) = UPPER(CAST(\"SEXUAL_ORIENTATION_CODE\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The SEXUAL_ORIENTATION_CODE \"'' || invalid_value || ''\" of SEXUAL_ORIENTATION_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the SEXUAL_ORIENTATION_CODE of SEXUAL_ORIENTATION_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''SEXUAL_ORIENTATION_DESCRIPTION'' AS issue_column,\n      tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS invalid_value,\n      tbl.\"SEXUAL_ORIENTATION_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" is not null\n  and tbl.\"SEXUAL_ORIENTATION_CODE\" is not null\n  and NOT EXISTS ( SELECT \"SEXUAL_ORIENTATION_CODE\" FROM sexual_orientation_reference WHERE UPPER(CAST(tbl.\"SEXUAL_ORIENTATION_CODE\" AS VARCHAR)) = UPPER(CAST(\"SEXUAL_ORIENTATION_CODE\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"SEXUAL_ORIENTATION_CODE_DESCRIPTION\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The SEXUAL_ORIENTATION_DESCRIPTION \"'' || invalid_value || ''\" of SEXUAL_ORIENTATION_CODE \"'' || dependent_value || ''\" is not matching with the SEXUAL_ORIENTATION_DESCRIPTION of SEXUAL_ORIENTATION_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH allowed_values AS (\n    SELECT ''SEXUAL_ORIENTATION_CODE_SYSTEM_NAME'' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" NOT IN (''SNOMED-CT'',''SNOMED'',''http://snomed.info/sct'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''SNOMED-CT'''',''''SNOMED'''',''''http://snomed.info/sct'''')'',\n           ''Use only allowed values ''''SNOMED-CT'''',''''SNOMED'''',''''http://snomed.info/sct'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_ethnicity_code_in_all_rows AS (\n    SELECT ''ETHNICITY_CODE'' AS issue_column,\n           ad.\"ETHNICITY_CODE\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN ethnicity_reference ref\n      ON UPPER(CAST(ad.\"ETHNICITY_CODE\" AS VARCHAR)) = UPPER(CAST(ref.\"Concept Code\" AS VARCHAR))\n     WHERE ad.\"ETHNICITY_CODE\" IS NOT NULL\n      AND ref.\"Concept Code\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid ETHNICITY CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ETHNICITY CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ETHNICITY CODE with ethnicity reference data''\n      FROM valid_ethnicity_code_in_all_rows;\nWITH valid_ethnicity_code_description_in_all_rows AS (\n    SELECT ''ETHNICITY_CODE_DESCRIPTION'' AS issue_column,\n           ad.\"ETHNICITY_CODE_DESCRIPTION\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN ethnicity_reference ref\n      ON UPPER(CAST(ad.\"ETHNICITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(ref.\"Concept Name\" AS VARCHAR))\n     WHERE ad.\"ETHNICITY_CODE_DESCRIPTION\" IS NOT NULL\n      AND ref.\"Concept Name\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid ETHNICITY CODE DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ETHNICITY CODE DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ETHNICITY CODE DESCRIPTION with ethnicity reference data''\n      FROM valid_ethnicity_code_description_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ETHNICITY_CODE'' AS issue_column,\n      tbl.\"ETHNICITY_CODE\" AS invalid_value,\n      tbl.\"ETHNICITY_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"ETHNICITY_CODE\" is not null\n  and tbl.\"ETHNICITY_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Concept Name\" FROM ethnicity_reference WHERE UPPER(CAST(tbl.\"ETHNICITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Concept Name\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ETHNICITY_CODE\" AS VARCHAR)) = UPPER(CAST(\"Concept Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ETHNICITY_CODE \"'' || invalid_value || ''\" of ETHNICITY_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the ETHNICITY_CODE of ETHNICITY_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ETHNICITY_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"ETHNICITY_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ETHNICITY_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"ETHNICITY_CODE_DESCRIPTION\" is not null\n  and tbl.\"ETHNICITY_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Concept Code\" FROM ethnicity_reference WHERE UPPER(CAST(tbl.\"ETHNICITY_CODE\" AS VARCHAR)) = UPPER(CAST(\"Concept Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ETHNICITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Concept Name\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ETHNICITY_CODE_DESCRIPTION \"'' || invalid_value || ''\" of ETHNICITY_CODE \"'' || dependent_value || ''\" is not matching with the ETHNICITY_CODE_DESCRIPTION of ETHNICITY_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_race_code_in_all_rows AS (\n    SELECT ''RACE_CODE'' AS issue_column,\n           ad.\"RACE_CODE\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN race_reference ref\n      ON UPPER(CAST(ad.\"RACE_CODE\" AS VARCHAR)) = UPPER(CAST(ref.\"Concept Code\" AS VARCHAR))\n     WHERE ad.\"RACE_CODE\" IS NOT NULL\n      AND ref.\"Concept Code\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid RACE CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid RACE CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate RACE CODE with race reference data''\n      FROM valid_race_code_in_all_rows;\nWITH valid_race_code_description_in_all_rows AS (\n    SELECT ''RACE_CODE_DESCRIPTION'' AS issue_column,\n           ad.\"RACE_CODE_DESCRIPTION\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN race_reference ref\n      ON UPPER(CAST(ad.\"RACE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(ref.\"Concept Name\" AS VARCHAR))\n     WHERE ad.\"RACE_CODE_DESCRIPTION\" IS NOT NULL\n      AND ref.\"Concept Name\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid RACE CODE DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid RACE CODE DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate RACE CODE DESCRIPTION with race reference data''\n      FROM valid_race_code_description_in_all_rows;\nWITH valid_preferred_language_code_in_all_rows AS (\n    SELECT ''PREFERRED_LANGUAGE_CODE'' AS issue_column,\n           ad.\"PREFERRED_LANGUAGE_CODE\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN preferred_language_reference ref\n      ON UPPER(CAST(ad.\"PREFERRED_LANGUAGE_CODE\" AS VARCHAR)) = UPPER(CAST(ref.\"ISO 639-2 Code\" AS VARCHAR))\n     WHERE ad.\"PREFERRED_LANGUAGE_CODE\" IS NOT NULL\n      AND ref.\"ISO 639-2 Code\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid PREFERRED LANGUAGE CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid PREFERRED LANGUAGE CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate PREFERRED LANGUAGE CODE with preferred language reference data''\n      FROM valid_preferred_language_code_in_all_rows;\nWITH valid_preferred_language_code_description_in_all_rows AS (\n    SELECT ''PREFERRED_LANGUAGE_DESCRIPTION'' AS issue_column,\n           ad.\"PREFERRED_LANGUAGE_DESCRIPTION\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN preferred_language_reference ref\n      ON UPPER(CAST(ad.\"PREFERRED_LANGUAGE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(ref.\"English name of Language\" AS VARCHAR))\n     WHERE ad.\"PREFERRED_LANGUAGE_DESCRIPTION\" IS NOT NULL\n      AND ref.\"English name of Language\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid PREFERRED LANGUAGE CODE DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid PREFERRED LANGUAGE CODE DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate PREFERRED LANGUAGE CODE DESCRIPTION with preferred language reference data''\n      FROM valid_preferred_language_code_description_in_all_rows;\nWITH allowed_values AS (\n    SELECT ''PREFERRED_LANGUAGE_CODE_SYSTEM_NAME'' AS issue_column,\n           \"PREFERRED_LANGUAGE_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"PREFERRED_LANGUAGE_CODE_SYSTEM_NAME\" NOT IN (''ISO'',''ISO 639-2'',''http://hl7.org/fhir/us/core/ValueSet/simple-language'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''ISO'''',''''ISO 639-2'''',''''http://hl7.org/fhir/us/core/ValueSet/simple-language'''')'',\n           ''Use only allowed values ''''ISO'''',''''ISO 639-2'''',''''http://hl7.org/fhir/us/core/ValueSet/simple-language'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''RACE_CODE'' AS issue_column,\n      tbl.\"RACE_CODE\" AS invalid_value,\n      tbl.\"RACE_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"RACE_CODE\" is not null\n  and tbl.\"RACE_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Concept Name\" FROM race_reference WHERE UPPER(CAST(tbl.\"RACE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Concept Name\" AS VARCHAR)) AND UPPER(CAST(tbl.\"RACE_CODE\" AS VARCHAR)) = UPPER(CAST(\"Concept Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The RACE_CODE \"'' || invalid_value || ''\" of RACE_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the RACE_CODE of RACE_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''PREFERRED_LANGUAGE_CODE'' AS issue_column,\n      tbl.\"PREFERRED_LANGUAGE_CODE\" AS invalid_value,\n      tbl.\"PREFERRED_LANGUAGE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"PREFERRED_LANGUAGE_CODE\" is not null\n  and tbl.\"PREFERRED_LANGUAGE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"English name of Language\" FROM preferred_language_reference WHERE UPPER(CAST(tbl.\"PREFERRED_LANGUAGE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"English name of Language\" AS VARCHAR)) AND UPPER(CAST(tbl.\"PREFERRED_LANGUAGE_CODE\" AS VARCHAR)) = UPPER(CAST(\"ISO 639-2 Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The PREFERRED_LANGUAGE_CODE \"'' || invalid_value || ''\" of PREFERRED_LANGUAGE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the PREFERRED_LANGUAGE_CODE of PREFERRED_LANGUAGE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''RACE_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"RACE_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"RACE_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"RACE_CODE_DESCRIPTION\" is not null\n  and tbl.\"RACE_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Concept Code\" FROM race_reference WHERE UPPER(CAST(tbl.\"RACE_CODE\" AS VARCHAR)) = UPPER(CAST(\"Concept Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"RACE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Concept Name\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The RACE_CODE_DESCRIPTION \"'' || invalid_value || ''\" of RACE_CODE \"'' || dependent_value || ''\" is not matching with the RACE_CODE_DESCRIPTION of RACE_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH allowed_values AS (\n    SELECT ''RACE_CODE_SYSTEM_NAME'' AS issue_column,\n           \"RACE_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"RACE_CODE_SYSTEM_NAME\" NOT IN (''CDC'',''CDCRE'',''urn:oid:2.16.840.1.113883.6.238'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''CDC'''',''''CDCRE'''',''''urn:oid:2.16.840.1.113883.6.238'''')'',\n           ''Use only allowed values ''''CDC'''',''''CDCRE'''',''''urn:oid:2.16.840.1.113883.6.238'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''ETHNICITY_CODE_SYSTEM_NAME'' AS issue_column,\n           \"ETHNICITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"ETHNICITY_CODE_SYSTEM_NAME\" NOT IN (''CDC'',''CDCRE'',''urn:oid:2.16.840.1.113883.6.238'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''CDC'''',''''CDCRE'''',''''urn:oid:2.16.840.1.113883.6.238'''')'',\n           ''Use only allowed values ''''CDC'''',''''CDCRE'''',''''urn:oid:2.16.840.1.113883.6.238'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''MPI_ID'' AS issue_column,\n           \"MPI_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"MPI_ID\" IS NULL\n        OR TRIM(CAST(\"MPI_ID\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(CAST(\"PAT_MRN_ID\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_mpi_id_per_pat_mrn_id_in_all_rows AS (\n    SELECT ''MPI_ID'' AS issue_column,\n      MPI_ID AS invalid_value,\n      min(src_file_row_number) AS issue_row\n    FROM admin_demographics_20240307\n    GROUP BY MPI_ID\n    HAVING COUNT(DISTINCT PAT_MRN_ID) > 1\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid MPI_ID'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''The unique field \"'' || issue_column || ''\" \"'' || invalid_value || ''\"is not unique per PAT MRN ID'',\n           ''MPI_ID is not unique per PAT MRN ID.''\n      FROM valid_mpi_id_per_pat_mrn_id_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_ID'' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ID\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''MEDICAID_CIN'' AS issue_column,\n           \"MEDICAID_CIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"MEDICAID_CIN\" AS VARCHAR) NOT SIMILAR TO ''^[A-Za-z]{2}\\d{5}[A-Za-z]$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$'',\n           ''Follow the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$ in '' || issue_column\n      FROM pattern;\nWITH valid_unique_medicaid_cin_per_mrn_in_all_rows AS (\n  SELECT ''MEDICAID_CIN'' AS issue_column,\n          \"MEDICAID_CIN\" AS invalid_value,\n          min(src_file_row_number) AS issue_row\n    FROM admin_demographics_20240307\n    WHERE MEDICAID_CIN IS NOT NULL\n    GROUP BY pat_mrn_id, MEDICAID_CIN\n    HAVING COUNT(*) > 1\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Unique Medicaid Cin Per Mrn'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid Unique Medicaid Cin Per Mrn \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate Unique Medicaid Cin Per Mrn''\n      FROM valid_unique_medicaid_cin_per_mrn_in_all_rows;\nWITH valid_address1_or_medicaid_cin_in_all_rows AS (\n    SELECT ''MEDICAID_CIN'' AS issue_column,\n           MEDICAID_CIN AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM admin_demographics_20240307\n      WHERE (MEDICAID_CIN IS NULL OR TRIM(\"MEDICAID_CIN\") = '''') AND (ADDRESS1 IS NULL OR TRIM(\"ADDRESS1\") = '''')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid MEDICAID_CIN'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value MEDICAID_CIN is missing. This is required due to the absence of the ADDRESS1.''\n      FROM valid_address1_or_medicaid_cin_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''CONSENT'' AS issue_column,\n           \"CONSENT\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"CONSENT\" IS NULL\n        OR TRIM(CAST(\"CONSENT\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''CONSENT'' AS issue_column,\n           \"CONSENT\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"CONSENT\" NOT IN (''Yes'', ''YES'', ''yes'', ''Y'', ''y'', ''No'', ''NO'', ''no'',''N'', ''n'',''Unknown'', ''UNKNOWN'', ''unknown'',''UNK'', ''Unk'', ''unk'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''YES'''', ''''yes'''', ''''Y'''', ''''y'''', ''''No'''', ''''NO'''', ''''no'''',''''N'''', ''''n'''',''''Unknown'''', ''''UNKNOWN'''', ''''unknown'''',''''UNK'''', ''''Unk'''', ''''unk'''')'',\n           ''Use only allowed values ''''Yes'''', ''''YES'''', ''''yes'''', ''''Y'''', ''''y'''', ''''No'''', ''''NO'''', ''''no'''',''''N'''', ''''n'''',''''Unknown'''', ''''UNKNOWN'''', ''''unknown'''',''''UNK'''', ''''Unk'''', ''''unk'''' in '' || issue_column\n      FROM allowed_values;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''87f8bee3-8c83-518e-865a-740b0e3a45d3'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''AdminDemographicCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''f6f5cc47-43d2-5134-b3d4-e6d954f3e391'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''767cb8df-3ec0-5b59-998e-a91e75be32b3'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''QeAdminDataCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(CAST(\"PAT_MRN_ID\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_ID'' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ID\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_unique_facility_id_per_facility_in_all_rows AS (\n  SELECT ''FACILITY_ID'' AS issue_column,\n    FACILITY_ID AS invalid_value,\n    min(src_file_row_number) AS issue_row\n  FROM qe_admin_data_20240307\n  GROUP BY FACILITY_ID\n  HAVING COUNT(DISTINCT FACILITY_LONG_NAME) > 1\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Invalid FACILITY_ID'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''The unique field \"'' || issue_column || ''\" \"'' || invalid_value || ''\"is not unique per facility'',\n           ''FACILITY_ID is not unique per facility.''\n      FROM valid_unique_facility_id_per_facility_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_LONG_NAME'' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_LONG_NAME\" IS NULL\n        OR TRIM(CAST(\"FACILITY_LONG_NAME\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''ORGANIZATION_TYPE'' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"ORGANIZATION_TYPE\" IS NULL\n        OR TRIM(CAST(\"ORGANIZATION_TYPE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''ORGANIZATION_TYPE'' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"ORGANIZATION_TYPE\" NOT IN (''Hospital'', ''DTC'', ''SNF'', ''SCN'', ''CBO'', ''OMH'', ''OASAS'', ''Practice'', ''Article 36'', ''Article 40'', ''MCO'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Hospital'''', ''''DTC'''', ''''SNF'''', ''''SCN'''', ''''CBO'''', ''''OMH'''', ''''OASAS'''', ''''Practice'''', ''''Article 36'''', ''''Article 40'''', ''''MCO'''')'',\n           ''Use only allowed values ''''Hospital'''', ''''DTC'''', ''''SNF'''', ''''SCN'''', ''''CBO'''', ''''OMH'''', ''''OASAS'''', ''''Practice'''', ''''Article 36'''', ''''Article 40'''', ''''MCO'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_ADDRESS1'' AS issue_column,\n           \"FACILITY_ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_ADDRESS1\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ADDRESS1\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_unique_facility_address1_per_facility_in_all_rows AS (\n  SELECT ''FACILITY_ADDRESS1'' AS issue_column,\n    FACILITY_ADDRESS1 AS invalid_value,\n    min(src_file_row_number) AS issue_row\n  FROM qe_admin_data_20240307\n  GROUP BY FACILITY_ADDRESS1\n  HAVING COUNT(DISTINCT FACILITY_LONG_NAME) > 1\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Invalid FACILITY_ADDRESS1'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''The unique field \"'' || issue_column || ''\" \"'' || invalid_value || ''\"is not unique per facility'',\n           ''FACILITY_ADDRESS1 is not unique per facility.''\n      FROM valid_unique_facility_address1_per_facility_in_all_rows;\nWITH valid_integer_alphanumeric_string_in_all_rows AS (\n  SELECT ''FACILITY_ADDRESS1'' AS issue_column,\n    t.\"FACILITY_ADDRESS1\" AS invalid_value,\n    t.src_file_row_number AS issue_row\n  FROM qe_admin_data_20240307 t\n  WHERE t.\"FACILITY_ADDRESS1\" SIMILAR TO ''[0-9]+''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Data Type Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Invalid string of numbers found''\n      FROM valid_integer_alphanumeric_string_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_STATE'' AS issue_column,\n           \"FACILITY_STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_STATE\" IS NULL\n        OR TRIM(CAST(\"FACILITY_STATE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''FACILITY_STATE'' AS issue_column,\n           \"FACILITY_STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_STATE\" NOT IN (''NY'', ''New York'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''NY'''', ''''New York'''')'',\n           ''Use only allowed values ''''NY'''', ''''New York'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_ZIP'' AS issue_column,\n           \"FACILITY_ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_ZIP\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ZIP\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''FACILITY_ZIP'' AS issue_column,\n           \"FACILITY_ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE CAST(\"FACILITY_ZIP\" AS VARCHAR) NOT SIMILAR TO ''^\\d{5}(\\d{4})?$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^\\d{5}(\\d{4})?$'',\n           ''Follow the pattern ^\\d{5}(\\d{4})?$ in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''VISIT_PART_2_FLAG'' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_PART_2_FLAG\" IS NULL\n        OR TRIM(CAST(\"VISIT_PART_2_FLAG\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_PART_2_FLAG'' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_PART_2_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_OMH_FLAG'' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_OMH_FLAG\" IS NULL\n        OR TRIM(CAST(\"VISIT_OMH_FLAG\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_OMH_FLAG'' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_OMH_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_OPWDD_FLAG'' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_OPWDD_FLAG\" IS NULL\n        OR TRIM(CAST(\"VISIT_OPWDD_FLAG\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_OPWDD_FLAG'' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_OPWDD_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH pattern AS (\n    SELECT ''FACILITY_LONG_NAME'' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE CAST(\"FACILITY_LONG_NAME\" AS VARCHAR) NOT SIMILAR TO ''^[a-zA-Z\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z\\s]+$ in '' || issue_column\n      FROM pattern;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7115f76c-32eb-563c-a1d5-040d0146651a'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''767cb8df-3ec0-5b59-998e-a91e75be32b3'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''QeAdminDataCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''26a2e6f5-6b62-5616-8b14-1059006f438b'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''ScreeningCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n\nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(CAST(\"PAT_MRN_ID\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_ID'' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ID\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_pat_mrn_id_across_all_three_tables AS (\n  WITH cte_qe_demographic_unmatched AS (\n      SELECT DISTINCT COALESCE(ad.PAT_MRN_ID, qe.PAT_MRN_ID) AS PAT_MRN_ID,\n              COALESCE(ad.FACILITY_ID, qe.FACILITY_ID) AS FACILITY_ID,\n                    CASE\n                        WHEN ad.PAT_MRN_ID IS NULL THEN ''QE_ADMIN_DATA''\n                        ELSE ''ADMIN_DEMOGRAPHIC''\n                    END AS unmatched_source,\n                    COALESCE(ad.src_file_row_number, qe.src_file_row_number) AS src_file_row_number,\n      FROM  admin_demographics_20240307 ad\n      FULL OUTER JOIN qe_admin_data_20240307 qe\n          ON ad.PAT_MRN_ID = qe.PAT_MRN_ID\n          AND ad.FACILITY_ID = qe.FACILITY_ID\n      WHERE ad.PAT_MRN_ID IS NULL OR qe.PAT_MRN_ID IS NULL\n  )\n  Select ''PAT_MRN_ID'' AS issue_column, pat_mrn_id AS invalid_pat_value, FACILITY_ID AS invalid_facility_value, unmatched_source, src_file_row_number  AS issue_row,\n  case when unmatched_source = ''ADMIN_DEMOGRAPHIC'' then ''admin_demographics_20240307''\n  when unmatched_source = ''QE_ADMIN_DATA'' then ''qe_admin_data_20240307''\n  Else '''' End As issue_table_name\n  from cte_qe_demographic_unmatched\n  UNION\n  Select DISTINCT ''PAT_MRN_ID'' AS issue_column, s.PAT_MRN_ID AS invalid_pat_value,s.FACILITY_ID AS invalid_facility_value,''SCREENING'' As unmatched_source, src_file_row_number  AS issue_row,\n  ''screening_20240307'' as issue_table_name\n  FROM screening_20240307 s\n    Left Outer Join (\n      SELECT  DISTINCT a.PAT_MRN_ID,a.FACILITY_ID From admin_demographics_20240307 a\n      Inner Join qe_admin_data_20240307 q\n      ON a.PAT_MRN_ID = q.PAT_MRN_ID\n      AND a.FACILITY_ID = q.FACILITY_ID\n      WHERE a.PAT_MRN_ID IS NOT NULL AND q.PAT_MRN_ID IS NOT NULL\n    ) aq\n    ON s.PAT_MRN_ID = aq.PAT_MRN_ID\n  AND aq.FACILITY_ID = s.FACILITY_ID\n  Where aq.PAT_MRN_ID IS  NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''PAT_MRN_ID that does not match the FACILITY_ID'',\n           issue_row,\n           issue_column,\n           invalid_pat_value,\n           ''PAT_MRN_ID (\"'' || invalid_pat_value || ''\") that does not match the FACILITY_ID (\"'' || invalid_facility_value || ''\") across the files was found in \"'' || issue_table_name || ''\".'',\n           ''Validate PAT_MRN_ID that maches the FACILITY_ID across the files''\n      FROM valid_pat_mrn_id_across_all_three_tables;\nWITH mandatory_value AS (\n    SELECT ''ENCOUNTER_CLASS_CODE'' AS issue_column,\n           \"ENCOUNTER_CLASS_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_CLASS_CODE\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_CLASS_CODE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_encounter_class_in_all_rows AS (\n    SELECT ''ENCOUNTER_CLASS_CODE'' AS issue_column,\n           sr.\"ENCOUNTER_CLASS_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_class_reference ecr\n      ON UPPER(sr.ENCOUNTER_CLASS_CODE) = UPPER(ecr.Code)\n     WHERE sr.ENCOUNTER_CLASS_CODE IS NOT NULL\n      AND ecr.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ENCOUNTER CLASS CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ENCOUNTER CLASS CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ENCOUNTER CLASS CODE with encounter class reference data''\n      FROM valid_encounter_class_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ENCOUNTER_CLASS_CODE'' AS issue_column,\n      tbl.\"ENCOUNTER_CLASS_CODE\" AS invalid_value,\n      tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_CLASS_CODE\" is not null\n  and tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Display\" FROM encounter_class_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_CLASS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ENCOUNTER_CLASS_CODE \"'' || invalid_value || ''\" of ENCOUNTER_CLASS_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the ENCOUNTER_CLASS_CODE of ENCOUNTER_CLASS_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ENCOUNTER_CLASS_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ENCOUNTER_CLASS_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" is not null\n  and tbl.\"ENCOUNTER_CLASS_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Code\" FROM encounter_class_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_CLASS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ENCOUNTER_CLASS_CODE_DESCRIPTION \"'' || invalid_value || ''\" of ENCOUNTER_CLASS_CODE \"'' || dependent_value || ''\" is not matching with the ENCOUNTER_CLASS_CODE_DESCRIPTION of ENCOUNTER_CLASS_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''ENCOUNTER_CLASS_CODE_SYSTEM'' AS issue_column,\n           \"ENCOUNTER_CLASS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_CLASS_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_CLASS_CODE_SYSTEM\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''ENCOUNTER_CLASS_CODE_SYSTEM'' AS issue_column,\n           \"ENCOUNTER_CLASS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_CLASS_CODE_SYSTEM\" NOT IN (''http://terminology.hl7.org/CodeSystem/v3-ActCode'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''http://terminology.hl7.org/CodeSystem/v3-ActCode'''')'',\n           ''Use only allowed values ''''http://terminology.hl7.org/CodeSystem/v3-ActCode'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_encounter_class_in_all_rows AS (\n    SELECT ''ENCOUNTER_CLASS_CODE_DESCRIPTION'' AS issue_column,\n           sr.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_class_reference ecr\n      ON UPPER(sr.ENCOUNTER_CLASS_CODE_DESCRIPTION) = UPPER(ecr.Display)\n     WHERE sr.ENCOUNTER_CLASS_CODE_DESCRIPTION IS NOT NULL\n      AND ecr.Display IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ENCOUNTER CLASS CODE DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ENCOUNTER CLASS CODE DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ENCOUNTER CLASS CODE DESCRIPTION with encounter class reference data''\n      FROM valid_encounter_class_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''ENCOUNTER_STATUS_CODE'' AS issue_column,\n           \"ENCOUNTER_STATUS_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_STATUS_CODE\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_STATUS_CODE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_encounter_status_code_in_all_rows AS (\n    SELECT ''ENCOUNTER_STATUS_CODE'' AS issue_column,\n           sr.\"ENCOUNTER_STATUS_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_status_code_reference ecr\n      ON UPPER(sr.ENCOUNTER_STATUS_CODE) = UPPER(ecr.Code)\n     WHERE sr.ENCOUNTER_STATUS_CODE IS NOT NULL\n      AND ecr.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ENCOUNTER STATUS CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ENCOUNTER STATUS CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ENCOUNTER STATUS CODE with encounter status reference data''\n      FROM valid_encounter_status_code_in_all_rows;\nWITH valid_encounter_status_code_in_all_rows AS (\n    SELECT ''ENCOUNTER_STATUS_CODE_DESCRIPTION'' AS issue_column,\n           sr.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_status_code_reference ecr\n      ON UPPER(sr.ENCOUNTER_STATUS_CODE_DESCRIPTION) = UPPER(ecr.Display)\n     WHERE sr.ENCOUNTER_STATUS_CODE_DESCRIPTION IS NOT NULL\n      AND ecr.Display IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ENCOUNTER STATUS CODE DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ENCOUNTER STATUS CODE DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ENCOUNTER STATUS CODE DESCRIPTION with encounter status reference data''\n      FROM valid_encounter_status_code_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ENCOUNTER_STATUS_CODE'' AS issue_column,\n      tbl.\"ENCOUNTER_STATUS_CODE\" AS invalid_value,\n      tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_STATUS_CODE\" is not null\n  and tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Display\" FROM encounter_status_code_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_STATUS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ENCOUNTER_STATUS_CODE \"'' || invalid_value || ''\" of ENCOUNTER_STATUS_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the ENCOUNTER_STATUS_CODE of ENCOUNTER_STATUS_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ENCOUNTER_STATUS_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ENCOUNTER_STATUS_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" is not null\n  and tbl.\"ENCOUNTER_STATUS_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Code\" FROM encounter_status_code_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_STATUS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ENCOUNTER_STATUS_CODE_DESCRIPTION \"'' || invalid_value || ''\" of ENCOUNTER_STATUS_CODE \"'' || dependent_value || ''\" is not matching with the ENCOUNTER_STATUS_CODE_DESCRIPTION of ENCOUNTER_STATUS_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''ENCOUNTER_STATUS_CODE_SYSTEM'' AS issue_column,\n           \"ENCOUNTER_STATUS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_STATUS_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_STATUS_CODE_SYSTEM\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''ENCOUNTER_STATUS_CODE_SYSTEM'' AS issue_column,\n           \"ENCOUNTER_STATUS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_STATUS_CODE_SYSTEM\" NOT IN (''http://hl7.org/fhir/encounter-status'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''http://hl7.org/fhir/encounter-status'''')'',\n           ''Use only allowed values ''''http://hl7.org/fhir/encounter-status'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''ENCOUNTER_TYPE_CODE'' AS issue_column,\n           \"ENCOUNTER_TYPE_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_TYPE_CODE\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_TYPE_CODE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''ENCOUNTER_TYPE_CODE_SYSTEM'' AS issue_column,\n           \"ENCOUNTER_TYPE_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_TYPE_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_TYPE_CODE_SYSTEM\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_encounter_type_code_in_all_rows AS (\n    SELECT ''ENCOUNTER_TYPE_CODE'' AS issue_column,\n           sr.\"ENCOUNTER_TYPE_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_type_code_reference ecr\n      ON UPPER(CAST(sr.ENCOUNTER_TYPE_CODE AS VARCHAR)) = UPPER(CAST(ecr.Code AS VARCHAR))\n     WHERE sr.ENCOUNTER_TYPE_CODE IS NOT NULL\n      AND ecr.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ENCOUNTER TYPE CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ENCOUNTER TYPE CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ENCOUNTER TYPE CODE with encounter type reference data''\n      FROM valid_encounter_type_code_in_all_rows;\nWITH allowed_values AS (\n    SELECT ''ENCOUNTER_TYPE_CODE_SYSTEM'' AS issue_column,\n           \"ENCOUNTER_TYPE_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_TYPE_CODE_SYSTEM\" NOT IN (''SNOMED-CT'', ''SNOMED'', ''http://snomed.info/sct'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''SNOMED-CT'''', ''''SNOMED'''', ''''http://snomed.info/sct'''')'',\n           ''Use only allowed values ''''SNOMED-CT'''', ''''SNOMED'''', ''''http://snomed.info/sct'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_encounter_type_code_in_all_rows AS (\n    SELECT ''ENCOUNTER_TYPE_CODE_DESCRIPTION'' AS issue_column,\n           sr.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_type_code_reference ecr\n      ON UPPER(CAST(sr.ENCOUNTER_TYPE_CODE_DESCRIPTION AS VARCHAR)) = UPPER(CAST(ecr.Display AS VARCHAR))\n     WHERE sr.ENCOUNTER_TYPE_CODE_DESCRIPTION IS NOT NULL\n      AND ecr.Display IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ENCOUNTER TYPE CODE DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ENCOUNTER TYPE CODE DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ENCOUNTER TYPE CODE DESCRIPTION with encounter type reference data''\n      FROM valid_encounter_type_code_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ENCOUNTER_TYPE_CODE'' AS issue_column,\n      tbl.\"ENCOUNTER_TYPE_CODE\" AS invalid_value,\n      tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_TYPE_CODE\" is not null\n  and tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Display\" FROM encounter_type_code_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_TYPE_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ENCOUNTER_TYPE_CODE \"'' || invalid_value || ''\" of ENCOUNTER_TYPE_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the ENCOUNTER_TYPE_CODE of ENCOUNTER_TYPE_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ENCOUNTER_TYPE_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ENCOUNTER_TYPE_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" is not null\n  and tbl.\"ENCOUNTER_TYPE_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Code\" FROM encounter_type_code_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_TYPE_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ENCOUNTER_TYPE_CODE_DESCRIPTION \"'' || invalid_value || ''\" of ENCOUNTER_TYPE_CODE \"'' || dependent_value || ''\" is not matching with the ENCOUNTER_TYPE_CODE_DESCRIPTION of ENCOUNTER_TYPE_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''SCREENING_STATUS_CODE'' AS issue_column,\n           \"SCREENING_STATUS_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_STATUS_CODE\" IS NULL\n        OR TRIM(CAST(\"SCREENING_STATUS_CODE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_screening_status_code_in_all_rows AS (\n    SELECT ''SCREENING_STATUS_CODE'' AS issue_column,\n           sr.\"SCREENING_STATUS_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN screening_status_code_reference ref\n      ON UPPER(sr.SCREENING_STATUS_CODE) = UPPER(ref.Code)\n     WHERE sr.SCREENING_STATUS_CODE IS NOT NULL\n      AND ref.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid SCREENING STATUS CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid SCREENING STATUS CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate SCREENING STATUS CODE with screening status code reference data''\n      FROM valid_screening_status_code_in_all_rows;\nWITH valid_screening_status_code_in_all_rows AS (\n    SELECT ''SCREENING_STATUS_CODE_DESCRIPTION'' AS issue_column,\n           sr.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN screening_status_code_reference ecr\n      ON UPPER(sr.SCREENING_STATUS_CODE_DESCRIPTION) = UPPER(ecr.Display)\n     WHERE sr.SCREENING_STATUS_CODE_DESCRIPTION IS NOT NULL\n      AND ecr.Display IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid SCREENING STATUS CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid SCREENING STATUS CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate SCREENING STATUS CODE with screening status code reference data''\n      FROM valid_screening_status_code_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''SCREENING_STATUS_CODE'' AS issue_column,\n      tbl.\"SCREENING_STATUS_CODE\" AS invalid_value,\n      tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"SCREENING_STATUS_CODE\" is not null\n  and tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Display\" FROM screening_status_code_reference WHERE UPPER(CAST(tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SCREENING_STATUS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The SCREENING_STATUS_CODE \"'' || invalid_value || ''\" of SCREENING_STATUS_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the SCREENING_STATUS_CODE of SCREENING_STATUS_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''SCREENING_STATUS_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"SCREENING_STATUS_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" is not null\n  and tbl.\"SCREENING_STATUS_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Code\" FROM screening_status_code_reference WHERE UPPER(CAST(tbl.\"SCREENING_STATUS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The SCREENING_STATUS_CODE_DESCRIPTION \"'' || invalid_value || ''\" of SCREENING_STATUS_CODE \"'' || dependent_value || ''\" is not matching with the SCREENING_STATUS_CODE_DESCRIPTION of SCREENING_STATUS_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''SCREENING_STATUS_CODE_SYSTEM'' AS issue_column,\n           \"SCREENING_STATUS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_STATUS_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"SCREENING_STATUS_CODE_SYSTEM\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''SCREENING_STATUS_CODE_SYSTEM'' AS issue_column,\n           \"SCREENING_STATUS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_STATUS_CODE_SYSTEM\" NOT IN (''http://hl7.org/fhir/observation-status'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''http://hl7.org/fhir/observation-status'''')'',\n           ''Use only allowed values ''''http://hl7.org/fhir/observation-status'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  ''ANSWER_CODE'' AS issue_column,\n              \"ANSWER_CODE\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (ANSWER_CODE IS NULL OR TRIM(\"ANSWER_CODE\") = '''')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN (''TOTAL SAFETY SCORE'',\n            ''CALCULATED WEEKLY PHYSICAL ACTIVITY'',\n            ''CALCULATED MENTAL HEALTH SCORE'')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid value in ANSWER_CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value ANSWER_CODE is missing''\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  ''ANSWER_CODE_SYSTEM_NAME'' AS issue_column,\n              \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (ANSWER_CODE_SYSTEM_NAME IS NULL OR TRIM(\"ANSWER_CODE_SYSTEM_NAME\") = '''')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN (''TOTAL SAFETY SCORE'',\n            ''CALCULATED WEEKLY PHYSICAL ACTIVITY'',\n            ''CALCULATED MENTAL HEALTH SCORE'')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid value in ANSWER_CODE_SYSTEM_NAME'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value ANSWER_CODE_SYSTEM_NAME is missing''\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  ''QUESTION_CODE'' AS issue_column,\n              \"QUESTION_CODE\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (QUESTION_CODE IS NULL OR TRIM(\"QUESTION_CODE\") = '''')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN (''TOTAL SAFETY SCORE'',\n            ''CALCULATED WEEKLY PHYSICAL ACTIVITY'',\n            ''CALCULATED MENTAL HEALTH SCORE'')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid value in QUESTION_CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value QUESTION_CODE is missing''\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  ''QUESTION_CODE_SYSTEM_NAME'' AS issue_column,\n              \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (QUESTION_CODE_SYSTEM_NAME IS NULL OR TRIM(\"QUESTION_CODE_SYSTEM_NAME\") = '''')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN (''TOTAL SAFETY SCORE'',\n            ''CALCULATED WEEKLY PHYSICAL ACTIVITY'',\n            ''CALCULATED MENTAL HEALTH SCORE'')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid value in QUESTION_CODE_SYSTEM_NAME'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value QUESTION_CODE_SYSTEM_NAME is missing''\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  ''SCREENING_CODE_DESCRIPTION'' AS issue_column,\n              \"SCREENING_CODE_DESCRIPTION\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (SCREENING_CODE_DESCRIPTION IS NULL OR TRIM(\"SCREENING_CODE_DESCRIPTION\") = '''')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN (''TOTAL SAFETY SCORE'',\n            ''CALCULATED WEEKLY PHYSICAL ACTIVITY'',\n            ''CALCULATED MENTAL HEALTH SCORE'')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid value in SCREENING_CODE_DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value SCREENING_CODE_DESCRIPTION is missing''\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH allowed_values AS (\n    SELECT ''SCREENING_CODE_DESCRIPTION'' AS issue_column,\n           \"SCREENING_CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_CODE_DESCRIPTION\" NOT IN (''Accountable health communities (AHC) health-related social needs (HRSN) supplemental questions'',''Accountable health communities (AHC) health-related social needs screening (HRSN) tool'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Accountable health communities (AHC) health-related social needs (HRSN) supplemental questions'''',''''Accountable health communities (AHC) health-related social needs screening (HRSN) tool'''')'',\n           ''Use only allowed values ''''Accountable health communities (AHC) health-related social needs (HRSN) supplemental questions'''',''''Accountable health communities (AHC) health-related social needs screening (HRSN) tool'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  ''SCREENING_CODE_SYSTEM_NAME'' AS issue_column,\n              \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (SCREENING_CODE_SYSTEM_NAME IS NULL OR TRIM(\"SCREENING_CODE_SYSTEM_NAME\") = '''')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN (''TOTAL SAFETY SCORE'',\n            ''CALCULATED WEEKLY PHYSICAL ACTIVITY'',\n            ''CALCULATED MENTAL HEALTH SCORE'')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid value in SCREENING_CODE_SYSTEM_NAME'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value SCREENING_CODE_SYSTEM_NAME is missing''\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  ''SCREENING_CODE'' AS issue_column,\n              \"SCREENING_CODE\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (SCREENING_CODE IS NULL OR TRIM(\"SCREENING_CODE\") = '''')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN (''TOTAL SAFETY SCORE'',\n            ''CALCULATED WEEKLY PHYSICAL ACTIVITY'',\n            ''CALCULATED MENTAL HEALTH SCORE'')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid value in SCREENING_CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value SCREENING_CODE is missing''\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''QUESTION_CODE_DESCRIPTION'' AS issue_column,\n           \"QUESTION_CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"QUESTION_CODE_DESCRIPTION\" IS NULL\n        OR TRIM(CAST(\"QUESTION_CODE_DESCRIPTION\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_answer_code_in_all_rows AS (\n  SELECT ''ANSWER_CODE'' AS issue_column,\n    scr.\"ANSWER_CODE\" AS invalid_value,\n    scr.\"QUESTION_CODE\" AS invalid_question_value,\n    scr.SCREENING_CODE AS invalid_screening_value,\n    scr.src_file_row_number AS issue_row\n    FROM screening_20240307 scr\n    LEFT OUTER JOIN ahc_cross_walk crw\n      ON UPPER(scr.SCREENING_CODE) = UPPER(crw.SCREENING_CODE)\n      AND UPPER(scr.QUESTION_CODE) = UPPER(crw.QUESTION_CODE)\n      AND UPPER(scr.ANSWER_CODE) = UPPER(crw.ANSWER_CODE)\n    WHERE scr.SCREENING_CODE IS NOT NULL\n      AND scr.QUESTION_CODE IS NOT NULL\n      AND scr.ANSWER_CODE IS NOT NULL\n      AND crw.ANSWER_CODE IS NULL\n)\n\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Answer Code'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Provided Screening Code \"'' || invalid_screening_value || ''\", Question Code \"'' || invalid_question_value || ''\" and Answer Code \"'' || invalid_value || ''\" are not matching with the reference data found in '' || issue_column,\n           ''Validate Screening Code, Question Code and Answer Code with ahc cross walk reference data''\n      FROM valid_answer_code_in_all_rows;\nWITH valid_total_safety_score_in_all_rows AS (\n  WITH cte_score AS (\n    SELECT\n        SUM(crw.Score) AS cross_walk_Score,\n        SUM(\n            CASE\n                WHEN UPPER(TRIM(scr.QUESTION_CODE_DESCRIPTION)) LIKE ''%TOTAL SAFETY SCORE%'' AND TRY_CAST(scr.ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL THEN CAST(scr.ANSWER_CODE_DESCRIPTION AS INTEGER)\n                ELSE 0\n            END\n        ) AS screening_score\n    FROM\n        screening_20240307 scr\n    LEFT OUTER JOIN (\n        SELECT \tacw.SCREENING_CODE,\n              acw.QUESTION_CODE,\n              acw.ANSWER_CODE,\n              acw.QUESTION_SLNO,\n              acw.Score AS Score\n        FROM ahc_cross_walk acw\n        Where QUESTION_SLNO_REFERENCE In(\n        SELECT QUESTION_SLNO\n            FROM ahc_cross_walk\n            WHERE UPPER(TRIM(QUESTION)) LIKE ''%TOTAL SAFETY SCORE%''\n            )\n        AND acw.QUESTION_CODE = scr.QUESTION_CODE\n        AND acw.ANSWER_CODE = scr.ANSWER_CODE\n    ) AS crw ON crw.SCREENING_CODE = scr.SCREENING_CODE\n)\nSELECT \tcross_walk_Score,\n    screening_score AS invalid_value,\n    (SELECT src_file_row_number FROM screening_20240307 WHERE UPPER(TRIM(QUESTION_CODE_DESCRIPTION)) LIKE ''%TOTAL SAFETY SCORE%'') AS issue_row,\n  ''ANSWER_CODE_DESCRIPTION'' AS issue_column\nFROM cte_score\nWHERE screening_score <> cross_walk_Score\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ANSWER_CODE_DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ANSWER_CODE_DESCRIPTION for TOTAL SAFETY SCORE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ANSWER_CODE_DESCRIPTION for TOTAL SAFETY SCORE (Calculated Score)''\n      FROM valid_total_safety_score_in_all_rows;\nWITH valid_calculated_mental_health_score_in_all_rows AS (\n  SELECT ANSWER_CODE_DESCRIPTION AS issue_column,\n  SCREENING_CALCULATED_SCORE AS invalid_value,\n  SRC_FILE_ROW_NUMBER AS issue_row\n  FROM\n  (\n  SELECT Sum(crw.score) As CROSSWALK_ANSWER_SCORE,\n      (SELECT CASE WHEN TRY_CAST(ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL THEN CAST(ANSWER_CODE_DESCRIPTION AS INTEGER) ELSE 0 END AS SCREENING_CALC_SCORE\n        FROM screening_20240307 scr2\n        WHERE UPPER(scr2.QUESTION_CODE_DESCRIPTION) LIKE ''%CALCULATED MENTAL HEALTH SCORE%''\n    ) AS SCREENING_CALCULATED_SCORE,\n    (SELECT src_file_row_number FROM screening_20240307 WHERE UPPER(QUESTION_CODE_DESCRIPTION) LIKE ''%CALCULATED MENTAL HEALTH SCORE%'') AS SRC_FILE_ROW_NUMBER,\n    ''ANSWER_CODE_DESCRIPTION'' AS ANSWER_CODE_DESCRIPTION\n      FROM screening_20240307 scr\n      INNER JOIN (\n          SELECT \tacw.score As SCORE\n          FROM ahc_cross_walk acw\n          Where QUESTION_SLNO_REFERENCE In(\n          SELECT QUESTION_SLNO\n              FROM ahc_cross_walk\n              WHERE UPPER(QUESTION) LIKE ''%CALCULATED MENTAL HEALTH SCORE%''\n              )\n          AND acw.QUESTION_CODE = scr.QUESTION_CODE\n          AND acw.ANSWER_CODE  = scr.ANSWER_CODE\n      ) AS crw ON 1 = 1\n  ) As calc_fld_val\n  Where calc_fld_val.CROSSWALK_ANSWER_SCORE <> calc_fld_val.SCREENING_CALCULATED_SCORE\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ANSWER_CODE_DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ANSWER_CODE_DESCRIPTION for CALCULATED MENTAL HEALTH SCORE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ANSWER_CODE_DESCRIPTION for CALCULATED MENTAL HEALTH SCORE (Calculated Score)''\n      FROM valid_calculated_mental_health_score_in_all_rows;\nWITH valid_calculated_weekly_physical_activity_score_in_all_rows AS (\n  WITH cte_physical_activity AS (\n    SELECT\n      scr.SCREENING_CODE,\n      scr.QUESTION_CODE,\n      scr.ANSWER_CODE,\n      crw.ANSWER_VALUE,\n      scr.ANSWER_CODE_DESCRIPTION,\n      ROW_NUMBER() OVER (\n      ORDER BY scr.SCREENING_CODE) AS sequence_number\n    FROM\n      screening_20240307 scr\n    INNER JOIN (\n      SELECT\n        acw.SCREENING_CODE,\n        acw.QUESTION_CODE,\n        acw.ANSWER_CODE,\n        acw.QUESTION_SLNO,\n        CASE\n          WHEN TRY_CAST(acw.ANSWER_VALUE AS INTEGER) IS NOT NULL THEN CAST(acw.ANSWER_VALUE AS INTEGER)\n          ELSE CASE WHEN acw.ANSWER_CODE=''LA32060-8'' THEN 150 ELSE 0 END\n        END AS ANSWER_VALUE\n      FROM\n        ahc_cross_walk acw\n      Where\n        QUESTION_SLNO_REFERENCE In(\n        SELECT\n          QUESTION_SLNO\n        FROM\n          ahc_cross_walk\n        WHERE\n          UPPER(QUESTION) LIKE ''%CALCULATED PHYSICAL ACTIVITY SCORE%''\n                )\n        AND acw.QUESTION_CODE = scr.QUESTION_CODE\n        AND acw.ANSWER_CODE = scr.ANSWER_CODE\n        ) AS crw ON\n      crw.SCREENING_CODE = scr.SCREENING_CODE\n    )\n    Select \tANSWER_CODE_DESCRIPTION AS issue_column,\n        CROSSWALK_ANSWER_VALUE AS CROSSWALK_ANSWER_VALUE,\n        SCREENING_CALCULATED_VALUE AS invalid_value,\n        SRC_FILE_ROW_NUMBER AS issue_row\n    FROM\n      (\n      Select\n        t1.ANSWER_VALUE * t2.ANSWER_VALUE As CROSSWALK_ANSWER_VALUE,\n        CASE\n          WHEN TRY_CAST(t1.ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL\n            AND TRY_CAST(t2.ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL THEN\n        CAST(t1.ANSWER_CODE_DESCRIPTION AS INTEGER) * CAST(t2.ANSWER_CODE_DESCRIPTION AS INTEGER)\n          ELSE CASE WHEN t2.ANSWER_CODE=''LA32060-8'' THEN 150 * CAST(t1.ANSWER_CODE_DESCRIPTION AS INTEGER) ELSE 0 END\n          END AS SCREENING_ANSWER_VALUE,\n          Scrn_Phycical_Act_Score.SCRN_PHYSICAL_ACTIVITY_VALUE AS SCREENING_CALCULATED_VALUE,\n          (SELECT src_file_row_number FROM screening_20240307 WHERE UPPER(QUESTION_CODE_DESCRIPTION) LIKE ''%CALCULATED WEEKLY PHYSICAL ACTIVITY%'') AS SRC_FILE_ROW_NUMBER,\n          ''ANSWER_CODE_DESCRIPTION'' AS ANSWER_CODE_DESCRIPTION\n\n        from\n          cte_physical_activity t1\n        Inner Join cte_physical_activity t2\n    On\n          t1.sequence_number = 1\n          and t2.sequence_number = 2\n        Left Outer Join (\n          Select\n            CASE\n              WHEN TRY_CAST(ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL THEN CAST(ANSWER_CODE_DESCRIPTION AS INTEGER)\n              ELSE 0\n            END SCRN_PHYSICAL_ACTIVITY_VALUE\n          From\n          screening_20240307 scr\n          Where\n            UPPER(scr.QUESTION_CODE_DESCRIPTION) LIKE ''%CALCULATED WEEKLY PHYSICAL ACTIVITY%'') AS Scrn_Phycical_Act_Score\n                On\n          1 = 1\n    ) As calc_fld\n    Where\n      (calc_fld.CROSSWALK_ANSWER_VALUE <> calc_fld.SCREENING_ANSWER_VALUE)\n      OR (calc_fld.SCREENING_ANSWER_VALUE <> calc_fld.SCREENING_CALCULATED_VALUE)\n      OR (calc_fld.CROSSWALK_ANSWER_VALUE <> calc_fld.SCREENING_CALCULATED_VALUE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ANSWER_CODE_DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ANSWER_CODE_DESCRIPTION for CALCULATED PHYSICAL ACTIVITY SCORE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ANSWER_CODE_DESCRIPTION for CALCULATED PHYSICAL ACTIVITY SCORE (Calculated Score)''\n      FROM valid_calculated_weekly_physical_activity_score_in_all_rows;\nWITH allowed_values AS (\n    SELECT ''SCREENING_CODE'' AS issue_column,\n           \"SCREENING_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_CODE\" NOT IN (''96777-8'', ''97023-6'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''96777-8'''', ''''97023-6'''')'',\n           ''Use only allowed values ''''96777-8'''', ''''97023-6'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''SCREENING_CODE_SYSTEM_NAME'' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" NOT IN (''LN'', ''LOINC'', ''http://loinc.org'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''', ''''LOINC'''', ''''http://loinc.org'''')'',\n           ''Use only allowed values ''''LN'''', ''''LOINC'''', ''''http://loinc.org'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''RECORDED_TIME'' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"RECORDED_TIME\" IS NULL\n        OR TRIM(CAST(\"RECORDED_TIME\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_date_time_in_all_rows AS (\n        SELECT  ''RECORDED_TIME'' AS issue_column,\n              \"RECORDED_TIME\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM \"screening_20240307\"\n        WHERE \"RECORDED_TIME\" IS NOT NULL\n        AND \"RECORDED_TIME\" NOT SIMILAR TO ''([0-9]([0-9]([0-9][1-9]|[1-9]0)|[1-9]00)|[1-9]000)-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])T([01][0-9]|2[0-3]):[0-5][0-9]:([0-5][0-9]|60)(\\.[0-9]+)?(Z|(\\+|-)((0[0-9]|1[0-3]):[0-5][0-9]|14:00))$''\n        OR TRY_CAST(\"RECORDED_TIME\" AS TIMESTAMP) IS NULL\n  )\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Date'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid timestamp \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Please be sure to provide both a valid date and time.''\n      FROM valid_date_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''SDOH_DOMAIN'' AS issue_column,\n           \"SDOH_DOMAIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SDOH_DOMAIN\" IS NULL\n        OR TRIM(CAST(\"SDOH_DOMAIN\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_sdoh_domain_in_all_rows AS (\n  SELECT DISTINCT scr.SDOH_DOMAIN AS invalid_value,\n    ''SDOH_DOMAIN'' AS issue_column,\n    scr.src_file_row_number AS issue_row\n  FROM screening_20240307 scr\n  LEFT JOIN ahc_cross_walk cw\n  ON UPPER(scr.SDOH_DOMAIN) = UPPER(cw.SDOH_DOMAIN)\n  WHERE cw.SDOH_DOMAIN IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid SDOH DOMAIN'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid SDOH DOMAIN \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate SDOH DOMAIN with ahc cross walk reference data''\n      FROM valid_sdoh_domain_in_all_rows;\nWITH valid_question_code_for_screening_code_in_all_rows AS (\n  SELECT DISTINCT scr.SCREENING_CODE AS issue_screening_value, scr.QUESTION_CODE AS invalid_value, ''QUESTION_CODE'' AS issue_column, scr.src_file_row_number AS issue_row\n  FROM screening_20240307 scr\n  LEFT JOIN ahc_cross_walk cw ON UPPER(scr.QUESTION_CODE) = UPPER(cw.QUESTION_CODE)\n  AND UPPER(scr.SCREENING_CODE) = UPPER(cw.SCREENING_CODE)\n  WHERE cw.QUESTION_CODE IS NULL\n  AND cw.SCREENING_CODE IS NOT NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Question Code'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid Question Code \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate Question Code with ahc cross walk reference data''\n      FROM valid_question_code_for_screening_code_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''ANSWER_CODE_DESCRIPTION'' AS issue_column,\n           \"ANSWER_CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ANSWER_CODE_DESCRIPTION\" IS NULL\n        OR TRIM(CAST(\"ANSWER_CODE_DESCRIPTION\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''QUESTION_CODE_SYSTEM_NAME'' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" NOT IN (''LN'',''LOINC'',''http://loinc.org'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''',''''LOINC'''',''''http://loinc.org'''')'',\n           ''Use only allowed values ''''LN'''',''''LOINC'''',''''http://loinc.org'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''ANSWER_CODE_SYSTEM_NAME'' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" NOT IN (''LN'',''LOINC'',''http://loinc.org'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''',''''LOINC'''',''''http://loinc.org'''')'',\n           ''Use only allowed values ''''LN'''',''''LOINC'''',''''http://loinc.org'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''POTENTIAL_NEED_INDICATED'' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" IS NULL\n        OR TRIM(CAST(\"POTENTIAL_NEED_INDICATED\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''POTENTIAL_NEED_INDICATED'' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" NOT IN (''Yes'',''No'',''NA'',''yes'',''no'',''na'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''',''''No'''',''''NA'''',''''yes'''',''''no'''',''''na'''')'',\n           ''Use only allowed values ''''Yes'''',''''No'''',''''NA'''',''''yes'''',''''no'''',''''na'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_screening_potential_need_indicated_question_answer_values_in_all_rows AS (\n  SELECT  ''POTENTIAL_NEED_INDICATED'' AS issue_column,\n          coalesce(scr.\"POTENTIAL_NEED_INDICATED\",''NULL'') AS invalid_value,\n          scr.ANSWER_CODE AS invalid_answer_value,\n          scr.QUESTION_CODE AS invalid_question_value,\n          scr.SCREENING_CODE AS invalid_screening_value,\n          scr.src_file_row_number AS issue_row\n  FROM screening_20240307 scr\n  LEFT JOIN ahc_cross_walk acw\n    ON UPPER(scr.SCREENING_CODE) = UPPER(acw.SCREENING_CODE)\n    AND UPPER(scr.QUESTION_CODE) = UPPER(acw.QUESTION_CODE)\n    AND UPPER(scr.ANSWER_CODE) = UPPER(acw.ANSWER_CODE)\n    AND UPPER(scr.\"POTENTIAL_NEED_INDICATED\") = UPPER(acw.\"POTENTIAL_NEED_INDICATED\")\n  WHERE acw.\"POTENTIAL_NEED_INDICATED\" IS NULL\n  AND  UPPER(scr.QUESTION_CODE_DESCRIPTION)\n  NOT IN(\n    ''TOTAL SAFETY SCORE'',\n    ''CALCULATED WEEKLY PHYSICAL ACTIVITY'',\n    ''CALCULATED MENTAL HEALTH SCORE''\n  )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid value in POTENTIAL_NEED_INDICATED'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Provided Potential Need Indicated \"'' || invalid_value || ''\", Screening Code \"'' || invalid_screening_value || ''\", Question Code \"'' || invalid_question_value || ''\" and Answer Code \"'' || invalid_answer_value || ''\" are not matching with the reference data found in '' || issue_column,\n           ''Validate Potential Need Indicated, Screening Code, Question Code and Answer Code with ahc cross walk reference data''\n      FROM valid_screening_potential_need_indicated_question_answer_values_in_all_rows;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''c50d9d2d-753b-5200-b2f6-e63309cf252d'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''ScreeningCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''463a01b7-82ad-5633-939d-54a554d09923'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''b9aac8ec-792a-511d-8107-25bd96085898'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''AhcCrossWalkCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''98f79424-a291-554e-aa6a-17c4c39e5c81'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''b9aac8ec-792a-511d-8107-25bd96085898'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''AhcCrossWalkCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''1e8926d1-43b1-5485-9308-7addd10605ab'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''48eb0055-f06e-57f4-8019-f49266be3d22'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''EncounterClassReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''a76151ab-e619-51bb-9db7-57c686404756'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''48eb0055-f06e-57f4-8019-f49266be3d22'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''EncounterClassReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''81a8b5c0-5c79-5ff9-95d6-cfcf0749c550'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''2e9c77e9-a664-5323-83e4-e6a92cf998ab'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''EncounterStatusCodeReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''731b9b5d-fbb0-541f-93bc-11778098ab71'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''2e9c77e9-a664-5323-83e4-e6a92cf998ab'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''EncounterStatusCodeReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''2af573ce-4941-56c1-a703-f92928ad3a7d'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''4b3dd9ab-d81b-509a-9662-68dbd6d142f7'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''EncounterTypeCodeReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''8fe71cea-8904-5ba0-823d-de9955eee28d'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''4b3dd9ab-d81b-509a-9662-68dbd6d142f7'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''EncounterTypeCodeReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''b7082a36-d569-5f54-b0fe-23dfaca90466'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''1a152daa-273d-5411-88cf-84067822a8aa'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''ScreeningStatusCodeReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7d4a917b-2900-5b12-a89c-a246a342b27b'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''1a152daa-273d-5411-88cf-84067822a8aa'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''ScreeningStatusCodeReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''de2853a4-d787-5e6d-ba4c-58a0cd667eac'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''787ee7ff-3ef5-59aa-a055-659cf10b6202'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''GenderIdentityReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''51873a08-9517-54b6-982b-38b5e08677b8'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''787ee7ff-3ef5-59aa-a055-659cf10b6202'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''GenderIdentityReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''bd4d7db3-4490-5a2f-8b54-876cd96bb629'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''79f3d60e-c863-5759-8043-f122175a7cbb'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''AdministrativeSexReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''e6b6e4b0-6fdd-5d2b-a626-801aaaa4967f'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''79f3d60e-c863-5759-8043-f122175a7cbb'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''AdministrativeSexReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7b22a848-5153-5975-b74e-e9c3ea06640c'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''6c2d9879-7393-524d-9e9e-02ea961aca39'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''SexAtBirthReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''8a53e502-4b61-5596-88d5-e2e23a907935'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''6c2d9879-7393-524d-9e9e-02ea961aca39'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''SexAtBirthReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''0ab7227d-471c-5f13-9630-7f3c0c6cd120'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''2239dca2-9dd4-5c3a-91c8-2585839b9584'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''SexualOrientationReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''63af23ca-ea46-53d2-a55c-459cb2419b54'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''2239dca2-9dd4-5c3a-91c8-2585839b9584'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''SexualOrientationReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''41f3b3f2-2670-5600-96ca-a39e21943a0a'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''fc740f9e-863e-5dd1-b1a1-86d176cb549c'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''BusinessRulesReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''2bb73de9-1a11-58ac-bcda-74d30c2ace8e'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''fc740f9e-863e-5dd1-b1a1-86d176cb549c'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''BusinessRulesReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''baac722a-6a3b-5494-9df5-91e63f8c22b0'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''f98a88dc-a929-5a9b-906a-277e62c93012'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''RaceReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''312774c2-4ed4-526a-a68c-64356a89466d'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''f98a88dc-a929-5a9b-906a-277e62c93012'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''RaceReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''6cf18abf-2b0d-5ec5-9b5e-2a7e81d0bcc3'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''b0cbca95-5c20-5b2b-b589-9e832c556bc6'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''EthnicityReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''66d2dfbd-511a-58c0-9092-fd1965efbe27'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''b0cbca95-5c20-5b2b-b589-9e832c556bc6'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''EthnicityReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''905ccf58-6d99-5787-97b2-2534a35e55d6'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''3469db42-0066-5f23-9ee4-2b857bf339a4'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''PreferredLanguageReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''96ffe5ed-2b40-5e9b-8e13-a60d66430ceb'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''3469db42-0066-5f23-9ee4-2b857bf339a4'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''PreferredLanguageReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''83c7e8ef-bc1c-5726-a3f1-46ec9c63a4df'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''f19d5ebb-ea63-5b1d-b1b1-758457a2da29'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''SdohDomainReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''aae34d6f-c822-51b7-b05a-b06cb3774a0f'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''f19d5ebb-ea63-5b1d-b1b1-758457a2da29'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''SdohDomainReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      ', NULL, NULL, NULL, '\n## ensureContent\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''630f992f-2d33-5d0b-9855-29fdb84f62ee'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''AdminDemographicCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''FIRST_NAME'' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"FIRST_NAME\" IS NULL\n        OR TRIM(CAST(\"FIRST_NAME\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''FIRST_NAME'' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"FIRST_NAME\" AS VARCHAR) NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT ''MIDDLE_NAME'' AS issue_column,\n           \"MIDDLE_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"MIDDLE_NAME\" AS VARCHAR) NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''LAST_NAME'' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"LAST_NAME\" IS NULL\n        OR TRIM(CAST(\"LAST_NAME\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''LAST_NAME'' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"LAST_NAME\" AS VARCHAR) NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''ADMINISTRATIVE_SEX_CODE'' AS issue_column,\n           \"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"ADMINISTRATIVE_SEX_CODE\" IS NULL\n        OR TRIM(CAST(\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''ADMINISTRATIVE_SEX_CODE_SYSTEM'' AS issue_column,\n           \"ADMINISTRATIVE_SEX_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"ADMINISTRATIVE_SEX_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"ADMINISTRATIVE_SEX_CODE_SYSTEM\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_administrative_sex_code_in_all_rows AS (\n    SELECT ''ADMINISTRATIVE_SEX_CODE'' AS issue_column,\n           sr.\"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN administrative_sex_reference ref\n      ON UPPER(sr.\"ADMINISTRATIVE_SEX_CODE\") = UPPER(ref.ADMINISTRATIVE_SEX_CODE)\n     WHERE sr.\"ADMINISTRATIVE_SEX_CODE\" IS NOT NULL\n      AND ref.ADMINISTRATIVE_SEX_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid ADMINISTRATIVE SEX CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ADMINISTRATIVE SEX CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ADMINISTRATIVE SEX CODE with administrative sex reference data''\n      FROM valid_administrative_sex_code_in_all_rows;\nWITH valid_administrative_sex_code_description_in_all_rows AS (\n    SELECT ''ADMINISTRATIVE_SEX_CODE_DESCRIPTION'' AS issue_column,\n           sr.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN administrative_sex_reference ref\n      ON UPPER(sr.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\") = UPPER(ref.ADMINISTRATIVE_SEX_CODE_DESCRIPTION)\n     WHERE sr.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" IS NOT NULL\n      AND ref.ADMINISTRATIVE_SEX_CODE_DESCRIPTION IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid ADMINISTRATIVE SEX CODE DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ADMINISTRATIVE SEX CODE DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ADMINISTRATIVE SEX CODE DESCRIPTION with administrative sex reference data''\n      FROM valid_administrative_sex_code_description_in_all_rows;\nWITH valid_administrative_sex_code_system_in_all_rows AS (\n    SELECT ''ADMINISTRATIVE_SEX_CODE_SYSTEM'' AS issue_column,\n           sr.\"ADMINISTRATIVE_SEX_CODE_SYSTEM\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN administrative_sex_reference ref\n      ON UPPER(sr.\"ADMINISTRATIVE_SEX_CODE_SYSTEM\") = UPPER(ref.ADMINISTRATIVE_SEX_CODE_SYSTEM)\n     WHERE sr.\"ADMINISTRATIVE_SEX_CODE_SYSTEM\" IS NOT NULL\n      AND ref.ADMINISTRATIVE_SEX_CODE_SYSTEM IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid ADMINISTRATIVE SEX CODE SYSTEM'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ADMINISTRATIVE SEX CODE SYSTEM \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ADMINISTRATIVE SEX CODE SYSTEM with administrative sex reference data''\n      FROM valid_administrative_sex_code_system_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ADMINISTRATIVE_SEX_CODE'' AS issue_column,\n      tbl.\"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n      tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"ADMINISTRATIVE_SEX_CODE\" is not null\n  and tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" FROM administrative_sex_reference WHERE UPPER(CAST(tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)) = UPPER(CAST(\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ADMINISTRATIVE_SEX_CODE \"'' || invalid_value || ''\" of ADMINISTRATIVE_SEX_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the ADMINISTRATIVE_SEX_CODE of ADMINISTRATIVE_SEX_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ADMINISTRATIVE_SEX_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ADMINISTRATIVE_SEX_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" is not null\n  and tbl.\"ADMINISTRATIVE_SEX_CODE\" is not null\n  and NOT EXISTS ( SELECT \"ADMINISTRATIVE_SEX_CODE\" FROM administrative_sex_reference WHERE UPPER(CAST(tbl.\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)) = UPPER(CAST(\"ADMINISTRATIVE_SEX_CODE\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"ADMINISTRATIVE_SEX_CODE_DESCRIPTION\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ADMINISTRATIVE_SEX_CODE_DESCRIPTION \"'' || invalid_value || ''\" of ADMINISTRATIVE_SEX_CODE \"'' || dependent_value || ''\" is not matching with the ADMINISTRATIVE_SEX_CODE_DESCRIPTION of ADMINISTRATIVE_SEX_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_sex_at_birth_code_in_all_rows AS (\n    SELECT ''SEX_AT_BIRTH_CODE'' AS issue_column,\n           sr.\"SEX_AT_BIRTH_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sex_at_birth_reference ref\n      ON UPPER(sr.SEX_AT_BIRTH_CODE) = UPPER(ref.SEX_AT_BIRTH_CODE)\n     WHERE sr.SEX_AT_BIRTH_CODE IS NOT NULL\n      AND ref.SEX_AT_BIRTH_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid SEX AT BIRTH CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid SEX AT BIRTH CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate SEX AT BIRTH CODE with sex at birth reference data''\n      FROM valid_sex_at_birth_code_in_all_rows;\nWITH valid_sex_at_birth_code_description_in_all_rows AS (\n    SELECT ''SEX_AT_BIRTH_CODE_DESCRIPTION'' AS issue_column,\n           sr.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sex_at_birth_reference ref\n      ON UPPER(sr.SEX_AT_BIRTH_CODE_DESCRIPTION) = UPPER(ref.SEX_AT_BIRTH_CODE_DESCRIPTION)\n     WHERE sr.SEX_AT_BIRTH_CODE_DESCRIPTION IS NOT NULL\n      AND ref.SEX_AT_BIRTH_CODE_DESCRIPTION IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid SEX_AT_BIRTH_CODE_DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid SEX_AT_BIRTH_CODE_DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate SEX_AT_BIRTH_CODE_DESCRIPTION with sex at birth reference data''\n      FROM valid_sex_at_birth_code_description_in_all_rows;\nWITH valid_sex_at_birth_code_system_in_all_rows AS (\n    SELECT ''SEX_AT_BIRTH_CODE_SYSTEM'' AS issue_column,\n           sr.\"SEX_AT_BIRTH_CODE_SYSTEM\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sex_at_birth_reference ref\n      ON UPPER(sr.SEX_AT_BIRTH_CODE_SYSTEM) = UPPER(ref.SEX_AT_BIRTH_CODE_SYSTEM)\n     WHERE sr.SEX_AT_BIRTH_CODE_SYSTEM IS NOT NULL\n      AND ref.SEX_AT_BIRTH_CODE_SYSTEM IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid SEX AT BIRTH CODE SYSTEM'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid SEX AT BIRTH CODE SYSTEM \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate SEX AT BIRTH CODE SYSTEM with sex at birth reference data''\n      FROM valid_sex_at_birth_code_system_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''SEX_AT_BIRTH_CODE'' AS issue_column,\n      tbl.\"SEX_AT_BIRTH_CODE\" AS invalid_value,\n      tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"SEX_AT_BIRTH_CODE\" is not null\n  and tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"SEX_AT_BIRTH_CODE_DESCRIPTION\" FROM sex_at_birth_reference WHERE UPPER(CAST(tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SEX_AT_BIRTH_CODE\" AS VARCHAR)) = UPPER(CAST(\"SEX_AT_BIRTH_CODE\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The SEX_AT_BIRTH_CODE \"'' || invalid_value || ''\" of SEX_AT_BIRTH_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the SEX_AT_BIRTH_CODE of SEX_AT_BIRTH_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''SEX_AT_BIRTH_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"SEX_AT_BIRTH_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" is not null\n  and tbl.\"SEX_AT_BIRTH_CODE\" is not null\n  and NOT EXISTS ( SELECT \"SEX_AT_BIRTH_CODE\" FROM sex_at_birth_reference WHERE UPPER(CAST(tbl.\"SEX_AT_BIRTH_CODE\" AS VARCHAR)) = UPPER(CAST(\"SEX_AT_BIRTH_CODE\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The SEX_AT_BIRTH_CODE_DESCRIPTION \"'' || invalid_value || ''\" of SEX_AT_BIRTH_CODE \"'' || dependent_value || ''\" is not matching with the SEX_AT_BIRTH_CODE_DESCRIPTION of SEX_AT_BIRTH_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''PAT_BIRTH_DATE'' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"PAT_BIRTH_DATE\" IS NULL\n        OR TRIM(CAST(\"PAT_BIRTH_DATE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_date_time_in_all_rows AS (\n    SELECT ''PAT_BIRTH_DATE'' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"PAT_BIRTH_DATE\" IS NOT NULL\n       AND TRY_CAST(\"PAT_BIRTH_DATE\" AS TIMESTAMP) IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Date'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid timestamp \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Please be sure to provide both a valid date and time.''\n      FROM valid_date_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''CITY'' AS issue_column,\n           \"CITY\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"CITY\" IS NULL\n        OR TRIM(CAST(\"CITY\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''STATE'' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"STATE\" IS NULL\n        OR TRIM(CAST(\"STATE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''STATE'' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"STATE\" NOT IN (''NY'', ''New York'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''NY'''', ''''New York'''')'',\n           ''Use only allowed values ''''NY'''', ''''New York'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''ZIP'' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"ZIP\" IS NULL\n        OR TRIM(CAST(\"ZIP\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''ZIP'' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"ZIP\" AS VARCHAR) NOT SIMILAR TO ''^\\d{5}(\\d{4})?$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^\\d{5}(\\d{4})?$'',\n           ''Follow the pattern ^\\d{5}(\\d{4})?$ in '' || issue_column\n      FROM pattern;\nWITH valid_integer_alphanumeric_string_in_all_rows AS (\n  SELECT ''ADDRESS1'' AS issue_column,\n    t.\"ADDRESS1\" AS invalid_value,\n    t.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307 t\n  WHERE t.\"ADDRESS1\" SIMILAR TO ''[0-9]+''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Data Type Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Invalid string of numbers found''\n      FROM valid_integer_alphanumeric_string_in_all_rows;\nWITH valid_address1_or_medicaid_cin_in_all_rows AS (\n    SELECT ''ADDRESS1'' AS issue_column,\n           ADDRESS1 AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM admin_demographics_20240307\n      WHERE (ADDRESS1 IS NULL OR TRIM(\"ADDRESS1\") = '''') AND (MEDICAID_CIN IS NULL OR TRIM(\"MEDICAID_CIN\") = '''')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid ADDRESS1'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value ADDRESS1 is missing. This is required due to the absence of the MEDICAID_CIN.''\n      FROM valid_address1_or_medicaid_cin_in_all_rows;\nWITH valid_gender_identity_code_in_all_rows AS (\n    SELECT ''GENDER_IDENTITY_CODE'' AS issue_column,\n           sr.\"GENDER_IDENTITY_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN gender_identity_reference ref\n      ON UPPER(sr.GENDER_IDENTITY_CODE) = UPPER(ref.GENDER_IDENTITY_CODE)\n     WHERE sr.GENDER_IDENTITY_CODE IS NOT NULL\n      AND ref.GENDER_IDENTITY_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid GENDER IDENTITY CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid GENDER IDENTITY CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate GENDER IDENTITY CODE with gender identity reference data''\n      FROM valid_gender_identity_code_in_all_rows;\nWITH allowed_values AS (\n    SELECT ''GENDER_IDENTITY_CODE_SYSTEM_NAME'' AS issue_column,\n           \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" NOT IN (''SNOMED-CT'',''SNOMED'',''http://snomed.info/sct'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''SNOMED-CT'''',''''SNOMED'''',''''http://snomed.info/sct'''')'',\n           ''Use only allowed values ''''SNOMED-CT'''',''''SNOMED'''',''''http://snomed.info/sct'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''GENDER_IDENTITY_CODE'' AS issue_column,\n      tbl.\"GENDER_IDENTITY_CODE\" AS invalid_value,\n      tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"GENDER_IDENTITY_CODE\" is not null\n  and tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"GENDER_IDENTITY_CODE_DESCRIPTION\" FROM gender_identity_reference WHERE UPPER(CAST(tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS VARCHAR)) AND UPPER(CAST(tbl.\"GENDER_IDENTITY_CODE\" AS VARCHAR)) = UPPER(CAST(\"GENDER_IDENTITY_CODE\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The GENDER_IDENTITY_CODE \"'' || invalid_value || ''\" of GENDER_IDENTITY_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the GENDER_IDENTITY_CODE of GENDER_IDENTITY_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''GENDER_IDENTITY_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"GENDER_IDENTITY_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" is not null\n  and tbl.\"GENDER_IDENTITY_CODE\" is not null\n  and NOT EXISTS ( SELECT \"GENDER_IDENTITY_CODE\" FROM gender_identity_reference WHERE UPPER(CAST(tbl.\"GENDER_IDENTITY_CODE\" AS VARCHAR)) = UPPER(CAST(\"GENDER_IDENTITY_CODE\" AS VARCHAR)) AND UPPER(CAST(tbl.\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"GENDER_IDENTITY_CODE_DESCRIPTION\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The GENDER_IDENTITY_CODE_DESCRIPTION \"'' || invalid_value || ''\" of GENDER_IDENTITY_CODE \"'' || dependent_value || ''\" is not matching with the GENDER_IDENTITY_CODE_DESCRIPTION of GENDER_IDENTITY_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_sexual_orientation_code_in_all_rows AS (\n    SELECT ''SEXUAL_ORIENTATION_CODE'' AS issue_column,\n           sr.\"SEXUAL_ORIENTATION_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sexual_orientation_reference ref\n      ON UPPER(sr.SEXUAL_ORIENTATION_CODE) = UPPER(ref.SEXUAL_ORIENTATION_CODE)\n     WHERE sr.SEXUAL_ORIENTATION_CODE IS NOT NULL\n      AND ref.SEXUAL_ORIENTATION_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid SEXUAL ORIENTATION CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid SEXUAL ORIENTATION CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate SEXUAL ORIENTATION CODE with sexual orientation reference data''\n      FROM valid_sexual_orientation_code_in_all_rows;\nWITH valid_sexual_orientation_description_in_all_rows AS (\n    SELECT ''SEXUAL_ORIENTATION_DESCRIPTION'' AS issue_column,\n           sr.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 sr\n      LEFT JOIN sexual_orientation_reference ref\n      ON UPPER(sr.SEXUAL_ORIENTATION_DESCRIPTION) = UPPER(ref.SEXUAL_ORIENTATION_CODE_DESCRIPTION)\n     WHERE sr.SEXUAL_ORIENTATION_DESCRIPTION IS NOT NULL\n      AND ref.SEXUAL_ORIENTATION_CODE_DESCRIPTION IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid SEXUAL ORIENTATION CODE DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid SEXUAL ORIENTATION CODE DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate SEXUAL ORIENTATION CODE DESCRIPTION with sexual orientation reference data''\n      FROM valid_sexual_orientation_description_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''SEXUAL_ORIENTATION_CODE'' AS issue_column,\n      tbl.\"SEXUAL_ORIENTATION_CODE\" AS invalid_value,\n      tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"SEXUAL_ORIENTATION_CODE\" is not null\n  and tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"SEXUAL_ORIENTATION_CODE_DESCRIPTION\" FROM sexual_orientation_reference WHERE UPPER(CAST(tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"SEXUAL_ORIENTATION_CODE_DESCRIPTION\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SEXUAL_ORIENTATION_CODE\" AS VARCHAR)) = UPPER(CAST(\"SEXUAL_ORIENTATION_CODE\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The SEXUAL_ORIENTATION_CODE \"'' || invalid_value || ''\" of SEXUAL_ORIENTATION_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the SEXUAL_ORIENTATION_CODE of SEXUAL_ORIENTATION_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''SEXUAL_ORIENTATION_DESCRIPTION'' AS issue_column,\n      tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS invalid_value,\n      tbl.\"SEXUAL_ORIENTATION_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" is not null\n  and tbl.\"SEXUAL_ORIENTATION_CODE\" is not null\n  and NOT EXISTS ( SELECT \"SEXUAL_ORIENTATION_CODE\" FROM sexual_orientation_reference WHERE UPPER(CAST(tbl.\"SEXUAL_ORIENTATION_CODE\" AS VARCHAR)) = UPPER(CAST(\"SEXUAL_ORIENTATION_CODE\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SEXUAL_ORIENTATION_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"SEXUAL_ORIENTATION_CODE_DESCRIPTION\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The SEXUAL_ORIENTATION_DESCRIPTION \"'' || invalid_value || ''\" of SEXUAL_ORIENTATION_CODE \"'' || dependent_value || ''\" is not matching with the SEXUAL_ORIENTATION_DESCRIPTION of SEXUAL_ORIENTATION_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH allowed_values AS (\n    SELECT ''SEXUAL_ORIENTATION_CODE_SYSTEM_NAME'' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" NOT IN (''SNOMED-CT'',''SNOMED'',''http://snomed.info/sct'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''SNOMED-CT'''',''''SNOMED'''',''''http://snomed.info/sct'''')'',\n           ''Use only allowed values ''''SNOMED-CT'''',''''SNOMED'''',''''http://snomed.info/sct'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_ethnicity_code_in_all_rows AS (\n    SELECT ''ETHNICITY_CODE'' AS issue_column,\n           ad.\"ETHNICITY_CODE\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN ethnicity_reference ref\n      ON UPPER(CAST(ad.\"ETHNICITY_CODE\" AS VARCHAR)) = UPPER(CAST(ref.\"Concept Code\" AS VARCHAR))\n     WHERE ad.\"ETHNICITY_CODE\" IS NOT NULL\n      AND ref.\"Concept Code\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid ETHNICITY CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ETHNICITY CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ETHNICITY CODE with ethnicity reference data''\n      FROM valid_ethnicity_code_in_all_rows;\nWITH valid_ethnicity_code_description_in_all_rows AS (\n    SELECT ''ETHNICITY_CODE_DESCRIPTION'' AS issue_column,\n           ad.\"ETHNICITY_CODE_DESCRIPTION\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN ethnicity_reference ref\n      ON UPPER(CAST(ad.\"ETHNICITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(ref.\"Concept Name\" AS VARCHAR))\n     WHERE ad.\"ETHNICITY_CODE_DESCRIPTION\" IS NOT NULL\n      AND ref.\"Concept Name\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid ETHNICITY CODE DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ETHNICITY CODE DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ETHNICITY CODE DESCRIPTION with ethnicity reference data''\n      FROM valid_ethnicity_code_description_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ETHNICITY_CODE'' AS issue_column,\n      tbl.\"ETHNICITY_CODE\" AS invalid_value,\n      tbl.\"ETHNICITY_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"ETHNICITY_CODE\" is not null\n  and tbl.\"ETHNICITY_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Concept Name\" FROM ethnicity_reference WHERE UPPER(CAST(tbl.\"ETHNICITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Concept Name\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ETHNICITY_CODE\" AS VARCHAR)) = UPPER(CAST(\"Concept Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ETHNICITY_CODE \"'' || invalid_value || ''\" of ETHNICITY_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the ETHNICITY_CODE of ETHNICITY_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ETHNICITY_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"ETHNICITY_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ETHNICITY_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"ETHNICITY_CODE_DESCRIPTION\" is not null\n  and tbl.\"ETHNICITY_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Concept Code\" FROM ethnicity_reference WHERE UPPER(CAST(tbl.\"ETHNICITY_CODE\" AS VARCHAR)) = UPPER(CAST(\"Concept Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ETHNICITY_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Concept Name\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ETHNICITY_CODE_DESCRIPTION \"'' || invalid_value || ''\" of ETHNICITY_CODE \"'' || dependent_value || ''\" is not matching with the ETHNICITY_CODE_DESCRIPTION of ETHNICITY_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_race_code_in_all_rows AS (\n    SELECT ''RACE_CODE'' AS issue_column,\n           ad.\"RACE_CODE\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN race_reference ref\n      ON UPPER(CAST(ad.\"RACE_CODE\" AS VARCHAR)) = UPPER(CAST(ref.\"Concept Code\" AS VARCHAR))\n     WHERE ad.\"RACE_CODE\" IS NOT NULL\n      AND ref.\"Concept Code\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid RACE CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid RACE CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate RACE CODE with race reference data''\n      FROM valid_race_code_in_all_rows;\nWITH valid_race_code_description_in_all_rows AS (\n    SELECT ''RACE_CODE_DESCRIPTION'' AS issue_column,\n           ad.\"RACE_CODE_DESCRIPTION\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN race_reference ref\n      ON UPPER(CAST(ad.\"RACE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(ref.\"Concept Name\" AS VARCHAR))\n     WHERE ad.\"RACE_CODE_DESCRIPTION\" IS NOT NULL\n      AND ref.\"Concept Name\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid RACE CODE DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid RACE CODE DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate RACE CODE DESCRIPTION with race reference data''\n      FROM valid_race_code_description_in_all_rows;\nWITH valid_preferred_language_code_in_all_rows AS (\n    SELECT ''PREFERRED_LANGUAGE_CODE'' AS issue_column,\n           ad.\"PREFERRED_LANGUAGE_CODE\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN preferred_language_reference ref\n      ON UPPER(CAST(ad.\"PREFERRED_LANGUAGE_CODE\" AS VARCHAR)) = UPPER(CAST(ref.\"ISO 639-2 Code\" AS VARCHAR))\n     WHERE ad.\"PREFERRED_LANGUAGE_CODE\" IS NOT NULL\n      AND ref.\"ISO 639-2 Code\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid PREFERRED LANGUAGE CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid PREFERRED LANGUAGE CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate PREFERRED LANGUAGE CODE with preferred language reference data''\n      FROM valid_preferred_language_code_in_all_rows;\nWITH valid_preferred_language_code_description_in_all_rows AS (\n    SELECT ''PREFERRED_LANGUAGE_DESCRIPTION'' AS issue_column,\n           ad.\"PREFERRED_LANGUAGE_DESCRIPTION\" AS invalid_value,\n           ad.src_file_row_number AS issue_row\n      FROM admin_demographics_20240307 ad\n      LEFT JOIN preferred_language_reference ref\n      ON UPPER(CAST(ad.\"PREFERRED_LANGUAGE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(ref.\"English name of Language\" AS VARCHAR))\n     WHERE ad.\"PREFERRED_LANGUAGE_DESCRIPTION\" IS NOT NULL\n      AND ref.\"English name of Language\" IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid PREFERRED LANGUAGE CODE DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid PREFERRED LANGUAGE CODE DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate PREFERRED LANGUAGE CODE DESCRIPTION with preferred language reference data''\n      FROM valid_preferred_language_code_description_in_all_rows;\nWITH allowed_values AS (\n    SELECT ''PREFERRED_LANGUAGE_CODE_SYSTEM_NAME'' AS issue_column,\n           \"PREFERRED_LANGUAGE_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"PREFERRED_LANGUAGE_CODE_SYSTEM_NAME\" NOT IN (''ISO'',''ISO 639-2'',''http://hl7.org/fhir/us/core/ValueSet/simple-language'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''ISO'''',''''ISO 639-2'''',''''http://hl7.org/fhir/us/core/ValueSet/simple-language'''')'',\n           ''Use only allowed values ''''ISO'''',''''ISO 639-2'''',''''http://hl7.org/fhir/us/core/ValueSet/simple-language'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''RACE_CODE'' AS issue_column,\n      tbl.\"RACE_CODE\" AS invalid_value,\n      tbl.\"RACE_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"RACE_CODE\" is not null\n  and tbl.\"RACE_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Concept Name\" FROM race_reference WHERE UPPER(CAST(tbl.\"RACE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Concept Name\" AS VARCHAR)) AND UPPER(CAST(tbl.\"RACE_CODE\" AS VARCHAR)) = UPPER(CAST(\"Concept Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The RACE_CODE \"'' || invalid_value || ''\" of RACE_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the RACE_CODE of RACE_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''PREFERRED_LANGUAGE_CODE'' AS issue_column,\n      tbl.\"PREFERRED_LANGUAGE_CODE\" AS invalid_value,\n      tbl.\"PREFERRED_LANGUAGE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"PREFERRED_LANGUAGE_CODE\" is not null\n  and tbl.\"PREFERRED_LANGUAGE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"English name of Language\" FROM preferred_language_reference WHERE UPPER(CAST(tbl.\"PREFERRED_LANGUAGE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"English name of Language\" AS VARCHAR)) AND UPPER(CAST(tbl.\"PREFERRED_LANGUAGE_CODE\" AS VARCHAR)) = UPPER(CAST(\"ISO 639-2 Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The PREFERRED_LANGUAGE_CODE \"'' || invalid_value || ''\" of PREFERRED_LANGUAGE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the PREFERRED_LANGUAGE_CODE of PREFERRED_LANGUAGE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''RACE_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"RACE_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"RACE_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM admin_demographics_20240307  tbl\n  WHERE tbl.\"RACE_CODE_DESCRIPTION\" is not null\n  and tbl.\"RACE_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Concept Code\" FROM race_reference WHERE UPPER(CAST(tbl.\"RACE_CODE\" AS VARCHAR)) = UPPER(CAST(\"Concept Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"RACE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Concept Name\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The RACE_CODE_DESCRIPTION \"'' || invalid_value || ''\" of RACE_CODE \"'' || dependent_value || ''\" is not matching with the RACE_CODE_DESCRIPTION of RACE_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH allowed_values AS (\n    SELECT ''RACE_CODE_SYSTEM_NAME'' AS issue_column,\n           \"RACE_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"RACE_CODE_SYSTEM_NAME\" NOT IN (''CDC'',''CDCRE'',''urn:oid:2.16.840.1.113883.6.238'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''CDC'''',''''CDCRE'''',''''urn:oid:2.16.840.1.113883.6.238'''')'',\n           ''Use only allowed values ''''CDC'''',''''CDCRE'''',''''urn:oid:2.16.840.1.113883.6.238'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''ETHNICITY_CODE_SYSTEM_NAME'' AS issue_column,\n           \"ETHNICITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"ETHNICITY_CODE_SYSTEM_NAME\" NOT IN (''CDC'',''CDCRE'',''urn:oid:2.16.840.1.113883.6.238'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''CDC'''',''''CDCRE'''',''''urn:oid:2.16.840.1.113883.6.238'''')'',\n           ''Use only allowed values ''''CDC'''',''''CDCRE'''',''''urn:oid:2.16.840.1.113883.6.238'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''MPI_ID'' AS issue_column,\n           \"MPI_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"MPI_ID\" IS NULL\n        OR TRIM(CAST(\"MPI_ID\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(CAST(\"PAT_MRN_ID\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_mpi_id_per_pat_mrn_id_in_all_rows AS (\n    SELECT ''MPI_ID'' AS issue_column,\n      MPI_ID AS invalid_value,\n      min(src_file_row_number) AS issue_row\n    FROM admin_demographics_20240307\n    GROUP BY MPI_ID\n    HAVING COUNT(DISTINCT PAT_MRN_ID) > 1\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid MPI_ID'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''The unique field \"'' || issue_column || ''\" \"'' || invalid_value || ''\"is not unique per PAT MRN ID'',\n           ''MPI_ID is not unique per PAT MRN ID.''\n      FROM valid_mpi_id_per_pat_mrn_id_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_ID'' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ID\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''MEDICAID_CIN'' AS issue_column,\n           \"MEDICAID_CIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE CAST(\"MEDICAID_CIN\" AS VARCHAR) NOT SIMILAR TO ''^[A-Za-z]{2}\\d{5}[A-Za-z]$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$'',\n           ''Follow the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$ in '' || issue_column\n      FROM pattern;\nWITH valid_unique_medicaid_cin_per_mrn_in_all_rows AS (\n  SELECT ''MEDICAID_CIN'' AS issue_column,\n          \"MEDICAID_CIN\" AS invalid_value,\n          min(src_file_row_number) AS issue_row\n    FROM admin_demographics_20240307\n    WHERE MEDICAID_CIN IS NOT NULL\n    GROUP BY pat_mrn_id, MEDICAID_CIN\n    HAVING COUNT(*) > 1\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Unique Medicaid Cin Per Mrn'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid Unique Medicaid Cin Per Mrn \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate Unique Medicaid Cin Per Mrn''\n      FROM valid_unique_medicaid_cin_per_mrn_in_all_rows;\nWITH valid_address1_or_medicaid_cin_in_all_rows AS (\n    SELECT ''MEDICAID_CIN'' AS issue_column,\n           MEDICAID_CIN AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM admin_demographics_20240307\n      WHERE (MEDICAID_CIN IS NULL OR TRIM(\"MEDICAID_CIN\") = '''') AND (ADDRESS1 IS NULL OR TRIM(\"ADDRESS1\") = '''')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid MEDICAID_CIN'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value MEDICAID_CIN is missing. This is required due to the absence of the ADDRESS1.''\n      FROM valid_address1_or_medicaid_cin_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''CONSENT'' AS issue_column,\n           \"CONSENT\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"CONSENT\" IS NULL\n        OR TRIM(CAST(\"CONSENT\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''CONSENT'' AS issue_column,\n           \"CONSENT\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"admin_demographics_20240307\"\n     WHERE \"CONSENT\" NOT IN (''Yes'', ''YES'', ''yes'', ''Y'', ''y'', ''No'', ''NO'', ''no'',''N'', ''n'',''Unknown'', ''UNKNOWN'', ''unknown'',''UNK'', ''Unk'', ''unk'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''YES'''', ''''yes'''', ''''Y'''', ''''y'''', ''''No'''', ''''NO'''', ''''no'''',''''N'''', ''''n'''',''''Unknown'''', ''''UNKNOWN'''', ''''unknown'''',''''UNK'''', ''''Unk'''', ''''unk'''')'',\n           ''Use only allowed values ''''Yes'''', ''''YES'''', ''''yes'''', ''''Y'''', ''''y'''', ''''No'''', ''''NO'''', ''''no'''',''''N'''', ''''n'''',''''Unknown'''', ''''UNKNOWN'''', ''''unknown'''',''''UNK'''', ''''Unk'''', ''''unk'''' in '' || issue_column\n      FROM allowed_values;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''87f8bee3-8c83-518e-865a-740b0e3a45d3'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''963ed7bf-d356-54ae-ba2a-739f7f164e1a'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''AdminDemographicCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''f6f5cc47-43d2-5134-b3d4-e6d954f3e391'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''767cb8df-3ec0-5b59-998e-a91e75be32b3'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''QeAdminDataCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(CAST(\"PAT_MRN_ID\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_ID'' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ID\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_unique_facility_id_per_facility_in_all_rows AS (\n  SELECT ''FACILITY_ID'' AS issue_column,\n    FACILITY_ID AS invalid_value,\n    min(src_file_row_number) AS issue_row\n  FROM qe_admin_data_20240307\n  GROUP BY FACILITY_ID\n  HAVING COUNT(DISTINCT FACILITY_LONG_NAME) > 1\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Invalid FACILITY_ID'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''The unique field \"'' || issue_column || ''\" \"'' || invalid_value || ''\"is not unique per facility'',\n           ''FACILITY_ID is not unique per facility.''\n      FROM valid_unique_facility_id_per_facility_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_LONG_NAME'' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_LONG_NAME\" IS NULL\n        OR TRIM(CAST(\"FACILITY_LONG_NAME\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''ORGANIZATION_TYPE'' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"ORGANIZATION_TYPE\" IS NULL\n        OR TRIM(CAST(\"ORGANIZATION_TYPE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''ORGANIZATION_TYPE'' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"ORGANIZATION_TYPE\" NOT IN (''Hospital'', ''DTC'', ''SNF'', ''SCN'', ''CBO'', ''OMH'', ''OASAS'', ''Practice'', ''Article 36'', ''Article 40'', ''MCO'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Hospital'''', ''''DTC'''', ''''SNF'''', ''''SCN'''', ''''CBO'''', ''''OMH'''', ''''OASAS'''', ''''Practice'''', ''''Article 36'''', ''''Article 40'''', ''''MCO'''')'',\n           ''Use only allowed values ''''Hospital'''', ''''DTC'''', ''''SNF'''', ''''SCN'''', ''''CBO'''', ''''OMH'''', ''''OASAS'''', ''''Practice'''', ''''Article 36'''', ''''Article 40'''', ''''MCO'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_ADDRESS1'' AS issue_column,\n           \"FACILITY_ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_ADDRESS1\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ADDRESS1\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_unique_facility_address1_per_facility_in_all_rows AS (\n  SELECT ''FACILITY_ADDRESS1'' AS issue_column,\n    FACILITY_ADDRESS1 AS invalid_value,\n    min(src_file_row_number) AS issue_row\n  FROM qe_admin_data_20240307\n  GROUP BY FACILITY_ADDRESS1\n  HAVING COUNT(DISTINCT FACILITY_LONG_NAME) > 1\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Invalid FACILITY_ADDRESS1'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''The unique field \"'' || issue_column || ''\" \"'' || invalid_value || ''\"is not unique per facility'',\n           ''FACILITY_ADDRESS1 is not unique per facility.''\n      FROM valid_unique_facility_address1_per_facility_in_all_rows;\nWITH valid_integer_alphanumeric_string_in_all_rows AS (\n  SELECT ''FACILITY_ADDRESS1'' AS issue_column,\n    t.\"FACILITY_ADDRESS1\" AS invalid_value,\n    t.src_file_row_number AS issue_row\n  FROM qe_admin_data_20240307 t\n  WHERE t.\"FACILITY_ADDRESS1\" SIMILAR TO ''[0-9]+''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Data Type Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Invalid string of numbers found''\n      FROM valid_integer_alphanumeric_string_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_STATE'' AS issue_column,\n           \"FACILITY_STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_STATE\" IS NULL\n        OR TRIM(CAST(\"FACILITY_STATE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''FACILITY_STATE'' AS issue_column,\n           \"FACILITY_STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_STATE\" NOT IN (''NY'', ''New York'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''NY'''', ''''New York'''')'',\n           ''Use only allowed values ''''NY'''', ''''New York'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_ZIP'' AS issue_column,\n           \"FACILITY_ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"FACILITY_ZIP\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ZIP\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''FACILITY_ZIP'' AS issue_column,\n           \"FACILITY_ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE CAST(\"FACILITY_ZIP\" AS VARCHAR) NOT SIMILAR TO ''^\\d{5}(\\d{4})?$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^\\d{5}(\\d{4})?$'',\n           ''Follow the pattern ^\\d{5}(\\d{4})?$ in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''VISIT_PART_2_FLAG'' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_PART_2_FLAG\" IS NULL\n        OR TRIM(CAST(\"VISIT_PART_2_FLAG\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_PART_2_FLAG'' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_PART_2_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_OMH_FLAG'' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_OMH_FLAG\" IS NULL\n        OR TRIM(CAST(\"VISIT_OMH_FLAG\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_OMH_FLAG'' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_OMH_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_OPWDD_FLAG'' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_OPWDD_FLAG\" IS NULL\n        OR TRIM(CAST(\"VISIT_OPWDD_FLAG\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_OPWDD_FLAG'' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE \"VISIT_OPWDD_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH pattern AS (\n    SELECT ''FACILITY_LONG_NAME'' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_20240307\"\n     WHERE CAST(\"FACILITY_LONG_NAME\" AS VARCHAR) NOT SIMILAR TO ''^[a-zA-Z\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''767cb8df-3ec0-5b59-998e-a91e75be32b3'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z\\s]+$ in '' || issue_column\n      FROM pattern;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7115f76c-32eb-563c-a1d5-040d0146651a'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''767cb8df-3ec0-5b59-998e-a91e75be32b3'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''QeAdminDataCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''26a2e6f5-6b62-5616-8b14-1059006f438b'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''ScreeningCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n\nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(CAST(\"PAT_MRN_ID\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_ID'' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(CAST(\"FACILITY_ID\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_pat_mrn_id_across_all_three_tables AS (\n  WITH cte_qe_demographic_unmatched AS (\n      SELECT DISTINCT COALESCE(ad.PAT_MRN_ID, qe.PAT_MRN_ID) AS PAT_MRN_ID,\n              COALESCE(ad.FACILITY_ID, qe.FACILITY_ID) AS FACILITY_ID,\n                    CASE\n                        WHEN ad.PAT_MRN_ID IS NULL THEN ''QE_ADMIN_DATA''\n                        ELSE ''ADMIN_DEMOGRAPHIC''\n                    END AS unmatched_source,\n                    COALESCE(ad.src_file_row_number, qe.src_file_row_number) AS src_file_row_number,\n      FROM  admin_demographics_20240307 ad\n      FULL OUTER JOIN qe_admin_data_20240307 qe\n          ON ad.PAT_MRN_ID = qe.PAT_MRN_ID\n          AND ad.FACILITY_ID = qe.FACILITY_ID\n      WHERE ad.PAT_MRN_ID IS NULL OR qe.PAT_MRN_ID IS NULL\n  )\n  Select ''PAT_MRN_ID'' AS issue_column, pat_mrn_id AS invalid_pat_value, FACILITY_ID AS invalid_facility_value, unmatched_source, src_file_row_number  AS issue_row,\n  case when unmatched_source = ''ADMIN_DEMOGRAPHIC'' then ''admin_demographics_20240307''\n  when unmatched_source = ''QE_ADMIN_DATA'' then ''qe_admin_data_20240307''\n  Else '''' End As issue_table_name\n  from cte_qe_demographic_unmatched\n  UNION\n  Select DISTINCT ''PAT_MRN_ID'' AS issue_column, s.PAT_MRN_ID AS invalid_pat_value,s.FACILITY_ID AS invalid_facility_value,''SCREENING'' As unmatched_source, src_file_row_number  AS issue_row,\n  ''screening_20240307'' as issue_table_name\n  FROM screening_20240307 s\n    Left Outer Join (\n      SELECT  DISTINCT a.PAT_MRN_ID,a.FACILITY_ID From admin_demographics_20240307 a\n      Inner Join qe_admin_data_20240307 q\n      ON a.PAT_MRN_ID = q.PAT_MRN_ID\n      AND a.FACILITY_ID = q.FACILITY_ID\n      WHERE a.PAT_MRN_ID IS NOT NULL AND q.PAT_MRN_ID IS NOT NULL\n    ) aq\n    ON s.PAT_MRN_ID = aq.PAT_MRN_ID\n  AND aq.FACILITY_ID = s.FACILITY_ID\n  Where aq.PAT_MRN_ID IS  NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''PAT_MRN_ID that does not match the FACILITY_ID'',\n           issue_row,\n           issue_column,\n           invalid_pat_value,\n           ''PAT_MRN_ID (\"'' || invalid_pat_value || ''\") that does not match the FACILITY_ID (\"'' || invalid_facility_value || ''\") across the files was found in \"'' || issue_table_name || ''\".'',\n           ''Validate PAT_MRN_ID that maches the FACILITY_ID across the files''\n      FROM valid_pat_mrn_id_across_all_three_tables;\nWITH mandatory_value AS (\n    SELECT ''ENCOUNTER_CLASS_CODE'' AS issue_column,\n           \"ENCOUNTER_CLASS_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_CLASS_CODE\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_CLASS_CODE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_encounter_class_in_all_rows AS (\n    SELECT ''ENCOUNTER_CLASS_CODE'' AS issue_column,\n           sr.\"ENCOUNTER_CLASS_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_class_reference ecr\n      ON UPPER(sr.ENCOUNTER_CLASS_CODE) = UPPER(ecr.Code)\n     WHERE sr.ENCOUNTER_CLASS_CODE IS NOT NULL\n      AND ecr.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ENCOUNTER CLASS CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ENCOUNTER CLASS CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ENCOUNTER CLASS CODE with encounter class reference data''\n      FROM valid_encounter_class_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ENCOUNTER_CLASS_CODE'' AS issue_column,\n      tbl.\"ENCOUNTER_CLASS_CODE\" AS invalid_value,\n      tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_CLASS_CODE\" is not null\n  and tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Display\" FROM encounter_class_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_CLASS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ENCOUNTER_CLASS_CODE \"'' || invalid_value || ''\" of ENCOUNTER_CLASS_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the ENCOUNTER_CLASS_CODE of ENCOUNTER_CLASS_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ENCOUNTER_CLASS_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ENCOUNTER_CLASS_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" is not null\n  and tbl.\"ENCOUNTER_CLASS_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Code\" FROM encounter_class_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_CLASS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ENCOUNTER_CLASS_CODE_DESCRIPTION \"'' || invalid_value || ''\" of ENCOUNTER_CLASS_CODE \"'' || dependent_value || ''\" is not matching with the ENCOUNTER_CLASS_CODE_DESCRIPTION of ENCOUNTER_CLASS_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''ENCOUNTER_CLASS_CODE_SYSTEM'' AS issue_column,\n           \"ENCOUNTER_CLASS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_CLASS_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_CLASS_CODE_SYSTEM\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''ENCOUNTER_CLASS_CODE_SYSTEM'' AS issue_column,\n           \"ENCOUNTER_CLASS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_CLASS_CODE_SYSTEM\" NOT IN (''http://terminology.hl7.org/CodeSystem/v3-ActCode'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''http://terminology.hl7.org/CodeSystem/v3-ActCode'''')'',\n           ''Use only allowed values ''''http://terminology.hl7.org/CodeSystem/v3-ActCode'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_encounter_class_in_all_rows AS (\n    SELECT ''ENCOUNTER_CLASS_CODE_DESCRIPTION'' AS issue_column,\n           sr.\"ENCOUNTER_CLASS_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_class_reference ecr\n      ON UPPER(sr.ENCOUNTER_CLASS_CODE_DESCRIPTION) = UPPER(ecr.Display)\n     WHERE sr.ENCOUNTER_CLASS_CODE_DESCRIPTION IS NOT NULL\n      AND ecr.Display IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ENCOUNTER CLASS CODE DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ENCOUNTER CLASS CODE DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ENCOUNTER CLASS CODE DESCRIPTION with encounter class reference data''\n      FROM valid_encounter_class_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''ENCOUNTER_STATUS_CODE'' AS issue_column,\n           \"ENCOUNTER_STATUS_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_STATUS_CODE\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_STATUS_CODE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_encounter_status_code_in_all_rows AS (\n    SELECT ''ENCOUNTER_STATUS_CODE'' AS issue_column,\n           sr.\"ENCOUNTER_STATUS_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_status_code_reference ecr\n      ON UPPER(sr.ENCOUNTER_STATUS_CODE) = UPPER(ecr.Code)\n     WHERE sr.ENCOUNTER_STATUS_CODE IS NOT NULL\n      AND ecr.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ENCOUNTER STATUS CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ENCOUNTER STATUS CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ENCOUNTER STATUS CODE with encounter status reference data''\n      FROM valid_encounter_status_code_in_all_rows;\nWITH valid_encounter_status_code_in_all_rows AS (\n    SELECT ''ENCOUNTER_STATUS_CODE_DESCRIPTION'' AS issue_column,\n           sr.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_status_code_reference ecr\n      ON UPPER(sr.ENCOUNTER_STATUS_CODE_DESCRIPTION) = UPPER(ecr.Display)\n     WHERE sr.ENCOUNTER_STATUS_CODE_DESCRIPTION IS NOT NULL\n      AND ecr.Display IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ENCOUNTER STATUS CODE DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ENCOUNTER STATUS CODE DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ENCOUNTER STATUS CODE DESCRIPTION with encounter status reference data''\n      FROM valid_encounter_status_code_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ENCOUNTER_STATUS_CODE'' AS issue_column,\n      tbl.\"ENCOUNTER_STATUS_CODE\" AS invalid_value,\n      tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_STATUS_CODE\" is not null\n  and tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Display\" FROM encounter_status_code_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_STATUS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ENCOUNTER_STATUS_CODE \"'' || invalid_value || ''\" of ENCOUNTER_STATUS_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the ENCOUNTER_STATUS_CODE of ENCOUNTER_STATUS_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ENCOUNTER_STATUS_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ENCOUNTER_STATUS_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" is not null\n  and tbl.\"ENCOUNTER_STATUS_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Code\" FROM encounter_status_code_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_STATUS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_STATUS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ENCOUNTER_STATUS_CODE_DESCRIPTION \"'' || invalid_value || ''\" of ENCOUNTER_STATUS_CODE \"'' || dependent_value || ''\" is not matching with the ENCOUNTER_STATUS_CODE_DESCRIPTION of ENCOUNTER_STATUS_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''ENCOUNTER_STATUS_CODE_SYSTEM'' AS issue_column,\n           \"ENCOUNTER_STATUS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_STATUS_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_STATUS_CODE_SYSTEM\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''ENCOUNTER_STATUS_CODE_SYSTEM'' AS issue_column,\n           \"ENCOUNTER_STATUS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_STATUS_CODE_SYSTEM\" NOT IN (''http://hl7.org/fhir/encounter-status'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''http://hl7.org/fhir/encounter-status'''')'',\n           ''Use only allowed values ''''http://hl7.org/fhir/encounter-status'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''ENCOUNTER_TYPE_CODE'' AS issue_column,\n           \"ENCOUNTER_TYPE_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_TYPE_CODE\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_TYPE_CODE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''ENCOUNTER_TYPE_CODE_SYSTEM'' AS issue_column,\n           \"ENCOUNTER_TYPE_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_TYPE_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"ENCOUNTER_TYPE_CODE_SYSTEM\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_encounter_type_code_in_all_rows AS (\n    SELECT ''ENCOUNTER_TYPE_CODE'' AS issue_column,\n           sr.\"ENCOUNTER_TYPE_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_type_code_reference ecr\n      ON UPPER(CAST(sr.ENCOUNTER_TYPE_CODE AS VARCHAR)) = UPPER(CAST(ecr.Code AS VARCHAR))\n     WHERE sr.ENCOUNTER_TYPE_CODE IS NOT NULL\n      AND ecr.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ENCOUNTER TYPE CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ENCOUNTER TYPE CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ENCOUNTER TYPE CODE with encounter type reference data''\n      FROM valid_encounter_type_code_in_all_rows;\nWITH allowed_values AS (\n    SELECT ''ENCOUNTER_TYPE_CODE_SYSTEM'' AS issue_column,\n           \"ENCOUNTER_TYPE_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ENCOUNTER_TYPE_CODE_SYSTEM\" NOT IN (''SNOMED-CT'', ''SNOMED'', ''http://snomed.info/sct'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''SNOMED-CT'''', ''''SNOMED'''', ''''http://snomed.info/sct'''')'',\n           ''Use only allowed values ''''SNOMED-CT'''', ''''SNOMED'''', ''''http://snomed.info/sct'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_encounter_type_code_in_all_rows AS (\n    SELECT ''ENCOUNTER_TYPE_CODE_DESCRIPTION'' AS issue_column,\n           sr.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN encounter_type_code_reference ecr\n      ON UPPER(CAST(sr.ENCOUNTER_TYPE_CODE_DESCRIPTION AS VARCHAR)) = UPPER(CAST(ecr.Display AS VARCHAR))\n     WHERE sr.ENCOUNTER_TYPE_CODE_DESCRIPTION IS NOT NULL\n      AND ecr.Display IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ENCOUNTER TYPE CODE DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ENCOUNTER TYPE CODE DESCRIPTION \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ENCOUNTER TYPE CODE DESCRIPTION with encounter type reference data''\n      FROM valid_encounter_type_code_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ENCOUNTER_TYPE_CODE'' AS issue_column,\n      tbl.\"ENCOUNTER_TYPE_CODE\" AS invalid_value,\n      tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_TYPE_CODE\" is not null\n  and tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Display\" FROM encounter_type_code_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_TYPE_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ENCOUNTER_TYPE_CODE \"'' || invalid_value || ''\" of ENCOUNTER_TYPE_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the ENCOUNTER_TYPE_CODE of ENCOUNTER_TYPE_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''ENCOUNTER_TYPE_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"ENCOUNTER_TYPE_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" is not null\n  and tbl.\"ENCOUNTER_TYPE_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Code\" FROM encounter_type_code_reference WHERE UPPER(CAST(tbl.\"ENCOUNTER_TYPE_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"ENCOUNTER_TYPE_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The ENCOUNTER_TYPE_CODE_DESCRIPTION \"'' || invalid_value || ''\" of ENCOUNTER_TYPE_CODE \"'' || dependent_value || ''\" is not matching with the ENCOUNTER_TYPE_CODE_DESCRIPTION of ENCOUNTER_TYPE_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''SCREENING_STATUS_CODE'' AS issue_column,\n           \"SCREENING_STATUS_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_STATUS_CODE\" IS NULL\n        OR TRIM(CAST(\"SCREENING_STATUS_CODE\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_screening_status_code_in_all_rows AS (\n    SELECT ''SCREENING_STATUS_CODE'' AS issue_column,\n           sr.\"SCREENING_STATUS_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN screening_status_code_reference ref\n      ON UPPER(sr.SCREENING_STATUS_CODE) = UPPER(ref.Code)\n     WHERE sr.SCREENING_STATUS_CODE IS NOT NULL\n      AND ref.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid SCREENING STATUS CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid SCREENING STATUS CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate SCREENING STATUS CODE with screening status code reference data''\n      FROM valid_screening_status_code_in_all_rows;\nWITH valid_screening_status_code_in_all_rows AS (\n    SELECT ''SCREENING_STATUS_CODE_DESCRIPTION'' AS issue_column,\n           sr.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_20240307 sr\n      LEFT JOIN screening_status_code_reference ecr\n      ON UPPER(sr.SCREENING_STATUS_CODE_DESCRIPTION) = UPPER(ecr.Display)\n     WHERE sr.SCREENING_STATUS_CODE_DESCRIPTION IS NOT NULL\n      AND ecr.Display IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid SCREENING STATUS CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid SCREENING STATUS CODE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate SCREENING STATUS CODE with screening status code reference data''\n      FROM valid_screening_status_code_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''SCREENING_STATUS_CODE'' AS issue_column,\n      tbl.\"SCREENING_STATUS_CODE\" AS invalid_value,\n      tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"SCREENING_STATUS_CODE\" is not null\n  and tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" is not null\n  and NOT EXISTS ( SELECT \"Display\" FROM screening_status_code_reference WHERE UPPER(CAST(tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SCREENING_STATUS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The SCREENING_STATUS_CODE \"'' || invalid_value || ''\" of SCREENING_STATUS_CODE_DESCRIPTION \"'' || dependent_value || ''\" is not matching with the SCREENING_STATUS_CODE of SCREENING_STATUS_CODE_DESCRIPTION in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH valid_field_combination_in_all_rows AS (\n  SELECT \t''SCREENING_STATUS_CODE_DESCRIPTION'' AS issue_column,\n      tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS invalid_value,\n      tbl.\"SCREENING_STATUS_CODE\" AS dependent_value,\n      tbl.src_file_row_number AS issue_row\n  FROM screening_20240307  tbl\n  WHERE tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" is not null\n  and tbl.\"SCREENING_STATUS_CODE\" is not null\n  and NOT EXISTS ( SELECT \"Code\" FROM screening_status_code_reference WHERE UPPER(CAST(tbl.\"SCREENING_STATUS_CODE\" AS VARCHAR)) = UPPER(CAST(\"Code\" AS VARCHAR)) AND UPPER(CAST(tbl.\"SCREENING_STATUS_CODE_DESCRIPTION\" AS VARCHAR)) = UPPER(CAST(\"Display\" AS VARCHAR)))\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Combination Not Matching'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''The SCREENING_STATUS_CODE_DESCRIPTION \"'' || invalid_value || ''\" of SCREENING_STATUS_CODE \"'' || dependent_value || ''\" is not matching with the SCREENING_STATUS_CODE_DESCRIPTION of SCREENING_STATUS_CODE in reference data''\n      FROM valid_field_combination_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''SCREENING_STATUS_CODE_SYSTEM'' AS issue_column,\n           \"SCREENING_STATUS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_STATUS_CODE_SYSTEM\" IS NULL\n        OR TRIM(CAST(\"SCREENING_STATUS_CODE_SYSTEM\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''SCREENING_STATUS_CODE_SYSTEM'' AS issue_column,\n           \"SCREENING_STATUS_CODE_SYSTEM\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_STATUS_CODE_SYSTEM\" NOT IN (''http://hl7.org/fhir/observation-status'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''http://hl7.org/fhir/observation-status'''')'',\n           ''Use only allowed values ''''http://hl7.org/fhir/observation-status'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  ''ANSWER_CODE'' AS issue_column,\n              \"ANSWER_CODE\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (ANSWER_CODE IS NULL OR TRIM(\"ANSWER_CODE\") = '''')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN (''TOTAL SAFETY SCORE'',\n            ''CALCULATED WEEKLY PHYSICAL ACTIVITY'',\n            ''CALCULATED MENTAL HEALTH SCORE'')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid value in ANSWER_CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value ANSWER_CODE is missing''\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  ''ANSWER_CODE_SYSTEM_NAME'' AS issue_column,\n              \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (ANSWER_CODE_SYSTEM_NAME IS NULL OR TRIM(\"ANSWER_CODE_SYSTEM_NAME\") = '''')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN (''TOTAL SAFETY SCORE'',\n            ''CALCULATED WEEKLY PHYSICAL ACTIVITY'',\n            ''CALCULATED MENTAL HEALTH SCORE'')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid value in ANSWER_CODE_SYSTEM_NAME'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value ANSWER_CODE_SYSTEM_NAME is missing''\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  ''QUESTION_CODE'' AS issue_column,\n              \"QUESTION_CODE\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (QUESTION_CODE IS NULL OR TRIM(\"QUESTION_CODE\") = '''')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN (''TOTAL SAFETY SCORE'',\n            ''CALCULATED WEEKLY PHYSICAL ACTIVITY'',\n            ''CALCULATED MENTAL HEALTH SCORE'')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid value in QUESTION_CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value QUESTION_CODE is missing''\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  ''QUESTION_CODE_SYSTEM_NAME'' AS issue_column,\n              \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (QUESTION_CODE_SYSTEM_NAME IS NULL OR TRIM(\"QUESTION_CODE_SYSTEM_NAME\") = '''')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN (''TOTAL SAFETY SCORE'',\n            ''CALCULATED WEEKLY PHYSICAL ACTIVITY'',\n            ''CALCULATED MENTAL HEALTH SCORE'')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid value in QUESTION_CODE_SYSTEM_NAME'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value QUESTION_CODE_SYSTEM_NAME is missing''\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  ''SCREENING_CODE_DESCRIPTION'' AS issue_column,\n              \"SCREENING_CODE_DESCRIPTION\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (SCREENING_CODE_DESCRIPTION IS NULL OR TRIM(\"SCREENING_CODE_DESCRIPTION\") = '''')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN (''TOTAL SAFETY SCORE'',\n            ''CALCULATED WEEKLY PHYSICAL ACTIVITY'',\n            ''CALCULATED MENTAL HEALTH SCORE'')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid value in SCREENING_CODE_DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value SCREENING_CODE_DESCRIPTION is missing''\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH allowed_values AS (\n    SELECT ''SCREENING_CODE_DESCRIPTION'' AS issue_column,\n           \"SCREENING_CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_CODE_DESCRIPTION\" NOT IN (''Accountable health communities (AHC) health-related social needs (HRSN) supplemental questions'',''Accountable health communities (AHC) health-related social needs screening (HRSN) tool'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Accountable health communities (AHC) health-related social needs (HRSN) supplemental questions'''',''''Accountable health communities (AHC) health-related social needs screening (HRSN) tool'''')'',\n           ''Use only allowed values ''''Accountable health communities (AHC) health-related social needs (HRSN) supplemental questions'''',''''Accountable health communities (AHC) health-related social needs screening (HRSN) tool'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  ''SCREENING_CODE_SYSTEM_NAME'' AS issue_column,\n              \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (SCREENING_CODE_SYSTEM_NAME IS NULL OR TRIM(\"SCREENING_CODE_SYSTEM_NAME\") = '''')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN (''TOTAL SAFETY SCORE'',\n            ''CALCULATED WEEKLY PHYSICAL ACTIVITY'',\n            ''CALCULATED MENTAL HEALTH SCORE'')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid value in SCREENING_CODE_SYSTEM_NAME'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value SCREENING_CODE_SYSTEM_NAME is missing''\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH valid_screening_question_answer_mandatory_values_in_all_rows AS (\n      SELECT  ''SCREENING_CODE'' AS issue_column,\n              \"SCREENING_CODE\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM screening_20240307\n        WHERE (SCREENING_CODE IS NULL OR TRIM(\"SCREENING_CODE\") = '''')\n        AND src_file_row_number\n        NOT IN(\n          Select src_file_row_number\n            FROM screening_20240307\n            Where UPPER(QUESTION_CODE_DESCRIPTION)\n            IN (''TOTAL SAFETY SCORE'',\n            ''CALCULATED WEEKLY PHYSICAL ACTIVITY'',\n            ''CALCULATED MENTAL HEALTH SCORE'')\n        )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid value in SCREENING_CODE'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field \"'' || issue_column || ''\" is empty'',\n           ''The required field value SCREENING_CODE is missing''\n      FROM valid_screening_question_answer_mandatory_values_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''QUESTION_CODE_DESCRIPTION'' AS issue_column,\n           \"QUESTION_CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"QUESTION_CODE_DESCRIPTION\" IS NULL\n        OR TRIM(CAST(\"QUESTION_CODE_DESCRIPTION\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_answer_code_in_all_rows AS (\n  SELECT ''ANSWER_CODE'' AS issue_column,\n    scr.\"ANSWER_CODE\" AS invalid_value,\n    scr.\"QUESTION_CODE\" AS invalid_question_value,\n    scr.SCREENING_CODE AS invalid_screening_value,\n    scr.src_file_row_number AS issue_row\n    FROM screening_20240307 scr\n    LEFT OUTER JOIN ahc_cross_walk crw\n      ON UPPER(scr.SCREENING_CODE) = UPPER(crw.SCREENING_CODE)\n      AND UPPER(scr.QUESTION_CODE) = UPPER(crw.QUESTION_CODE)\n      AND UPPER(scr.ANSWER_CODE) = UPPER(crw.ANSWER_CODE)\n    WHERE scr.SCREENING_CODE IS NOT NULL\n      AND scr.QUESTION_CODE IS NOT NULL\n      AND scr.ANSWER_CODE IS NOT NULL\n      AND crw.ANSWER_CODE IS NULL\n)\n\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Answer Code'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Provided Screening Code \"'' || invalid_screening_value || ''\", Question Code \"'' || invalid_question_value || ''\" and Answer Code \"'' || invalid_value || ''\" are not matching with the reference data found in '' || issue_column,\n           ''Validate Screening Code, Question Code and Answer Code with ahc cross walk reference data''\n      FROM valid_answer_code_in_all_rows;\nWITH valid_total_safety_score_in_all_rows AS (\n  WITH cte_score AS (\n    SELECT\n        SUM(crw.Score) AS cross_walk_Score,\n        SUM(\n            CASE\n                WHEN UPPER(TRIM(scr.QUESTION_CODE_DESCRIPTION)) LIKE ''%TOTAL SAFETY SCORE%'' AND TRY_CAST(scr.ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL THEN CAST(scr.ANSWER_CODE_DESCRIPTION AS INTEGER)\n                ELSE 0\n            END\n        ) AS screening_score\n    FROM\n        screening_20240307 scr\n    LEFT OUTER JOIN (\n        SELECT \tacw.SCREENING_CODE,\n              acw.QUESTION_CODE,\n              acw.ANSWER_CODE,\n              acw.QUESTION_SLNO,\n              acw.Score AS Score\n        FROM ahc_cross_walk acw\n        Where QUESTION_SLNO_REFERENCE In(\n        SELECT QUESTION_SLNO\n            FROM ahc_cross_walk\n            WHERE UPPER(TRIM(QUESTION)) LIKE ''%TOTAL SAFETY SCORE%''\n            )\n        AND acw.QUESTION_CODE = scr.QUESTION_CODE\n        AND acw.ANSWER_CODE = scr.ANSWER_CODE\n    ) AS crw ON crw.SCREENING_CODE = scr.SCREENING_CODE\n)\nSELECT \tcross_walk_Score,\n    screening_score AS invalid_value,\n    (SELECT src_file_row_number FROM screening_20240307 WHERE UPPER(TRIM(QUESTION_CODE_DESCRIPTION)) LIKE ''%TOTAL SAFETY SCORE%'') AS issue_row,\n  ''ANSWER_CODE_DESCRIPTION'' AS issue_column\nFROM cte_score\nWHERE screening_score <> cross_walk_Score\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ANSWER_CODE_DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ANSWER_CODE_DESCRIPTION for TOTAL SAFETY SCORE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ANSWER_CODE_DESCRIPTION for TOTAL SAFETY SCORE (Calculated Score)''\n      FROM valid_total_safety_score_in_all_rows;\nWITH valid_calculated_mental_health_score_in_all_rows AS (\n  SELECT ANSWER_CODE_DESCRIPTION AS issue_column,\n  SCREENING_CALCULATED_SCORE AS invalid_value,\n  SRC_FILE_ROW_NUMBER AS issue_row\n  FROM\n  (\n  SELECT Sum(crw.score) As CROSSWALK_ANSWER_SCORE,\n      (SELECT CASE WHEN TRY_CAST(ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL THEN CAST(ANSWER_CODE_DESCRIPTION AS INTEGER) ELSE 0 END AS SCREENING_CALC_SCORE\n        FROM screening_20240307 scr2\n        WHERE UPPER(scr2.QUESTION_CODE_DESCRIPTION) LIKE ''%CALCULATED MENTAL HEALTH SCORE%''\n    ) AS SCREENING_CALCULATED_SCORE,\n    (SELECT src_file_row_number FROM screening_20240307 WHERE UPPER(QUESTION_CODE_DESCRIPTION) LIKE ''%CALCULATED MENTAL HEALTH SCORE%'') AS SRC_FILE_ROW_NUMBER,\n    ''ANSWER_CODE_DESCRIPTION'' AS ANSWER_CODE_DESCRIPTION\n      FROM screening_20240307 scr\n      INNER JOIN (\n          SELECT \tacw.score As SCORE\n          FROM ahc_cross_walk acw\n          Where QUESTION_SLNO_REFERENCE In(\n          SELECT QUESTION_SLNO\n              FROM ahc_cross_walk\n              WHERE UPPER(QUESTION) LIKE ''%CALCULATED MENTAL HEALTH SCORE%''\n              )\n          AND acw.QUESTION_CODE = scr.QUESTION_CODE\n          AND acw.ANSWER_CODE  = scr.ANSWER_CODE\n      ) AS crw ON 1 = 1\n  ) As calc_fld_val\n  Where calc_fld_val.CROSSWALK_ANSWER_SCORE <> calc_fld_val.SCREENING_CALCULATED_SCORE\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ANSWER_CODE_DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ANSWER_CODE_DESCRIPTION for CALCULATED MENTAL HEALTH SCORE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ANSWER_CODE_DESCRIPTION for CALCULATED MENTAL HEALTH SCORE (Calculated Score)''\n      FROM valid_calculated_mental_health_score_in_all_rows;\nWITH valid_calculated_weekly_physical_activity_score_in_all_rows AS (\n  WITH cte_physical_activity AS (\n    SELECT\n      scr.SCREENING_CODE,\n      scr.QUESTION_CODE,\n      scr.ANSWER_CODE,\n      crw.ANSWER_VALUE,\n      scr.ANSWER_CODE_DESCRIPTION,\n      ROW_NUMBER() OVER (\n      ORDER BY scr.SCREENING_CODE) AS sequence_number\n    FROM\n      screening_20240307 scr\n    INNER JOIN (\n      SELECT\n        acw.SCREENING_CODE,\n        acw.QUESTION_CODE,\n        acw.ANSWER_CODE,\n        acw.QUESTION_SLNO,\n        CASE\n          WHEN TRY_CAST(acw.ANSWER_VALUE AS INTEGER) IS NOT NULL THEN CAST(acw.ANSWER_VALUE AS INTEGER)\n          ELSE CASE WHEN acw.ANSWER_CODE=''LA32060-8'' THEN 150 ELSE 0 END\n        END AS ANSWER_VALUE\n      FROM\n        ahc_cross_walk acw\n      Where\n        QUESTION_SLNO_REFERENCE In(\n        SELECT\n          QUESTION_SLNO\n        FROM\n          ahc_cross_walk\n        WHERE\n          UPPER(QUESTION) LIKE ''%CALCULATED PHYSICAL ACTIVITY SCORE%''\n                )\n        AND acw.QUESTION_CODE = scr.QUESTION_CODE\n        AND acw.ANSWER_CODE = scr.ANSWER_CODE\n        ) AS crw ON\n      crw.SCREENING_CODE = scr.SCREENING_CODE\n    )\n    Select \tANSWER_CODE_DESCRIPTION AS issue_column,\n        CROSSWALK_ANSWER_VALUE AS CROSSWALK_ANSWER_VALUE,\n        SCREENING_CALCULATED_VALUE AS invalid_value,\n        SRC_FILE_ROW_NUMBER AS issue_row\n    FROM\n      (\n      Select\n        t1.ANSWER_VALUE * t2.ANSWER_VALUE As CROSSWALK_ANSWER_VALUE,\n        CASE\n          WHEN TRY_CAST(t1.ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL\n            AND TRY_CAST(t2.ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL THEN\n        CAST(t1.ANSWER_CODE_DESCRIPTION AS INTEGER) * CAST(t2.ANSWER_CODE_DESCRIPTION AS INTEGER)\n          ELSE CASE WHEN t2.ANSWER_CODE=''LA32060-8'' THEN 150 * CAST(t1.ANSWER_CODE_DESCRIPTION AS INTEGER) ELSE 0 END\n          END AS SCREENING_ANSWER_VALUE,\n          Scrn_Phycical_Act_Score.SCRN_PHYSICAL_ACTIVITY_VALUE AS SCREENING_CALCULATED_VALUE,\n          (SELECT src_file_row_number FROM screening_20240307 WHERE UPPER(QUESTION_CODE_DESCRIPTION) LIKE ''%CALCULATED WEEKLY PHYSICAL ACTIVITY%'') AS SRC_FILE_ROW_NUMBER,\n          ''ANSWER_CODE_DESCRIPTION'' AS ANSWER_CODE_DESCRIPTION\n\n        from\n          cte_physical_activity t1\n        Inner Join cte_physical_activity t2\n    On\n          t1.sequence_number = 1\n          and t2.sequence_number = 2\n        Left Outer Join (\n          Select\n            CASE\n              WHEN TRY_CAST(ANSWER_CODE_DESCRIPTION AS INTEGER) IS NOT NULL THEN CAST(ANSWER_CODE_DESCRIPTION AS INTEGER)\n              ELSE 0\n            END SCRN_PHYSICAL_ACTIVITY_VALUE\n          From\n          screening_20240307 scr\n          Where\n            UPPER(scr.QUESTION_CODE_DESCRIPTION) LIKE ''%CALCULATED WEEKLY PHYSICAL ACTIVITY%'') AS Scrn_Phycical_Act_Score\n                On\n          1 = 1\n    ) As calc_fld\n    Where\n      (calc_fld.CROSSWALK_ANSWER_VALUE <> calc_fld.SCREENING_ANSWER_VALUE)\n      OR (calc_fld.SCREENING_ANSWER_VALUE <> calc_fld.SCREENING_CALCULATED_VALUE)\n      OR (calc_fld.CROSSWALK_ANSWER_VALUE <> calc_fld.SCREENING_CALCULATED_VALUE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid ANSWER_CODE_DESCRIPTION'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid ANSWER_CODE_DESCRIPTION for CALCULATED PHYSICAL ACTIVITY SCORE \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate ANSWER_CODE_DESCRIPTION for CALCULATED PHYSICAL ACTIVITY SCORE (Calculated Score)''\n      FROM valid_calculated_weekly_physical_activity_score_in_all_rows;\nWITH allowed_values AS (\n    SELECT ''SCREENING_CODE'' AS issue_column,\n           \"SCREENING_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_CODE\" NOT IN (''96777-8'', ''97023-6'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''96777-8'''', ''''97023-6'''')'',\n           ''Use only allowed values ''''96777-8'''', ''''97023-6'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''SCREENING_CODE_SYSTEM_NAME'' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" NOT IN (''LN'', ''LOINC'', ''http://loinc.org'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''', ''''LOINC'''', ''''http://loinc.org'''')'',\n           ''Use only allowed values ''''LN'''', ''''LOINC'''', ''''http://loinc.org'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''RECORDED_TIME'' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"RECORDED_TIME\" IS NULL\n        OR TRIM(CAST(\"RECORDED_TIME\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_date_time_in_all_rows AS (\n        SELECT  ''RECORDED_TIME'' AS issue_column,\n              \"RECORDED_TIME\" AS invalid_value,\n              src_file_row_number AS issue_row\n        FROM \"screening_20240307\"\n        WHERE \"RECORDED_TIME\" IS NOT NULL\n        AND \"RECORDED_TIME\" NOT SIMILAR TO ''([0-9]([0-9]([0-9][1-9]|[1-9]0)|[1-9]00)|[1-9]000)-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])T([01][0-9]|2[0-3]):[0-5][0-9]:([0-5][0-9]|60)(\\.[0-9]+)?(Z|(\\+|-)((0[0-9]|1[0-3]):[0-5][0-9]|14:00))$''\n        OR TRY_CAST(\"RECORDED_TIME\" AS TIMESTAMP) IS NULL\n  )\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Date'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid timestamp \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Please be sure to provide both a valid date and time.''\n      FROM valid_date_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''SDOH_DOMAIN'' AS issue_column,\n           \"SDOH_DOMAIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"SDOH_DOMAIN\" IS NULL\n        OR TRIM(CAST(\"SDOH_DOMAIN\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_sdoh_domain_in_all_rows AS (\n  SELECT DISTINCT scr.SDOH_DOMAIN AS invalid_value,\n    ''SDOH_DOMAIN'' AS issue_column,\n    scr.src_file_row_number AS issue_row\n  FROM screening_20240307 scr\n  LEFT JOIN ahc_cross_walk cw\n  ON UPPER(scr.SDOH_DOMAIN) = UPPER(cw.SDOH_DOMAIN)\n  WHERE cw.SDOH_DOMAIN IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid SDOH DOMAIN'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid SDOH DOMAIN \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate SDOH DOMAIN with ahc cross walk reference data''\n      FROM valid_sdoh_domain_in_all_rows;\nWITH valid_question_code_for_screening_code_in_all_rows AS (\n  SELECT DISTINCT scr.SCREENING_CODE AS issue_screening_value, scr.QUESTION_CODE AS invalid_value, ''QUESTION_CODE'' AS issue_column, scr.src_file_row_number AS issue_row\n  FROM screening_20240307 scr\n  LEFT JOIN ahc_cross_walk cw ON UPPER(scr.QUESTION_CODE) = UPPER(cw.QUESTION_CODE)\n  AND UPPER(scr.SCREENING_CODE) = UPPER(cw.SCREENING_CODE)\n  WHERE cw.QUESTION_CODE IS NULL\n  AND cw.SCREENING_CODE IS NOT NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Question Code'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid Question Code \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate Question Code with ahc cross walk reference data''\n      FROM valid_question_code_for_screening_code_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''ANSWER_CODE_DESCRIPTION'' AS issue_column,\n           \"ANSWER_CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ANSWER_CODE_DESCRIPTION\" IS NULL\n        OR TRIM(CAST(\"ANSWER_CODE_DESCRIPTION\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''QUESTION_CODE_SYSTEM_NAME'' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" NOT IN (''LN'',''LOINC'',''http://loinc.org'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''',''''LOINC'''',''''http://loinc.org'''')'',\n           ''Use only allowed values ''''LN'''',''''LOINC'''',''''http://loinc.org'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''ANSWER_CODE_SYSTEM_NAME'' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" NOT IN (''LN'',''LOINC'',''http://loinc.org'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''',''''LOINC'''',''''http://loinc.org'''')'',\n           ''Use only allowed values ''''LN'''',''''LOINC'''',''''http://loinc.org'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''POTENTIAL_NEED_INDICATED'' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" IS NULL\n        OR TRIM(CAST(\"POTENTIAL_NEED_INDICATED\" AS VARCHAR)) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''POTENTIAL_NEED_INDICATED'' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_20240307\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" NOT IN (''Yes'',''No'',''NA'',''yes'',''no'',''na'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''',''''No'''',''''NA'''',''''yes'''',''''no'''',''''na'''')'',\n           ''Use only allowed values ''''Yes'''',''''No'''',''''NA'''',''''yes'''',''''no'''',''''na'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_screening_potential_need_indicated_question_answer_values_in_all_rows AS (\n  SELECT  ''POTENTIAL_NEED_INDICATED'' AS issue_column,\n          coalesce(scr.\"POTENTIAL_NEED_INDICATED\",''NULL'') AS invalid_value,\n          scr.ANSWER_CODE AS invalid_answer_value,\n          scr.QUESTION_CODE AS invalid_question_value,\n          scr.SCREENING_CODE AS invalid_screening_value,\n          scr.src_file_row_number AS issue_row\n  FROM screening_20240307 scr\n  LEFT JOIN ahc_cross_walk acw\n    ON UPPER(scr.SCREENING_CODE) = UPPER(acw.SCREENING_CODE)\n    AND UPPER(scr.QUESTION_CODE) = UPPER(acw.QUESTION_CODE)\n    AND UPPER(scr.ANSWER_CODE) = UPPER(acw.ANSWER_CODE)\n    AND UPPER(scr.\"POTENTIAL_NEED_INDICATED\") = UPPER(acw.\"POTENTIAL_NEED_INDICATED\")\n  WHERE acw.\"POTENTIAL_NEED_INDICATED\" IS NULL\n  AND  UPPER(scr.QUESTION_CODE_DESCRIPTION)\n  NOT IN(\n    ''TOTAL SAFETY SCORE'',\n    ''CALCULATED WEEKLY PHYSICAL ACTIVITY'',\n    ''CALCULATED MENTAL HEALTH SCORE''\n  )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''52c6a395-5d83-4051-bb7c-39036f26ab29'',\n           ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'',\n           ''Invalid value in POTENTIAL_NEED_INDICATED'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Provided Potential Need Indicated \"'' || invalid_value || ''\", Screening Code \"'' || invalid_screening_value || ''\", Question Code \"'' || invalid_question_value || ''\" and Answer Code \"'' || invalid_answer_value || ''\" are not matching with the reference data found in '' || issue_column,\n           ''Validate Potential Need Indicated, Screening Code, Question Code and Answer Code with ahc cross walk reference data''\n      FROM valid_screening_potential_need_indicated_question_answer_values_in_all_rows;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''c50d9d2d-753b-5200-b2f6-e63309cf252d'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''d09ebe08-1b63-56d8-8f2b-8fff76c9828f'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''ScreeningCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''463a01b7-82ad-5633-939d-54a554d09923'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''b9aac8ec-792a-511d-8107-25bd96085898'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''AhcCrossWalkCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''98f79424-a291-554e-aa6a-17c4c39e5c81'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''b9aac8ec-792a-511d-8107-25bd96085898'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''AhcCrossWalkCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''1e8926d1-43b1-5485-9308-7addd10605ab'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''48eb0055-f06e-57f4-8019-f49266be3d22'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''EncounterClassReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''a76151ab-e619-51bb-9db7-57c686404756'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''48eb0055-f06e-57f4-8019-f49266be3d22'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''EncounterClassReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''81a8b5c0-5c79-5ff9-95d6-cfcf0749c550'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''2e9c77e9-a664-5323-83e4-e6a92cf998ab'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''EncounterStatusCodeReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''731b9b5d-fbb0-541f-93bc-11778098ab71'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''2e9c77e9-a664-5323-83e4-e6a92cf998ab'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''EncounterStatusCodeReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''2af573ce-4941-56c1-a703-f92928ad3a7d'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''4b3dd9ab-d81b-509a-9662-68dbd6d142f7'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''EncounterTypeCodeReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''8fe71cea-8904-5ba0-823d-de9955eee28d'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''4b3dd9ab-d81b-509a-9662-68dbd6d142f7'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''EncounterTypeCodeReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''b7082a36-d569-5f54-b0fe-23dfaca90466'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''1a152daa-273d-5411-88cf-84067822a8aa'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''ScreeningStatusCodeReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7d4a917b-2900-5b12-a89c-a246a342b27b'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''1a152daa-273d-5411-88cf-84067822a8aa'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''ScreeningStatusCodeReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''de2853a4-d787-5e6d-ba4c-58a0cd667eac'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''787ee7ff-3ef5-59aa-a055-659cf10b6202'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''GenderIdentityReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''51873a08-9517-54b6-982b-38b5e08677b8'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''787ee7ff-3ef5-59aa-a055-659cf10b6202'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''GenderIdentityReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''bd4d7db3-4490-5a2f-8b54-876cd96bb629'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''79f3d60e-c863-5759-8043-f122175a7cbb'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''AdministrativeSexReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''e6b6e4b0-6fdd-5d2b-a626-801aaaa4967f'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''79f3d60e-c863-5759-8043-f122175a7cbb'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''AdministrativeSexReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7b22a848-5153-5975-b74e-e9c3ea06640c'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''6c2d9879-7393-524d-9e9e-02ea961aca39'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''SexAtBirthReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''8a53e502-4b61-5596-88d5-e2e23a907935'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''6c2d9879-7393-524d-9e9e-02ea961aca39'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''SexAtBirthReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''0ab7227d-471c-5f13-9630-7f3c0c6cd120'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''2239dca2-9dd4-5c3a-91c8-2585839b9584'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''SexualOrientationReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''63af23ca-ea46-53d2-a55c-459cb2419b54'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''2239dca2-9dd4-5c3a-91c8-2585839b9584'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''SexualOrientationReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''41f3b3f2-2670-5600-96ca-a39e21943a0a'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''fc740f9e-863e-5dd1-b1a1-86d176cb549c'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''BusinessRulesReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''2bb73de9-1a11-58ac-bcda-74d30c2ace8e'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''fc740f9e-863e-5dd1-b1a1-86d176cb549c'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''BusinessRulesReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''baac722a-6a3b-5494-9df5-91e63f8c22b0'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''f98a88dc-a929-5a9b-906a-277e62c93012'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''RaceReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''312774c2-4ed4-526a-a68c-64356a89466d'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''f98a88dc-a929-5a9b-906a-277e62c93012'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''RaceReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''6cf18abf-2b0d-5ec5-9b5e-2a7e81d0bcc3'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''b0cbca95-5c20-5b2b-b589-9e832c556bc6'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''EthnicityReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''66d2dfbd-511a-58c0-9092-fd1965efbe27'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''b0cbca95-5c20-5b2b-b589-9e832c556bc6'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''EthnicityReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''905ccf58-6d99-5787-97b2-2534a35e55d6'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''3469db42-0066-5f23-9ee4-2b857bf339a4'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''PreferredLanguageReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''96ffe5ed-2b40-5e9b-8e13-a60d66430ceb'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''3469db42-0066-5f23-9ee4-2b857bf339a4'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''PreferredLanguageReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''83c7e8ef-bc1c-5726-a3f1-46ec9c63a4df'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''f19d5ebb-ea63-5b1d-b1b1-758457a2da29'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''SdohDomainReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''aae34d6f-c822-51b7-b05a-b06cb3774a0f'', ''52c6a395-5d83-4051-bb7c-39036f26ab29'', ''f19d5ebb-ea63-5b1d-b1b1-758457a2da29'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''SdohDomainReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n```\nNo STDOUT emitted by `ensureContent` (status: `0`).\n\nNo STDERR emitted by `ensureContent`.\n\n    ', NULL);;\n-- diagnostics-md-ignore-finish \"SQLPage and execution diagnostics SQL DML\"\n\nCREATE VIEW orch_session_issue_classification AS\nWITH cte_business_rule AS (\n  SELECT worksheet as worksheet,\n      field as field,\n      required as required,\n      \"Resolved by QE/QCS\" as resolved_by_qe_qcs,\n      CONCAT(\n          CASE WHEN UPPER(\"True Rejection\") = 'YES' THEN 'REJECTION' ELSE '' END,\n          CASE WHEN UPPER(\"Warning Layer\") = 'YES' THEN 'WARNING' ELSE '' END\n      ) AS record_action\n  FROM\n      \"ingestion-center\".main.business_rules\n)\n--select * from cte_business_rule\n\nSELECT\n  -- Including all other columns from 'orch_session'\n  ises.* EXCLUDE (orch_started_at, orch_finished_at),\n  -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n    -- strftime(timestamptz orch_started_at, '%Y-%m-%d %H:%M:%S') AS orch_started_at,\n    -- strftime(timestamptz orch_finished_at, '%Y-%m-%d %H:%M:%S') AS orch_finished_at,\n  -- Including all columns from 'orch_session_entry'\n  isee.* EXCLUDE (session_id),\n  -- Including all other columns from 'orch_session_issue'\n  isi.* EXCLUDE (session_id, session_entry_id),\n  CASE\n    WHEN\n        UPPER(isi.issue_type) = 'MISSING COLUMN'\n      THEN\n        'STRUCTURAL ISSUE'\n      ELSE\n        br.record_action\n    END\n  AS disposition,\n  case when UPPER(br.resolved_by_qe_qcs) = 'YES' then 'Resolved By QE/QCS' else null end AS remediation\n  FROM orch_session AS ises\n  JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n  LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id\n  --LEFT JOIN business_rules br ON isi.issue_column = br.FIELD\n  LEFT OUTER JOIN cte_business_rule br ON br.field = isi.issue_column\n  WHERE isi.orch_session_issue_id IS NOT NULL\n;\n\nATTACH 'HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/resource.sqlite.db' AS resource_db (TYPE SQLITE);\n\n-- copy relevant orchestration engine admin tables into the the attached database\nCREATE TABLE resource_db.device AS SELECT * FROM device;\nCREATE TABLE resource_db.orch_session AS SELECT * FROM orch_session;\nCREATE TABLE resource_db.orch_session_entry AS SELECT * FROM orch_session_entry;\nCREATE TABLE resource_db.orch_session_state AS SELECT * FROM orch_session_state;\nCREATE TABLE resource_db.orch_session_exec AS SELECT * FROM orch_session_exec;\nCREATE TABLE resource_db.orch_session_issue AS SELECT * FROM orch_session_issue;\nCREATE TABLE resource_db.sqlpage_files AS SELECT * FROM sqlpage_files;\n\n-- export content tables from DuckDb into the attached database (nature-dependent)\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('ee41c26e-0432-5c46-8e87-4493240aa872', '52c6a395-5d83-4051-bb7c-39036f26ab29', '963ed7bf-d356-54ae-ba2a-739f7f164e1a', 'ASSURED_CSV', 'EXIT(AdminDemographicCsvFileIngestSource)', NULL, 'AdminDemographicCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS demographic_data AS SELECT *, CAST(NULL AS VARCHAR) AS source_table FROM admin_demographics_20240307 WHERE 0=1;\nINSERT INTO demographic_data SELECT *, 'admin_demographics_20240307' AS source_table FROM admin_demographics_20240307;\n\nCREATE TABLE resource_db.admin_demographics_20240307 AS SELECT * FROM admin_demographics_20240307;\n\nCREATE TABLE IF NOT EXISTS resource_db.demographic_data AS SELECT *, CAST(NULL AS VARCHAR) AS source_table FROM admin_demographics_20240307 WHERE 0=1;\nINSERT INTO resource_db.demographic_data SELECT *, 'admin_demographics_20240307' AS source_table FROM admin_demographics_20240307;\n\n\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('e8659af4-7259-5edd-bdcc-ac0a4efd58c0', '52c6a395-5d83-4051-bb7c-39036f26ab29', '963ed7bf-d356-54ae-ba2a-739f7f164e1a', 'ATTEMPT_CSV_EXPORT', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'AdminDemographicCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('13c54df5-b695-5291-babd-c8b267e9d523', '52c6a395-5d83-4051-bb7c-39036f26ab29', '767cb8df-3ec0-5b59-998e-a91e75be32b3', 'ASSURED_CSV', 'EXIT(QeAdminDataCsvFileIngestSource)', NULL, 'QeAdminDataCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS qe_admin_data AS SELECT *, CAST(NULL AS VARCHAR) AS source_table FROM qe_admin_data_20240307 WHERE 0=1;\nINSERT INTO qe_admin_data SELECT *, 'qe_admin_data_20240307' AS source_table FROM qe_admin_data_20240307;\n\nCREATE TABLE resource_db.qe_admin_data_20240307 AS SELECT * FROM qe_admin_data_20240307;\n\nCREATE TABLE IF NOT EXISTS resource_db.qe_admin_data AS SELECT *, CAST(NULL AS VARCHAR) AS source_table FROM qe_admin_data_20240307 WHERE 0=1;\nINSERT INTO resource_db.qe_admin_data SELECT *, 'qe_admin_data_20240307' AS source_table FROM qe_admin_data_20240307;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('17ef47cc-33c1-5c18-93c5-72e549769537', '52c6a395-5d83-4051-bb7c-39036f26ab29', '767cb8df-3ec0-5b59-998e-a91e75be32b3', 'ATTEMPT_CSV_EXPORT', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'QeAdminDataCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('e9acf2a4-e063-5ece-beed-7053b11e9181', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'd09ebe08-1b63-56d8-8f2b-8fff76c9828f', 'ASSURED_CSV', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'ScreeningCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS screening AS SELECT *, CAST(NULL AS VARCHAR) AS source_table FROM screening_20240307 WHERE 0=1;\nINSERT INTO screening SELECT *, 'screening_20240307' AS source_table FROM screening_20240307;\n\nCREATE TABLE resource_db.screening_20240307 AS SELECT * FROM screening_20240307;\n\nCREATE TABLE IF NOT EXISTS resource_db.screening AS SELECT *, CAST(NULL AS VARCHAR) AS source_table FROM screening_20240307 WHERE 0=1;\nINSERT INTO resource_db.screening SELECT *, 'screening_20240307' AS source_table FROM screening_20240307;\n\n-- try sqltofhir Visual Studio Code extension for writing FHIR resources with SQL.\n-- see https://marketplace.visualstudio.com/items?itemName=arkhn.sqltofhir-vscode\nCREATE VIEW IF NOT EXISTS screening_fhir AS\n  SELECT tab_screening.PAT_MRN_ID, CONCAT(tab_demograph.FIRST_NAME,' ', tab_demograph.LAST_NAME) as display_name, json_object(\n        'resourceType', 'Observation',\n        'id', tab_screening.ENCOUNTER_ID,\n        'status', 'final',\n        'code', json_object(\n            'coding', json_array(\n                json_object(\n                    'system', tab_screening.QUESTION_CODE_SYSTEM_NAME,\n                    'code', tab_screening.QUESTION_CODE,\n                    'display', tab_screening.QUESTION_CODE_DESCRIPTION\n                )\n            )\n        ),\n        'subject', json_object(\n            'reference', 'Patient/' || tab_screening.PAT_MRN_ID,\n            'display',  CONCAT(tab_demograph.FIRST_NAME,' ', tab_demograph.LAST_NAME)\n        ),\n        'effectiveDateTime', tab_screening.RECORDED_TIME,\n        'valueString', tab_screening.ANSWER_CODE_DESCRIPTION,\n        'performer', json_array(\n            json_object(\n                'reference', 'Practitioner/' || tab_screening.session_id\n            )\n        ),\n        'context', json_object(\n            'reference', 'Encounter/' || tab_screening.ENCOUNTER_ID\n        )\n    ) AS FHIR_Observation\n  FROM screening_20240307 as tab_screening LEFT JOIN admin_demographics_20240307 as tab_demograph\n  ON tab_screening.PAT_MRN_ID = tab_demograph.PAT_MRN_ID;\n\nCREATE VIEW IF NOT EXISTS resource_db.screening_fhir AS\n  SELECT tab_screening.PAT_MRN_ID, CONCAT(tab_demograph.FIRST_NAME,' ', tab_demograph.LAST_NAME) as display_name, json_object(\n        'resourceType', 'Observation',\n        'id', tab_screening.ENCOUNTER_ID,\n        'status', 'final',\n        'code', json_object(\n            'coding', json_array(\n                json_object(\n                    'system', tab_screening.QUESTION_CODE_SYSTEM_NAME,\n                    'code', tab_screening.QUESTION_CODE,\n                    'display', tab_screening.QUESTION_CODE_DESCRIPTION\n                )\n            )\n        ),\n        'subject', json_object(\n            'reference', 'Patient/' || tab_screening.PAT_MRN_ID,\n            'display',  CONCAT(tab_demograph.FIRST_NAME,' ', tab_demograph.LAST_NAME)\n        ),\n        'effectiveDateTime', tab_screening.RECORDED_TIME,\n        'valueString', tab_screening.ANSWER_CODE_DESCRIPTION,\n        'performer', json_array(\n            json_object(\n                'reference', 'Practitioner/' || tab_screening.session_id\n            )\n        ),\n        'context', json_object(\n            'reference', 'Encounter/' || tab_screening.ENCOUNTER_ID\n        )\n    ) AS FHIR_Observation\n  FROM screening_20240307 as tab_screening LEFT JOIN admin_demographics_20240307 as tab_demograph\n  ON tab_screening.PAT_MRN_ID = tab_demograph.PAT_MRN_ID;\n\n        -- TODO: Need to fill out subject->display, source->display, questionnaire\nCREATE VIEW IF NOT EXISTS resource_db.screening_fhir_questionnaire AS\n  SELECT tab_screening.PAT_MRN_ID, CONCAT(tab_demograph.FIRST_NAME,' ', tab_demograph.LAST_NAME) as display_name, json_object(\n        'resourceType', 'QuestionnaireResponse',\n        'id', tab_screening.ENCOUNTER_ID,\n        'status', 'completed',\n        'questionnaire', '',\n        '_questionnaire', json_object(\n            'extension', json_array(\n                json_object(\n                    'url', tab_screening.QUESTION_CODE_SYSTEM_NAME,\n                    'valueString', tab_screening.QUESTION_CODE\n                )\n            )\n        ),\n        'subject', json_object(\n            'reference', 'Patient/' || tab_screening.PAT_MRN_ID,\n            'display',  CONCAT(tab_demograph.FIRST_NAME,' ', tab_demograph.LAST_NAME)\n        ),\n        'authored', tab_screening.RECORDED_TIME,\n        'source', json_object(\n            'reference', 'Patient/' || tab_screening.PAT_MRN_ID,\n            'display',  CONCAT(tab_demograph.FIRST_NAME,' ', tab_demograph.LAST_NAME)\n        ),\n        'item', json_array(\n            json_object(\n                'linkId', tab_screening.QUESTION_CODE,\n                'text', tab_screening.QUESTION_CODE_DESCRIPTION,\n                'answer',  json_array(\n                  json_object(\n                      'valueCoding', json_object(\n                        'system', 'http://loinc.org',\n                        'code', tab_screening.ANSWER_CODE,\n                        'display', tab_screening.ANSWER_CODE_DESCRIPTION\n                      )\n                  )\n                )\n            )\n        )\n    ) AS FHIR_Questionnaire\n  FROM screening_20240307 as tab_screening LEFT JOIN admin_demographics_20240307 as tab_demograph\n  ON tab_screening.PAT_MRN_ID = tab_demograph.PAT_MRN_ID;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('52d390d5-4f35-5707-857e-eb43f4b41fe5', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'd09ebe08-1b63-56d8-8f2b-8fff76c9828f', 'ATTEMPT_CSV_EXPORT', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'ScreeningCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('3c858698-491c-5134-863e-cf43cc958e87', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b9aac8ec-792a-511d-8107-25bd96085898', 'ASSURED_CSV', 'EXIT(AhcCrossWalkCsvFileIngestSource)', NULL, 'AhcCrossWalkCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.ahc_cross_walk AS SELECT * FROM ahc_cross_walk WHERE 0=1;\nINSERT INTO resource_db.ahc_cross_walk SELECT * FROM ahc_cross_walk;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('3bac5767-3a72-5522-8f53-b289c94ae153', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b9aac8ec-792a-511d-8107-25bd96085898', 'ATTEMPT_CSV_EXPORT', 'EXIT(AhcCrossWalkCsvFileIngestSource)', NULL, 'AhcCrossWalkCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('d1f279e8-6732-5bb6-9700-1c8c3d75cbfc', '52c6a395-5d83-4051-bb7c-39036f26ab29', '48eb0055-f06e-57f4-8019-f49266be3d22', 'ASSURED_CSV', 'EXIT(EncounterClassReferenceCsvFileIngestSource)', NULL, 'EncounterClassReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.encounter_class_reference AS SELECT * FROM encounter_class_reference WHERE 0=1;\nINSERT INTO resource_db.encounter_class_reference SELECT * FROM encounter_class_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('ab6a85a4-6397-5cef-a429-936f795c5f40', '52c6a395-5d83-4051-bb7c-39036f26ab29', '48eb0055-f06e-57f4-8019-f49266be3d22', 'ATTEMPT_CSV_EXPORT', 'EXIT(EncounterClassReferenceCsvFileIngestSource)', NULL, 'EncounterClassReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('e49e6abb-371b-538d-848c-5d77b42df2be', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2e9c77e9-a664-5323-83e4-e6a92cf998ab', 'ASSURED_CSV', 'EXIT(EncounterStatusCodeReferenceCsvFileIngestSource)', NULL, 'EncounterStatusCodeReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.encounter_status_code_reference AS SELECT * FROM encounter_status_code_reference WHERE 0=1;\nINSERT INTO resource_db.encounter_status_code_reference SELECT * FROM encounter_status_code_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('aa16821b-d305-58cf-9634-ccfa8b43ff4a', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2e9c77e9-a664-5323-83e4-e6a92cf998ab', 'ATTEMPT_CSV_EXPORT', 'EXIT(EncounterStatusCodeReferenceCsvFileIngestSource)', NULL, 'EncounterStatusCodeReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('24772d54-226d-50f7-91cb-cbacccfb13cc', '52c6a395-5d83-4051-bb7c-39036f26ab29', '4b3dd9ab-d81b-509a-9662-68dbd6d142f7', 'ASSURED_CSV', 'EXIT(EncounterTypeCodeReferenceCsvFileIngestSource)', NULL, 'EncounterTypeCodeReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.encounter_type_code_reference AS SELECT * FROM encounter_type_code_reference WHERE 0=1;\nINSERT INTO resource_db.encounter_type_code_reference SELECT * FROM encounter_type_code_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('4894f5a0-e42a-58d1-a1a0-68c60927e244', '52c6a395-5d83-4051-bb7c-39036f26ab29', '4b3dd9ab-d81b-509a-9662-68dbd6d142f7', 'ATTEMPT_CSV_EXPORT', 'EXIT(EncounterTypeCodeReferenceCsvFileIngestSource)', NULL, 'EncounterTypeCodeReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('108d080a-3c8d-55d0-a4b3-093d808e9425', '52c6a395-5d83-4051-bb7c-39036f26ab29', '1a152daa-273d-5411-88cf-84067822a8aa', 'ASSURED_CSV', 'EXIT(ScreeningStatusCodeReferenceCsvFileIngestSource)', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.screening_status_code_reference AS SELECT * FROM screening_status_code_reference WHERE 0=1;\nINSERT INTO resource_db.screening_status_code_reference SELECT * FROM screening_status_code_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('5d72401f-6126-5936-b487-72b814b067b4', '52c6a395-5d83-4051-bb7c-39036f26ab29', '1a152daa-273d-5411-88cf-84067822a8aa', 'ATTEMPT_CSV_EXPORT', 'EXIT(ScreeningStatusCodeReferenceCsvFileIngestSource)', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('50e2f362-b5e5-5b66-ab03-7885e3c4a94e', '52c6a395-5d83-4051-bb7c-39036f26ab29', '787ee7ff-3ef5-59aa-a055-659cf10b6202', 'ASSURED_CSV', 'EXIT(GenderIdentityReferenceCsvFileIngestSource)', NULL, 'GenderIdentityReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.gender_identity_reference AS SELECT * FROM gender_identity_reference WHERE 0=1;\nINSERT INTO resource_db.gender_identity_reference SELECT * FROM gender_identity_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('603210af-d8eb-50b0-a901-62445eff8227', '52c6a395-5d83-4051-bb7c-39036f26ab29', '787ee7ff-3ef5-59aa-a055-659cf10b6202', 'ATTEMPT_CSV_EXPORT', 'EXIT(GenderIdentityReferenceCsvFileIngestSource)', NULL, 'GenderIdentityReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('93378ce6-e53a-5f14-a6dd-68de9f44e5e6', '52c6a395-5d83-4051-bb7c-39036f26ab29', '79f3d60e-c863-5759-8043-f122175a7cbb', 'ASSURED_CSV', 'EXIT(AdministrativeSexReferenceCsvFileIngestSource)', NULL, 'AdministrativeSexReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.administrative_sex_reference AS SELECT * FROM administrative_sex_reference WHERE 0=1;\nINSERT INTO resource_db.administrative_sex_reference SELECT * FROM administrative_sex_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('11f32278-5dd7-5997-9014-9afe5f5d841b', '52c6a395-5d83-4051-bb7c-39036f26ab29', '79f3d60e-c863-5759-8043-f122175a7cbb', 'ATTEMPT_CSV_EXPORT', 'EXIT(AdministrativeSexReferenceCsvFileIngestSource)', NULL, 'AdministrativeSexReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('16182dbd-064e-5083-b5c6-fb741d8afc03', '52c6a395-5d83-4051-bb7c-39036f26ab29', '6c2d9879-7393-524d-9e9e-02ea961aca39', 'ASSURED_CSV', 'EXIT(SexAtBirthReferenceCsvFileIngestSource)', NULL, 'SexAtBirthReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.sex_at_birth_reference AS SELECT * FROM sex_at_birth_reference WHERE 0=1;\nINSERT INTO resource_db.sex_at_birth_reference SELECT * FROM sex_at_birth_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('b6058e56-de5f-50ac-9e58-cf0c98e33157', '52c6a395-5d83-4051-bb7c-39036f26ab29', '6c2d9879-7393-524d-9e9e-02ea961aca39', 'ATTEMPT_CSV_EXPORT', 'EXIT(SexAtBirthReferenceCsvFileIngestSource)', NULL, 'SexAtBirthReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('eb9733e4-31a4-545e-91d4-917dea346b56', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2239dca2-9dd4-5c3a-91c8-2585839b9584', 'ASSURED_CSV', 'EXIT(SexualOrientationReferenceCsvFileIngestSource)', NULL, 'SexualOrientationReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.sexual_orientation_reference AS SELECT * FROM sexual_orientation_reference WHERE 0=1;\nINSERT INTO resource_db.sexual_orientation_reference SELECT * FROM sexual_orientation_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('daa222d9-a8cd-5aa0-8489-812498651ca7', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2239dca2-9dd4-5c3a-91c8-2585839b9584', 'ATTEMPT_CSV_EXPORT', 'EXIT(SexualOrientationReferenceCsvFileIngestSource)', NULL, 'SexualOrientationReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('10533670-17e2-5485-8865-5bc5e8849dae', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'fc740f9e-863e-5dd1-b1a1-86d176cb549c', 'ASSURED_CSV', 'EXIT(BusinessRulesReferenceCsvFileIngestSource)', NULL, 'BusinessRulesReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.business_rules AS SELECT * FROM business_rules WHERE 0=1;\nINSERT INTO resource_db.business_rules SELECT * FROM business_rules;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('6bc40a02-418f-54d9-856e-32e10ba5d280', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'fc740f9e-863e-5dd1-b1a1-86d176cb549c', 'ATTEMPT_CSV_EXPORT', 'EXIT(BusinessRulesReferenceCsvFileIngestSource)', NULL, 'BusinessRulesReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('33878364-0076-5616-a9bb-f76f79412d48', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f98a88dc-a929-5a9b-906a-277e62c93012', 'ASSURED_CSV', 'EXIT(RaceReferenceCsvFileIngestSource)', NULL, 'RaceReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.race_reference AS SELECT * FROM race_reference WHERE 0=1;\nINSERT INTO resource_db.race_reference SELECT * FROM race_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('cac60ec5-d280-5042-a525-084f0a113be3', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f98a88dc-a929-5a9b-906a-277e62c93012', 'ATTEMPT_CSV_EXPORT', 'EXIT(RaceReferenceCsvFileIngestSource)', NULL, 'RaceReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('294f670b-cd60-579d-8a89-2e4278d859d7', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b0cbca95-5c20-5b2b-b589-9e832c556bc6', 'ASSURED_CSV', 'EXIT(EthnicityReferenceCsvFileIngestSource)', NULL, 'EthnicityReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.ethnicity_reference AS SELECT * FROM ethnicity_reference WHERE 0=1;\nINSERT INTO resource_db.ethnicity_reference SELECT * FROM ethnicity_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('c99907f4-d324-55e3-84b1-6173237c8ddd', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b0cbca95-5c20-5b2b-b589-9e832c556bc6', 'ATTEMPT_CSV_EXPORT', 'EXIT(EthnicityReferenceCsvFileIngestSource)', NULL, 'EthnicityReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('5ba09e54-ee01-59a9-a418-ad161bfe897d', '52c6a395-5d83-4051-bb7c-39036f26ab29', '3469db42-0066-5f23-9ee4-2b857bf339a4', 'ASSURED_CSV', 'EXIT(PreferredLanguageReferenceCsvFileIngestSource)', NULL, 'PreferredLanguageReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.preferred_language_reference AS SELECT * FROM preferred_language_reference WHERE 0=1;\nINSERT INTO resource_db.preferred_language_reference SELECT * FROM preferred_language_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('0a849a74-98b5-5d39-8ff2-6e844d08d68a', '52c6a395-5d83-4051-bb7c-39036f26ab29', '3469db42-0066-5f23-9ee4-2b857bf339a4', 'ATTEMPT_CSV_EXPORT', 'EXIT(PreferredLanguageReferenceCsvFileIngestSource)', NULL, 'PreferredLanguageReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('23bc7407-0e9b-5ac6-a614-4156c5fabe9c', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f19d5ebb-ea63-5b1d-b1b1-758457a2da29', 'ASSURED_CSV', 'EXIT(SdohDomainReferenceCsvFileIngestSource)', NULL, 'SdohDomainReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.sdoh_domain_reference AS SELECT * FROM sdoh_domain_reference WHERE 0=1;\nINSERT INTO resource_db.sdoh_domain_reference SELECT * FROM sdoh_domain_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('00d9e8a2-7805-5ea6-9026-1c0a4caf99ee', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f19d5ebb-ea63-5b1d-b1b1-758457a2da29', 'ATTEMPT_CSV_EXPORT', 'EXIT(SdohDomainReferenceCsvFileIngestSource)', NULL, 'SdohDomainReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  ;\n\n\nDETACH DATABASE resource_db;\n\n-- no after-finalize SQL provided","session_id":"52c6a395-5d83-4051-bb7c-39036f26ab29","narrative_md":"\n## emitResources\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('52196f78-69f4-585b-92cd-8c8ae034bd56', '52c6a395-5d83-4051-bb7c-39036f26ab29', NULL, 'NONE', 'ENTER(prepareInit)', NULL, 'rsEE.beforeCell', ('2024-05-03T10:18:41.940Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('9c7a9deb-310c-56b5-bcaf-a15c8364fd30', '52c6a395-5d83-4051-bb7c-39036f26ab29', NULL, 'EXIT(prepareInit)', 'ENTER(init)', NULL, 'rsEE.afterCell', ('2024-05-03T10:18:41.940Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('a55e9808-8c5b-5dbd-87fb-4b555db691b0', '52c6a395-5d83-4051-bb7c-39036f26ab29', NULL, 'EXIT(init)', 'ENTER(ingest)', NULL, 'rsEE.afterCell', ('2024-05-03T10:18:41.940Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('52b4baaf-8edd-5214-a0fd-5e6e3083f830', '52c6a395-5d83-4051-bb7c-39036f26ab29', NULL, 'EXIT(ingest)', 'ENTER(ensureContent)', NULL, 'rsEE.afterCell', ('2024-05-03T10:18:41.940Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('434be675-ad6c-5d22-8930-2dbef82f52a3', '52c6a395-5d83-4051-bb7c-39036f26ab29', NULL, 'EXIT(ensureContent)', 'ENTER(emitResources)', NULL, 'rsEE.afterCell', ('2024-05-03T10:18:41.940Z'), NULL);\n\n-- removed SQLPage and execution diagnostics SQL DML from diagnostics Markdown\n\nCREATE VIEW orch_session_issue_classification AS\nWITH cte_business_rule AS (\n  SELECT worksheet as worksheet,\n      field as field,\n      required as required,\n      \"Resolved by QE/QCS\" as resolved_by_qe_qcs,\n      CONCAT(\n          CASE WHEN UPPER(\"True Rejection\") = 'YES' THEN 'REJECTION' ELSE '' END,\n          CASE WHEN UPPER(\"Warning Layer\") = 'YES' THEN 'WARNING' ELSE '' END\n      ) AS record_action\n  FROM\n      \"ingestion-center\".main.business_rules\n)\n--select * from cte_business_rule\n\nSELECT\n  -- Including all other columns from 'orch_session'\n  ises.* EXCLUDE (orch_started_at, orch_finished_at),\n  -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n    -- strftime(timestamptz orch_started_at, '%Y-%m-%d %H:%M:%S') AS orch_started_at,\n    -- strftime(timestamptz orch_finished_at, '%Y-%m-%d %H:%M:%S') AS orch_finished_at,\n  -- Including all columns from 'orch_session_entry'\n  isee.* EXCLUDE (session_id),\n  -- Including all other columns from 'orch_session_issue'\n  isi.* EXCLUDE (session_id, session_entry_id),\n  CASE\n    WHEN\n        UPPER(isi.issue_type) = 'MISSING COLUMN'\n      THEN\n        'STRUCTURAL ISSUE'\n      ELSE\n        br.record_action\n    END\n  AS disposition,\n  case when UPPER(br.resolved_by_qe_qcs) = 'YES' then 'Resolved By QE/QCS' else null end AS remediation\n  FROM orch_session AS ises\n  JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n  LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id\n  --LEFT JOIN business_rules br ON isi.issue_column = br.FIELD\n  LEFT OUTER JOIN cte_business_rule br ON br.field = isi.issue_column\n  WHERE isi.orch_session_issue_id IS NOT NULL\n;\n\nATTACH 'HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/resource.sqlite.db' AS resource_db (TYPE SQLITE);\n\n-- copy relevant orchestration engine admin tables into the the attached database\nCREATE TABLE resource_db.device AS SELECT * FROM device;\nCREATE TABLE resource_db.orch_session AS SELECT * FROM orch_session;\nCREATE TABLE resource_db.orch_session_entry AS SELECT * FROM orch_session_entry;\nCREATE TABLE resource_db.orch_session_state AS SELECT * FROM orch_session_state;\nCREATE TABLE resource_db.orch_session_exec AS SELECT * FROM orch_session_exec;\nCREATE TABLE resource_db.orch_session_issue AS SELECT * FROM orch_session_issue;\nCREATE TABLE resource_db.sqlpage_files AS SELECT * FROM sqlpage_files;\n\n-- export content tables from DuckDb into the attached database (nature-dependent)\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('ee41c26e-0432-5c46-8e87-4493240aa872', '52c6a395-5d83-4051-bb7c-39036f26ab29', '963ed7bf-d356-54ae-ba2a-739f7f164e1a', 'ASSURED_CSV', 'EXIT(AdminDemographicCsvFileIngestSource)', NULL, 'AdminDemographicCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS demographic_data AS SELECT *, CAST(NULL AS VARCHAR) AS source_table FROM admin_demographics_20240307 WHERE 0=1;\nINSERT INTO demographic_data SELECT *, 'admin_demographics_20240307' AS source_table FROM admin_demographics_20240307;\n\nCREATE TABLE resource_db.admin_demographics_20240307 AS SELECT * FROM admin_demographics_20240307;\n\nCREATE TABLE IF NOT EXISTS resource_db.demographic_data AS SELECT *, CAST(NULL AS VARCHAR) AS source_table FROM admin_demographics_20240307 WHERE 0=1;\nINSERT INTO resource_db.demographic_data SELECT *, 'admin_demographics_20240307' AS source_table FROM admin_demographics_20240307;\n\n\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('e8659af4-7259-5edd-bdcc-ac0a4efd58c0', '52c6a395-5d83-4051-bb7c-39036f26ab29', '963ed7bf-d356-54ae-ba2a-739f7f164e1a', 'ATTEMPT_CSV_EXPORT', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'AdminDemographicCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('13c54df5-b695-5291-babd-c8b267e9d523', '52c6a395-5d83-4051-bb7c-39036f26ab29', '767cb8df-3ec0-5b59-998e-a91e75be32b3', 'ASSURED_CSV', 'EXIT(QeAdminDataCsvFileIngestSource)', NULL, 'QeAdminDataCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS qe_admin_data AS SELECT *, CAST(NULL AS VARCHAR) AS source_table FROM qe_admin_data_20240307 WHERE 0=1;\nINSERT INTO qe_admin_data SELECT *, 'qe_admin_data_20240307' AS source_table FROM qe_admin_data_20240307;\n\nCREATE TABLE resource_db.qe_admin_data_20240307 AS SELECT * FROM qe_admin_data_20240307;\n\nCREATE TABLE IF NOT EXISTS resource_db.qe_admin_data AS SELECT *, CAST(NULL AS VARCHAR) AS source_table FROM qe_admin_data_20240307 WHERE 0=1;\nINSERT INTO resource_db.qe_admin_data SELECT *, 'qe_admin_data_20240307' AS source_table FROM qe_admin_data_20240307;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('17ef47cc-33c1-5c18-93c5-72e549769537', '52c6a395-5d83-4051-bb7c-39036f26ab29', '767cb8df-3ec0-5b59-998e-a91e75be32b3', 'ATTEMPT_CSV_EXPORT', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'QeAdminDataCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('e9acf2a4-e063-5ece-beed-7053b11e9181', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'd09ebe08-1b63-56d8-8f2b-8fff76c9828f', 'ASSURED_CSV', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'ScreeningCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS screening AS SELECT *, CAST(NULL AS VARCHAR) AS source_table FROM screening_20240307 WHERE 0=1;\nINSERT INTO screening SELECT *, 'screening_20240307' AS source_table FROM screening_20240307;\n\nCREATE TABLE resource_db.screening_20240307 AS SELECT * FROM screening_20240307;\n\nCREATE TABLE IF NOT EXISTS resource_db.screening AS SELECT *, CAST(NULL AS VARCHAR) AS source_table FROM screening_20240307 WHERE 0=1;\nINSERT INTO resource_db.screening SELECT *, 'screening_20240307' AS source_table FROM screening_20240307;\n\n-- try sqltofhir Visual Studio Code extension for writing FHIR resources with SQL.\n-- see https://marketplace.visualstudio.com/items?itemName=arkhn.sqltofhir-vscode\nCREATE VIEW IF NOT EXISTS screening_fhir AS\n  SELECT tab_screening.PAT_MRN_ID, CONCAT(tab_demograph.FIRST_NAME,' ', tab_demograph.LAST_NAME) as display_name, json_object(\n        'resourceType', 'Observation',\n        'id', tab_screening.ENCOUNTER_ID,\n        'status', 'final',\n        'code', json_object(\n            'coding', json_array(\n                json_object(\n                    'system', tab_screening.QUESTION_CODE_SYSTEM_NAME,\n                    'code', tab_screening.QUESTION_CODE,\n                    'display', tab_screening.QUESTION_CODE_DESCRIPTION\n                )\n            )\n        ),\n        'subject', json_object(\n            'reference', 'Patient/' || tab_screening.PAT_MRN_ID,\n            'display',  CONCAT(tab_demograph.FIRST_NAME,' ', tab_demograph.LAST_NAME)\n        ),\n        'effectiveDateTime', tab_screening.RECORDED_TIME,\n        'valueString', tab_screening.ANSWER_CODE_DESCRIPTION,\n        'performer', json_array(\n            json_object(\n                'reference', 'Practitioner/' || tab_screening.session_id\n            )\n        ),\n        'context', json_object(\n            'reference', 'Encounter/' || tab_screening.ENCOUNTER_ID\n        )\n    ) AS FHIR_Observation\n  FROM screening_20240307 as tab_screening LEFT JOIN admin_demographics_20240307 as tab_demograph\n  ON tab_screening.PAT_MRN_ID = tab_demograph.PAT_MRN_ID;\n\nCREATE VIEW IF NOT EXISTS resource_db.screening_fhir AS\n  SELECT tab_screening.PAT_MRN_ID, CONCAT(tab_demograph.FIRST_NAME,' ', tab_demograph.LAST_NAME) as display_name, json_object(\n        'resourceType', 'Observation',\n        'id', tab_screening.ENCOUNTER_ID,\n        'status', 'final',\n        'code', json_object(\n            'coding', json_array(\n                json_object(\n                    'system', tab_screening.QUESTION_CODE_SYSTEM_NAME,\n                    'code', tab_screening.QUESTION_CODE,\n                    'display', tab_screening.QUESTION_CODE_DESCRIPTION\n                )\n            )\n        ),\n        'subject', json_object(\n            'reference', 'Patient/' || tab_screening.PAT_MRN_ID,\n            'display',  CONCAT(tab_demograph.FIRST_NAME,' ', tab_demograph.LAST_NAME)\n        ),\n        'effectiveDateTime', tab_screening.RECORDED_TIME,\n        'valueString', tab_screening.ANSWER_CODE_DESCRIPTION,\n        'performer', json_array(\n            json_object(\n                'reference', 'Practitioner/' || tab_screening.session_id\n            )\n        ),\n        'context', json_object(\n            'reference', 'Encounter/' || tab_screening.ENCOUNTER_ID\n        )\n    ) AS FHIR_Observation\n  FROM screening_20240307 as tab_screening LEFT JOIN admin_demographics_20240307 as tab_demograph\n  ON tab_screening.PAT_MRN_ID = tab_demograph.PAT_MRN_ID;\n\n        -- TODO: Need to fill out subject->display, source->display, questionnaire\nCREATE VIEW IF NOT EXISTS resource_db.screening_fhir_questionnaire AS\n  SELECT tab_screening.PAT_MRN_ID, CONCAT(tab_demograph.FIRST_NAME,' ', tab_demograph.LAST_NAME) as display_name, json_object(\n        'resourceType', 'QuestionnaireResponse',\n        'id', tab_screening.ENCOUNTER_ID,\n        'status', 'completed',\n        'questionnaire', '',\n        '_questionnaire', json_object(\n            'extension', json_array(\n                json_object(\n                    'url', tab_screening.QUESTION_CODE_SYSTEM_NAME,\n                    'valueString', tab_screening.QUESTION_CODE\n                )\n            )\n        ),\n        'subject', json_object(\n            'reference', 'Patient/' || tab_screening.PAT_MRN_ID,\n            'display',  CONCAT(tab_demograph.FIRST_NAME,' ', tab_demograph.LAST_NAME)\n        ),\n        'authored', tab_screening.RECORDED_TIME,\n        'source', json_object(\n            'reference', 'Patient/' || tab_screening.PAT_MRN_ID,\n            'display',  CONCAT(tab_demograph.FIRST_NAME,' ', tab_demograph.LAST_NAME)\n        ),\n        'item', json_array(\n            json_object(\n                'linkId', tab_screening.QUESTION_CODE,\n                'text', tab_screening.QUESTION_CODE_DESCRIPTION,\n                'answer',  json_array(\n                  json_object(\n                      'valueCoding', json_object(\n                        'system', 'http://loinc.org',\n                        'code', tab_screening.ANSWER_CODE,\n                        'display', tab_screening.ANSWER_CODE_DESCRIPTION\n                      )\n                  )\n                )\n            )\n        )\n    ) AS FHIR_Questionnaire\n  FROM screening_20240307 as tab_screening LEFT JOIN admin_demographics_20240307 as tab_demograph\n  ON tab_screening.PAT_MRN_ID = tab_demograph.PAT_MRN_ID;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('52d390d5-4f35-5707-857e-eb43f4b41fe5', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'd09ebe08-1b63-56d8-8f2b-8fff76c9828f', 'ATTEMPT_CSV_EXPORT', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'ScreeningCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('3c858698-491c-5134-863e-cf43cc958e87', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b9aac8ec-792a-511d-8107-25bd96085898', 'ASSURED_CSV', 'EXIT(AhcCrossWalkCsvFileIngestSource)', NULL, 'AhcCrossWalkCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.ahc_cross_walk AS SELECT * FROM ahc_cross_walk WHERE 0=1;\nINSERT INTO resource_db.ahc_cross_walk SELECT * FROM ahc_cross_walk;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('3bac5767-3a72-5522-8f53-b289c94ae153', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b9aac8ec-792a-511d-8107-25bd96085898', 'ATTEMPT_CSV_EXPORT', 'EXIT(AhcCrossWalkCsvFileIngestSource)', NULL, 'AhcCrossWalkCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('d1f279e8-6732-5bb6-9700-1c8c3d75cbfc', '52c6a395-5d83-4051-bb7c-39036f26ab29', '48eb0055-f06e-57f4-8019-f49266be3d22', 'ASSURED_CSV', 'EXIT(EncounterClassReferenceCsvFileIngestSource)', NULL, 'EncounterClassReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.encounter_class_reference AS SELECT * FROM encounter_class_reference WHERE 0=1;\nINSERT INTO resource_db.encounter_class_reference SELECT * FROM encounter_class_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('ab6a85a4-6397-5cef-a429-936f795c5f40', '52c6a395-5d83-4051-bb7c-39036f26ab29', '48eb0055-f06e-57f4-8019-f49266be3d22', 'ATTEMPT_CSV_EXPORT', 'EXIT(EncounterClassReferenceCsvFileIngestSource)', NULL, 'EncounterClassReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('e49e6abb-371b-538d-848c-5d77b42df2be', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2e9c77e9-a664-5323-83e4-e6a92cf998ab', 'ASSURED_CSV', 'EXIT(EncounterStatusCodeReferenceCsvFileIngestSource)', NULL, 'EncounterStatusCodeReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.encounter_status_code_reference AS SELECT * FROM encounter_status_code_reference WHERE 0=1;\nINSERT INTO resource_db.encounter_status_code_reference SELECT * FROM encounter_status_code_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('aa16821b-d305-58cf-9634-ccfa8b43ff4a', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2e9c77e9-a664-5323-83e4-e6a92cf998ab', 'ATTEMPT_CSV_EXPORT', 'EXIT(EncounterStatusCodeReferenceCsvFileIngestSource)', NULL, 'EncounterStatusCodeReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('24772d54-226d-50f7-91cb-cbacccfb13cc', '52c6a395-5d83-4051-bb7c-39036f26ab29', '4b3dd9ab-d81b-509a-9662-68dbd6d142f7', 'ASSURED_CSV', 'EXIT(EncounterTypeCodeReferenceCsvFileIngestSource)', NULL, 'EncounterTypeCodeReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.encounter_type_code_reference AS SELECT * FROM encounter_type_code_reference WHERE 0=1;\nINSERT INTO resource_db.encounter_type_code_reference SELECT * FROM encounter_type_code_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('4894f5a0-e42a-58d1-a1a0-68c60927e244', '52c6a395-5d83-4051-bb7c-39036f26ab29', '4b3dd9ab-d81b-509a-9662-68dbd6d142f7', 'ATTEMPT_CSV_EXPORT', 'EXIT(EncounterTypeCodeReferenceCsvFileIngestSource)', NULL, 'EncounterTypeCodeReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('108d080a-3c8d-55d0-a4b3-093d808e9425', '52c6a395-5d83-4051-bb7c-39036f26ab29', '1a152daa-273d-5411-88cf-84067822a8aa', 'ASSURED_CSV', 'EXIT(ScreeningStatusCodeReferenceCsvFileIngestSource)', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.screening_status_code_reference AS SELECT * FROM screening_status_code_reference WHERE 0=1;\nINSERT INTO resource_db.screening_status_code_reference SELECT * FROM screening_status_code_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('5d72401f-6126-5936-b487-72b814b067b4', '52c6a395-5d83-4051-bb7c-39036f26ab29', '1a152daa-273d-5411-88cf-84067822a8aa', 'ATTEMPT_CSV_EXPORT', 'EXIT(ScreeningStatusCodeReferenceCsvFileIngestSource)', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('50e2f362-b5e5-5b66-ab03-7885e3c4a94e', '52c6a395-5d83-4051-bb7c-39036f26ab29', '787ee7ff-3ef5-59aa-a055-659cf10b6202', 'ASSURED_CSV', 'EXIT(GenderIdentityReferenceCsvFileIngestSource)', NULL, 'GenderIdentityReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.gender_identity_reference AS SELECT * FROM gender_identity_reference WHERE 0=1;\nINSERT INTO resource_db.gender_identity_reference SELECT * FROM gender_identity_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('603210af-d8eb-50b0-a901-62445eff8227', '52c6a395-5d83-4051-bb7c-39036f26ab29', '787ee7ff-3ef5-59aa-a055-659cf10b6202', 'ATTEMPT_CSV_EXPORT', 'EXIT(GenderIdentityReferenceCsvFileIngestSource)', NULL, 'GenderIdentityReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('93378ce6-e53a-5f14-a6dd-68de9f44e5e6', '52c6a395-5d83-4051-bb7c-39036f26ab29', '79f3d60e-c863-5759-8043-f122175a7cbb', 'ASSURED_CSV', 'EXIT(AdministrativeSexReferenceCsvFileIngestSource)', NULL, 'AdministrativeSexReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.administrative_sex_reference AS SELECT * FROM administrative_sex_reference WHERE 0=1;\nINSERT INTO resource_db.administrative_sex_reference SELECT * FROM administrative_sex_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('11f32278-5dd7-5997-9014-9afe5f5d841b', '52c6a395-5d83-4051-bb7c-39036f26ab29', '79f3d60e-c863-5759-8043-f122175a7cbb', 'ATTEMPT_CSV_EXPORT', 'EXIT(AdministrativeSexReferenceCsvFileIngestSource)', NULL, 'AdministrativeSexReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('16182dbd-064e-5083-b5c6-fb741d8afc03', '52c6a395-5d83-4051-bb7c-39036f26ab29', '6c2d9879-7393-524d-9e9e-02ea961aca39', 'ASSURED_CSV', 'EXIT(SexAtBirthReferenceCsvFileIngestSource)', NULL, 'SexAtBirthReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.sex_at_birth_reference AS SELECT * FROM sex_at_birth_reference WHERE 0=1;\nINSERT INTO resource_db.sex_at_birth_reference SELECT * FROM sex_at_birth_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('b6058e56-de5f-50ac-9e58-cf0c98e33157', '52c6a395-5d83-4051-bb7c-39036f26ab29', '6c2d9879-7393-524d-9e9e-02ea961aca39', 'ATTEMPT_CSV_EXPORT', 'EXIT(SexAtBirthReferenceCsvFileIngestSource)', NULL, 'SexAtBirthReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('eb9733e4-31a4-545e-91d4-917dea346b56', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2239dca2-9dd4-5c3a-91c8-2585839b9584', 'ASSURED_CSV', 'EXIT(SexualOrientationReferenceCsvFileIngestSource)', NULL, 'SexualOrientationReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.sexual_orientation_reference AS SELECT * FROM sexual_orientation_reference WHERE 0=1;\nINSERT INTO resource_db.sexual_orientation_reference SELECT * FROM sexual_orientation_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('daa222d9-a8cd-5aa0-8489-812498651ca7', '52c6a395-5d83-4051-bb7c-39036f26ab29', '2239dca2-9dd4-5c3a-91c8-2585839b9584', 'ATTEMPT_CSV_EXPORT', 'EXIT(SexualOrientationReferenceCsvFileIngestSource)', NULL, 'SexualOrientationReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('10533670-17e2-5485-8865-5bc5e8849dae', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'fc740f9e-863e-5dd1-b1a1-86d176cb549c', 'ASSURED_CSV', 'EXIT(BusinessRulesReferenceCsvFileIngestSource)', NULL, 'BusinessRulesReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.business_rules AS SELECT * FROM business_rules WHERE 0=1;\nINSERT INTO resource_db.business_rules SELECT * FROM business_rules;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('6bc40a02-418f-54d9-856e-32e10ba5d280', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'fc740f9e-863e-5dd1-b1a1-86d176cb549c', 'ATTEMPT_CSV_EXPORT', 'EXIT(BusinessRulesReferenceCsvFileIngestSource)', NULL, 'BusinessRulesReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('33878364-0076-5616-a9bb-f76f79412d48', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f98a88dc-a929-5a9b-906a-277e62c93012', 'ASSURED_CSV', 'EXIT(RaceReferenceCsvFileIngestSource)', NULL, 'RaceReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.race_reference AS SELECT * FROM race_reference WHERE 0=1;\nINSERT INTO resource_db.race_reference SELECT * FROM race_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('cac60ec5-d280-5042-a525-084f0a113be3', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f98a88dc-a929-5a9b-906a-277e62c93012', 'ATTEMPT_CSV_EXPORT', 'EXIT(RaceReferenceCsvFileIngestSource)', NULL, 'RaceReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('294f670b-cd60-579d-8a89-2e4278d859d7', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b0cbca95-5c20-5b2b-b589-9e832c556bc6', 'ASSURED_CSV', 'EXIT(EthnicityReferenceCsvFileIngestSource)', NULL, 'EthnicityReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.ethnicity_reference AS SELECT * FROM ethnicity_reference WHERE 0=1;\nINSERT INTO resource_db.ethnicity_reference SELECT * FROM ethnicity_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('c99907f4-d324-55e3-84b1-6173237c8ddd', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'b0cbca95-5c20-5b2b-b589-9e832c556bc6', 'ATTEMPT_CSV_EXPORT', 'EXIT(EthnicityReferenceCsvFileIngestSource)', NULL, 'EthnicityReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('5ba09e54-ee01-59a9-a418-ad161bfe897d', '52c6a395-5d83-4051-bb7c-39036f26ab29', '3469db42-0066-5f23-9ee4-2b857bf339a4', 'ASSURED_CSV', 'EXIT(PreferredLanguageReferenceCsvFileIngestSource)', NULL, 'PreferredLanguageReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.preferred_language_reference AS SELECT * FROM preferred_language_reference WHERE 0=1;\nINSERT INTO resource_db.preferred_language_reference SELECT * FROM preferred_language_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('0a849a74-98b5-5d39-8ff2-6e844d08d68a', '52c6a395-5d83-4051-bb7c-39036f26ab29', '3469db42-0066-5f23-9ee4-2b857bf339a4', 'ATTEMPT_CSV_EXPORT', 'EXIT(PreferredLanguageReferenceCsvFileIngestSource)', NULL, 'PreferredLanguageReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('23bc7407-0e9b-5ac6-a614-4156c5fabe9c', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f19d5ebb-ea63-5b1d-b1b1-758457a2da29', 'ASSURED_CSV', 'EXIT(SdohDomainReferenceCsvFileIngestSource)', NULL, 'SdohDomainReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.sdoh_domain_reference AS SELECT * FROM sdoh_domain_reference WHERE 0=1;\nINSERT INTO resource_db.sdoh_domain_reference SELECT * FROM sdoh_domain_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('00d9e8a2-7805-5ea6-9026-1c0a4caf99ee', '52c6a395-5d83-4051-bb7c-39036f26ab29', 'f19d5ebb-ea63-5b1d-b1b1-758457a2da29', 'ATTEMPT_CSV_EXPORT', 'EXIT(SdohDomainReferenceCsvFileIngestSource)', NULL, 'SdohDomainReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  ;\n\n\nDETACH DATABASE resource_db;\n\n-- no after-finalize SQL provided\n```\nNo STDOUT emitted by `emitResources` (status: `0`).\n\nNo STDERR emitted by `emitResources`.\n\n    "}},{"insertable":{"exec_identity":"jsonResult_4","exec_code":"duckdb HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.workflow/ingestion-center.duckdb --json","sql":"-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nSELECT COUNT(*) AS table_count FROM information_schema.tables WHERE table_name IN ('screening', 'demographic_data', 'qe_admin_data');\n      ","output_nature":"JSON","orch_session_exec_id":"5acd4e76-61fd-55c8-a07d-49f3a2371359","exec_nature":"duckdb","exec_status":0,"input_text":"-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nSELECT COUNT(*) AS table_count FROM information_schema.tables WHERE table_name IN ('screening', 'demographic_data', 'qe_admin_data');\n      ","output_text":"[{\"table_count\":3}]\n","session_id":"52c6a395-5d83-4051-bb7c-39036f26ab29","narrative_md":"\n## jsonResult_4\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nSELECT COUNT(*) AS table_count FROM information_schema.tables WHERE table_name IN ('screening', 'demographic_data', 'qe_admin_data');\n      \n```\n### `jsonResult_4` STDOUT (status: `0`)\n```json\n[{\"table_count\":3}]\n\n```\nNo STDERR emitted by `jsonResult_4`.\n\n    "}},{"insertable":{"exec_identity":"execute_5","exec_code":"duckdb HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.workflow/ingestion-center.duckdb","sql":"-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n\n    CREATE VIEW orch_session_fhir_emit AS\n    WITH ValidEncounters AS (\n        SELECT\n        DISTINCT (CONCAT(scr.ENCOUNTER_ID,scr.FACILITY_ID,'-',scr.PAT_MRN_ID)) AS UNIQUE_ID,\n        CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID)END AS ENCOUNTER_ID ,\n        osic.orch_session_id,\n        osic.device_id,\n        osic.version,\n        osic.orch_session_entry_id,\n        scr.PAT_MRN_ID ,\n        scr.FACILITY_ID ,\n        osic.disposition,\n        CASE\n        WHEN osic.disposition = 'REJECTION'\n        OR osic.disposition = 'STRUCTURAL ISSUE' THEN 'NO'\n        ELSE 'YES'\n        END AS FHIR_EMITTABLE\n        -- Add name of the fhir json file, session id and other ways to connect this to the proper session\n        -- Later we might actually store the fhir json in the actual column as well\n        FROM\n        orch_session_issue_classification osic\n        JOIN screening scr\n        ON\n        osic.ingest_table_name = scr.source_table\n        WHERE\n        osic.DISPOSITION IN ('REJECTION', 'STRUCTURAL ISSUE')\n\n        UNION ALL\n\n        SELECT\n        DISTINCT (CONCAT(scr.ENCOUNTER_ID,scr.FACILITY_ID,'-',scr.PAT_MRN_ID)) AS UNIQUE_ID,\n        CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID)END AS ENCOUNTER_ID ,\n        osic.orch_session_id,\n        osic.device_id,\n        osic.version,\n        osic.orch_session_entry_id,\n        qad.PAT_MRN_ID ,\n        scr.FACILITY_ID ,\n        osic.DISPOSITION,\n        CASE WHEN osic.disposition = 'REJECTION' OR osic.disposition = 'STRUCTURAL ISSUE' THEN 'NO' ELSE 'YES' END AS FHIR_EMITTABLE\n        FROM\n        orch_session_issue_classification osic\n        JOIN qe_admin_data  qad\n        ON osic.ingest_table_name = qad.source_table\n        JOIN screening scr\n        ON qad.PAT_MRN_ID = scr.PAT_MRN_ID\n        WHERE\n        osic.DISPOSITION IN ('REJECTION', 'STRUCTURAL ISSUE')\n\n        UNION ALL\n\n        SELECT\n        DISTINCT (CONCAT(scr.ENCOUNTER_ID,scr.FACILITY_ID,'-',scr.PAT_MRN_ID)) AS UNIQUE_ID,\n        CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID)END AS ENCOUNTER_ID ,\n        osic.orch_session_id,\n        osic.device_id,\n        osic.version,\n        osic.orch_session_entry_id,\n        adt.PAT_MRN_ID ,\n        scr.FACILITY_ID ,\n        osic.DISPOSITION,\n        CASE\n        WHEN osic.disposition = 'REJECTION'\n        OR osic.disposition = 'STRUCTURAL ISSUE' THEN 'NO'\n        ELSE 'YES'\n        END AS FHIR_EMITTABLE\n        FROM\n        orch_session_issue_classification osic\n        JOIN demographic_data adt\n        ON\n        osic.ingest_table_name = adt.source_table\n        JOIN screening scr\n        ON\n        adt.PAT_MRN_ID = scr.PAT_MRN_ID\n        WHERE\n        osic.DISPOSITION IN ('REJECTION', 'STRUCTURAL ISSUE')\n        ),\n        InvalidEncounters AS (\n\n        SELECT\n        DISTINCT (CONCAT(scr.ENCOUNTER_ID,scr.FACILITY_ID,'-',scr.PAT_MRN_ID)) AS UNIQUE_ID,\n        CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID)END AS ENCOUNTER_ID ,\n        osic.orch_session_id,\n        osic.device_id,\n        osic.version,\n        osic.orch_session_entry_id,\n        scr.PAT_MRN_ID ,\n        scr.FACILITY_ID ,\n        osic.disposition,\n        CASE\n        WHEN osic.disposition = 'REJECTION'\n        OR osic.disposition = 'STRUCTURAL ISSUE' THEN 'NO'\n        ELSE 'YES'\n        END AS FHIR_EMITTABLE\n        FROM\n        orch_session_issue_classification osic\n        JOIN screening scr\n        ON\n        osic.ingest_table_name = scr.source_table\n\n        WHERE\n        osic.DISPOSITION NOT IN ('REJECTION', 'STRUCTURAL ISSUE')\n\n\n        UNION ALL\n\n        SELECT\n        DISTINCT (CONCAT(scr.ENCOUNTER_ID,scr.FACILITY_ID,'-',scr.PAT_MRN_ID)) AS UNIQUE_ID,\n        CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID)END AS ENCOUNTER_ID ,\n        osic.orch_session_id,\n        osic.device_id,\n        osic.version,\n        osic.orch_session_entry_id,\n        qad.PAT_MRN_ID ,\n        scr.FACILITY_ID ,\n        osic.DISPOSITION,\n        CASE WHEN osic.disposition = 'REJECTION' OR osic.disposition = 'STRUCTURAL ISSUE' THEN 'NO' ELSE 'YES' END AS FHIR_EMITTABLE\n        FROM\n        orch_session_issue_classification osic\n        JOIN qe_admin_data  qad\n        ON osic.ingest_table_name = qad.source_table\n        JOIN screening scr\n        ON qad.PAT_MRN_ID = scr.PAT_MRN_ID\n\n        WHERE\n        osic.DISPOSITION NOT IN ('REJECTION', 'STRUCTURAL ISSUE')\n\n        UNION ALL\n\n        SELECT\n        DISTINCT (CONCAT(scr.ENCOUNTER_ID,scr.FACILITY_ID,'-',scr.PAT_MRN_ID)) AS UNIQUE_ID,\n        CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID)END AS ENCOUNTER_ID ,\n        osic.orch_session_id,\n        osic.device_id,\n        osic.version,\n        osic.orch_session_entry_id,\n        adt.PAT_MRN_ID ,\n        scr.FACILITY_ID ,\n        osic.DISPOSITION,\n        CASE\n        WHEN osic.disposition = 'REJECTION'\n        OR osic.disposition = 'STRUCTURAL ISSUE' THEN 'NO'\n        ELSE 'YES'\n        END AS FHIR_EMITTABLE\n        FROM\n        orch_session_issue_classification osic\n        JOIN demographic_data adt\n        ON\n        osic.ingest_table_name = adt.source_table\n        JOIN screening scr\n        ON\n        adt.PAT_MRN_ID = scr.PAT_MRN_ID\n        WHERE\n        osic.DISPOSITION NOT IN ('REJECTION', 'STRUCTURAL ISSUE')\n        )\n\n        SELECT\n        ENCOUNTER_ID,\n        orch_session_id AS ORCH_SESSION_ID,\n        device_id AS DEVICE_ID,\n        version AS VERSION,\n        orch_session_entry_id AS ORCH_SESSION_ENTRY_ID,\n        PAT_MRN_ID,\n        disposition AS DISPOSITION,\n        FHIR_EMITTABLE,\n        CONCAT('fhir-',PAT_MRN_ID,'-',ENCOUNTER_ID,'.json') AS FHIR_JSON_FILE\n        FROM\n        ValidEncounters\n\n        UNION ALL\n\n        SELECT\n        ENCOUNTER_ID,\n        orch_session_id AS ORCH_SESSION_ID,\n        device_id AS DEVICE_ID,\n        version AS VERSION,\n        orch_session_entry_id AS ORCH_SESSION_ENTRY_ID,\n        PAT_MRN_ID,\n        disposition AS DISPOSITION,\n        FHIR_EMITTABLE,\n        CASE WHEN FHIR_EMITTABLE='YES' THEN CONCAT('fhir-',PAT_MRN_ID,'-',ENCOUNTER_ID,'.json') ELSE '' END AS FHIR_JSON_FILE\n        FROM\n        InvalidEncounters\n        WHERE\n        ENCOUNTER_ID NOT IN (SELECT ENCOUNTER_ID FROM ValidEncounters);\n    ","orch_session_exec_id":"51cdbbad-172a-5e60-abb3-f5a1626c4b53","exec_nature":"duckdb","exec_status":0,"input_text":"-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n\n    CREATE VIEW orch_session_fhir_emit AS\n    WITH ValidEncounters AS (\n        SELECT\n        DISTINCT (CONCAT(scr.ENCOUNTER_ID,scr.FACILITY_ID,'-',scr.PAT_MRN_ID)) AS UNIQUE_ID,\n        CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID)END AS ENCOUNTER_ID ,\n        osic.orch_session_id,\n        osic.device_id,\n        osic.version,\n        osic.orch_session_entry_id,\n        scr.PAT_MRN_ID ,\n        scr.FACILITY_ID ,\n        osic.disposition,\n        CASE\n        WHEN osic.disposition = 'REJECTION'\n        OR osic.disposition = 'STRUCTURAL ISSUE' THEN 'NO'\n        ELSE 'YES'\n        END AS FHIR_EMITTABLE\n        -- Add name of the fhir json file, session id and other ways to connect this to the proper session\n        -- Later we might actually store the fhir json in the actual column as well\n        FROM\n        orch_session_issue_classification osic\n        JOIN screening scr\n        ON\n        osic.ingest_table_name = scr.source_table\n        WHERE\n        osic.DISPOSITION IN ('REJECTION', 'STRUCTURAL ISSUE')\n\n        UNION ALL\n\n        SELECT\n        DISTINCT (CONCAT(scr.ENCOUNTER_ID,scr.FACILITY_ID,'-',scr.PAT_MRN_ID)) AS UNIQUE_ID,\n        CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID)END AS ENCOUNTER_ID ,\n        osic.orch_session_id,\n        osic.device_id,\n        osic.version,\n        osic.orch_session_entry_id,\n        qad.PAT_MRN_ID ,\n        scr.FACILITY_ID ,\n        osic.DISPOSITION,\n        CASE WHEN osic.disposition = 'REJECTION' OR osic.disposition = 'STRUCTURAL ISSUE' THEN 'NO' ELSE 'YES' END AS FHIR_EMITTABLE\n        FROM\n        orch_session_issue_classification osic\n        JOIN qe_admin_data  qad\n        ON osic.ingest_table_name = qad.source_table\n        JOIN screening scr\n        ON qad.PAT_MRN_ID = scr.PAT_MRN_ID\n        WHERE\n        osic.DISPOSITION IN ('REJECTION', 'STRUCTURAL ISSUE')\n\n        UNION ALL\n\n        SELECT\n        DISTINCT (CONCAT(scr.ENCOUNTER_ID,scr.FACILITY_ID,'-',scr.PAT_MRN_ID)) AS UNIQUE_ID,\n        CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID)END AS ENCOUNTER_ID ,\n        osic.orch_session_id,\n        osic.device_id,\n        osic.version,\n        osic.orch_session_entry_id,\n        adt.PAT_MRN_ID ,\n        scr.FACILITY_ID ,\n        osic.DISPOSITION,\n        CASE\n        WHEN osic.disposition = 'REJECTION'\n        OR osic.disposition = 'STRUCTURAL ISSUE' THEN 'NO'\n        ELSE 'YES'\n        END AS FHIR_EMITTABLE\n        FROM\n        orch_session_issue_classification osic\n        JOIN demographic_data adt\n        ON\n        osic.ingest_table_name = adt.source_table\n        JOIN screening scr\n        ON\n        adt.PAT_MRN_ID = scr.PAT_MRN_ID\n        WHERE\n        osic.DISPOSITION IN ('REJECTION', 'STRUCTURAL ISSUE')\n        ),\n        InvalidEncounters AS (\n\n        SELECT\n        DISTINCT (CONCAT(scr.ENCOUNTER_ID,scr.FACILITY_ID,'-',scr.PAT_MRN_ID)) AS UNIQUE_ID,\n        CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID)END AS ENCOUNTER_ID ,\n        osic.orch_session_id,\n        osic.device_id,\n        osic.version,\n        osic.orch_session_entry_id,\n        scr.PAT_MRN_ID ,\n        scr.FACILITY_ID ,\n        osic.disposition,\n        CASE\n        WHEN osic.disposition = 'REJECTION'\n        OR osic.disposition = 'STRUCTURAL ISSUE' THEN 'NO'\n        ELSE 'YES'\n        END AS FHIR_EMITTABLE\n        FROM\n        orch_session_issue_classification osic\n        JOIN screening scr\n        ON\n        osic.ingest_table_name = scr.source_table\n\n        WHERE\n        osic.DISPOSITION NOT IN ('REJECTION', 'STRUCTURAL ISSUE')\n\n\n        UNION ALL\n\n        SELECT\n        DISTINCT (CONCAT(scr.ENCOUNTER_ID,scr.FACILITY_ID,'-',scr.PAT_MRN_ID)) AS UNIQUE_ID,\n        CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID)END AS ENCOUNTER_ID ,\n        osic.orch_session_id,\n        osic.device_id,\n        osic.version,\n        osic.orch_session_entry_id,\n        qad.PAT_MRN_ID ,\n        scr.FACILITY_ID ,\n        osic.DISPOSITION,\n        CASE WHEN osic.disposition = 'REJECTION' OR osic.disposition = 'STRUCTURAL ISSUE' THEN 'NO' ELSE 'YES' END AS FHIR_EMITTABLE\n        FROM\n        orch_session_issue_classification osic\n        JOIN qe_admin_data  qad\n        ON osic.ingest_table_name = qad.source_table\n        JOIN screening scr\n        ON qad.PAT_MRN_ID = scr.PAT_MRN_ID\n\n        WHERE\n        osic.DISPOSITION NOT IN ('REJECTION', 'STRUCTURAL ISSUE')\n\n        UNION ALL\n\n        SELECT\n        DISTINCT (CONCAT(scr.ENCOUNTER_ID,scr.FACILITY_ID,'-',scr.PAT_MRN_ID)) AS UNIQUE_ID,\n        CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID)END AS ENCOUNTER_ID ,\n        osic.orch_session_id,\n        osic.device_id,\n        osic.version,\n        osic.orch_session_entry_id,\n        adt.PAT_MRN_ID ,\n        scr.FACILITY_ID ,\n        osic.DISPOSITION,\n        CASE\n        WHEN osic.disposition = 'REJECTION'\n        OR osic.disposition = 'STRUCTURAL ISSUE' THEN 'NO'\n        ELSE 'YES'\n        END AS FHIR_EMITTABLE\n        FROM\n        orch_session_issue_classification osic\n        JOIN demographic_data adt\n        ON\n        osic.ingest_table_name = adt.source_table\n        JOIN screening scr\n        ON\n        adt.PAT_MRN_ID = scr.PAT_MRN_ID\n        WHERE\n        osic.DISPOSITION NOT IN ('REJECTION', 'STRUCTURAL ISSUE')\n        )\n\n        SELECT\n        ENCOUNTER_ID,\n        orch_session_id AS ORCH_SESSION_ID,\n        device_id AS DEVICE_ID,\n        version AS VERSION,\n        orch_session_entry_id AS ORCH_SESSION_ENTRY_ID,\n        PAT_MRN_ID,\n        disposition AS DISPOSITION,\n        FHIR_EMITTABLE,\n        CONCAT('fhir-',PAT_MRN_ID,'-',ENCOUNTER_ID,'.json') AS FHIR_JSON_FILE\n        FROM\n        ValidEncounters\n\n        UNION ALL\n\n        SELECT\n        ENCOUNTER_ID,\n        orch_session_id AS ORCH_SESSION_ID,\n        device_id AS DEVICE_ID,\n        version AS VERSION,\n        orch_session_entry_id AS ORCH_SESSION_ENTRY_ID,\n        PAT_MRN_ID,\n        disposition AS DISPOSITION,\n        FHIR_EMITTABLE,\n        CASE WHEN FHIR_EMITTABLE='YES' THEN CONCAT('fhir-',PAT_MRN_ID,'-',ENCOUNTER_ID,'.json') ELSE '' END AS FHIR_JSON_FILE\n        FROM\n        InvalidEncounters\n        WHERE\n        ENCOUNTER_ID NOT IN (SELECT ENCOUNTER_ID FROM ValidEncounters);\n    ","session_id":"52c6a395-5d83-4051-bb7c-39036f26ab29","narrative_md":"\n## execute_5\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n\n    CREATE VIEW orch_session_fhir_emit AS\n    WITH ValidEncounters AS (\n        SELECT\n        DISTINCT (CONCAT(scr.ENCOUNTER_ID,scr.FACILITY_ID,'-',scr.PAT_MRN_ID)) AS UNIQUE_ID,\n        CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID)END AS ENCOUNTER_ID ,\n        osic.orch_session_id,\n        osic.device_id,\n        osic.version,\n        osic.orch_session_entry_id,\n        scr.PAT_MRN_ID ,\n        scr.FACILITY_ID ,\n        osic.disposition,\n        CASE\n        WHEN osic.disposition = 'REJECTION'\n        OR osic.disposition = 'STRUCTURAL ISSUE' THEN 'NO'\n        ELSE 'YES'\n        END AS FHIR_EMITTABLE\n        -- Add name of the fhir json file, session id and other ways to connect this to the proper session\n        -- Later we might actually store the fhir json in the actual column as well\n        FROM\n        orch_session_issue_classification osic\n        JOIN screening scr\n        ON\n        osic.ingest_table_name = scr.source_table\n        WHERE\n        osic.DISPOSITION IN ('REJECTION', 'STRUCTURAL ISSUE')\n\n        UNION ALL\n\n        SELECT\n        DISTINCT (CONCAT(scr.ENCOUNTER_ID,scr.FACILITY_ID,'-',scr.PAT_MRN_ID)) AS UNIQUE_ID,\n        CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID)END AS ENCOUNTER_ID ,\n        osic.orch_session_id,\n        osic.device_id,\n        osic.version,\n        osic.orch_session_entry_id,\n        qad.PAT_MRN_ID ,\n        scr.FACILITY_ID ,\n        osic.DISPOSITION,\n        CASE WHEN osic.disposition = 'REJECTION' OR osic.disposition = 'STRUCTURAL ISSUE' THEN 'NO' ELSE 'YES' END AS FHIR_EMITTABLE\n        FROM\n        orch_session_issue_classification osic\n        JOIN qe_admin_data  qad\n        ON osic.ingest_table_name = qad.source_table\n        JOIN screening scr\n        ON qad.PAT_MRN_ID = scr.PAT_MRN_ID\n        WHERE\n        osic.DISPOSITION IN ('REJECTION', 'STRUCTURAL ISSUE')\n\n        UNION ALL\n\n        SELECT\n        DISTINCT (CONCAT(scr.ENCOUNTER_ID,scr.FACILITY_ID,'-',scr.PAT_MRN_ID)) AS UNIQUE_ID,\n        CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID)END AS ENCOUNTER_ID ,\n        osic.orch_session_id,\n        osic.device_id,\n        osic.version,\n        osic.orch_session_entry_id,\n        adt.PAT_MRN_ID ,\n        scr.FACILITY_ID ,\n        osic.DISPOSITION,\n        CASE\n        WHEN osic.disposition = 'REJECTION'\n        OR osic.disposition = 'STRUCTURAL ISSUE' THEN 'NO'\n        ELSE 'YES'\n        END AS FHIR_EMITTABLE\n        FROM\n        orch_session_issue_classification osic\n        JOIN demographic_data adt\n        ON\n        osic.ingest_table_name = adt.source_table\n        JOIN screening scr\n        ON\n        adt.PAT_MRN_ID = scr.PAT_MRN_ID\n        WHERE\n        osic.DISPOSITION IN ('REJECTION', 'STRUCTURAL ISSUE')\n        ),\n        InvalidEncounters AS (\n\n        SELECT\n        DISTINCT (CONCAT(scr.ENCOUNTER_ID,scr.FACILITY_ID,'-',scr.PAT_MRN_ID)) AS UNIQUE_ID,\n        CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID)END AS ENCOUNTER_ID ,\n        osic.orch_session_id,\n        osic.device_id,\n        osic.version,\n        osic.orch_session_entry_id,\n        scr.PAT_MRN_ID ,\n        scr.FACILITY_ID ,\n        osic.disposition,\n        CASE\n        WHEN osic.disposition = 'REJECTION'\n        OR osic.disposition = 'STRUCTURAL ISSUE' THEN 'NO'\n        ELSE 'YES'\n        END AS FHIR_EMITTABLE\n        FROM\n        orch_session_issue_classification osic\n        JOIN screening scr\n        ON\n        osic.ingest_table_name = scr.source_table\n\n        WHERE\n        osic.DISPOSITION NOT IN ('REJECTION', 'STRUCTURAL ISSUE')\n\n\n        UNION ALL\n\n        SELECT\n        DISTINCT (CONCAT(scr.ENCOUNTER_ID,scr.FACILITY_ID,'-',scr.PAT_MRN_ID)) AS UNIQUE_ID,\n        CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID)END AS ENCOUNTER_ID ,\n        osic.orch_session_id,\n        osic.device_id,\n        osic.version,\n        osic.orch_session_entry_id,\n        qad.PAT_MRN_ID ,\n        scr.FACILITY_ID ,\n        osic.DISPOSITION,\n        CASE WHEN osic.disposition = 'REJECTION' OR osic.disposition = 'STRUCTURAL ISSUE' THEN 'NO' ELSE 'YES' END AS FHIR_EMITTABLE\n        FROM\n        orch_session_issue_classification osic\n        JOIN qe_admin_data  qad\n        ON osic.ingest_table_name = qad.source_table\n        JOIN screening scr\n        ON qad.PAT_MRN_ID = scr.PAT_MRN_ID\n\n        WHERE\n        osic.DISPOSITION NOT IN ('REJECTION', 'STRUCTURAL ISSUE')\n\n        UNION ALL\n\n        SELECT\n        DISTINCT (CONCAT(scr.ENCOUNTER_ID,scr.FACILITY_ID,'-',scr.PAT_MRN_ID)) AS UNIQUE_ID,\n        CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID)END AS ENCOUNTER_ID ,\n        osic.orch_session_id,\n        osic.device_id,\n        osic.version,\n        osic.orch_session_entry_id,\n        adt.PAT_MRN_ID ,\n        scr.FACILITY_ID ,\n        osic.DISPOSITION,\n        CASE\n        WHEN osic.disposition = 'REJECTION'\n        OR osic.disposition = 'STRUCTURAL ISSUE' THEN 'NO'\n        ELSE 'YES'\n        END AS FHIR_EMITTABLE\n        FROM\n        orch_session_issue_classification osic\n        JOIN demographic_data adt\n        ON\n        osic.ingest_table_name = adt.source_table\n        JOIN screening scr\n        ON\n        adt.PAT_MRN_ID = scr.PAT_MRN_ID\n        WHERE\n        osic.DISPOSITION NOT IN ('REJECTION', 'STRUCTURAL ISSUE')\n        )\n\n        SELECT\n        ENCOUNTER_ID,\n        orch_session_id AS ORCH_SESSION_ID,\n        device_id AS DEVICE_ID,\n        version AS VERSION,\n        orch_session_entry_id AS ORCH_SESSION_ENTRY_ID,\n        PAT_MRN_ID,\n        disposition AS DISPOSITION,\n        FHIR_EMITTABLE,\n        CONCAT('fhir-',PAT_MRN_ID,'-',ENCOUNTER_ID,'.json') AS FHIR_JSON_FILE\n        FROM\n        ValidEncounters\n\n        UNION ALL\n\n        SELECT\n        ENCOUNTER_ID,\n        orch_session_id AS ORCH_SESSION_ID,\n        device_id AS DEVICE_ID,\n        version AS VERSION,\n        orch_session_entry_id AS ORCH_SESSION_ENTRY_ID,\n        PAT_MRN_ID,\n        disposition AS DISPOSITION,\n        FHIR_EMITTABLE,\n        CASE WHEN FHIR_EMITTABLE='YES' THEN CONCAT('fhir-',PAT_MRN_ID,'-',ENCOUNTER_ID,'.json') ELSE '' END AS FHIR_JSON_FILE\n        FROM\n        InvalidEncounters\n        WHERE\n        ENCOUNTER_ID NOT IN (SELECT ENCOUNTER_ID FROM ValidEncounters);\n    \n```\nNo STDOUT emitted by `execute_5` (status: `0`).\n\nNo STDERR emitted by `execute_5`.\n\n    "}},{"insertable":{"exec_identity":"execute_6","exec_code":"duckdb HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.workflow/ingestion-center.duckdb","sql":"-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n\n      CREATE VIEW IF NOT EXISTS fhir_bundle AS\n        WITH cte_fhir_patient AS (\n      SELECT DISTINCT ON (CONCAT(scr.ENCOUNTER_ID,scr.FACILITY_ID,'-',scr.PAT_MRN_ID)) CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID)END AS ENCOUNTER_ID,adt.pat_mrn_id,json_object('fullUrl', CONCAT(adt.FACILITY_ID,'-',adt.PAT_MRN_ID),\n        'resource', json_object(\n              'resourceType', 'Patient',\n              'id', CONCAT(adt.FACILITY_ID,'-',adt.PAT_MRN_ID),\n              'meta', json_object(\n                'lastUpdated',(SELECT MAX(scr.RECORDED_TIME) FROM screening scr WHERE adt.FACILITY_ID = scr.FACILITY_ID),\n                'profile', json_array('http://shinny.org/StructureDefinition/shinny-patient')\n              ),\n              CASE WHEN PREFERRED_LANGUAGE_CODE IS NOT NULL THEN 'language' ELSE NULL END, PREFERRED_LANGUAGE_CODE,\n              CASE WHEN (RACE_CODE_SYSTEM_NAME IS NOT NULL AND RACE_CODE IS NOT NULL AND RACE_CODE_DESCRIPTION IS NOT NULL) OR (ETHNICITY_CODE_SYSTEM_NAME IS NOT NULL AND ETHNICITY_CODE IS NOT NULL AND ETHNICITY_CODE_DESCRIPTION IS NOT NULL) OR (SEX_AT_BIRTH_CODE_SYSTEM IS NOT NULL AND SEX_AT_BIRTH_CODE IS NOT NULL AND SEX_AT_BIRTH_CODE_DESCRIPTION IS NOT NULL) THEN 'extension' ELSE NULL END, json_array(\n                              CASE WHEN RACE_CODE_SYSTEM_NAME IS NOT NULL AND RACE_CODE IS NOT NULL AND RACE_CODE_DESCRIPTION IS NOT NULL THEN json_object(\n                                  'extension', json_array(\n                                                json_object(\n                                                    'url','ombCategory',\n                                                    'valueCoding',json_object(\n                                                                'system',RACE_CODE_SYSTEM_NAME,\n                                                                'code',CAST(RACE_CODE AS TEXT),\n                                                                'display',RACE_CODE_DESCRIPTION\n                                                                )\n                                                            )\n                                            ),\n                                  'url', 'http://hl7.org/fhir/us/core/StructureDefinition/us-core-race'\n                                ) END,\n                                CASE WHEN ETHNICITY_CODE_SYSTEM_NAME IS NOT NULL AND ETHNICITY_CODE IS NOT NULL AND ETHNICITY_CODE_DESCRIPTION IS NOT NULL THEN json_object(\n                                  'extension',json_array(\n                                                json_object(\n                                                    'url','ombCategory',\n                                                    'valueCoding',json_object(\n                                                                  'system',ETHNICITY_CODE_SYSTEM_NAME,\n                                                                  'code',CAST(ETHNICITY_CODE AS TEXT),\n                                                                  'display',ETHNICITY_CODE_DESCRIPTION\n                                                                  )\n                                                            )\n                                          ),\n                                    'url', 'http://hl7.org/fhir/us/core/StructureDefinition/us-core-ethnicity'\n                              ) END,\n                              CASE WHEN SEX_AT_BIRTH_CODE_SYSTEM IS NOT NULL AND SEX_AT_BIRTH_CODE IS NOT NULL AND SEX_AT_BIRTH_CODE_DESCRIPTION IS NOT NULL THEN json_object(\n                                      'url','http://hl7.org/fhir/us/core/StructureDefinition/us-core-birthsex',\n                                      'valueCode',CAST(SEX_AT_BIRTH_CODE AS TEXT)\n\n                            ) END,\n                              CASE WHEN SEXUAL_ORIENTATION_CODE_SYSTEM_NAME IS NOT NULL AND SEXUAL_ORIENTATION_CODE IS NOT NULL AND SEXUAL_ORIENTATION_DESCRIPTION IS NOT NULL THEN json_object(\n                                      'url','http://shinny.org/StructureDefinition/shinny-sexual-orientation',\n                                      'valueCodeableConcept',json_object('coding', json_array(json_object(\n                                                    'system',SEXUAL_ORIENTATION_CODE_SYSTEM_NAME,\n                                                    'code',SEXUAL_ORIENTATION_CODE,\n                                                    'display',SEXUAL_ORIENTATION_DESCRIPTION\n                                                    )))\n\n                            ) END),\n              'identifier', json_array(\n                              json_object(\n                                  'type', json_object(\n                                      'coding', json_array(json_object('system', 'http://terminology.hl7.org/CodeSystem/v2-0203', 'code', 'MR')),\n                                      'text', 'Medical Record Number'\n                                  ),\n                                  'system', CONCAT('/facility/',adt.FACILITY_ID),\n                                  'value', qat.PAT_MRN_ID,\n                                  'assigner', json_object('reference', 'Organization/' || qat.FACILITY_ID)\n                              ),\n                              CASE\n                                  WHEN MEDICAID_CIN != '' THEN\n                                      json_object(\n                                          'type', json_object(\n                                              'coding', json_array(json_object('system', 'http://terminology.hl7.org/CodeSystem/v2-0203', 'code', 'MA'))\n                                          ),\n                                          'system', 'http://www.medicaid.gov/',\n                                          'value', MEDICAID_CIN,\n                                          'assigner', json_object('reference', 'Organization/2.16.840.1.113883.3.249')\n                                      )\n                                  ELSE NULL\n                              END,\n                              CASE\n                                  WHEN adt.MPI_ID IS NOT NULL THEN\n                                      json_object(\n                                          'type', json_object(\n                                              'coding', json_array(json_object('system', 'http://terminology.hl7.org/CodeSystem/v2-0203', 'code', 'PN'))\n                                          ),\n                                          'system', 'http://www.acme.com/identifiers/patient',\n                                          'value', CAST(adt.MPI_ID AS TEXT)\n                                      )\n                                  ELSE NULL\n                              END\n                          ),\n              CASE WHEN FIRST_NAME IS NOT NULL THEN 'name' ELSE NULL END, json_array(json_object(\n                CASE WHEN FIRST_NAME IS NOT NULL THEN 'text' ELSE NULL END, CONCAT(FIRST_NAME,' ', MIDDLE_NAME,' ', LAST_NAME),\n                CASE WHEN LAST_NAME IS NOT NULL THEN 'family' ELSE NULL END, LAST_NAME,\n                'given', json_array(FIRST_NAME,CASE WHEN MIDDLE_NAME IS NOT NULL THEN MIDDLE_NAME END))\n              ),\n              CASE WHEN ADMINISTRATIVE_SEX_CODE IS NOT NULL THEN 'gender' ELSE NULL END, ADMINISTRATIVE_SEX_CODE,\n              CASE WHEN PAT_BIRTH_DATE IS NOT NULL THEN 'birthDate' ELSE NULL END, PAT_BIRTH_DATE,\n              CASE WHEN CITY IS NOT NULL AND CITY != '' IS NOT NULL AND STATE IS NOT NULL AND STATE != '' THEN 'address' ELSE NULL END, json_array(\n                  json_object(\n                    CASE WHEN ADDRESS1 IS NOT NULL AND ADDRESS1 != '' IS NOT NULL THEN 'text' ELSE NULL END, CONCAT(ADDRESS1, ' ', ADDRESS2),\n                    CASE WHEN ADDRESS1 IS NOT NULL AND ADDRESS1 != '' IS NOT NULL THEN 'line' ELSE NULL END, json_array(ADDRESS1, ADDRESS2),\n                    'city', CITY,\n                    'state', STATE,\n                    CASE WHEN ZIP IS NOT NULL AND CAST(ZIP AS TEXT) != '' IS NOT NULL THEN 'postalCode' ELSE NULL END, CAST(ZIP AS TEXT)\n                )\n              ),\n              CASE WHEN PREFERRED_LANGUAGE_CODE IS NOT NULL THEN 'communication' ELSE NULL END, json_array(\n                json_object('language', json_object(\n                  'coding', json_array(\n                    json_object(\n                      'code', PREFERRED_LANGUAGE_CODE\n                    )\n                  )\n                ),\n                  'preferred', true\n              ))\n        )) AS FHIR_Patient\n    FROM demographic_data adt LEFT JOIN qe_admin_data qat\n    ON adt.PAT_MRN_ID = qat.PAT_MRN_ID LEFT JOIN screening scr ON scr.PAT_MRN_ID = adt.PAT_MRN_ID\n    WHERE adt.PAT_MRN_ID IS NOT NULL AND  qat.PAT_MRN_ID IS NOT NULL AND scr.PAT_MRN_ID IS NOT NULL\n    ),\n        cte_fhir_consent AS (\n      SELECT DISTINCT ON (CONCAT(scr.ENCOUNTER_ID,scr.FACILITY_ID,'-',scr.PAT_MRN_ID)) CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID) END AS ENCOUNTER_ID,adt.pat_mrn_id,json_object('fullUrl', CONCAT('consentFor',adt.PAT_MRN_ID),\n        'resource', json_object(\n              'resourceType', 'Consent',\n              'id', CONCAT('consentFor',adt.PAT_MRN_ID),\n              'meta', json_object(\n                'lastUpdated',(SELECT MAX(scr.RECORDED_TIME) FROM screening scr WHERE adt.FACILITY_ID = scr.FACILITY_ID),\n                'profile', json_array('http://shinny.org/StructureDefinition/shin-ny-organization')\n              ),\n              'status','active',\n              'scope', json_object('coding',json_array(json_object('code','treatment')),'text','treatment'),\n              'category', json_array(json_object(\n                'coding',json_array(\n                  json_object('display', 'Patient Consent',\n                  'code', '59284-0',\n                  'system','http://loinc.org')\n                )\n              )),\n              'patient', json_object(\n                'reference', CONCAT('Patient/',scr.FACILITY_ID,'-',scr.PAT_MRN_ID)\n              ),\n              'dateTime',(SELECT MAX(scr.RECORDED_TIME) FROM screening scr WHERE adt.FACILITY_ID = scr.FACILITY_ID),\n              'organization', json_array(json_object('reference', 'Organization/' || qat.FACILITY_ID))\n\n\n        )\n      ) AS FHIR_Consent\n    FROM demographic_data adt LEFT JOIN qe_admin_data qat\n    ON adt.PAT_MRN_ID = qat.PAT_MRN_ID LEFT JOIN screening scr ON scr.PAT_MRN_ID = adt.PAT_MRN_ID\n    WHERE adt.PAT_MRN_ID IS NOT NULL AND qat.PAT_MRN_ID IS NOT NULL AND scr.PAT_MRN_ID IS NOT NULL\n    ),\n        cte_fhir_org AS (\n      SELECT DISTINCT ON (CONCAT(scr.ENCOUNTER_ID,scr.FACILITY_ID,'-',scr.PAT_MRN_ID)) CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID) END AS ENCOUNTER_ID,qed.PAT_MRN_ID, JSON_OBJECT(\n        'fullUrl', LOWER(REPLACE(qed.FACILITY_LONG_NAME, ' ', '-')) || '-' || LOWER(REPLACE(qed.ORGANIZATION_TYPE, ' ', '-')) || '-' || LOWER(REPLACE(qed.FACILITY_ID, ' ', '-')),\n        'resource', JSON_OBJECT(\n            'resourceType', 'Organization',\n            'id', qed.FACILITY_ID,\n            'meta', JSON_OBJECT(\n                'lastUpdated', (SELECT MAX(scr.RECORDED_TIME) FROM screening scr WHERE qed.FACILITY_ID = scr.FACILITY_ID),\n                'profile', JSON_ARRAY('http://shinny.org/StructureDefinition/shin-ny-organization')\n            ),\n            'identifier', JSON_ARRAY(\n                JSON_OBJECT(\n                    'system', qed.FACILITY_ID,\n                    'value', LOWER(REPLACE(qed.FACILITY_LONG_NAME, ' ', '-')) || '-' || LOWER(REPLACE(qed.ORGANIZATION_TYPE, ' ', '-')) || '-' || LOWER(REPLACE(qed.FACILITY_ID, ' ', '-'))\n                )\n            ),\n            'active', true,\n            CASE WHEN qed.ORGANIZATION_TYPE IS NOT NULL THEN 'type' ELSE NULL END, JSON_ARRAY(\n                JSON_OBJECT(\n                    'coding', JSON_ARRAY(\n                        JSON_OBJECT(\n                            'system', 'http://terminology.hl7.org/CodeSystem/organization-type',\n                            'code', qed.ORGANIZATION_TYPE,\n                            'display', qed.ORGANIZATION_TYPE\n                        )\n                    )\n                )\n            ),\n            'name', qed.FACILITY_LONG_NAME,\n            'address', JSON_ARRAY(\n                JSON_OBJECT(\n                    'text', CONCAT(qed.FACILITY_ADDRESS1,' ', qed.FACILITY_ADDRESS2),\n                    'city', qed.FACILITY_CITY,\n                    'state', qed.FACILITY_STATE,\n                    'postalCode', CAST(qed.FACILITY_ZIP AS TEXT)\n                )\n            )\n        )\n    ) AS FHIR_Organization\n    FROM qe_admin_data qed LEFT JOIN screening scr ON qed.PAT_MRN_ID=scr.PAT_MRN_ID WHERE qed.FACILITY_ID!='' AND qed.FACILITY_ID iS NOT NULL AND qed.PAT_MRN_ID IS NOT NULL AND scr.PAT_MRN_ID IS NOT NULL ORDER BY qed.FACILITY_ID\n    ),\n        derived_from_cte AS (\n      SELECT\n          parent_question_code,\n          parent_question_sl_no,\n          facility_id,\n          pat_mrn_id,\n          encounter_id,\n          recorded_time,\n          json_group_array(json_object('reference', derived_reference)) AS derived_from_references\n      FROM (\n          SELECT\n              acw.QUESTION_CODE AS parent_question_code,\n              acw.QUESTION_SLNO AS parent_question_sl_no,\n              scr.PAT_MRN_ID AS pat_mrn_id,\n              scr.FACILITY_ID AS facility_id,\n              scr.RECORDED_TIME AS recorded_time,\n              CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID)\tEND AS encounter_id,\n              CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN CONCAT('Observation/','observationResponseQuestion-',scr.ENCOUNTER_ID,'-',md5(scr.RECORDED_TIME),'-',acw_sub.QUESTION_SLNO) ELSE CONCAT('Observation/','observationResponseQuestion-',scr.PAT_MRN_ID,'-',scr.FACILITY_ID,'-',md5(scr.RECORDED_TIME),'-',acw_sub.QUESTION_SLNO) END  AS derived_reference\n          FROM\n              ahc_cross_walk acw\n          INNER JOIN ahc_cross_walk acw_sub ON acw_sub.\"QUESTION_SLNO_REFERENCE\" = acw.QUESTION_SLNO\n          INNER JOIN screening scr ON (scr.\"QUESTION_CODE\" = acw.QUESTION_CODE OR scr.\"QUESTION_CODE\" IS NULL)\n          GROUP BY\n              acw.QUESTION_CODE,\n              acw.QUESTION_SLNO,\n              acw_sub.QUESTION_SLNO,\n              scr.PAT_MRN_ID,\n              scr.FACILITY_ID,\n              scr.ENCOUNTER_ID,\n              scr.RECORDED_TIME\n      ) AS distinct_references\n      GROUP BY\n          parent_question_code,\n          parent_question_sl_no,\n          facility_id,\n          pat_mrn_id,\n          encounter_id,\n          recorded_time\n    ),\n        cte_fhir_observation AS (\n      SELECT CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID) END AS ENCOUNTER_ID,scr.PAT_MRN_ID, JSON_OBJECT(\n        'fullUrl', CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN CONCAT('observationResponseQuestion-',scr.ENCOUNTER_ID,'-',md5(scr.RECORDED_TIME),'-',acw.QUESTION_SLNO) ELSE CONCAT('observationResponseQuestion-',scr.PAT_MRN_ID,'-',scr.FACILITY_ID,'-',md5(scr.RECORDED_TIME),'-',acw.QUESTION_SLNO) END,\n        'resource', JSON_OBJECT(\n          'resourceType', 'Observation',\n              'id', CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN CONCAT('observationResponseQuestion-',scr.ENCOUNTER_ID,'-',md5(scr.RECORDED_TIME),'-',acw.QUESTION_SLNO) ELSE CONCAT('observationResponseQuestion-',scr.PAT_MRN_ID,'-',scr.FACILITY_ID,'-',md5(scr.RECORDED_TIME),'-',acw.QUESTION_SLNO) END,\n              'meta', JSON_OBJECT(\n                  'lastUpdated', scr.RECORDED_TIME,\n                  'profile', JSON_ARRAY('http://hl7.org/fhir/us/sdoh-clinicalcare/StructureDefinition/SDOHCC-ObservationScreeningResponse')\n              ),\n              'status', SCREENING_STATUS_CODE,\n              'category', json_array(json_object('coding',json_array(json_object('system','http://terminology.hl7.org/CodeSystem/observation-category','code','social-history','display','Social History'))),json_object('coding',json_array(json_object('system','http://terminology.hl7.org/CodeSystem/observation-category','code','survey','display','Survey'))),json_object('coding',json_array(json_object('system','http://hl7.org/fhir/us/sdoh-clinicalcare/CodeSystem/SDOHCC-CodeSystemTemporaryCodes','code',CASE WHEN sdr.Code IS NOT NULL AND sdr.Code != '' THEN sdr.Code ELSE 'sdoh-category-unspecified' END,'display',CASE WHEN sdr.Display IS NOT NULL AND sdr.Display != '' THEN sdr.Display ELSE 'SDOH Category Unspecified' END)))),\n              CASE WHEN QUESTION_CODE_DESCRIPTION IS NOT NULL THEN 'code' ELSE NULL END, json_object(\n                'coding', json_array(json_object(CASE WHEN QUESTION_CODE_SYSTEM_NAME IS NOT NULL THEN 'system' ELSE NULL END,QUESTION_CODE_SYSTEM_NAME,CASE WHEN scr.QUESTION_CODE IS NOT NULL THEN 'code' ELSE NULL END,scr.QUESTION_CODE,CASE WHEN QUESTION_CODE_DESCRIPTION IS NOT NULL THEN 'display' ELSE NULL END,QUESTION_CODE_DESCRIPTION))\n              ),\n              'subject', json_object('reference',CONCAT('Patient/',scr.FACILITY_ID,'-',scr.PAT_MRN_ID)),\n              'effectiveDateTime', scr.RECORDED_TIME,\n              'issued', scr.RECORDED_TIME,\n              'valueCodeableConcept',CASE WHEN acw.CALCULATED_FIELD = 1 THEN json_object('coding',json_array(json_object('system','http://unitsofmeasure.org','code',acw.\"UCUM_UNITS\",'display',ANSWER_CODE_DESCRIPTION))) ELSE json_object('coding',json_array(json_object('system','http://loinc.org','code',scr.ANSWER_CODE,'display',ANSWER_CODE_DESCRIPTION))) END,\n              CASE WHEN acw.CALCULATED_FIELD = 1 THEN 'derivedFrom' ELSE NULL END, COALESCE(df.derived_from_references, json_array()),\n              'interpretation',json_array(json_object('coding',json_array(json_object('system','http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation','code','POS','display','Positive'))))\n          )\n      ) AS FHIR_Observation\n      FROM screening scr LEFT JOIN sdoh_domain_reference sdr ON scr.SDOH_DOMAIN = sdr.Display LEFT JOIN (SELECT DISTINCT QUESTION_CODE, QUESTION_SLNO, \"UCUM_UNITS\", CALCULATED_FIELD FROM ahc_cross_walk) acw ON acw.QUESTION_SLNO = scr.src_file_row_number LEFT JOIN derived_from_cte df ON df.parent_question_sl_no = scr.src_file_row_number AND df.pat_mrn_id=scr.PAT_MRN_ID AND df.encounter_id = (CASE\n      WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID) END) AND md5(df.recorded_time) = md5(scr.RECORDED_TIME) WHERE acw.QUESTION_SLNO IS NOT NULL AND scr.PAT_MRN_ID IS NOT NULL ORDER BY acw.QUESTION_SLNO),\n        cte_fhir_observation_grouper AS (\n      SELECT CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID) END AS ENCOUNTER_ID,scr.PAT_MRN_ID, JSON_OBJECT(\n        'fullUrl', (SELECT CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN CONCAT('observationResponseQuestion-',scr.ENCOUNTER_ID,'-',md5(sub1.RECORDED_TIME),'-',slNo,'-grouper') ELSE CONCAT('observationResponseQuestion-',sub1.PAT_MRN_ID,'-',sub1.FACILITY_ID,'-',md5(sub1.RECORDED_TIME),'-',slNo,'-grouper') END\n                      FROM (SELECT MAX(QUESTION_SLNO) as slNo, PAT_MRN_ID, FACILITY_ID, RECORDED_TIME\n                            FROM\n                              screening ssub\n                            LEFT JOIN\n                              (SELECT DISTINCT QUESTION_SLNO FROM ahc_cross_walk) acw\n                            ON acw.QUESTION_SLNO = ssub.src_file_row_number\n                            WHERE ssub.SCREENING_CODE=scr.SCREENING_CODE AND acw.QUESTION_SLNO IS NOT NULL AND ssub.PAT_MRN_ID = scr.PAT_MRN_ID\n                            GROUP BY PAT_MRN_ID,FACILITY_ID,RECORDED_TIME\n                            ORDER BY RECORDED_TIME\n                          ) AS sub1),\n        'resource', JSON_OBJECT(\n          'resourceType', 'Observation',\n              'id', (SELECT CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN CONCAT('observationResponseQuestion-',scr.ENCOUNTER_ID,'-',md5(sub1.RECORDED_TIME),'-',slNo,'-grouper') ELSE CONCAT('observationResponseQuestion-',sub1.PAT_MRN_ID,'-',sub1.FACILITY_ID,'-',md5(sub1.RECORDED_TIME),'-',slNo,'-grouper') END\n                      FROM (SELECT MAX(QUESTION_SLNO) as slNo, PAT_MRN_ID, FACILITY_ID,RECORDED_TIME\n                            FROM\n                              screening ssub\n                            LEFT JOIN\n                              (SELECT DISTINCT QUESTION_SLNO FROM ahc_cross_walk) acw\n                            ON acw.QUESTION_SLNO = ssub.src_file_row_number\n                            WHERE ssub.SCREENING_CODE=scr.SCREENING_CODE AND acw.QUESTION_SLNO IS NOT NULL AND ssub.PAT_MRN_ID = scr.PAT_MRN_ID\n                            GROUP BY PAT_MRN_ID,FACILITY_ID,RECORDED_TIME\n                            ORDER BY RECORDED_TIME\n                          ) AS sub1),\n              'meta', JSON_OBJECT(\n                  'lastUpdated', MAX(RECORDED_TIME),\n                  'profile', JSON_ARRAY('http://hl7.org/fhir/us/sdoh-clinicalcare/StructureDefinition/SDOHCC-ObservationScreeningResponse')\n              ),\n              'status', SCREENING_STATUS_CODE,\n              'category', json_array(json_object('coding',json_array(json_object('system','http://terminology.hl7.org/CodeSystem/observation-category','code','social-history','display','Social History'))),json_object('coding',json_array(json_object('system','http://terminology.hl7.org/CodeSystem/observation-category','code','survey','display','Survey'))),json_object('coding',(SELECT json_group_array(JSON_OBJECT(\n                            'system', 'http://hl7.org/fhir/us/sdoh-clinicalcare/CodeSystem/SDOHCC-CodeSystemTemporaryCodes',\n                            'display', sub.display,\n                            'code', sub.code\n                        )) FROM (\n                            SELECT DISTINCT\n                                CASE WHEN sdr.Display IS NOT NULL AND sdr.Display != '' THEN sdr.Display ELSE 'SDOH Category Unspecified' END AS display,\n                                CASE WHEN sdr.Code IS NOT NULL AND sdr.Code != '' THEN sdr.Code ELSE 'sdoh-category-unspecified' END AS code\n                            FROM\n                              screening sub\n                            LEFT JOIN\n                                sdoh_domain_reference sdr\n                            ON\n                                sub.SDOH_DOMAIN = sdr.Display\n                            WHERE\n                                sub.SCREENING_CODE=scr.SCREENING_CODE\n                        ) AS sub ))\n              ),\n              CASE WHEN SCREENING_CODE_DESCRIPTION IS NOT NULL THEN 'code' ELSE NULL END, json_object(\n                'coding', json_array(json_object(CASE WHEN SCREENING_CODE_SYSTEM_NAME IS NOT NULL THEN 'system' ELSE NULL END,SCREENING_CODE_SYSTEM_NAME,CASE WHEN scr.SCREENING_CODE IS NOT NULL THEN 'code' ELSE NULL END,scr.SCREENING_CODE,CASE WHEN SCREENING_CODE_DESCRIPTION IS NOT NULL THEN 'display' ELSE NULL END,SCREENING_CODE_DESCRIPTION))\n              ),\n              'subject', json_object('reference',CONCAT('Patient/',scr.FACILITY_ID,'-',scr.PAT_MRN_ID)),\n              CASE WHEN ENCOUNTER_ID IS NOT NULL THEN 'encounter' ELSE NULL END, json_object('reference',CONCAT('Encounter/',ENCOUNTER_ID)),\n              'effectiveDateTime', MAX(RECORDED_TIME),\n              'issued', MAX(RECORDED_TIME),\n              'hasMember', (SELECT json_group_array(JSON_OBJECT(\n                              'reference', CASE WHEN sub1.ENCOUNTER_ID IS NOT NULL THEN CONCAT('Observation/','observationResponseQuestion-',sub1.ENCOUNTER_ID,'-',md5(sub1.RECORDED_TIME),'-',sub1.QUESTION_SLNO) ELSE CONCAT('Observation/','observationResponseQuestion-',sub1.PAT_MRN_ID,'-',sub1.FACILITY_ID,'-',md5(sub1.RECORDED_TIME),'-',sub1.QUESTION_SLNO) END\n                          ))\n                          FROM (\n                          SELECT DISTINCT\n                              QUESTION_SLNO, PAT_MRN_ID, FACILITY_ID, RECORDED_TIME, ENCOUNTER_ID\n                          FROM\n                          screening ssub\n                          LEFT JOIN\n                            (SELECT DISTINCT QUESTION_SLNO FROM ahc_cross_walk) acw\n                          ON acw.QUESTION_SLNO = ssub.src_file_row_number\n                          WHERE ssub.SCREENING_CODE=scr.SCREENING_CODE AND ssub.PAT_MRN_ID=scr.PAT_MRN_ID AND ssub.FACILITY_ID=scr.FACILITY_ID AND acw.QUESTION_SLNO IS NOT NULL GROUP BY acw.QUESTION_SLNO, PAT_MRN_ID, FACILITY_ID, RECORDED_TIME, ENCOUNTER_ID\n                          ORDER BY acw.QUESTION_SLNO\n                      ) AS sub1\n                          )\n          )\n      ) AS FHIR_Observation_Grouper\n      FROM screening scr WHERE scr.PAT_MRN_ID IS NOT NULL GROUP BY SCREENING_CODE, FACILITY_ID, PAT_MRN_ID, SCREENING_CODE_DESCRIPTION,SCREENING_STATUS_CODE, SCREENING_CODE_SYSTEM_NAME,ENCOUNTER_ID),\n        cte_fhir_encounter AS (\n      SELECT DISTINCT ON (CONCAT(scr.ENCOUNTER_ID,scr.FACILITY_ID,'-',scr.PAT_MRN_ID)) scr.PAT_MRN_ID, CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID) END AS ENCOUNTER_ID, JSON_OBJECT(\n        'fullUrl', CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID) END,\n        'resource', JSON_OBJECT(\n          'resourceType', 'Encounter',\n          'id', CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID) END,\n          'meta', JSON_OBJECT(\n              'lastUpdated', RECORDED_TIME,\n              'profile', JSON_ARRAY('http://shinny.org/StructureDefinition/shin-ny-encounter')\n          ),\n          'status', CASE WHEN ENCOUNTER_STATUS_CODE IS NOT NULL THEN ENCOUNTER_STATUS_CODE ELSE 'unknown' END,\n          'class', json_object('system',ENCOUNTER_CLASS_CODE_SYSTEM,CASE WHEN ENCOUNTER_CLASS_CODE IS NOT NULL THEN 'code' ELSE NULL END,ENCOUNTER_CLASS_CODE),\n          'type', json_array(json_object('coding',json_array(json_object('system',ENCOUNTER_TYPE_CODE_SYSTEM,CASE WHEN ENCOUNTER_TYPE_CODE IS NOT NULL THEN 'code' ELSE NULL END,  CAST(ENCOUNTER_TYPE_CODE AS TEXT),'display', ENCOUNTER_TYPE_CODE_DESCRIPTION  )),'text',ENCOUNTER_TYPE_CODE_DESCRIPTION)),\n          'subject', json_object('reference',CONCAT('Patient/',scr.FACILITY_ID,'-',scr.PAT_MRN_ID))\n        )\n    ) AS FHIR_Encounter\n    FROM screening scr LEFT JOIN cte_fhir_patient ON scr.PAT_MRN_ID=cte_fhir_patient.PAT_MRN_ID WHERE scr.PAT_MRN_ID IS NOT NULL ORDER BY scr.ENCOUNTER_ID, scr.RECORDED_TIME DESC)\n        SELECT cte.ENCOUNTER_ID,cte.PAT_MRN_ID, json_object(\n          'resourceType', 'Bundle',\n              'id', CONCAT('84d832e0-0936-11ef-9028-cda0a7254a37','-',PAT_MRN_ID,'-',ENCOUNTER_ID),\n              'type', 'transaction',\n              'meta', JSON_OBJECT(\n                  'lastUpdated', (SELECT MAX(scr.RECORDED_TIME) FROM screening scr)\n              ),\n              'timestamp', '2024-05-03T10:18:43.342Z',\n              'entry', json(json_group_array(cte.json_data))\n          ) AS FHIR_Bundle\n          FROM (\n            SELECT ENCOUNTER_ID, PAT_MRN_ID, FHIR_Organization AS json_data FROM cte_fhir_org\n            UNION ALL\n            SELECT ENCOUNTER_ID, PAT_MRN_ID, FHIR_Patient AS json_data FROM cte_fhir_patient\n            UNION ALL\n            SELECT ENCOUNTER_ID, PAT_MRN_ID, FHIR_Observation AS json_data FROM cte_fhir_observation\n            UNION ALL\n            SELECT ENCOUNTER_ID, PAT_MRN_ID, FHIR_Observation_Grouper AS json_data FROM cte_fhir_observation_grouper\n            UNION ALL\n            SELECT ENCOUNTER_ID, PAT_MRN_ID, FHIR_Encounter AS json_data FROM cte_fhir_encounter\n            UNION ALL\n            SELECT ENCOUNTER_ID, PAT_MRN_ID, FHIR_Consent AS json_data FROM cte_fhir_consent\n          ) AS cte\n          GROUP BY cte.PAT_MRN_ID, cte.ENCOUNTER_ID;\n    ","orch_session_exec_id":"0f60b1dc-8565-5706-b7a3-cd2661c0005b","exec_nature":"duckdb","exec_status":0,"input_text":"-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n\n      CREATE VIEW IF NOT EXISTS fhir_bundle AS\n        WITH cte_fhir_patient AS (\n      SELECT DISTINCT ON (CONCAT(scr.ENCOUNTER_ID,scr.FACILITY_ID,'-',scr.PAT_MRN_ID)) CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID)END AS ENCOUNTER_ID,adt.pat_mrn_id,json_object('fullUrl', CONCAT(adt.FACILITY_ID,'-',adt.PAT_MRN_ID),\n        'resource', json_object(\n              'resourceType', 'Patient',\n              'id', CONCAT(adt.FACILITY_ID,'-',adt.PAT_MRN_ID),\n              'meta', json_object(\n                'lastUpdated',(SELECT MAX(scr.RECORDED_TIME) FROM screening scr WHERE adt.FACILITY_ID = scr.FACILITY_ID),\n                'profile', json_array('http://shinny.org/StructureDefinition/shinny-patient')\n              ),\n              CASE WHEN PREFERRED_LANGUAGE_CODE IS NOT NULL THEN 'language' ELSE NULL END, PREFERRED_LANGUAGE_CODE,\n              CASE WHEN (RACE_CODE_SYSTEM_NAME IS NOT NULL AND RACE_CODE IS NOT NULL AND RACE_CODE_DESCRIPTION IS NOT NULL) OR (ETHNICITY_CODE_SYSTEM_NAME IS NOT NULL AND ETHNICITY_CODE IS NOT NULL AND ETHNICITY_CODE_DESCRIPTION IS NOT NULL) OR (SEX_AT_BIRTH_CODE_SYSTEM IS NOT NULL AND SEX_AT_BIRTH_CODE IS NOT NULL AND SEX_AT_BIRTH_CODE_DESCRIPTION IS NOT NULL) THEN 'extension' ELSE NULL END, json_array(\n                              CASE WHEN RACE_CODE_SYSTEM_NAME IS NOT NULL AND RACE_CODE IS NOT NULL AND RACE_CODE_DESCRIPTION IS NOT NULL THEN json_object(\n                                  'extension', json_array(\n                                                json_object(\n                                                    'url','ombCategory',\n                                                    'valueCoding',json_object(\n                                                                'system',RACE_CODE_SYSTEM_NAME,\n                                                                'code',CAST(RACE_CODE AS TEXT),\n                                                                'display',RACE_CODE_DESCRIPTION\n                                                                )\n                                                            )\n                                            ),\n                                  'url', 'http://hl7.org/fhir/us/core/StructureDefinition/us-core-race'\n                                ) END,\n                                CASE WHEN ETHNICITY_CODE_SYSTEM_NAME IS NOT NULL AND ETHNICITY_CODE IS NOT NULL AND ETHNICITY_CODE_DESCRIPTION IS NOT NULL THEN json_object(\n                                  'extension',json_array(\n                                                json_object(\n                                                    'url','ombCategory',\n                                                    'valueCoding',json_object(\n                                                                  'system',ETHNICITY_CODE_SYSTEM_NAME,\n                                                                  'code',CAST(ETHNICITY_CODE AS TEXT),\n                                                                  'display',ETHNICITY_CODE_DESCRIPTION\n                                                                  )\n                                                            )\n                                          ),\n                                    'url', 'http://hl7.org/fhir/us/core/StructureDefinition/us-core-ethnicity'\n                              ) END,\n                              CASE WHEN SEX_AT_BIRTH_CODE_SYSTEM IS NOT NULL AND SEX_AT_BIRTH_CODE IS NOT NULL AND SEX_AT_BIRTH_CODE_DESCRIPTION IS NOT NULL THEN json_object(\n                                      'url','http://hl7.org/fhir/us/core/StructureDefinition/us-core-birthsex',\n                                      'valueCode',CAST(SEX_AT_BIRTH_CODE AS TEXT)\n\n                            ) END,\n                              CASE WHEN SEXUAL_ORIENTATION_CODE_SYSTEM_NAME IS NOT NULL AND SEXUAL_ORIENTATION_CODE IS NOT NULL AND SEXUAL_ORIENTATION_DESCRIPTION IS NOT NULL THEN json_object(\n                                      'url','http://shinny.org/StructureDefinition/shinny-sexual-orientation',\n                                      'valueCodeableConcept',json_object('coding', json_array(json_object(\n                                                    'system',SEXUAL_ORIENTATION_CODE_SYSTEM_NAME,\n                                                    'code',SEXUAL_ORIENTATION_CODE,\n                                                    'display',SEXUAL_ORIENTATION_DESCRIPTION\n                                                    )))\n\n                            ) END),\n              'identifier', json_array(\n                              json_object(\n                                  'type', json_object(\n                                      'coding', json_array(json_object('system', 'http://terminology.hl7.org/CodeSystem/v2-0203', 'code', 'MR')),\n                                      'text', 'Medical Record Number'\n                                  ),\n                                  'system', CONCAT('/facility/',adt.FACILITY_ID),\n                                  'value', qat.PAT_MRN_ID,\n                                  'assigner', json_object('reference', 'Organization/' || qat.FACILITY_ID)\n                              ),\n                              CASE\n                                  WHEN MEDICAID_CIN != '' THEN\n                                      json_object(\n                                          'type', json_object(\n                                              'coding', json_array(json_object('system', 'http://terminology.hl7.org/CodeSystem/v2-0203', 'code', 'MA'))\n                                          ),\n                                          'system', 'http://www.medicaid.gov/',\n                                          'value', MEDICAID_CIN,\n                                          'assigner', json_object('reference', 'Organization/2.16.840.1.113883.3.249')\n                                      )\n                                  ELSE NULL\n                              END,\n                              CASE\n                                  WHEN adt.MPI_ID IS NOT NULL THEN\n                                      json_object(\n                                          'type', json_object(\n                                              'coding', json_array(json_object('system', 'http://terminology.hl7.org/CodeSystem/v2-0203', 'code', 'PN'))\n                                          ),\n                                          'system', 'http://www.acme.com/identifiers/patient',\n                                          'value', CAST(adt.MPI_ID AS TEXT)\n                                      )\n                                  ELSE NULL\n                              END\n                          ),\n              CASE WHEN FIRST_NAME IS NOT NULL THEN 'name' ELSE NULL END, json_array(json_object(\n                CASE WHEN FIRST_NAME IS NOT NULL THEN 'text' ELSE NULL END, CONCAT(FIRST_NAME,' ', MIDDLE_NAME,' ', LAST_NAME),\n                CASE WHEN LAST_NAME IS NOT NULL THEN 'family' ELSE NULL END, LAST_NAME,\n                'given', json_array(FIRST_NAME,CASE WHEN MIDDLE_NAME IS NOT NULL THEN MIDDLE_NAME END))\n              ),\n              CASE WHEN ADMINISTRATIVE_SEX_CODE IS NOT NULL THEN 'gender' ELSE NULL END, ADMINISTRATIVE_SEX_CODE,\n              CASE WHEN PAT_BIRTH_DATE IS NOT NULL THEN 'birthDate' ELSE NULL END, PAT_BIRTH_DATE,\n              CASE WHEN CITY IS NOT NULL AND CITY != '' IS NOT NULL AND STATE IS NOT NULL AND STATE != '' THEN 'address' ELSE NULL END, json_array(\n                  json_object(\n                    CASE WHEN ADDRESS1 IS NOT NULL AND ADDRESS1 != '' IS NOT NULL THEN 'text' ELSE NULL END, CONCAT(ADDRESS1, ' ', ADDRESS2),\n                    CASE WHEN ADDRESS1 IS NOT NULL AND ADDRESS1 != '' IS NOT NULL THEN 'line' ELSE NULL END, json_array(ADDRESS1, ADDRESS2),\n                    'city', CITY,\n                    'state', STATE,\n                    CASE WHEN ZIP IS NOT NULL AND CAST(ZIP AS TEXT) != '' IS NOT NULL THEN 'postalCode' ELSE NULL END, CAST(ZIP AS TEXT)\n                )\n              ),\n              CASE WHEN PREFERRED_LANGUAGE_CODE IS NOT NULL THEN 'communication' ELSE NULL END, json_array(\n                json_object('language', json_object(\n                  'coding', json_array(\n                    json_object(\n                      'code', PREFERRED_LANGUAGE_CODE\n                    )\n                  )\n                ),\n                  'preferred', true\n              ))\n        )) AS FHIR_Patient\n    FROM demographic_data adt LEFT JOIN qe_admin_data qat\n    ON adt.PAT_MRN_ID = qat.PAT_MRN_ID LEFT JOIN screening scr ON scr.PAT_MRN_ID = adt.PAT_MRN_ID\n    WHERE adt.PAT_MRN_ID IS NOT NULL AND  qat.PAT_MRN_ID IS NOT NULL AND scr.PAT_MRN_ID IS NOT NULL\n    ),\n        cte_fhir_consent AS (\n      SELECT DISTINCT ON (CONCAT(scr.ENCOUNTER_ID,scr.FACILITY_ID,'-',scr.PAT_MRN_ID)) CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID) END AS ENCOUNTER_ID,adt.pat_mrn_id,json_object('fullUrl', CONCAT('consentFor',adt.PAT_MRN_ID),\n        'resource', json_object(\n              'resourceType', 'Consent',\n              'id', CONCAT('consentFor',adt.PAT_MRN_ID),\n              'meta', json_object(\n                'lastUpdated',(SELECT MAX(scr.RECORDED_TIME) FROM screening scr WHERE adt.FACILITY_ID = scr.FACILITY_ID),\n                'profile', json_array('http://shinny.org/StructureDefinition/shin-ny-organization')\n              ),\n              'status','active',\n              'scope', json_object('coding',json_array(json_object('code','treatment')),'text','treatment'),\n              'category', json_array(json_object(\n                'coding',json_array(\n                  json_object('display', 'Patient Consent',\n                  'code', '59284-0',\n                  'system','http://loinc.org')\n                )\n              )),\n              'patient', json_object(\n                'reference', CONCAT('Patient/',scr.FACILITY_ID,'-',scr.PAT_MRN_ID)\n              ),\n              'dateTime',(SELECT MAX(scr.RECORDED_TIME) FROM screening scr WHERE adt.FACILITY_ID = scr.FACILITY_ID),\n              'organization', json_array(json_object('reference', 'Organization/' || qat.FACILITY_ID))\n\n\n        )\n      ) AS FHIR_Consent\n    FROM demographic_data adt LEFT JOIN qe_admin_data qat\n    ON adt.PAT_MRN_ID = qat.PAT_MRN_ID LEFT JOIN screening scr ON scr.PAT_MRN_ID = adt.PAT_MRN_ID\n    WHERE adt.PAT_MRN_ID IS NOT NULL AND qat.PAT_MRN_ID IS NOT NULL AND scr.PAT_MRN_ID IS NOT NULL\n    ),\n        cte_fhir_org AS (\n      SELECT DISTINCT ON (CONCAT(scr.ENCOUNTER_ID,scr.FACILITY_ID,'-',scr.PAT_MRN_ID)) CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID) END AS ENCOUNTER_ID,qed.PAT_MRN_ID, JSON_OBJECT(\n        'fullUrl', LOWER(REPLACE(qed.FACILITY_LONG_NAME, ' ', '-')) || '-' || LOWER(REPLACE(qed.ORGANIZATION_TYPE, ' ', '-')) || '-' || LOWER(REPLACE(qed.FACILITY_ID, ' ', '-')),\n        'resource', JSON_OBJECT(\n            'resourceType', 'Organization',\n            'id', qed.FACILITY_ID,\n            'meta', JSON_OBJECT(\n                'lastUpdated', (SELECT MAX(scr.RECORDED_TIME) FROM screening scr WHERE qed.FACILITY_ID = scr.FACILITY_ID),\n                'profile', JSON_ARRAY('http://shinny.org/StructureDefinition/shin-ny-organization')\n            ),\n            'identifier', JSON_ARRAY(\n                JSON_OBJECT(\n                    'system', qed.FACILITY_ID,\n                    'value', LOWER(REPLACE(qed.FACILITY_LONG_NAME, ' ', '-')) || '-' || LOWER(REPLACE(qed.ORGANIZATION_TYPE, ' ', '-')) || '-' || LOWER(REPLACE(qed.FACILITY_ID, ' ', '-'))\n                )\n            ),\n            'active', true,\n            CASE WHEN qed.ORGANIZATION_TYPE IS NOT NULL THEN 'type' ELSE NULL END, JSON_ARRAY(\n                JSON_OBJECT(\n                    'coding', JSON_ARRAY(\n                        JSON_OBJECT(\n                            'system', 'http://terminology.hl7.org/CodeSystem/organization-type',\n                            'code', qed.ORGANIZATION_TYPE,\n                            'display', qed.ORGANIZATION_TYPE\n                        )\n                    )\n                )\n            ),\n            'name', qed.FACILITY_LONG_NAME,\n            'address', JSON_ARRAY(\n                JSON_OBJECT(\n                    'text', CONCAT(qed.FACILITY_ADDRESS1,' ', qed.FACILITY_ADDRESS2),\n                    'city', qed.FACILITY_CITY,\n                    'state', qed.FACILITY_STATE,\n                    'postalCode', CAST(qed.FACILITY_ZIP AS TEXT)\n                )\n            )\n        )\n    ) AS FHIR_Organization\n    FROM qe_admin_data qed LEFT JOIN screening scr ON qed.PAT_MRN_ID=scr.PAT_MRN_ID WHERE qed.FACILITY_ID!='' AND qed.FACILITY_ID iS NOT NULL AND qed.PAT_MRN_ID IS NOT NULL AND scr.PAT_MRN_ID IS NOT NULL ORDER BY qed.FACILITY_ID\n    ),\n        derived_from_cte AS (\n      SELECT\n          parent_question_code,\n          parent_question_sl_no,\n          facility_id,\n          pat_mrn_id,\n          encounter_id,\n          recorded_time,\n          json_group_array(json_object('reference', derived_reference)) AS derived_from_references\n      FROM (\n          SELECT\n              acw.QUESTION_CODE AS parent_question_code,\n              acw.QUESTION_SLNO AS parent_question_sl_no,\n              scr.PAT_MRN_ID AS pat_mrn_id,\n              scr.FACILITY_ID AS facility_id,\n              scr.RECORDED_TIME AS recorded_time,\n              CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID)\tEND AS encounter_id,\n              CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN CONCAT('Observation/','observationResponseQuestion-',scr.ENCOUNTER_ID,'-',md5(scr.RECORDED_TIME),'-',acw_sub.QUESTION_SLNO) ELSE CONCAT('Observation/','observationResponseQuestion-',scr.PAT_MRN_ID,'-',scr.FACILITY_ID,'-',md5(scr.RECORDED_TIME),'-',acw_sub.QUESTION_SLNO) END  AS derived_reference\n          FROM\n              ahc_cross_walk acw\n          INNER JOIN ahc_cross_walk acw_sub ON acw_sub.\"QUESTION_SLNO_REFERENCE\" = acw.QUESTION_SLNO\n          INNER JOIN screening scr ON (scr.\"QUESTION_CODE\" = acw.QUESTION_CODE OR scr.\"QUESTION_CODE\" IS NULL)\n          GROUP BY\n              acw.QUESTION_CODE,\n              acw.QUESTION_SLNO,\n              acw_sub.QUESTION_SLNO,\n              scr.PAT_MRN_ID,\n              scr.FACILITY_ID,\n              scr.ENCOUNTER_ID,\n              scr.RECORDED_TIME\n      ) AS distinct_references\n      GROUP BY\n          parent_question_code,\n          parent_question_sl_no,\n          facility_id,\n          pat_mrn_id,\n          encounter_id,\n          recorded_time\n    ),\n        cte_fhir_observation AS (\n      SELECT CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID) END AS ENCOUNTER_ID,scr.PAT_MRN_ID, JSON_OBJECT(\n        'fullUrl', CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN CONCAT('observationResponseQuestion-',scr.ENCOUNTER_ID,'-',md5(scr.RECORDED_TIME),'-',acw.QUESTION_SLNO) ELSE CONCAT('observationResponseQuestion-',scr.PAT_MRN_ID,'-',scr.FACILITY_ID,'-',md5(scr.RECORDED_TIME),'-',acw.QUESTION_SLNO) END,\n        'resource', JSON_OBJECT(\n          'resourceType', 'Observation',\n              'id', CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN CONCAT('observationResponseQuestion-',scr.ENCOUNTER_ID,'-',md5(scr.RECORDED_TIME),'-',acw.QUESTION_SLNO) ELSE CONCAT('observationResponseQuestion-',scr.PAT_MRN_ID,'-',scr.FACILITY_ID,'-',md5(scr.RECORDED_TIME),'-',acw.QUESTION_SLNO) END,\n              'meta', JSON_OBJECT(\n                  'lastUpdated', scr.RECORDED_TIME,\n                  'profile', JSON_ARRAY('http://hl7.org/fhir/us/sdoh-clinicalcare/StructureDefinition/SDOHCC-ObservationScreeningResponse')\n              ),\n              'status', SCREENING_STATUS_CODE,\n              'category', json_array(json_object('coding',json_array(json_object('system','http://terminology.hl7.org/CodeSystem/observation-category','code','social-history','display','Social History'))),json_object('coding',json_array(json_object('system','http://terminology.hl7.org/CodeSystem/observation-category','code','survey','display','Survey'))),json_object('coding',json_array(json_object('system','http://hl7.org/fhir/us/sdoh-clinicalcare/CodeSystem/SDOHCC-CodeSystemTemporaryCodes','code',CASE WHEN sdr.Code IS NOT NULL AND sdr.Code != '' THEN sdr.Code ELSE 'sdoh-category-unspecified' END,'display',CASE WHEN sdr.Display IS NOT NULL AND sdr.Display != '' THEN sdr.Display ELSE 'SDOH Category Unspecified' END)))),\n              CASE WHEN QUESTION_CODE_DESCRIPTION IS NOT NULL THEN 'code' ELSE NULL END, json_object(\n                'coding', json_array(json_object(CASE WHEN QUESTION_CODE_SYSTEM_NAME IS NOT NULL THEN 'system' ELSE NULL END,QUESTION_CODE_SYSTEM_NAME,CASE WHEN scr.QUESTION_CODE IS NOT NULL THEN 'code' ELSE NULL END,scr.QUESTION_CODE,CASE WHEN QUESTION_CODE_DESCRIPTION IS NOT NULL THEN 'display' ELSE NULL END,QUESTION_CODE_DESCRIPTION))\n              ),\n              'subject', json_object('reference',CONCAT('Patient/',scr.FACILITY_ID,'-',scr.PAT_MRN_ID)),\n              'effectiveDateTime', scr.RECORDED_TIME,\n              'issued', scr.RECORDED_TIME,\n              'valueCodeableConcept',CASE WHEN acw.CALCULATED_FIELD = 1 THEN json_object('coding',json_array(json_object('system','http://unitsofmeasure.org','code',acw.\"UCUM_UNITS\",'display',ANSWER_CODE_DESCRIPTION))) ELSE json_object('coding',json_array(json_object('system','http://loinc.org','code',scr.ANSWER_CODE,'display',ANSWER_CODE_DESCRIPTION))) END,\n              CASE WHEN acw.CALCULATED_FIELD = 1 THEN 'derivedFrom' ELSE NULL END, COALESCE(df.derived_from_references, json_array()),\n              'interpretation',json_array(json_object('coding',json_array(json_object('system','http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation','code','POS','display','Positive'))))\n          )\n      ) AS FHIR_Observation\n      FROM screening scr LEFT JOIN sdoh_domain_reference sdr ON scr.SDOH_DOMAIN = sdr.Display LEFT JOIN (SELECT DISTINCT QUESTION_CODE, QUESTION_SLNO, \"UCUM_UNITS\", CALCULATED_FIELD FROM ahc_cross_walk) acw ON acw.QUESTION_SLNO = scr.src_file_row_number LEFT JOIN derived_from_cte df ON df.parent_question_sl_no = scr.src_file_row_number AND df.pat_mrn_id=scr.PAT_MRN_ID AND df.encounter_id = (CASE\n      WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID) END) AND md5(df.recorded_time) = md5(scr.RECORDED_TIME) WHERE acw.QUESTION_SLNO IS NOT NULL AND scr.PAT_MRN_ID IS NOT NULL ORDER BY acw.QUESTION_SLNO),\n        cte_fhir_observation_grouper AS (\n      SELECT CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID) END AS ENCOUNTER_ID,scr.PAT_MRN_ID, JSON_OBJECT(\n        'fullUrl', (SELECT CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN CONCAT('observationResponseQuestion-',scr.ENCOUNTER_ID,'-',md5(sub1.RECORDED_TIME),'-',slNo,'-grouper') ELSE CONCAT('observationResponseQuestion-',sub1.PAT_MRN_ID,'-',sub1.FACILITY_ID,'-',md5(sub1.RECORDED_TIME),'-',slNo,'-grouper') END\n                      FROM (SELECT MAX(QUESTION_SLNO) as slNo, PAT_MRN_ID, FACILITY_ID, RECORDED_TIME\n                            FROM\n                              screening ssub\n                            LEFT JOIN\n                              (SELECT DISTINCT QUESTION_SLNO FROM ahc_cross_walk) acw\n                            ON acw.QUESTION_SLNO = ssub.src_file_row_number\n                            WHERE ssub.SCREENING_CODE=scr.SCREENING_CODE AND acw.QUESTION_SLNO IS NOT NULL AND ssub.PAT_MRN_ID = scr.PAT_MRN_ID\n                            GROUP BY PAT_MRN_ID,FACILITY_ID,RECORDED_TIME\n                            ORDER BY RECORDED_TIME\n                          ) AS sub1),\n        'resource', JSON_OBJECT(\n          'resourceType', 'Observation',\n              'id', (SELECT CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN CONCAT('observationResponseQuestion-',scr.ENCOUNTER_ID,'-',md5(sub1.RECORDED_TIME),'-',slNo,'-grouper') ELSE CONCAT('observationResponseQuestion-',sub1.PAT_MRN_ID,'-',sub1.FACILITY_ID,'-',md5(sub1.RECORDED_TIME),'-',slNo,'-grouper') END\n                      FROM (SELECT MAX(QUESTION_SLNO) as slNo, PAT_MRN_ID, FACILITY_ID,RECORDED_TIME\n                            FROM\n                              screening ssub\n                            LEFT JOIN\n                              (SELECT DISTINCT QUESTION_SLNO FROM ahc_cross_walk) acw\n                            ON acw.QUESTION_SLNO = ssub.src_file_row_number\n                            WHERE ssub.SCREENING_CODE=scr.SCREENING_CODE AND acw.QUESTION_SLNO IS NOT NULL AND ssub.PAT_MRN_ID = scr.PAT_MRN_ID\n                            GROUP BY PAT_MRN_ID,FACILITY_ID,RECORDED_TIME\n                            ORDER BY RECORDED_TIME\n                          ) AS sub1),\n              'meta', JSON_OBJECT(\n                  'lastUpdated', MAX(RECORDED_TIME),\n                  'profile', JSON_ARRAY('http://hl7.org/fhir/us/sdoh-clinicalcare/StructureDefinition/SDOHCC-ObservationScreeningResponse')\n              ),\n              'status', SCREENING_STATUS_CODE,\n              'category', json_array(json_object('coding',json_array(json_object('system','http://terminology.hl7.org/CodeSystem/observation-category','code','social-history','display','Social History'))),json_object('coding',json_array(json_object('system','http://terminology.hl7.org/CodeSystem/observation-category','code','survey','display','Survey'))),json_object('coding',(SELECT json_group_array(JSON_OBJECT(\n                            'system', 'http://hl7.org/fhir/us/sdoh-clinicalcare/CodeSystem/SDOHCC-CodeSystemTemporaryCodes',\n                            'display', sub.display,\n                            'code', sub.code\n                        )) FROM (\n                            SELECT DISTINCT\n                                CASE WHEN sdr.Display IS NOT NULL AND sdr.Display != '' THEN sdr.Display ELSE 'SDOH Category Unspecified' END AS display,\n                                CASE WHEN sdr.Code IS NOT NULL AND sdr.Code != '' THEN sdr.Code ELSE 'sdoh-category-unspecified' END AS code\n                            FROM\n                              screening sub\n                            LEFT JOIN\n                                sdoh_domain_reference sdr\n                            ON\n                                sub.SDOH_DOMAIN = sdr.Display\n                            WHERE\n                                sub.SCREENING_CODE=scr.SCREENING_CODE\n                        ) AS sub ))\n              ),\n              CASE WHEN SCREENING_CODE_DESCRIPTION IS NOT NULL THEN 'code' ELSE NULL END, json_object(\n                'coding', json_array(json_object(CASE WHEN SCREENING_CODE_SYSTEM_NAME IS NOT NULL THEN 'system' ELSE NULL END,SCREENING_CODE_SYSTEM_NAME,CASE WHEN scr.SCREENING_CODE IS NOT NULL THEN 'code' ELSE NULL END,scr.SCREENING_CODE,CASE WHEN SCREENING_CODE_DESCRIPTION IS NOT NULL THEN 'display' ELSE NULL END,SCREENING_CODE_DESCRIPTION))\n              ),\n              'subject', json_object('reference',CONCAT('Patient/',scr.FACILITY_ID,'-',scr.PAT_MRN_ID)),\n              CASE WHEN ENCOUNTER_ID IS NOT NULL THEN 'encounter' ELSE NULL END, json_object('reference',CONCAT('Encounter/',ENCOUNTER_ID)),\n              'effectiveDateTime', MAX(RECORDED_TIME),\n              'issued', MAX(RECORDED_TIME),\n              'hasMember', (SELECT json_group_array(JSON_OBJECT(\n                              'reference', CASE WHEN sub1.ENCOUNTER_ID IS NOT NULL THEN CONCAT('Observation/','observationResponseQuestion-',sub1.ENCOUNTER_ID,'-',md5(sub1.RECORDED_TIME),'-',sub1.QUESTION_SLNO) ELSE CONCAT('Observation/','observationResponseQuestion-',sub1.PAT_MRN_ID,'-',sub1.FACILITY_ID,'-',md5(sub1.RECORDED_TIME),'-',sub1.QUESTION_SLNO) END\n                          ))\n                          FROM (\n                          SELECT DISTINCT\n                              QUESTION_SLNO, PAT_MRN_ID, FACILITY_ID, RECORDED_TIME, ENCOUNTER_ID\n                          FROM\n                          screening ssub\n                          LEFT JOIN\n                            (SELECT DISTINCT QUESTION_SLNO FROM ahc_cross_walk) acw\n                          ON acw.QUESTION_SLNO = ssub.src_file_row_number\n                          WHERE ssub.SCREENING_CODE=scr.SCREENING_CODE AND ssub.PAT_MRN_ID=scr.PAT_MRN_ID AND ssub.FACILITY_ID=scr.FACILITY_ID AND acw.QUESTION_SLNO IS NOT NULL GROUP BY acw.QUESTION_SLNO, PAT_MRN_ID, FACILITY_ID, RECORDED_TIME, ENCOUNTER_ID\n                          ORDER BY acw.QUESTION_SLNO\n                      ) AS sub1\n                          )\n          )\n      ) AS FHIR_Observation_Grouper\n      FROM screening scr WHERE scr.PAT_MRN_ID IS NOT NULL GROUP BY SCREENING_CODE, FACILITY_ID, PAT_MRN_ID, SCREENING_CODE_DESCRIPTION,SCREENING_STATUS_CODE, SCREENING_CODE_SYSTEM_NAME,ENCOUNTER_ID),\n        cte_fhir_encounter AS (\n      SELECT DISTINCT ON (CONCAT(scr.ENCOUNTER_ID,scr.FACILITY_ID,'-',scr.PAT_MRN_ID)) scr.PAT_MRN_ID, CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID) END AS ENCOUNTER_ID, JSON_OBJECT(\n        'fullUrl', CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID) END,\n        'resource', JSON_OBJECT(\n          'resourceType', 'Encounter',\n          'id', CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID) END,\n          'meta', JSON_OBJECT(\n              'lastUpdated', RECORDED_TIME,\n              'profile', JSON_ARRAY('http://shinny.org/StructureDefinition/shin-ny-encounter')\n          ),\n          'status', CASE WHEN ENCOUNTER_STATUS_CODE IS NOT NULL THEN ENCOUNTER_STATUS_CODE ELSE 'unknown' END,\n          'class', json_object('system',ENCOUNTER_CLASS_CODE_SYSTEM,CASE WHEN ENCOUNTER_CLASS_CODE IS NOT NULL THEN 'code' ELSE NULL END,ENCOUNTER_CLASS_CODE),\n          'type', json_array(json_object('coding',json_array(json_object('system',ENCOUNTER_TYPE_CODE_SYSTEM,CASE WHEN ENCOUNTER_TYPE_CODE IS NOT NULL THEN 'code' ELSE NULL END,  CAST(ENCOUNTER_TYPE_CODE AS TEXT),'display', ENCOUNTER_TYPE_CODE_DESCRIPTION  )),'text',ENCOUNTER_TYPE_CODE_DESCRIPTION)),\n          'subject', json_object('reference',CONCAT('Patient/',scr.FACILITY_ID,'-',scr.PAT_MRN_ID))\n        )\n    ) AS FHIR_Encounter\n    FROM screening scr LEFT JOIN cte_fhir_patient ON scr.PAT_MRN_ID=cte_fhir_patient.PAT_MRN_ID WHERE scr.PAT_MRN_ID IS NOT NULL ORDER BY scr.ENCOUNTER_ID, scr.RECORDED_TIME DESC)\n        SELECT cte.ENCOUNTER_ID,cte.PAT_MRN_ID, json_object(\n          'resourceType', 'Bundle',\n              'id', CONCAT('84d832e0-0936-11ef-9028-cda0a7254a37','-',PAT_MRN_ID,'-',ENCOUNTER_ID),\n              'type', 'transaction',\n              'meta', JSON_OBJECT(\n                  'lastUpdated', (SELECT MAX(scr.RECORDED_TIME) FROM screening scr)\n              ),\n              'timestamp', '2024-05-03T10:18:43.342Z',\n              'entry', json(json_group_array(cte.json_data))\n          ) AS FHIR_Bundle\n          FROM (\n            SELECT ENCOUNTER_ID, PAT_MRN_ID, FHIR_Organization AS json_data FROM cte_fhir_org\n            UNION ALL\n            SELECT ENCOUNTER_ID, PAT_MRN_ID, FHIR_Patient AS json_data FROM cte_fhir_patient\n            UNION ALL\n            SELECT ENCOUNTER_ID, PAT_MRN_ID, FHIR_Observation AS json_data FROM cte_fhir_observation\n            UNION ALL\n            SELECT ENCOUNTER_ID, PAT_MRN_ID, FHIR_Observation_Grouper AS json_data FROM cte_fhir_observation_grouper\n            UNION ALL\n            SELECT ENCOUNTER_ID, PAT_MRN_ID, FHIR_Encounter AS json_data FROM cte_fhir_encounter\n            UNION ALL\n            SELECT ENCOUNTER_ID, PAT_MRN_ID, FHIR_Consent AS json_data FROM cte_fhir_consent\n          ) AS cte\n          GROUP BY cte.PAT_MRN_ID, cte.ENCOUNTER_ID;\n    ","session_id":"52c6a395-5d83-4051-bb7c-39036f26ab29","narrative_md":"\n## execute_6\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n\n      CREATE VIEW IF NOT EXISTS fhir_bundle AS\n        WITH cte_fhir_patient AS (\n      SELECT DISTINCT ON (CONCAT(scr.ENCOUNTER_ID,scr.FACILITY_ID,'-',scr.PAT_MRN_ID)) CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID)END AS ENCOUNTER_ID,adt.pat_mrn_id,json_object('fullUrl', CONCAT(adt.FACILITY_ID,'-',adt.PAT_MRN_ID),\n        'resource', json_object(\n              'resourceType', 'Patient',\n              'id', CONCAT(adt.FACILITY_ID,'-',adt.PAT_MRN_ID),\n              'meta', json_object(\n                'lastUpdated',(SELECT MAX(scr.RECORDED_TIME) FROM screening scr WHERE adt.FACILITY_ID = scr.FACILITY_ID),\n                'profile', json_array('http://shinny.org/StructureDefinition/shinny-patient')\n              ),\n              CASE WHEN PREFERRED_LANGUAGE_CODE IS NOT NULL THEN 'language' ELSE NULL END, PREFERRED_LANGUAGE_CODE,\n              CASE WHEN (RACE_CODE_SYSTEM_NAME IS NOT NULL AND RACE_CODE IS NOT NULL AND RACE_CODE_DESCRIPTION IS NOT NULL) OR (ETHNICITY_CODE_SYSTEM_NAME IS NOT NULL AND ETHNICITY_CODE IS NOT NULL AND ETHNICITY_CODE_DESCRIPTION IS NOT NULL) OR (SEX_AT_BIRTH_CODE_SYSTEM IS NOT NULL AND SEX_AT_BIRTH_CODE IS NOT NULL AND SEX_AT_BIRTH_CODE_DESCRIPTION IS NOT NULL) THEN 'extension' ELSE NULL END, json_array(\n                              CASE WHEN RACE_CODE_SYSTEM_NAME IS NOT NULL AND RACE_CODE IS NOT NULL AND RACE_CODE_DESCRIPTION IS NOT NULL THEN json_object(\n                                  'extension', json_array(\n                                                json_object(\n                                                    'url','ombCategory',\n                                                    'valueCoding',json_object(\n                                                                'system',RACE_CODE_SYSTEM_NAME,\n                                                                'code',CAST(RACE_CODE AS TEXT),\n                                                                'display',RACE_CODE_DESCRIPTION\n                                                                )\n                                                            )\n                                            ),\n                                  'url', 'http://hl7.org/fhir/us/core/StructureDefinition/us-core-race'\n                                ) END,\n                                CASE WHEN ETHNICITY_CODE_SYSTEM_NAME IS NOT NULL AND ETHNICITY_CODE IS NOT NULL AND ETHNICITY_CODE_DESCRIPTION IS NOT NULL THEN json_object(\n                                  'extension',json_array(\n                                                json_object(\n                                                    'url','ombCategory',\n                                                    'valueCoding',json_object(\n                                                                  'system',ETHNICITY_CODE_SYSTEM_NAME,\n                                                                  'code',CAST(ETHNICITY_CODE AS TEXT),\n                                                                  'display',ETHNICITY_CODE_DESCRIPTION\n                                                                  )\n                                                            )\n                                          ),\n                                    'url', 'http://hl7.org/fhir/us/core/StructureDefinition/us-core-ethnicity'\n                              ) END,\n                              CASE WHEN SEX_AT_BIRTH_CODE_SYSTEM IS NOT NULL AND SEX_AT_BIRTH_CODE IS NOT NULL AND SEX_AT_BIRTH_CODE_DESCRIPTION IS NOT NULL THEN json_object(\n                                      'url','http://hl7.org/fhir/us/core/StructureDefinition/us-core-birthsex',\n                                      'valueCode',CAST(SEX_AT_BIRTH_CODE AS TEXT)\n\n                            ) END,\n                              CASE WHEN SEXUAL_ORIENTATION_CODE_SYSTEM_NAME IS NOT NULL AND SEXUAL_ORIENTATION_CODE IS NOT NULL AND SEXUAL_ORIENTATION_DESCRIPTION IS NOT NULL THEN json_object(\n                                      'url','http://shinny.org/StructureDefinition/shinny-sexual-orientation',\n                                      'valueCodeableConcept',json_object('coding', json_array(json_object(\n                                                    'system',SEXUAL_ORIENTATION_CODE_SYSTEM_NAME,\n                                                    'code',SEXUAL_ORIENTATION_CODE,\n                                                    'display',SEXUAL_ORIENTATION_DESCRIPTION\n                                                    )))\n\n                            ) END),\n              'identifier', json_array(\n                              json_object(\n                                  'type', json_object(\n                                      'coding', json_array(json_object('system', 'http://terminology.hl7.org/CodeSystem/v2-0203', 'code', 'MR')),\n                                      'text', 'Medical Record Number'\n                                  ),\n                                  'system', CONCAT('/facility/',adt.FACILITY_ID),\n                                  'value', qat.PAT_MRN_ID,\n                                  'assigner', json_object('reference', 'Organization/' || qat.FACILITY_ID)\n                              ),\n                              CASE\n                                  WHEN MEDICAID_CIN != '' THEN\n                                      json_object(\n                                          'type', json_object(\n                                              'coding', json_array(json_object('system', 'http://terminology.hl7.org/CodeSystem/v2-0203', 'code', 'MA'))\n                                          ),\n                                          'system', 'http://www.medicaid.gov/',\n                                          'value', MEDICAID_CIN,\n                                          'assigner', json_object('reference', 'Organization/2.16.840.1.113883.3.249')\n                                      )\n                                  ELSE NULL\n                              END,\n                              CASE\n                                  WHEN adt.MPI_ID IS NOT NULL THEN\n                                      json_object(\n                                          'type', json_object(\n                                              'coding', json_array(json_object('system', 'http://terminology.hl7.org/CodeSystem/v2-0203', 'code', 'PN'))\n                                          ),\n                                          'system', 'http://www.acme.com/identifiers/patient',\n                                          'value', CAST(adt.MPI_ID AS TEXT)\n                                      )\n                                  ELSE NULL\n                              END\n                          ),\n              CASE WHEN FIRST_NAME IS NOT NULL THEN 'name' ELSE NULL END, json_array(json_object(\n                CASE WHEN FIRST_NAME IS NOT NULL THEN 'text' ELSE NULL END, CONCAT(FIRST_NAME,' ', MIDDLE_NAME,' ', LAST_NAME),\n                CASE WHEN LAST_NAME IS NOT NULL THEN 'family' ELSE NULL END, LAST_NAME,\n                'given', json_array(FIRST_NAME,CASE WHEN MIDDLE_NAME IS NOT NULL THEN MIDDLE_NAME END))\n              ),\n              CASE WHEN ADMINISTRATIVE_SEX_CODE IS NOT NULL THEN 'gender' ELSE NULL END, ADMINISTRATIVE_SEX_CODE,\n              CASE WHEN PAT_BIRTH_DATE IS NOT NULL THEN 'birthDate' ELSE NULL END, PAT_BIRTH_DATE,\n              CASE WHEN CITY IS NOT NULL AND CITY != '' IS NOT NULL AND STATE IS NOT NULL AND STATE != '' THEN 'address' ELSE NULL END, json_array(\n                  json_object(\n                    CASE WHEN ADDRESS1 IS NOT NULL AND ADDRESS1 != '' IS NOT NULL THEN 'text' ELSE NULL END, CONCAT(ADDRESS1, ' ', ADDRESS2),\n                    CASE WHEN ADDRESS1 IS NOT NULL AND ADDRESS1 != '' IS NOT NULL THEN 'line' ELSE NULL END, json_array(ADDRESS1, ADDRESS2),\n                    'city', CITY,\n                    'state', STATE,\n                    CASE WHEN ZIP IS NOT NULL AND CAST(ZIP AS TEXT) != '' IS NOT NULL THEN 'postalCode' ELSE NULL END, CAST(ZIP AS TEXT)\n                )\n              ),\n              CASE WHEN PREFERRED_LANGUAGE_CODE IS NOT NULL THEN 'communication' ELSE NULL END, json_array(\n                json_object('language', json_object(\n                  'coding', json_array(\n                    json_object(\n                      'code', PREFERRED_LANGUAGE_CODE\n                    )\n                  )\n                ),\n                  'preferred', true\n              ))\n        )) AS FHIR_Patient\n    FROM demographic_data adt LEFT JOIN qe_admin_data qat\n    ON adt.PAT_MRN_ID = qat.PAT_MRN_ID LEFT JOIN screening scr ON scr.PAT_MRN_ID = adt.PAT_MRN_ID\n    WHERE adt.PAT_MRN_ID IS NOT NULL AND  qat.PAT_MRN_ID IS NOT NULL AND scr.PAT_MRN_ID IS NOT NULL\n    ),\n        cte_fhir_consent AS (\n      SELECT DISTINCT ON (CONCAT(scr.ENCOUNTER_ID,scr.FACILITY_ID,'-',scr.PAT_MRN_ID)) CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID) END AS ENCOUNTER_ID,adt.pat_mrn_id,json_object('fullUrl', CONCAT('consentFor',adt.PAT_MRN_ID),\n        'resource', json_object(\n              'resourceType', 'Consent',\n              'id', CONCAT('consentFor',adt.PAT_MRN_ID),\n              'meta', json_object(\n                'lastUpdated',(SELECT MAX(scr.RECORDED_TIME) FROM screening scr WHERE adt.FACILITY_ID = scr.FACILITY_ID),\n                'profile', json_array('http://shinny.org/StructureDefinition/shin-ny-organization')\n              ),\n              'status','active',\n              'scope', json_object('coding',json_array(json_object('code','treatment')),'text','treatment'),\n              'category', json_array(json_object(\n                'coding',json_array(\n                  json_object('display', 'Patient Consent',\n                  'code', '59284-0',\n                  'system','http://loinc.org')\n                )\n              )),\n              'patient', json_object(\n                'reference', CONCAT('Patient/',scr.FACILITY_ID,'-',scr.PAT_MRN_ID)\n              ),\n              'dateTime',(SELECT MAX(scr.RECORDED_TIME) FROM screening scr WHERE adt.FACILITY_ID = scr.FACILITY_ID),\n              'organization', json_array(json_object('reference', 'Organization/' || qat.FACILITY_ID))\n\n\n        )\n      ) AS FHIR_Consent\n    FROM demographic_data adt LEFT JOIN qe_admin_data qat\n    ON adt.PAT_MRN_ID = qat.PAT_MRN_ID LEFT JOIN screening scr ON scr.PAT_MRN_ID = adt.PAT_MRN_ID\n    WHERE adt.PAT_MRN_ID IS NOT NULL AND qat.PAT_MRN_ID IS NOT NULL AND scr.PAT_MRN_ID IS NOT NULL\n    ),\n        cte_fhir_org AS (\n      SELECT DISTINCT ON (CONCAT(scr.ENCOUNTER_ID,scr.FACILITY_ID,'-',scr.PAT_MRN_ID)) CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID) END AS ENCOUNTER_ID,qed.PAT_MRN_ID, JSON_OBJECT(\n        'fullUrl', LOWER(REPLACE(qed.FACILITY_LONG_NAME, ' ', '-')) || '-' || LOWER(REPLACE(qed.ORGANIZATION_TYPE, ' ', '-')) || '-' || LOWER(REPLACE(qed.FACILITY_ID, ' ', '-')),\n        'resource', JSON_OBJECT(\n            'resourceType', 'Organization',\n            'id', qed.FACILITY_ID,\n            'meta', JSON_OBJECT(\n                'lastUpdated', (SELECT MAX(scr.RECORDED_TIME) FROM screening scr WHERE qed.FACILITY_ID = scr.FACILITY_ID),\n                'profile', JSON_ARRAY('http://shinny.org/StructureDefinition/shin-ny-organization')\n            ),\n            'identifier', JSON_ARRAY(\n                JSON_OBJECT(\n                    'system', qed.FACILITY_ID,\n                    'value', LOWER(REPLACE(qed.FACILITY_LONG_NAME, ' ', '-')) || '-' || LOWER(REPLACE(qed.ORGANIZATION_TYPE, ' ', '-')) || '-' || LOWER(REPLACE(qed.FACILITY_ID, ' ', '-'))\n                )\n            ),\n            'active', true,\n            CASE WHEN qed.ORGANIZATION_TYPE IS NOT NULL THEN 'type' ELSE NULL END, JSON_ARRAY(\n                JSON_OBJECT(\n                    'coding', JSON_ARRAY(\n                        JSON_OBJECT(\n                            'system', 'http://terminology.hl7.org/CodeSystem/organization-type',\n                            'code', qed.ORGANIZATION_TYPE,\n                            'display', qed.ORGANIZATION_TYPE\n                        )\n                    )\n                )\n            ),\n            'name', qed.FACILITY_LONG_NAME,\n            'address', JSON_ARRAY(\n                JSON_OBJECT(\n                    'text', CONCAT(qed.FACILITY_ADDRESS1,' ', qed.FACILITY_ADDRESS2),\n                    'city', qed.FACILITY_CITY,\n                    'state', qed.FACILITY_STATE,\n                    'postalCode', CAST(qed.FACILITY_ZIP AS TEXT)\n                )\n            )\n        )\n    ) AS FHIR_Organization\n    FROM qe_admin_data qed LEFT JOIN screening scr ON qed.PAT_MRN_ID=scr.PAT_MRN_ID WHERE qed.FACILITY_ID!='' AND qed.FACILITY_ID iS NOT NULL AND qed.PAT_MRN_ID IS NOT NULL AND scr.PAT_MRN_ID IS NOT NULL ORDER BY qed.FACILITY_ID\n    ),\n        derived_from_cte AS (\n      SELECT\n          parent_question_code,\n          parent_question_sl_no,\n          facility_id,\n          pat_mrn_id,\n          encounter_id,\n          recorded_time,\n          json_group_array(json_object('reference', derived_reference)) AS derived_from_references\n      FROM (\n          SELECT\n              acw.QUESTION_CODE AS parent_question_code,\n              acw.QUESTION_SLNO AS parent_question_sl_no,\n              scr.PAT_MRN_ID AS pat_mrn_id,\n              scr.FACILITY_ID AS facility_id,\n              scr.RECORDED_TIME AS recorded_time,\n              CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID)\tEND AS encounter_id,\n              CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN CONCAT('Observation/','observationResponseQuestion-',scr.ENCOUNTER_ID,'-',md5(scr.RECORDED_TIME),'-',acw_sub.QUESTION_SLNO) ELSE CONCAT('Observation/','observationResponseQuestion-',scr.PAT_MRN_ID,'-',scr.FACILITY_ID,'-',md5(scr.RECORDED_TIME),'-',acw_sub.QUESTION_SLNO) END  AS derived_reference\n          FROM\n              ahc_cross_walk acw\n          INNER JOIN ahc_cross_walk acw_sub ON acw_sub.\"QUESTION_SLNO_REFERENCE\" = acw.QUESTION_SLNO\n          INNER JOIN screening scr ON (scr.\"QUESTION_CODE\" = acw.QUESTION_CODE OR scr.\"QUESTION_CODE\" IS NULL)\n          GROUP BY\n              acw.QUESTION_CODE,\n              acw.QUESTION_SLNO,\n              acw_sub.QUESTION_SLNO,\n              scr.PAT_MRN_ID,\n              scr.FACILITY_ID,\n              scr.ENCOUNTER_ID,\n              scr.RECORDED_TIME\n      ) AS distinct_references\n      GROUP BY\n          parent_question_code,\n          parent_question_sl_no,\n          facility_id,\n          pat_mrn_id,\n          encounter_id,\n          recorded_time\n    ),\n        cte_fhir_observation AS (\n      SELECT CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID) END AS ENCOUNTER_ID,scr.PAT_MRN_ID, JSON_OBJECT(\n        'fullUrl', CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN CONCAT('observationResponseQuestion-',scr.ENCOUNTER_ID,'-',md5(scr.RECORDED_TIME),'-',acw.QUESTION_SLNO) ELSE CONCAT('observationResponseQuestion-',scr.PAT_MRN_ID,'-',scr.FACILITY_ID,'-',md5(scr.RECORDED_TIME),'-',acw.QUESTION_SLNO) END,\n        'resource', JSON_OBJECT(\n          'resourceType', 'Observation',\n              'id', CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN CONCAT('observationResponseQuestion-',scr.ENCOUNTER_ID,'-',md5(scr.RECORDED_TIME),'-',acw.QUESTION_SLNO) ELSE CONCAT('observationResponseQuestion-',scr.PAT_MRN_ID,'-',scr.FACILITY_ID,'-',md5(scr.RECORDED_TIME),'-',acw.QUESTION_SLNO) END,\n              'meta', JSON_OBJECT(\n                  'lastUpdated', scr.RECORDED_TIME,\n                  'profile', JSON_ARRAY('http://hl7.org/fhir/us/sdoh-clinicalcare/StructureDefinition/SDOHCC-ObservationScreeningResponse')\n              ),\n              'status', SCREENING_STATUS_CODE,\n              'category', json_array(json_object('coding',json_array(json_object('system','http://terminology.hl7.org/CodeSystem/observation-category','code','social-history','display','Social History'))),json_object('coding',json_array(json_object('system','http://terminology.hl7.org/CodeSystem/observation-category','code','survey','display','Survey'))),json_object('coding',json_array(json_object('system','http://hl7.org/fhir/us/sdoh-clinicalcare/CodeSystem/SDOHCC-CodeSystemTemporaryCodes','code',CASE WHEN sdr.Code IS NOT NULL AND sdr.Code != '' THEN sdr.Code ELSE 'sdoh-category-unspecified' END,'display',CASE WHEN sdr.Display IS NOT NULL AND sdr.Display != '' THEN sdr.Display ELSE 'SDOH Category Unspecified' END)))),\n              CASE WHEN QUESTION_CODE_DESCRIPTION IS NOT NULL THEN 'code' ELSE NULL END, json_object(\n                'coding', json_array(json_object(CASE WHEN QUESTION_CODE_SYSTEM_NAME IS NOT NULL THEN 'system' ELSE NULL END,QUESTION_CODE_SYSTEM_NAME,CASE WHEN scr.QUESTION_CODE IS NOT NULL THEN 'code' ELSE NULL END,scr.QUESTION_CODE,CASE WHEN QUESTION_CODE_DESCRIPTION IS NOT NULL THEN 'display' ELSE NULL END,QUESTION_CODE_DESCRIPTION))\n              ),\n              'subject', json_object('reference',CONCAT('Patient/',scr.FACILITY_ID,'-',scr.PAT_MRN_ID)),\n              'effectiveDateTime', scr.RECORDED_TIME,\n              'issued', scr.RECORDED_TIME,\n              'valueCodeableConcept',CASE WHEN acw.CALCULATED_FIELD = 1 THEN json_object('coding',json_array(json_object('system','http://unitsofmeasure.org','code',acw.\"UCUM_UNITS\",'display',ANSWER_CODE_DESCRIPTION))) ELSE json_object('coding',json_array(json_object('system','http://loinc.org','code',scr.ANSWER_CODE,'display',ANSWER_CODE_DESCRIPTION))) END,\n              CASE WHEN acw.CALCULATED_FIELD = 1 THEN 'derivedFrom' ELSE NULL END, COALESCE(df.derived_from_references, json_array()),\n              'interpretation',json_array(json_object('coding',json_array(json_object('system','http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation','code','POS','display','Positive'))))\n          )\n      ) AS FHIR_Observation\n      FROM screening scr LEFT JOIN sdoh_domain_reference sdr ON scr.SDOH_DOMAIN = sdr.Display LEFT JOIN (SELECT DISTINCT QUESTION_CODE, QUESTION_SLNO, \"UCUM_UNITS\", CALCULATED_FIELD FROM ahc_cross_walk) acw ON acw.QUESTION_SLNO = scr.src_file_row_number LEFT JOIN derived_from_cte df ON df.parent_question_sl_no = scr.src_file_row_number AND df.pat_mrn_id=scr.PAT_MRN_ID AND df.encounter_id = (CASE\n      WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID) END) AND md5(df.recorded_time) = md5(scr.RECORDED_TIME) WHERE acw.QUESTION_SLNO IS NOT NULL AND scr.PAT_MRN_ID IS NOT NULL ORDER BY acw.QUESTION_SLNO),\n        cte_fhir_observation_grouper AS (\n      SELECT CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID) END AS ENCOUNTER_ID,scr.PAT_MRN_ID, JSON_OBJECT(\n        'fullUrl', (SELECT CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN CONCAT('observationResponseQuestion-',scr.ENCOUNTER_ID,'-',md5(sub1.RECORDED_TIME),'-',slNo,'-grouper') ELSE CONCAT('observationResponseQuestion-',sub1.PAT_MRN_ID,'-',sub1.FACILITY_ID,'-',md5(sub1.RECORDED_TIME),'-',slNo,'-grouper') END\n                      FROM (SELECT MAX(QUESTION_SLNO) as slNo, PAT_MRN_ID, FACILITY_ID, RECORDED_TIME\n                            FROM\n                              screening ssub\n                            LEFT JOIN\n                              (SELECT DISTINCT QUESTION_SLNO FROM ahc_cross_walk) acw\n                            ON acw.QUESTION_SLNO = ssub.src_file_row_number\n                            WHERE ssub.SCREENING_CODE=scr.SCREENING_CODE AND acw.QUESTION_SLNO IS NOT NULL AND ssub.PAT_MRN_ID = scr.PAT_MRN_ID\n                            GROUP BY PAT_MRN_ID,FACILITY_ID,RECORDED_TIME\n                            ORDER BY RECORDED_TIME\n                          ) AS sub1),\n        'resource', JSON_OBJECT(\n          'resourceType', 'Observation',\n              'id', (SELECT CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN CONCAT('observationResponseQuestion-',scr.ENCOUNTER_ID,'-',md5(sub1.RECORDED_TIME),'-',slNo,'-grouper') ELSE CONCAT('observationResponseQuestion-',sub1.PAT_MRN_ID,'-',sub1.FACILITY_ID,'-',md5(sub1.RECORDED_TIME),'-',slNo,'-grouper') END\n                      FROM (SELECT MAX(QUESTION_SLNO) as slNo, PAT_MRN_ID, FACILITY_ID,RECORDED_TIME\n                            FROM\n                              screening ssub\n                            LEFT JOIN\n                              (SELECT DISTINCT QUESTION_SLNO FROM ahc_cross_walk) acw\n                            ON acw.QUESTION_SLNO = ssub.src_file_row_number\n                            WHERE ssub.SCREENING_CODE=scr.SCREENING_CODE AND acw.QUESTION_SLNO IS NOT NULL AND ssub.PAT_MRN_ID = scr.PAT_MRN_ID\n                            GROUP BY PAT_MRN_ID,FACILITY_ID,RECORDED_TIME\n                            ORDER BY RECORDED_TIME\n                          ) AS sub1),\n              'meta', JSON_OBJECT(\n                  'lastUpdated', MAX(RECORDED_TIME),\n                  'profile', JSON_ARRAY('http://hl7.org/fhir/us/sdoh-clinicalcare/StructureDefinition/SDOHCC-ObservationScreeningResponse')\n              ),\n              'status', SCREENING_STATUS_CODE,\n              'category', json_array(json_object('coding',json_array(json_object('system','http://terminology.hl7.org/CodeSystem/observation-category','code','social-history','display','Social History'))),json_object('coding',json_array(json_object('system','http://terminology.hl7.org/CodeSystem/observation-category','code','survey','display','Survey'))),json_object('coding',(SELECT json_group_array(JSON_OBJECT(\n                            'system', 'http://hl7.org/fhir/us/sdoh-clinicalcare/CodeSystem/SDOHCC-CodeSystemTemporaryCodes',\n                            'display', sub.display,\n                            'code', sub.code\n                        )) FROM (\n                            SELECT DISTINCT\n                                CASE WHEN sdr.Display IS NOT NULL AND sdr.Display != '' THEN sdr.Display ELSE 'SDOH Category Unspecified' END AS display,\n                                CASE WHEN sdr.Code IS NOT NULL AND sdr.Code != '' THEN sdr.Code ELSE 'sdoh-category-unspecified' END AS code\n                            FROM\n                              screening sub\n                            LEFT JOIN\n                                sdoh_domain_reference sdr\n                            ON\n                                sub.SDOH_DOMAIN = sdr.Display\n                            WHERE\n                                sub.SCREENING_CODE=scr.SCREENING_CODE\n                        ) AS sub ))\n              ),\n              CASE WHEN SCREENING_CODE_DESCRIPTION IS NOT NULL THEN 'code' ELSE NULL END, json_object(\n                'coding', json_array(json_object(CASE WHEN SCREENING_CODE_SYSTEM_NAME IS NOT NULL THEN 'system' ELSE NULL END,SCREENING_CODE_SYSTEM_NAME,CASE WHEN scr.SCREENING_CODE IS NOT NULL THEN 'code' ELSE NULL END,scr.SCREENING_CODE,CASE WHEN SCREENING_CODE_DESCRIPTION IS NOT NULL THEN 'display' ELSE NULL END,SCREENING_CODE_DESCRIPTION))\n              ),\n              'subject', json_object('reference',CONCAT('Patient/',scr.FACILITY_ID,'-',scr.PAT_MRN_ID)),\n              CASE WHEN ENCOUNTER_ID IS NOT NULL THEN 'encounter' ELSE NULL END, json_object('reference',CONCAT('Encounter/',ENCOUNTER_ID)),\n              'effectiveDateTime', MAX(RECORDED_TIME),\n              'issued', MAX(RECORDED_TIME),\n              'hasMember', (SELECT json_group_array(JSON_OBJECT(\n                              'reference', CASE WHEN sub1.ENCOUNTER_ID IS NOT NULL THEN CONCAT('Observation/','observationResponseQuestion-',sub1.ENCOUNTER_ID,'-',md5(sub1.RECORDED_TIME),'-',sub1.QUESTION_SLNO) ELSE CONCAT('Observation/','observationResponseQuestion-',sub1.PAT_MRN_ID,'-',sub1.FACILITY_ID,'-',md5(sub1.RECORDED_TIME),'-',sub1.QUESTION_SLNO) END\n                          ))\n                          FROM (\n                          SELECT DISTINCT\n                              QUESTION_SLNO, PAT_MRN_ID, FACILITY_ID, RECORDED_TIME, ENCOUNTER_ID\n                          FROM\n                          screening ssub\n                          LEFT JOIN\n                            (SELECT DISTINCT QUESTION_SLNO FROM ahc_cross_walk) acw\n                          ON acw.QUESTION_SLNO = ssub.src_file_row_number\n                          WHERE ssub.SCREENING_CODE=scr.SCREENING_CODE AND ssub.PAT_MRN_ID=scr.PAT_MRN_ID AND ssub.FACILITY_ID=scr.FACILITY_ID AND acw.QUESTION_SLNO IS NOT NULL GROUP BY acw.QUESTION_SLNO, PAT_MRN_ID, FACILITY_ID, RECORDED_TIME, ENCOUNTER_ID\n                          ORDER BY acw.QUESTION_SLNO\n                      ) AS sub1\n                          )\n          )\n      ) AS FHIR_Observation_Grouper\n      FROM screening scr WHERE scr.PAT_MRN_ID IS NOT NULL GROUP BY SCREENING_CODE, FACILITY_ID, PAT_MRN_ID, SCREENING_CODE_DESCRIPTION,SCREENING_STATUS_CODE, SCREENING_CODE_SYSTEM_NAME,ENCOUNTER_ID),\n        cte_fhir_encounter AS (\n      SELECT DISTINCT ON (CONCAT(scr.ENCOUNTER_ID,scr.FACILITY_ID,'-',scr.PAT_MRN_ID)) scr.PAT_MRN_ID, CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID) END AS ENCOUNTER_ID, JSON_OBJECT(\n        'fullUrl', CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID) END,\n        'resource', JSON_OBJECT(\n          'resourceType', 'Encounter',\n          'id', CASE WHEN scr.ENCOUNTER_ID IS NOT NULL THEN scr.ENCOUNTER_ID ELSE CONCAT('encounter-',scr.FACILITY_ID,'-',scr.PAT_MRN_ID) END,\n          'meta', JSON_OBJECT(\n              'lastUpdated', RECORDED_TIME,\n              'profile', JSON_ARRAY('http://shinny.org/StructureDefinition/shin-ny-encounter')\n          ),\n          'status', CASE WHEN ENCOUNTER_STATUS_CODE IS NOT NULL THEN ENCOUNTER_STATUS_CODE ELSE 'unknown' END,\n          'class', json_object('system',ENCOUNTER_CLASS_CODE_SYSTEM,CASE WHEN ENCOUNTER_CLASS_CODE IS NOT NULL THEN 'code' ELSE NULL END,ENCOUNTER_CLASS_CODE),\n          'type', json_array(json_object('coding',json_array(json_object('system',ENCOUNTER_TYPE_CODE_SYSTEM,CASE WHEN ENCOUNTER_TYPE_CODE IS NOT NULL THEN 'code' ELSE NULL END,  CAST(ENCOUNTER_TYPE_CODE AS TEXT),'display', ENCOUNTER_TYPE_CODE_DESCRIPTION  )),'text',ENCOUNTER_TYPE_CODE_DESCRIPTION)),\n          'subject', json_object('reference',CONCAT('Patient/',scr.FACILITY_ID,'-',scr.PAT_MRN_ID))\n        )\n    ) AS FHIR_Encounter\n    FROM screening scr LEFT JOIN cte_fhir_patient ON scr.PAT_MRN_ID=cte_fhir_patient.PAT_MRN_ID WHERE scr.PAT_MRN_ID IS NOT NULL ORDER BY scr.ENCOUNTER_ID, scr.RECORDED_TIME DESC)\n        SELECT cte.ENCOUNTER_ID,cte.PAT_MRN_ID, json_object(\n          'resourceType', 'Bundle',\n              'id', CONCAT('84d832e0-0936-11ef-9028-cda0a7254a37','-',PAT_MRN_ID,'-',ENCOUNTER_ID),\n              'type', 'transaction',\n              'meta', JSON_OBJECT(\n                  'lastUpdated', (SELECT MAX(scr.RECORDED_TIME) FROM screening scr)\n              ),\n              'timestamp', '2024-05-03T10:18:43.342Z',\n              'entry', json(json_group_array(cte.json_data))\n          ) AS FHIR_Bundle\n          FROM (\n            SELECT ENCOUNTER_ID, PAT_MRN_ID, FHIR_Organization AS json_data FROM cte_fhir_org\n            UNION ALL\n            SELECT ENCOUNTER_ID, PAT_MRN_ID, FHIR_Patient AS json_data FROM cte_fhir_patient\n            UNION ALL\n            SELECT ENCOUNTER_ID, PAT_MRN_ID, FHIR_Observation AS json_data FROM cte_fhir_observation\n            UNION ALL\n            SELECT ENCOUNTER_ID, PAT_MRN_ID, FHIR_Observation_Grouper AS json_data FROM cte_fhir_observation_grouper\n            UNION ALL\n            SELECT ENCOUNTER_ID, PAT_MRN_ID, FHIR_Encounter AS json_data FROM cte_fhir_encounter\n            UNION ALL\n            SELECT ENCOUNTER_ID, PAT_MRN_ID, FHIR_Consent AS json_data FROM cte_fhir_consent\n          ) AS cte\n          GROUP BY cte.PAT_MRN_ID, cte.ENCOUNTER_ID;\n    \n```\nNo STDOUT emitted by `execute_6` (status: `0`).\n\nNo STDERR emitted by `execute_6`.\n\n    "}},{"insertable":{"exec_identity":"jsonResult_7","exec_code":"duckdb HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.workflow/ingestion-center.duckdb --json","sql":"-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nSELECT COUNT(*) AS table_count FROM information_schema.tables WHERE table_name IN ('screening', 'demographic_data', 'qe_admin_data');\n      ","output_nature":"JSON","orch_session_exec_id":"8bc0b587-08e6-5791-96fb-c15c39df2a11","exec_nature":"duckdb","exec_status":0,"input_text":"-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nSELECT COUNT(*) AS table_count FROM information_schema.tables WHERE table_name IN ('screening', 'demographic_data', 'qe_admin_data');\n      ","output_text":"[{\"table_count\":3}]\n","session_id":"52c6a395-5d83-4051-bb7c-39036f26ab29","narrative_md":"\n## jsonResult_7\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nSELECT COUNT(*) AS table_count FROM information_schema.tables WHERE table_name IN ('screening', 'demographic_data', 'qe_admin_data');\n      \n```\n### `jsonResult_7` STDOUT (status: `0`)\n```json\n[{\"table_count\":3}]\n\n```\nNo STDERR emitted by `jsonResult_7`.\n\n    "}},{"insertable":{"exec_identity":"emitDiagnostics","exec_code":"duckdb HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.workflow/ingestion-center.duckdb","sql":"-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSTALL spatial; LOAD spatial;\n-- TODO: join with orch_session table to give all the results in one sheet\nCOPY (SELECT * FROM orch_session_issue_classification) TO 'HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/diagnostics.xlsx' WITH (FORMAT GDAL, DRIVER 'xlsx');","orch_session_exec_id":"487db3ae-12c4-51c7-a5a9-a145b5d6df98","exec_nature":"duckdb","exec_status":0,"input_text":"-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSTALL spatial; LOAD spatial;\n-- TODO: join with orch_session table to give all the results in one sheet\nCOPY (SELECT * FROM orch_session_issue_classification) TO 'HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/diagnostics.xlsx' WITH (FORMAT GDAL, DRIVER 'xlsx');","session_id":"52c6a395-5d83-4051-bb7c-39036f26ab29","narrative_md":"\n## emitDiagnostics\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSTALL spatial; LOAD spatial;\n-- TODO: join with orch_session table to give all the results in one sheet\nCOPY (SELECT * FROM orch_session_issue_classification) TO 'HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/diagnostics.xlsx' WITH (FORMAT GDAL, DRIVER 'xlsx');\n```\nNo STDOUT emitted by `emitDiagnostics` (status: `0`).\n\nNo STDERR emitted by `emitDiagnostics`.\n\n    "}},{"insertable":{"exec_identity":"emitDiagnostics","exec_code":"duckdb HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.workflow/ingestion-center.duckdb","sql":"-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSTALL spatial; LOAD spatial;\n  COPY (SELECT * FROM orch_session_fhir_emit) TO 'HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/diagnostics-fhir.xlsx' WITH (FORMAT GDAL, DRIVER 'xlsx');","orch_session_exec_id":"eecba0aa-220d-52dc-aa67-95ee4e8a613f","exec_nature":"duckdb","exec_status":0,"input_text":"-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSTALL spatial; LOAD spatial;\n  COPY (SELECT * FROM orch_session_fhir_emit) TO 'HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/diagnostics-fhir.xlsx' WITH (FORMAT GDAL, DRIVER 'xlsx');","session_id":"52c6a395-5d83-4051-bb7c-39036f26ab29","narrative_md":"\n## emitDiagnostics\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSTALL spatial; LOAD spatial;\n  COPY (SELECT * FROM orch_session_fhir_emit) TO 'HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/diagnostics-fhir.xlsx' WITH (FORMAT GDAL, DRIVER 'xlsx');\n```\nNo STDOUT emitted by `emitDiagnostics` (status: `0`).\n\nNo STDERR emitted by `emitDiagnostics`.\n\n    "}},{"insertable":{"exec_identity":"jsonResult_10","exec_code":"duckdb HTTP/healthelink/egress/52c6a395-5d83-4051-bb7c-39036f26ab29/.workflow/ingestion-center.duckdb --json","sql":"-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nSELECT * FROM orch_session_fhir_emit;\n        ","output_nature":"JSON","orch_session_exec_id":"e4b7f945-ff66-525d-a282-860d452a53f4","exec_nature":"duckdb","exec_status":0,"input_text":"-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nSELECT * FROM orch_session_fhir_emit;\n        ","output_text":"[{\"ENCOUNTER_ID\":\"healthelinkGYNB8RC1AS\",\"ORCH_SESSION_ID\":\"52c6a395-5d83-4051-bb7c-39036f26ab29\",\"DEVICE_ID\":\"fb100496-cb54-5e75-8a29-4fe36e78b522\",\"VERSION\":\"0.17.2\",\"ORCH_SESSION_ENTRY_ID\":\"d09ebe08-1b63-56d8-8f2b-8fff76c9828f\",\"PAT_MRN_ID\":\"healthelink-20240305-testcase3-MRN\",\"DISPOSITION\":\"\",\"FHIR_EMITTABLE\":\"YES\",\"FHIR_JSON_FILE\":\"fhir-healthelink-20240305-testcase3-MRN-healthelinkGYNB8RC1AS.json\"},\n{\"ENCOUNTER_ID\":\"healthelink19VCFAQISN\",\"ORCH_SESSION_ID\":\"52c6a395-5d83-4051-bb7c-39036f26ab29\",\"DEVICE_ID\":\"fb100496-cb54-5e75-8a29-4fe36e78b522\",\"VERSION\":\"0.17.2\",\"ORCH_SESSION_ENTRY_ID\":\"d09ebe08-1b63-56d8-8f2b-8fff76c9828f\",\"PAT_MRN_ID\":\"healthelink-20240305-testcase3-MRN\",\"DISPOSITION\":\"\",\"FHIR_EMITTABLE\":\"YES\",\"FHIR_JSON_FILE\":\"fhir-healthelink-20240305-testcase3-MRN-healthelink19VCFAQISN.json\"},\n{\"ENCOUNTER_ID\":\"healthelinkGYNB8RC1AS\",\"ORCH_SESSION_ID\":\"52c6a395-5d83-4051-bb7c-39036f26ab29\",\"DEVICE_ID\":\"fb100496-cb54-5e75-8a29-4fe36e78b522\",\"VERSION\":\"0.17.2\",\"ORCH_SESSION_ENTRY_ID\":\"963ed7bf-d356-54ae-ba2a-739f7f164e1a\",\"PAT_MRN_ID\":\"healthelink-20240305-testcase3-MRN\",\"DISPOSITION\":\"\",\"FHIR_EMITTABLE\":\"YES\",\"FHIR_JSON_FILE\":\"fhir-healthelink-20240305-testcase3-MRN-healthelinkGYNB8RC1AS.json\"},\n{\"ENCOUNTER_ID\":\"healthelink19VCFAQISN\",\"ORCH_SESSION_ID\":\"52c6a395-5d83-4051-bb7c-39036f26ab29\",\"DEVICE_ID\":\"fb100496-cb54-5e75-8a29-4fe36e78b522\",\"VERSION\":\"0.17.2\",\"ORCH_SESSION_ENTRY_ID\":\"963ed7bf-d356-54ae-ba2a-739f7f164e1a\",\"PAT_MRN_ID\":\"healthelink-20240305-testcase3-MRN\",\"DISPOSITION\":\"\",\"FHIR_EMITTABLE\":\"YES\",\"FHIR_JSON_FILE\":\"fhir-healthelink-20240305-testcase3-MRN-healthelink19VCFAQISN.json\"}]\n","session_id":"52c6a395-5d83-4051-bb7c-39036f26ab29","narrative_md":"\n## jsonResult_10\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nSELECT * FROM orch_session_fhir_emit;\n        \n```\n### `jsonResult_10` STDOUT (status: `0`)\n```json\n[{\"ENCOUNTER_ID\":\"healthelinkGYNB8RC1AS\",\"ORCH_SESSION_ID\":\"52c6a395-5d83-4051-bb7c-39036f26ab29\",\"DEVICE_ID\":\"fb100496-cb54-5e75-8a29-4fe36e78b522\",\"VERSION\":\"0.17.2\",\"ORCH_SESSION_ENTRY_ID\":\"d09ebe08-1b63-56d8-8f2b-8fff76c9828f\",\"PAT_MRN_ID\":\"healthelink-20240305-testcase3-MRN\",\"DISPOSITION\":\"\",\"FHIR_EMITTABLE\":\"YES\",\"FHIR_JSON_FILE\":\"fhir-healthelink-20240305-testcase3-MRN-healthelinkGYNB8RC1AS.json\"},\n{\"ENCOUNTER_ID\":\"healthelink19VCFAQISN\",\"ORCH_SESSION_ID\":\"52c6a395-5d83-4051-bb7c-39036f26ab29\",\"DEVICE_ID\":\"fb100496-cb54-5e75-8a29-4fe36e78b522\",\"VERSION\":\"0.17.2\",\"ORCH_SESSION_ENTRY_ID\":\"d09ebe08-1b63-56d8-8f2b-8fff76c9828f\",\"PAT_MRN_ID\":\"healthelink-20240305-testcase3-MRN\",\"DISPOSITION\":\"\",\"FHIR_EMITTABLE\":\"YES\",\"FHIR_JSON_FILE\":\"fhir-healthelink-20240305-testcase3-MRN-healthelink19VCFAQISN.json\"},\n{\"ENCOUNTER_ID\":\"healthelinkGYNB8RC1AS\",\"ORCH_SESSION_ID\":\"52c6a395-5d83-4051-bb7c-39036f26ab29\",\"DEVICE_ID\":\"fb100496-cb54-5e75-8a29-4fe36e78b522\",\"VERSION\":\"0.17.2\",\"ORCH_SESSION_ENTRY_ID\":\"963ed7bf-d356-54ae-ba2a-739f7f164e1a\",\"PAT_MRN_ID\":\"healthelink-20240305-testcase3-MRN\",\"DISPOSITION\":\"\",\"FHIR_EMITTABLE\":\"YES\",\"FHIR_JSON_FILE\":\"fhir-healthelink-20240305-testcase3-MRN-healthelinkGYNB8RC1AS.json\"},\n{\"ENCOUNTER_ID\":\"healthelink19VCFAQISN\",\"ORCH_SESSION_ID\":\"52c6a395-5d83-4051-bb7c-39036f26ab29\",\"DEVICE_ID\":\"fb100496-cb54-5e75-8a29-4fe36e78b522\",\"VERSION\":\"0.17.2\",\"ORCH_SESSION_ENTRY_ID\":\"963ed7bf-d356-54ae-ba2a-739f7f164e1a\",\"PAT_MRN_ID\":\"healthelink-20240305-testcase3-MRN\",\"DISPOSITION\":\"\",\"FHIR_EMITTABLE\":\"YES\",\"FHIR_JSON_FILE\":\"fhir-healthelink-20240305-testcase3-MRN-healthelink19VCFAQISN.json\"}]\n\n```\nNo STDERR emitted by `jsonResult_10`.\n\n    "}}],"fhirDiags":[{"ENCOUNTER_ID":"healthelinkGYNB8RC1AS","ORCH_SESSION_ID":"52c6a395-5d83-4051-bb7c-39036f26ab29","DEVICE_ID":"fb100496-cb54-5e75-8a29-4fe36e78b522","VERSION":"0.17.2","ORCH_SESSION_ENTRY_ID":"d09ebe08-1b63-56d8-8f2b-8fff76c9828f","PAT_MRN_ID":"healthelink-20240305-testcase3-MRN","DISPOSITION":"","FHIR_EMITTABLE":"YES","FHIR_JSON_FILE":"fhir-healthelink-20240305-testcase3-MRN-healthelinkGYNB8RC1AS.json"},{"ENCOUNTER_ID":"healthelink19VCFAQISN","ORCH_SESSION_ID":"52c6a395-5d83-4051-bb7c-39036f26ab29","DEVICE_ID":"fb100496-cb54-5e75-8a29-4fe36e78b522","VERSION":"0.17.2","ORCH_SESSION_ENTRY_ID":"d09ebe08-1b63-56d8-8f2b-8fff76c9828f","PAT_MRN_ID":"healthelink-20240305-testcase3-MRN","DISPOSITION":"","FHIR_EMITTABLE":"YES","FHIR_JSON_FILE":"fhir-healthelink-20240305-testcase3-MRN-healthelink19VCFAQISN.json"},{"ENCOUNTER_ID":"healthelinkGYNB8RC1AS","ORCH_SESSION_ID":"52c6a395-5d83-4051-bb7c-39036f26ab29","DEVICE_ID":"fb100496-cb54-5e75-8a29-4fe36e78b522","VERSION":"0.17.2","ORCH_SESSION_ENTRY_ID":"963ed7bf-d356-54ae-ba2a-739f7f164e1a","PAT_MRN_ID":"healthelink-20240305-testcase3-MRN","DISPOSITION":"","FHIR_EMITTABLE":"YES","FHIR_JSON_FILE":"fhir-healthelink-20240305-testcase3-MRN-healthelinkGYNB8RC1AS.json"},{"ENCOUNTER_ID":"healthelink19VCFAQISN","ORCH_SESSION_ID":"52c6a395-5d83-4051-bb7c-39036f26ab29","DEVICE_ID":"fb100496-cb54-5e75-8a29-4fe36e78b522","VERSION":"0.17.2","ORCH_SESSION_ENTRY_ID":"963ed7bf-d356-54ae-ba2a-739f7f164e1a","PAT_MRN_ID":"healthelink-20240305-testcase3-MRN","DISPOSITION":"","FHIR_EMITTABLE":"YES","FHIR_JSON_FILE":"fhir-healthelink-20240305-testcase3-MRN-healthelink19VCFAQISN.json"}]}